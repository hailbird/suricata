# Emerging Threats
#
# This distribution may contain rules under two different licenses.
#
#  Rules with sids 1 through 3464, and 100000000 through 100000908 are under the GPLv2.
#  A copy of that license is available at http://www.gnu.org/licenses/gpl-2.0.html
#
#  Rules with sids 2000000 through 2799999 are from Emerging Threats and are covered under the BSD License
#  as follows:
#
#*************************************************************
#  Copyright (c) 2003-2017, Emerging Threats
#  All rights reserved.
#
#  Redistribution and use in source and binary forms, with or without modification, are permitted provided that the
#  following conditions are met:
#
#  * Redistributions of source code must retain the above copyright notice, this list of conditions and the following
#    disclaimer.
#  * Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the
#    following disclaimer in the documentation and/or other materials provided with the distribution.
#  * Neither the name of the nor the names of its contributors may be used to endorse or promote products derived
#    from this software without specific prior written permission.
#
#  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY EXPRESS OR IMPLIED WARRANTIES,
#  INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
#  DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
#  SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
#  SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,
#  WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE
#  USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
#
#*************************************************************
#
#
#
#

# ET EXPLOIT Possible ZyXELs ZynOS Configuration Download Attempt (Contains Passwords) (attempted-admin) - detector_id: 45354 original_sid: 2018232
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET EXPLOIT Possible ZyXELs ZynOS Configuration Download Attempt (Contains Passwords)"; flow:established,to_server; urilen:6; content:"/rom-0"; http_uri; nocase; metadata:former_category CURRENT_EVENTS, flip_endpoints False, server_side True; reference:url,www.team-cymru.com/ReadingRoom/Whitepapers/2013/TeamCymruSOHOPharming.pdf; classtype:attempted-admin; sid:1045354; rev:3; metadata:created_at 2014_03_07, updated_at 2017_11_28; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Linksys WAP54G debug.cgi Shell Access as Gemtek (attempted-admin) - detector_id: 54448 original_sid: 2011669
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"ET EXPLOIT Linksys WAP54G debug.cgi Shell Access as Gemtek"; flow:established,to_server; content:"Authorization|3a| Basic R2VtdGVrOmdlbXRla3N3ZA==|0d 0a|"; http_header; content:"/debug.cgi"; http_uri; reference:url,seclists.org/fulldisclosure/2010/Jun/176; reference:url,doc.emergingthreats.net/2011669; classtype:attempted-admin; sid:1054448; rev:4; metadata:created_at 2010_07_30, updated_at 2010_07_30, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT xp_enumerrorlogs access (attempted-user) - detector_id: 54457 original_sid: 2010001
alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 1433 (msg:"ET EXPLOIT xp_enumerrorlogs access"; flow:to_server,established; content:"x|00|p|00|_|00|e|00|n|00|u|00|m|00|e|00|r|00|r|00|o|00|r|00|l|00|o|00|g|00|s|00|"; nocase; metadata:former_category ATTACK_RESPONSE, flip_endpoints False, server_side True; reference:url,doc.emergingthreats.net/2010001; classtype:attempted-user; sid:1054457; rev:4; metadata:created_at 2010_07_30, updated_at 2018_01_09; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT xp_readerrorlogs access (attempted-user) - detector_id: 54458 original_sid: 2010002
alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 1433 (msg:"ET EXPLOIT xp_readerrorlogs access"; flow:to_server,established; content:"x|00|p|00|_|00|r|00|e|00|a|00|d|00|e|00|r|00|r|00|o|00|r|00|l|00|o|00|g|00|s|00|"; nocase; metadata:former_category ATTACK_RESPONSE, flip_endpoints False, server_side True; reference:url,doc.emergingthreats.net/2010002; classtype:attempted-user; sid:1054458; rev:5; metadata:created_at 2010_07_30, updated_at 2018_01_09; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT xp_enumdsn access (attempted-user) - detector_id: 54459 original_sid: 2010003
alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 1433 (msg:"ET EXPLOIT xp_enumdsn access"; flow:to_server,established; content:"x|00|p|00|_|00|e|00|n|00|u|00|m|00|d|00|s|00|n|00|"; nocase; metadata:former_category ATTACK_RESPONSE, flip_endpoints False, server_side True; reference:url,doc.emergingthreats.net/2010003; classtype:attempted-user; sid:1054459; rev:5; metadata:created_at 2010_07_30, updated_at 2018_01_09; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Possible Oracle Database Text Component ctxsys.drvxtabc.create_tables Remote SQL Injection Attempt (attempted-admin) - detector_id: 54470 original_sid: 2010375
alert tcp $EXTERNAL_NET any -> $HOME_NET $ORACLE_PORTS (msg:"ET EXPLOIT Possible Oracle Database Text Component ctxsys.drvxtabc.create_tables Remote SQL Injection Attempt"; flow:established,to_server; content:"ctxsys|2E|drvxtabc|2E|create|5F|tables"; nocase; content:"dbms|5F|sql|2E|execute"; nocase; distance:0; pcre:"/ctxsys\x2Edrvxtabc\x2Ecreate\x5Ftables.+(SELECT|DELETE|CREATE|INSERT|UPDATE|OUTFILE)/si"; reference:url,www.securityfocus.com/bid/36748; reference:cve,2009-1991; reference:url,doc.emergingthreats.net/2010375; classtype:attempted-admin; sid:1054470; rev:2; metadata:affected_product Web_Server_Applications, attack_target Web_Server, deployment Datacenter, tag SQL_Injection, signature_severity Major, created_at 2010_07_30, updated_at 2016_07_01, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Pwdump3e Session Established Reg-Entry port 139 (suspicious-login) - detector_id: 54473 original_sid: 2000565
alert tcp any any -> $HOME_NET 139 (msg:"ET EXPLOIT Pwdump3e Session Established Reg-Entry port 139"; flow:to_server,established; content:"|53 00 4f 00 46 00 54 00 57 00 41 00 52 00 45 00 5c 00 45 00 62 00 69 00 7a 00 5c 00 68 00 61 00 73 00 68|"; reference:url,doc.emergingthreats.net/bin/view/Main/2000565; classtype:suspicious-login; sid:1054473; rev:8; metadata:created_at 2010_07_30, updated_at 2010_07_30, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Pwdump3e Session Established Reg-Entry port 445 (suspicious-login) - detector_id: 54474 original_sid: 2000566
alert tcp any any -> $HOME_NET 445 (msg:"ET EXPLOIT Pwdump3e Session Established Reg-Entry port 445"; flow:to_server,established; content:"|53 00 4f 00 46 00 54 00 57 00 41 00 52 00 45 00 5c 00 45 00 62 00 69 00 7a 00 5c 00 68 00 61 00 73 00 68|"; reference:url,doc.emergingthreats.net/bin/view/Main/2000566; classtype:suspicious-login; sid:1054474; rev:8; metadata:created_at 2010_07_30, updated_at 2010_07_30, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Pwdump3e pwservice.exe Access port 445 (misc-attack) - detector_id: 54475 original_sid: 2000564
alert tcp any any -> $HOME_NET 445 (msg:"ET EXPLOIT Pwdump3e pwservice.exe Access port 445"; flow:to_server,established; content:"p|00|w|00|s|00|e|00|r|00|v|00|i|00|c|00|e|00|.|00|e|00|x|00|e"; reference:url,doc.emergingthreats.net/bin/view/Main/2000564; classtype:misc-attack; sid:1054475; rev:9; metadata:created_at 2010_07_30, updated_at 2010_07_30, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Pwdump3e pwservice.exe Access port 139 (misc-attack) - detector_id: 54476 original_sid: 2000567
alert tcp any any -> $HOME_NET 139 (msg:"ET EXPLOIT Pwdump3e pwservice.exe Access port 139"; flow:to_server,established; content:"p|00|w|00|s|00|e|00|r|00|v|00|i|00|c|00|e|00|.|00|e|00|x|00|e"; reference:url,doc.emergingthreats.net/bin/view/Main/2000567; classtype:misc-attack; sid:1054476; rev:8; metadata:created_at 2010_07_30, updated_at 2010_07_30, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Pwdump3e Password Hash Retrieval port 445 (misc-attack) - detector_id: 54477 original_sid: 2000563
alert tcp $HOME_NET 445 -> any any (msg:"ET EXPLOIT Pwdump3e Password Hash Retrieval port 445"; flow:from_server,established; content:"|3a 00|5|00|0|00|0|3a|"; reference:url,doc.emergingthreats.net/bin/view/Main/2000563; classtype:misc-attack; sid:1054477; rev:11; metadata:created_at 2010_07_30, updated_at 2010_07_30, flip_endpoints True, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET EXPLOIT Pwdump3e Password Hash Retrieval port 139 (misc-attack) - detector_id: 54478 original_sid: 2000568
alert tcp $HOME_NET 139 -> any any (msg:"ET EXPLOIT Pwdump3e Password Hash Retrieval port 139"; flow:from_server,established; content:"|3a 00|5|00|0|00|0|3a|"; reference:url,doc.emergingthreats.net/bin/view/Main/2000568; classtype:misc-attack; sid:1054478; rev:10; metadata:created_at 2010_07_30, updated_at 2010_07_30, flip_endpoints True, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET EXPLOIT NTDump.exe Service Started port 139 (misc-activity) - detector_id: 54479 original_sid: 2001053
alert tcp any any -> $HOME_NET 139 (msg:"ET EXPLOIT NTDump.exe Service Started port 139"; flow:to_server,established; content:"|4e 00 74 00 44 00 75 00 6d 00 70 00 53 00 76 00 63 00 2e 00 65 00 78 00 65 00|"; reference:url,doc.emergingthreats.net/bin/view/Main/2001053; classtype:misc-activity; sid:1054479; rev:7; metadata:created_at 2010_07_30, updated_at 2010_07_30, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT NTDump.exe Service Started port 445 (misc-activity) - detector_id: 54480 original_sid: 2001544
alert tcp any any -> $HOME_NET 445 (msg:"ET EXPLOIT NTDump.exe Service Started port 445"; flow:to_server,established; content:"|4e 00 74 00 44 00 75 00 6d 00 70 00 53 00 76 00 63 00 2e 00 65 00 78 00 65 00|"; reference:url,doc.emergingthreats.net/bin/view/Main/2001544; classtype:misc-activity; sid:1054480; rev:7; metadata:created_at 2010_07_30, updated_at 2010_07_30, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT NTDump Session Established Reg-Entry port 139 (misc-activity) - detector_id: 54481 original_sid: 2001052
alert tcp any any -> $HOME_NET 139 (msg:"ET EXPLOIT NTDump Session Established Reg-Entry port 139"; flow:to_server,established; content:"|53 00 4f 00 46 00 54 00 57 00 41 00 52 00 45 00 5c 00 4e 00 74 00 44 00 75 00 6d 00 70 00|"; reference:url,doc.emergingthreats.net/bin/view/Main/2001052; classtype:misc-activity; sid:1054481; rev:8; metadata:created_at 2010_07_30, updated_at 2010_07_30, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT NTDump Session Established Reg-Entry port 445 (misc-activity) - detector_id: 54482 original_sid: 2001543
alert tcp any any -> $HOME_NET 445 (msg:"ET EXPLOIT NTDump Session Established Reg-Entry port 445"; flow:to_server,established; content:"|53 00 4f 00 46 00 54 00 57 00 41 00 52 00 45 00 5c 00 4e 00 74 00 44 00 75 00 6d 00 70 00|"; reference:url,doc.emergingthreats.net/bin/view/Main/2001543; classtype:misc-activity; sid:1054482; rev:7; metadata:created_at 2010_07_30, updated_at 2010_07_30, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Pwdump4 Session Established GetHash port 139 (suspicious-login) - detector_id: 54483 original_sid: 2001753
alert tcp any any -> $HOME_NET 139 (msg:"ET EXPLOIT Pwdump4 Session Established GetHash port 139"; flow:to_server,established; content:"|50 57 44 75 6d 70 34 2e 64 6c 6c 00 47 65 74 48 61 73 68|"; reference:url,doc.emergingthreats.net/bin/view/Main/2001753; classtype:suspicious-login; sid:1054483; rev:4; metadata:created_at 2010_07_30, updated_at 2010_07_30, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Pwdump4 Session Established GetHash port 445 (suspicious-login) - detector_id: 54484 original_sid: 2001754
alert tcp any any -> $HOME_NET 445 (msg:"ET EXPLOIT Pwdump4 Session Established GetHash port 445"; flow:to_server,established; content:"|50 57 44 75 6d 70 34 2e 64 6c 6c 00 47 65 74 48 61 73 68|"; reference:url,doc.emergingthreats.net/bin/view/Main/2001754; classtype:suspicious-login; sid:1054484; rev:4; metadata:created_at 2010_07_30, updated_at 2010_07_30, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT PWDump4 Password dumping exe copied to victim (suspicious-filename-detect) - detector_id: 54485 original_sid: 2008444
alert tcp any any -> $HOME_NET [139,445] (msg:"ET EXPLOIT PWDump4 Password dumping exe copied to victim"; flow:to_server,established; content:"|4F 00 72 00 69 00 67 00 69 00 6E 00 61 00 6C 00 46 00 69 00 6C 00 65 00 6E 00 61 00 6D 00 65 00 00 00 50 00 57 00 44 00 55 00 4D 00 50 00 34 00 2E 00 65 00 78 00 65|"; reference:url,xinn.org/Snort-pwdump4.html; reference:url,doc.emergingthreats.net/bin/view/Main/2008444; classtype:suspicious-filename-detect; sid:1054485; rev:3; metadata:created_at 2010_07_30, updated_at 2010_07_30, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Pwdump6 Session Established test file created on victim (suspicious-filename-detect) - detector_id: 54486 original_sid: 2008445
alert tcp any any -> $HOME_NET [139,445] (msg:"ET EXPLOIT Pwdump6 Session Established test file created on victim"; flow:to_server,established; content:"|5c 00 74 00 65 00 73 00 74 00 2e 00 70 00 77 00 64|"; reference:url,xinn.org/Snort-pwdump6.html; reference:url,doc.emergingthreats.net/bin/view/Main/2008445; classtype:suspicious-filename-detect; sid:1054486; rev:3; metadata:created_at 2010_07_30, updated_at 2010_07_30, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT SQL sp_configure - configuration change (attempted-user) - detector_id: 54488 original_sid: 2008517
alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 1433 (msg:"ET EXPLOIT SQL sp_configure - configuration change"; flow:to_server,established; content:"s|00|p|00|_|00|c|00|o|00|n|00|f|00|i|00|g|00|u|00|r|00|e|00|"; nocase; reference:url,msdn.microsoft.com/en-us/library/ms190693.aspx; reference:url,doc.emergingthreats.net/bin/view/Main/2008517; classtype:attempted-user; sid:1054488; rev:2; metadata:created_at 2010_07_30, updated_at 2010_07_30, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT SQL sp_configure attempt (attempted-user) - detector_id: 54489 original_sid: 2008518
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"ET EXPLOIT SQL sp_configure attempt"; flow:to_server,established; content:"sp_configure"; nocase; reference:url,msdn.microsoft.com/en-us/library/ms190693.aspx; reference:url,doc.emergingthreats.net/bin/view/Main/2008518; classtype:attempted-user; sid:1054489; rev:2; metadata:created_at 2010_07_30, updated_at 2010_07_30, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Possible Etrust Secure Transaction Platform Identification and Entitlements Server File Disclosure Attempt (misc-attack) - detector_id: 54788 original_sid: 2011502
alert tcp $EXTERNAL_NET any -> $HOME_NET 50002 (msg:"ET EXPLOIT Possible Etrust Secure Transaction Platform Identification and Entitlements Server File Disclosure Attempt"; flow:established,to_server; content:"POST "; nocase; depth:5; content:"<!DOCTYPE"; nocase; distance:0; content:"<!ENTITY"; nocase; distance:0; content:"<soapenv|3A|Envelope"; nocase; distance:0; content:"<ns1|3A|Username>"; nocase; distance:0; flowbits:set,ET.etrust.fieldis; reference:url,shh.thathost.com/secadv/2009-06-15-entrust-ies.txt; reference:url,securitytracker.com/alerts/2010/Sep/1024391.html; classtype:misc-attack; sid:1054788; rev:1; metadata:created_at 2010_09_27, updated_at 2010_09_27, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Lexmark Printer RDYMSG Cross Site Scripting Attempt (web-application-attack) - detector_id: 54833 original_sid: 2012193
alert http $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"ET EXPLOIT Lexmark Printer RDYMSG Cross Site Scripting Attempt"; flow:established,to_server; content:"pjl_ready_message="; http_uri; nocase; fast_pattern:only; pcre:"/pjl\x5Fready\x5Fmessage\x3D.+(script|alert|onmouse[a-z]+|onkey[a-z]+|onload|onunload|ondragdrop|onblur|onfocus|onclick|ondblclick|onsubmit|onreset|onselect|onchange)/Ui"; reference:url,packetstormsecurity.org/files/view/97265/lexmark-xss.txt; classtype:web-application-attack; sid:1054833; rev:2; metadata:affected_product Web_Server_Applications, attack_target Web_Server, deployment Datacenter, tag XSS, tag Cross_Site_Scripting, signature_severity Major, created_at 2011_01_15, updated_at 2016_07_01, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT MySQL Server for Windows Remote SYSTEM Level Exploit (Stuxnet Techique DUMP INTO executable) (attempted-user) - detector_id: 54998 original_sid: 2015995
alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 3306 (msg:"ET EXPLOIT MySQL Server for Windows Remote SYSTEM Level Exploit (Stuxnet Techique DUMP INTO executable)"; flow:to_server,established; content:"|03|"; offset:3; depth:4; content:"SELECT data FROM"; nocase; distance:0; content:"INTO DUMPFILE"; nocase; distance:0; content:"c|3a|/windows/system32/"; nocase; fast_pattern; content:".exe"; nocase; distance:0; pcre:"/SELECT data FROM [^\x20]+?\x20INTO DUMPFILE [\x27\x22]c\x3a\/windows\/system32\/[a-z0-9_-]+?\.exe[\x27\x22]/i"; reference:url,seclists.org/fulldisclosure/2012/Dec/att-13/; classtype:attempted-user; sid:1054998; rev:4; metadata:created_at 2012_12_05, updated_at 2012_12_05, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT MySQL Server for Windows Remote SYSTEM Level Exploit (Stuxnet Technique) (attempted-user) - detector_id: 54999 original_sid: 2015996
alert tcp $EXTERNAL_NET any -> $SQL_SERVERS 3306 (msg:"ET EXPLOIT MySQL Server for Windows Remote SYSTEM Level Exploit (Stuxnet Technique)"; flow:to_server,established; content:"|03|"; offset:3; depth:4; content:"INSERT INTO"; nocase; distance:0; content:"#pragma namespace("; nocase; distance:0; content:"|5c 5c 5c|.|5c 5c 5c 5c|root|5c 5c 5c 5c|"; nocase; distance:0; content:"__EventFilter"; nocase; distance:0; content:" __InstanceModificationEvent"; nocase; distance:0; content:"TargetInstance"; nocase; distance:0; content:"Win32_LocalTime"; nocase; distance:0; content:"ActiveScriptEventConsumer"; nocase; distance:0; content:"JScript"; nocase; distance:0; content:"WScript.Shell"; nocase; distance:0; content:"WSH.run"; nocase; distance:0; content:".exe"; distance:0; content:"__FilterToConsumerBinding"; pcre:"/WSH\.run\x28\x5c+?[\x22\x27][a-z0-9_-]+?\.exe/"; reference:url,seclists.org/fulldisclosure/2012/Dec/att-13/; classtype:attempted-user; sid:1054999; rev:3; metadata:created_at 2012_12_05, updated_at 2012_12_05, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Exim/Dovecot Possible MAIL FROM Command Execution (attempted-admin) - detector_id: 55018 original_sid: 2016835
alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"ET EXPLOIT Exim/Dovecot Possible MAIL FROM Command Execution"; flow:to_server,established; content:"${IFS}"; fast_pattern:only; content:"mail from|3a|"; nocase; pcre:"/^[^\r\n]*?\x60[^\x60]*?\$\{IFS\}/R"; reference:url,redteam-pentesting.de/de/advisories/rt-sa-2013-001/-exim-with-dovecot-typical-misconfiguration-leads-to-remote-command-execution; classtype:attempted-admin; sid:1055018; rev:2; metadata:created_at 2013_05_08, updated_at 2013_05_08, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Apache Struts Possible OGNL AllowStaticMethodAccess in client body (attempted-user) - detector_id: 55020 original_sid: 2016954
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET EXPLOIT Apache Struts Possible OGNL AllowStaticMethodAccess in client body"; flow:to_server,established; content:"memberAccess"; http_client_body; nocase; content:"allowStaticMethodAccess"; http_client_body; nocase; classtype:attempted-user; sid:1055020; rev:3; metadata:created_at 2013_05_31, updated_at 2013_05_31, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Apache Struts Possible OGNL Java Exec in client body (attempted-user) - detector_id: 55022 original_sid: 2016957
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET EXPLOIT Apache Struts Possible OGNL Java Exec in client body"; flow:to_server,established; content:"java.lang.Runtime@getRuntime().exec("; http_client_body; nocase; reference:url,struts.apache.org/development/2.x/docs/s2-013.html; classtype:attempted-user; sid:1055022; rev:3; metadata:created_at 2013_05_31, updated_at 2013_05_31, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT SolusVM 1.13.03 SQL injection (trojan-activity) - detector_id: 55028 original_sid: 2017060
alert http any any -> $HTTP_SERVERS any (msg:"ET EXPLOIT SolusVM 1.13.03 SQL injection"; flow:established,to_server; content:"POST"; http_method; content:"/centralbackup.php?"; http_uri; fast_pattern:only; content:"_v="; content:"deleteid="; classtype:trojan-activity; sid:1055028; rev:4; metadata:affected_product Web_Server_Applications, attack_target Web_Server, deployment Datacenter, tag SQL_Injection, signature_severity Major, created_at 2013_06_24, updated_at 2016_07_01, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Wscript Shell Run Attempt - Likely Hostile (attempted-user) - detector_id: 55036 original_sid: 2017205
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET EXPLOIT Wscript Shell Run Attempt - Likely Hostile"; flow:established,to_server; content:"WScript.Shell"; nocase; content:".Run"; nocase; within:100; pcre:"/[\r\n\s]+(?P<var1>([a-z]([a-z0-9_])*|_+([a-z0-9])([a-z0-9_])*))[\r\n\s]*\x3d[\r\n\s]*CreateObject\(\s*[\x22\x27]Wscript\.Shell[\x27\x22]\s*\).+?(?P=var1)\.run/si"; classtype:attempted-user; sid:1055036; rev:2; metadata:created_at 2013_07_26, updated_at 2013_07_26, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Zollard PHP Exploit UA (trojan-activity) - detector_id: 55042 original_sid: 2017798
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET EXPLOIT Zollard PHP Exploit UA"; flow:established,to_server; content:"Zollard"; http_user_agent; reference:url,deependresearch.org/2013/12/hey-zollard-leave-my-internet-of-things.html; classtype:trojan-activity; sid:1055042; rev:2; metadata:created_at 2013_12_04, updated_at 2013_12_04, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Zollard PHP Exploit Telnet Inbound (attempted-user) - detector_id: 55043 original_sid: 2017799
alert tcp $EXTERNAL_NET any -> $HOME_NET 23 (msg:"ET EXPLOIT Zollard PHP Exploit Telnet Inbound"; flow:to_server,established; content:"/var/run/.zollard/"; reference:url,deependresearch.org/2013/12/hey-zollard-leave-my-internet-of-things.html; classtype:attempted-user; sid:1055043; rev:2; metadata:created_at 2013_12_04, updated_at 2013_12_04, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Linksys Auth Bypass fw_sys_up.cgi (attempted-admin) - detector_id: 55058 original_sid: 2018156
alert http $EXTERNAL_NET any -> $HOME_NET 8083 (msg:"ET EXPLOIT Linksys Auth Bypass fw_sys_up.cgi"; flow:to_server,established; content:"GET"; http_method; nocase; content:"/cgi-bin/fw_sys_up.cgi"; http_uri; nocase; reference:url,www.securityfocus.com/archive/1/531107; classtype:attempted-admin; sid:1055058; rev:2; metadata:created_at 2014_02_18, updated_at 2014_02_18, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Linksys Auth Bypass override.cgi (attempted-admin) - detector_id: 55059 original_sid: 2018157
alert http $EXTERNAL_NET any -> $HOME_NET 8083 (msg:"ET EXPLOIT Linksys Auth Bypass override.cgi"; flow:to_server,established; content:"GET"; http_method; nocase; content:"/cgi-bin/override.cgi"; http_uri; nocase; reference:url,www.securityfocus.com/archive/1/531107; classtype:attempted-admin; sid:1055059; rev:2; metadata:created_at 2014_02_18, updated_at 2014_02_18, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Linksys Auth Bypass share_editor.cgi (attempted-admin) - detector_id: 55060 original_sid: 2018158
alert http $EXTERNAL_NET any -> $HOME_NET 8083 (msg:"ET EXPLOIT Linksys Auth Bypass share_editor.cgi"; flow:to_server,established; content:"GET"; http_method; nocase; content:"/cgi-bin/share_editor.cgi"; http_uri; nocase; reference:url,www.securityfocus.com/archive/1/531107; classtype:attempted-admin; sid:1055060; rev:2; metadata:created_at 2014_02_18, updated_at 2014_02_18, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Linksys Auth Bypass switch_boot.cgi (attempted-admin) - detector_id: 55061 original_sid: 2018159
alert http $EXTERNAL_NET any -> $HOME_NET 8083 (msg:"ET EXPLOIT Linksys Auth Bypass switch_boot.cgi"; flow:to_server,established; content:"GET"; http_method; nocase; content:"/cgi-bin/switch_boot.cgi"; http_uri; nocase; reference:url,www.securityfocus.com/archive/1/531107; classtype:attempted-admin; sid:1055061; rev:3; metadata:created_at 2014_02_18, updated_at 2014_02_18, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Linksys Failed Upgrade BackDoor Access (Server Response) (attempted-admin) - detector_id: 55062 original_sid: 2018160
alert http $HOME_NET 8083 -> $EXTERNAL_NET any (msg:"ET EXPLOIT Linksys Failed Upgrade BackDoor Access (Server Response)"; flow:from_server,established; file_data; content:"Utopia_Init|3a 20|SUCCEEDED"; reference:url,www.securityfocus.com/archive/1/531107; classtype:attempted-admin; sid:1055062; rev:3; metadata:created_at 2014_02_18, updated_at 2014_02_18, flip_endpoints True, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET EXPLOIT Supermicro BMC Password Disclosure 1 (attempted-admin) - detector_id: 55069 original_sid: 2018585
alert http $EXTERNAL_NET any -> $HOME_NET 49152 (msg:"ET EXPLOIT Supermicro BMC Password Disclosure 1"; flow:established,to_server; content:"/PSBlock"; http_uri; fast_pattern:only; reference:url,arstechnica.com/security/2014/06/at-least-32000-servers-broadcast-admin-passwords-in-the-clear-advisory-warns/; classtype:attempted-admin; sid:1055069; rev:4; metadata:created_at 2014_06_20, updated_at 2014_06_20, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Supermicro BMC Password Disclosure 2 (attempted-admin) - detector_id: 55070 original_sid: 2018586
alert http $EXTERNAL_NET any -> $HOME_NET 49152 (msg:"ET EXPLOIT Supermicro BMC Password Disclosure 2"; flow:established,to_server; content:"/PSStore"; http_uri; fast_pattern:only; reference:url,arstechnica.com/security/2014/06/at-least-32000-servers-broadcast-admin-passwords-in-the-clear-advisory-warns/; classtype:attempted-admin; sid:1055070; rev:5; metadata:created_at 2014_06_20, updated_at 2014_06_20, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Supermicro BMC Password Disclosure 3 (attempted-admin) - detector_id: 55071 original_sid: 2018587
alert http $EXTERNAL_NET any -> $HOME_NET 49152 (msg:"ET EXPLOIT Supermicro BMC Password Disclosure 3"; flow:established,to_server; content:"/PMConfig.dat"; fast_pattern:only; reference:url,arstechnica.com/security/2014/06/at-least-32000-servers-broadcast-admin-passwords-in-the-clear-advisory-warns/; classtype:attempted-admin; sid:1055071; rev:4; metadata:created_at 2014_06_20, updated_at 2014_06_20, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Supermicro BMC Password Disclosure 4 (attempted-admin) - detector_id: 55072 original_sid: 2018588
alert http $EXTERNAL_NET any -> $HOME_NET 49152 (msg:"ET EXPLOIT Supermicro BMC Password Disclosure 4"; flow:established,to_server; content:"/wsman/simple_auth.passwd"; http_uri; fast_pattern:5,20; reference:url,arstechnica.com/security/2014/06/at-least-32000-servers-broadcast-admin-passwords-in-the-clear-advisory-warns/; classtype:attempted-admin; sid:1055072; rev:4; metadata:created_at 2014_06_20, updated_at 2014_06_20, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Possible CVE-2014-6271 Attempt Against SIP Proxy (attempted-admin) - detector_id: 55094 original_sid: 2019289
alert udp any any -> $HOME_NET [5060,5061] (msg:"ET EXPLOIT Possible CVE-2014-6271 Attempt Against SIP Proxy"; flow:to_server; content:"|28 29 20 7b|"; fast_pattern:only; reference:url,github.com/zaf/sipshock; classtype:attempted-admin; sid:1055094; rev:3; metadata:created_at 2014_09_26, updated_at 2014_09_26, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Possible CVE-2014-6271 Attempt Against SIP Proxy (attempted-admin) - detector_id: 55095 original_sid: 2019290
alert tcp any any -> $HOME_NET [5060,5061] (msg:"ET EXPLOIT Possible CVE-2014-6271 Attempt Against SIP Proxy"; flow:to_server,established; content:"|28 29 20 7b|"; fast_pattern:only; reference:url,github.com/zaf/sipshock; classtype:attempted-admin; sid:1055095; rev:2; metadata:created_at 2014_09_26, updated_at 2014_09_26, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Possible Qmail CVE-2014-6271 Mail From attempt (attempted-admin) - detector_id: 55096 original_sid: 2019293
alert tcp any any -> $HOME_NET [25,587] (msg:"ET EXPLOIT Possible Qmail CVE-2014-6271 Mail From attempt"; flow:to_server,established; content:"|28 29 20 7b|"; fast_pattern:only; pcre:"/^mail\s*?from\s*?\x3a\s*?[^\r\n]*?\x28\x29\x20\x7b/mi"; reference:url,marc.info/?l=qmail&m=141183309314366&w=2; classtype:attempted-admin; sid:1055096; rev:2; metadata:created_at 2014_09_29, updated_at 2014_09_29, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Possible OpenVPN CVE-2014-6271 attempt (attempted-admin) - detector_id: 55097 original_sid: 2019322
alert udp any any -> $HOME_NET 1194 (msg:"ET EXPLOIT Possible OpenVPN CVE-2014-6271 attempt"; flow:to_server; content:"|20|"; depth:1; content:"|28 29 20 7b|"; fast_pattern:only; reference:url,news.ycombinator.com/item?id=8385332; classtype:attempted-admin; sid:1055097; rev:2; metadata:created_at 2014_09_30, updated_at 2014_09_30, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Possible OpenVPN CVE-2014-6271 attempt (attempted-admin) - detector_id: 55098 original_sid: 2019323
alert tcp any any -> $HOME_NET 1194 (msg:"ET EXPLOIT Possible OpenVPN CVE-2014-6271 attempt"; flow:to_server,established; content:"|20|"; depth:1; content:"|28 29 20 7b|"; fast_pattern:only; reference:url,news.ycombinator.com/item?id=8385332; classtype:attempted-admin; sid:1055098; rev:2; metadata:created_at 2014_09_30, updated_at 2014_09_30, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Possible Pure-FTPd CVE-2014-6271 attempt (attempted-admin) - detector_id: 55099 original_sid: 2019335
alert tcp any any -> $HOME_NET 21 (msg:"ET EXPLOIT Possible Pure-FTPd CVE-2014-6271 attempt"; flow:to_server,established; content:"|28 29 20 7b 20|"; fast_pattern:only; reference:url,gist.github.com/jedisct1/88c62ee34e6fa92c31dc; reference:cve,2014-6271; classtype:attempted-admin; sid:1055099; rev:1; metadata:created_at 2014_10_01, updated_at 2014_10_01, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Possible Postfix CVE-2014-6271 attempt (attempted-admin) - detector_id: 55102 original_sid: 2019389
alert tcp any any -> $HOME_NET [25,587] (msg:"ET EXPLOIT Possible Postfix CVE-2014-6271 attempt"; flow:to_server,established; content:"|28 29 20 7b|"; fast_pattern:only; pcre:"/^[a-z-]+\s*?\x3a\s*?[^\r\n]*?\x28\x29\x20\x7b.*\x3b.*\x7d\s*\x3b(?!=[\r\n])/mi"; reference:url,exploit-db.com/exploits/34896/; reference:cve,2014-6271; classtype:attempted-admin; sid:1055102; rev:4; metadata:created_at 2014_10_10, updated_at 2014_10_10, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Possible CVE-2014-3704 Drupal SQLi attempt URLENCODE 1 (web-application-attack) - detector_id: 55114 original_sid: 2019422
alert http any any -> $HTTP_SERVERS any (msg:"ET EXPLOIT Possible CVE-2014-3704 Drupal SQLi attempt URLENCODE 1"; flow:established,to_server; content:"name["; nocase; fast_pattern:only; http_client_body; pcre:"/(?:^|&|Content-Disposition[\x3a][^\n]*?name\s*?=\s*?[\x22\x27])name\[[^\x5d]*?\W/Pi"; reference:url,pastebin.com/F2Dk9LbX; classtype:web-application-attack; sid:1055114; rev:2; metadata:created_at 2014_10_16, updated_at 2014_10_16, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Possible CVE-2014-3704 Drupal SQLi attempt URLENCODE 2 (web-application-attack) - detector_id: 55115 original_sid: 2019423
alert http any any -> $HTTP_SERVERS any (msg:"ET EXPLOIT Possible CVE-2014-3704 Drupal SQLi attempt URLENCODE 2"; flow:established,to_server; content:"name%5b"; nocase; fast_pattern:only; http_client_body; pcre:"/(?:^|&|Content-Disposition[\x3a][^\n]*?name\s*?=\s*?[\x22\x27])name\%5b[^\x5d]*?\W/Pi"; reference:url,pastebin.com/F2Dk9LbX; classtype:web-application-attack; sid:1055115; rev:2; metadata:created_at 2014_10_16, updated_at 2014_10_16, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Possible CVE-2014-3704 Drupal SQLi attempt URLENCODE 3 (web-application-attack) - detector_id: 55116 original_sid: 2019424
alert http any any -> $HTTP_SERVERS any (msg:"ET EXPLOIT Possible CVE-2014-3704 Drupal SQLi attempt URLENCODE 3"; flow:established,to_server; content:"nam%65["; nocase; fast_pattern:only; http_client_body; pcre:"/(?:^|&|Content-Disposition[\x3a][^\n]*?name\s*?=\s*?[\x22\x27])nam\%65\[[^\x5d]*?\W/Pi"; reference:url,pastebin.com/F2Dk9LbX; classtype:web-application-attack; sid:1055116; rev:2; metadata:created_at 2014_10_16, updated_at 2014_10_16, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Possible CVE-2014-3704 Drupal SQLi attempt URLENCODE 4 (web-application-attack) - detector_id: 55117 original_sid: 2019425
alert http any any -> $HTTP_SERVERS any (msg:"ET EXPLOIT Possible CVE-2014-3704 Drupal SQLi attempt URLENCODE 4"; flow:established,to_server; content:"nam%65%5b"; nocase; fast_pattern:only; http_client_body; pcre:"/(?:^|&|Content-Disposition[\x3a][^\n]*?name\s*?=\s*?[\x22\x27])nam\%65\%5b[^\x5d]*?\W/Pi"; reference:url,pastebin.com/F2Dk9LbX; classtype:web-application-attack; sid:1055117; rev:2; metadata:created_at 2014_10_16, updated_at 2014_10_16, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Possible CVE-2014-3704 Drupal SQLi attempt URLENCODE 5 (web-application-attack) - detector_id: 55118 original_sid: 2019426
alert http any any -> $HTTP_SERVERS any (msg:"ET EXPLOIT Possible CVE-2014-3704 Drupal SQLi attempt URLENCODE 5"; flow:established,to_server; content:"na%6de["; nocase; fast_pattern:only; http_client_body; pcre:"/(?:^|&|Content-Disposition[\x3a][^\n]*?name\s*?=\s*?[\x22\x27])na\%6de\[[^\x5d]*?\W/Pi"; reference:url,pastebin.com/F2Dk9LbX; classtype:web-application-attack; sid:1055118; rev:2; metadata:created_at 2014_10_16, updated_at 2014_10_16, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Possible CVE-2014-3704 Drupal SQLi attempt URLENCODE 6 (web-application-attack) - detector_id: 55119 original_sid: 2019427
alert http any any -> $HTTP_SERVERS any (msg:"ET EXPLOIT Possible CVE-2014-3704 Drupal SQLi attempt URLENCODE 6"; flow:established,to_server; content:"na%6de%5b"; nocase; fast_pattern:only; http_client_body; pcre:"/(?:^|&|Content-Disposition[\x3a][^\n]*?name\s*?=\s*?[\x22\x27])na\%6de\%5b[^\x5d]*?\W/Pi"; reference:url,pastebin.com/F2Dk9LbX; classtype:web-application-attack; sid:1055119; rev:2; metadata:created_at 2014_10_16, updated_at 2014_10_16, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Possible CVE-2014-3704 Drupal SQLi attempt URLENCODE 7 (web-application-attack) - detector_id: 55120 original_sid: 2019428
alert http any any -> $HTTP_SERVERS any (msg:"ET EXPLOIT Possible CVE-2014-3704 Drupal SQLi attempt URLENCODE 7"; flow:established,to_server; content:"na%6d%65["; nocase; fast_pattern:only; http_client_body; pcre:"/(?:^|&|Content-Disposition[\x3a][^\n]*?name\s*?=\s*?[\x22\x27])na\%6d\%65\[[^\x5d]*?\W/Pi"; reference:url,pastebin.com/F2Dk9LbX; classtype:web-application-attack; sid:1055120; rev:2; metadata:created_at 2014_10_16, updated_at 2014_10_16, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Possible CVE-2014-3704 Drupal SQLi attempt URLENCODE 8 (web-application-attack) - detector_id: 55121 original_sid: 2019429
alert http any any -> $HTTP_SERVERS any (msg:"ET EXPLOIT Possible CVE-2014-3704 Drupal SQLi attempt URLENCODE 8"; flow:established,to_server; content:"na%6d%65%5b"; nocase; fast_pattern:only; http_client_body; pcre:"/(?:^|&|Content-Disposition[\x3a][^\n]*?name\s*?=\s*?[\x22\x27])na\%6d\%65\%5b[^\x5d]*?\W/Pi"; reference:url,pastebin.com/F2Dk9LbX; classtype:web-application-attack; sid:1055121; rev:2; metadata:created_at 2014_10_16, updated_at 2014_10_16, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Possible CVE-2014-3704 Drupal SQLi attempt URLENCODE 9 (web-application-attack) - detector_id: 55122 original_sid: 2019430
alert http any any -> $HTTP_SERVERS any (msg:"ET EXPLOIT Possible CVE-2014-3704 Drupal SQLi attempt URLENCODE 9"; flow:established,to_server; content:"n%61me["; nocase; fast_pattern:only; http_client_body; pcre:"/(?:^|&|Content-Disposition[\x3a][^\n]*?name\s*?=\s*?[\x22\x27])n\%61me\[[^\x5d]*?\W/Pi"; reference:url,pastebin.com/F2Dk9LbX; classtype:web-application-attack; sid:1055122; rev:2; metadata:created_at 2014_10_16, updated_at 2014_10_16, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Possible CVE-2014-3704 Drupal SQLi attempt URLENCODE 10 (web-application-attack) - detector_id: 55123 original_sid: 2019431
alert http any any -> $HTTP_SERVERS any (msg:"ET EXPLOIT Possible CVE-2014-3704 Drupal SQLi attempt URLENCODE 10"; flow:established,to_server; content:"n%61me%5b"; nocase; fast_pattern:only; http_client_body; pcre:"/(?:^|&|Content-Disposition[\x3a][^\n]*?name\s*?=\s*?[\x22\x27])n\%61me\%5b[^\x5d]*?\W/Pi"; reference:url,pastebin.com/F2Dk9LbX; classtype:web-application-attack; sid:1055123; rev:2; metadata:created_at 2014_10_16, updated_at 2014_10_16, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Possible CVE-2014-3704 Drupal SQLi attempt URLENCODE 11 (web-application-attack) - detector_id: 55124 original_sid: 2019432
alert http any any -> $HTTP_SERVERS any (msg:"ET EXPLOIT Possible CVE-2014-3704 Drupal SQLi attempt URLENCODE 11"; flow:established,to_server; content:"n%61m%65["; nocase; fast_pattern:only; http_client_body; pcre:"/(?:^|&|Content-Disposition[\x3a][^\n]*?name\s*?=\s*?[\x22\x27])n\%61m\%65\[[^\x5d]*?\W/Pi"; reference:url,pastebin.com/F2Dk9LbX; classtype:web-application-attack; sid:1055124; rev:2; metadata:created_at 2014_10_16, updated_at 2014_10_16, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Possible CVE-2014-3704 Drupal SQLi attempt URLENCODE 12 (web-application-attack) - detector_id: 55125 original_sid: 2019433
alert http any any -> $HTTP_SERVERS any (msg:"ET EXPLOIT Possible CVE-2014-3704 Drupal SQLi attempt URLENCODE 12"; flow:established,to_server; content:"n%61m%65%5b"; nocase; fast_pattern:only; http_client_body; pcre:"/(?:^|&|Content-Disposition[\x3a][^\n]*?name\s*?=\s*?[\x22\x27])n\%61m\%65\%5b[^\x5d]*?\W/Pi"; reference:url,pastebin.com/F2Dk9LbX; classtype:web-application-attack; sid:1055125; rev:2; metadata:created_at 2014_10_16, updated_at 2014_10_16, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Possible CVE-2014-3704 Drupal SQLi attempt URLENCODE 13 (web-application-attack) - detector_id: 55126 original_sid: 2019434
alert http any any -> $HTTP_SERVERS any (msg:"ET EXPLOIT Possible CVE-2014-3704 Drupal SQLi attempt URLENCODE 13"; flow:established,to_server; content:"n%61%6de["; nocase; fast_pattern:only; http_client_body; pcre:"/(?:^|&|Content-Disposition[\x3a][^\n]*?name\s*?=\s*?[\x22\x27])n\%61\%6de\[[^\x5d]*?\W/Pi"; reference:url,pastebin.com/F2Dk9LbX; classtype:web-application-attack; sid:1055126; rev:2; metadata:created_at 2014_10_16, updated_at 2014_10_16, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Possible CVE-2014-3704 Drupal SQLi attempt URLENCODE 14 (web-application-attack) - detector_id: 55127 original_sid: 2019435
alert http any any -> $HTTP_SERVERS any (msg:"ET EXPLOIT Possible CVE-2014-3704 Drupal SQLi attempt URLENCODE 14"; flow:established,to_server; content:"n%61%6de%5b"; nocase; fast_pattern:only; http_client_body; pcre:"/(?:^|&|Content-Disposition[\x3a][^\n]*?name\s*?=\s*?[\x22\x27])n\%61\%6de\%5b[^\x5d]*?\W/Pi"; reference:url,pastebin.com/F2Dk9LbX; classtype:web-application-attack; sid:1055127; rev:2; metadata:created_at 2014_10_16, updated_at 2014_10_16, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Possible CVE-2014-3704 Drupal SQLi attempt URLENCODE 15 (web-application-attack) - detector_id: 55128 original_sid: 2019436
alert http any any -> $HTTP_SERVERS any (msg:"ET EXPLOIT Possible CVE-2014-3704 Drupal SQLi attempt URLENCODE 15"; flow:established,to_server; content:"n%61%6d%65["; nocase; fast_pattern:only; http_client_body; pcre:"/(?:^|&|Content-Disposition[\x3a][^\n]*?name\s*?=\s*?[\x22\x27])n\%61\%6d\%65\[[^\x5d]*?\W/Pi"; reference:url,pastebin.com/F2Dk9LbX; classtype:web-application-attack; sid:1055128; rev:2; metadata:created_at 2014_10_16, updated_at 2014_10_16, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Possible CVE-2014-3704 Drupal SQLi attempt URLENCODE 16 (web-application-attack) - detector_id: 55129 original_sid: 2019437
alert http any any -> $HTTP_SERVERS any (msg:"ET EXPLOIT Possible CVE-2014-3704 Drupal SQLi attempt URLENCODE 16"; flow:established,to_server; content:"n%61%6d%65%5b"; nocase; fast_pattern:only; http_client_body; pcre:"/(?:^|&|Content-Disposition[\x3a][^\n]*?name\s*?=\s*?[\x22\x27])n\%61\%6d\%65\%5b[^\x5d]*?\W/Pi"; reference:url,pastebin.com/F2Dk9LbX; classtype:web-application-attack; sid:1055129; rev:2; metadata:created_at 2014_10_16, updated_at 2014_10_16, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Possible CVE-2014-3704 Drupal SQLi attempt URLENCODE 17 (web-application-attack) - detector_id: 55130 original_sid: 2019438
alert http any any -> $HTTP_SERVERS any (msg:"ET EXPLOIT Possible CVE-2014-3704 Drupal SQLi attempt URLENCODE 17"; flow:established,to_server; content:"%6eame["; nocase; fast_pattern:only; http_client_body; pcre:"/(?:^|&|Content-Disposition[\x3a][^\n]*?name\s*?=\s*?[\x22\x27])\%6eame\[[^\x5d]*?\W/Pi"; reference:url,pastebin.com/F2Dk9LbX; classtype:web-application-attack; sid:1055130; rev:2; metadata:created_at 2014_10_16, updated_at 2014_10_16, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Possible CVE-2014-3704 Drupal SQLi attempt URLENCODE 18 (web-application-attack) - detector_id: 55131 original_sid: 2019439
alert http any any -> $HTTP_SERVERS any (msg:"ET EXPLOIT Possible CVE-2014-3704 Drupal SQLi attempt URLENCODE 18"; flow:established,to_server; content:"%6eame%5b"; nocase; fast_pattern:only; http_client_body; pcre:"/(?:^|&|Content-Disposition[\x3a][^\n]*?name\s*?=\s*?[\x22\x27])\%6eame\%5b[^\x5d]*?\W/Pi"; reference:url,pastebin.com/F2Dk9LbX; classtype:web-application-attack; sid:1055131; rev:2; metadata:created_at 2014_10_16, updated_at 2014_10_16, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Possible CVE-2014-3704 Drupal SQLi attempt URLENCODE 19 (web-application-attack) - detector_id: 55132 original_sid: 2019440
alert http any any -> $HTTP_SERVERS any (msg:"ET EXPLOIT Possible CVE-2014-3704 Drupal SQLi attempt URLENCODE 19"; flow:established,to_server; content:"%6eam%65["; nocase; fast_pattern:only; http_client_body; pcre:"/(?:^|&|Content-Disposition[\x3a][^\n]*?name\s*?=\s*?[\x22\x27])\%6eam\%65\[[^\x5d]*?\W/Pi"; reference:url,pastebin.com/F2Dk9LbX; classtype:web-application-attack; sid:1055132; rev:2; metadata:created_at 2014_10_16, updated_at 2014_10_16, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Possible CVE-2014-3704 Drupal SQLi attempt URLENCODE 20 (web-application-attack) - detector_id: 55133 original_sid: 2019441
alert http any any -> $HTTP_SERVERS any (msg:"ET EXPLOIT Possible CVE-2014-3704 Drupal SQLi attempt URLENCODE 20"; flow:established,to_server; content:"%6eam%65%5b"; nocase; fast_pattern:only; http_client_body; pcre:"/(?:^|&|Content-Disposition[\x3a][^\n]*?name\s*?=\s*?[\x22\x27])\%6eam\%65\%5b[^\x5d]*?\W/Pi"; reference:url,pastebin.com/F2Dk9LbX; classtype:web-application-attack; sid:1055133; rev:2; metadata:created_at 2014_10_16, updated_at 2014_10_16, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Possible CVE-2014-3704 Drupal SQLi attempt URLENCODE 21 (web-application-attack) - detector_id: 55134 original_sid: 2019442
alert http any any -> $HTTP_SERVERS any (msg:"ET EXPLOIT Possible CVE-2014-3704 Drupal SQLi attempt URLENCODE 21"; flow:established,to_server; content:"%6ea%6de["; nocase; fast_pattern:only; http_client_body; pcre:"/(?:^|&|Content-Disposition[\x3a][^\n]*?name\s*?=\s*?[\x22\x27])\%6ea\%6de\[[^\x5d]*?\W/Pi"; reference:url,pastebin.com/F2Dk9LbX; classtype:web-application-attack; sid:1055134; rev:2; metadata:created_at 2014_10_16, updated_at 2014_10_16, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Possible CVE-2014-3704 Drupal SQLi attempt URLENCODE 22 (web-application-attack) - detector_id: 55135 original_sid: 2019443
alert http any any -> $HTTP_SERVERS any (msg:"ET EXPLOIT Possible CVE-2014-3704 Drupal SQLi attempt URLENCODE 22"; flow:established,to_server; content:"%6ea%6de%5b"; nocase; fast_pattern:only; http_client_body; pcre:"/(?:^|&|Content-Disposition[\x3a][^\n]*?name\s*?=\s*?[\x22\x27])\%6ea\%6de\%5b[^\x5d]*?\W/Pi"; reference:url,pastebin.com/F2Dk9LbX; classtype:web-application-attack; sid:1055135; rev:2; metadata:created_at 2014_10_16, updated_at 2014_10_16, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Possible CVE-2014-3704 Drupal SQLi attempt URLENCODE 23 (web-application-attack) - detector_id: 55136 original_sid: 2019444
alert http any any -> $HTTP_SERVERS any (msg:"ET EXPLOIT Possible CVE-2014-3704 Drupal SQLi attempt URLENCODE 23"; flow:established,to_server; content:"%6ea%6d%65["; nocase; fast_pattern:only; http_client_body; pcre:"/(?:^|&|Content-Disposition[\x3a][^\n]*?name\s*?=\s*?[\x22\x27])\%6ea\%6d\%65\[[^\x5d]*?\W/Pi"; reference:url,pastebin.com/F2Dk9LbX; classtype:web-application-attack; sid:1055136; rev:2; metadata:created_at 2014_10_16, updated_at 2014_10_16, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Possible CVE-2014-3704 Drupal SQLi attempt URLENCODE 24 (web-application-attack) - detector_id: 55137 original_sid: 2019445
alert http any any -> $HTTP_SERVERS any (msg:"ET EXPLOIT Possible CVE-2014-3704 Drupal SQLi attempt URLENCODE 24"; flow:established,to_server; content:"%6ea%6d%65%5b"; nocase; fast_pattern:only; http_client_body; pcre:"/(?:^|&|Content-Disposition[\x3a][^\n]*?name\s*?=\s*?[\x22\x27])\%6ea\%6d\%65\%5b[^\x5d]*?\W/Pi"; reference:url,pastebin.com/F2Dk9LbX; classtype:web-application-attack; sid:1055137; rev:2; metadata:created_at 2014_10_16, updated_at 2014_10_16, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Possible CVE-2014-3704 Drupal SQLi attempt URLENCODE 25 (web-application-attack) - detector_id: 55138 original_sid: 2019446
alert http any any -> $HTTP_SERVERS any (msg:"ET EXPLOIT Possible CVE-2014-3704 Drupal SQLi attempt URLENCODE 25"; flow:established,to_server; content:"%6e%61me["; nocase; fast_pattern:only; http_client_body; pcre:"/(?:^|&|Content-Disposition[\x3a][^\n]*?name\s*?=\s*?[\x22\x27])\%6e\%61me\[[^\x5d]*?\W/Pi"; reference:url,pastebin.com/F2Dk9LbX; classtype:web-application-attack; sid:1055138; rev:2; metadata:created_at 2014_10_16, updated_at 2014_10_16, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Possible CVE-2014-3704 Drupal SQLi attempt URLENCODE 26 (web-application-attack) - detector_id: 55139 original_sid: 2019447
alert http any any -> $HTTP_SERVERS any (msg:"ET EXPLOIT Possible CVE-2014-3704 Drupal SQLi attempt URLENCODE 26"; flow:established,to_server; content:"%6e%61me%5b"; nocase; fast_pattern:only; http_client_body; pcre:"/(?:^|&|Content-Disposition[\x3a][^\n]*?name\s*?=\s*?[\x22\x27])\%6e\%61me\%5b[^\x5d]*?\W/Pi"; reference:url,pastebin.com/F2Dk9LbX; classtype:web-application-attack; sid:1055139; rev:2; metadata:created_at 2014_10_16, updated_at 2014_10_16, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Possible CVE-2014-3704 Drupal SQLi attempt URLENCODE 27 (web-application-attack) - detector_id: 55140 original_sid: 2019448
alert http any any -> $HTTP_SERVERS any (msg:"ET EXPLOIT Possible CVE-2014-3704 Drupal SQLi attempt URLENCODE 27"; flow:established,to_server; content:"%6e%61m%65["; nocase; fast_pattern:only; http_client_body; pcre:"/(?:^|&|Content-Disposition[\x3a][^\n]*?name\s*?=\s*?[\x22\x27])\%6e\%61m\%65\[[^\x5d]*?\W/Pi"; reference:url,pastebin.com/F2Dk9LbX; classtype:web-application-attack; sid:1055140; rev:2; metadata:created_at 2014_10_16, updated_at 2014_10_16, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Possible CVE-2014-3704 Drupal SQLi attempt URLENCODE 28 (web-application-attack) - detector_id: 55141 original_sid: 2019449
alert http any any -> $HTTP_SERVERS any (msg:"ET EXPLOIT Possible CVE-2014-3704 Drupal SQLi attempt URLENCODE 28"; flow:established,to_server; content:"%6e%61m%65%5b"; nocase; fast_pattern:only; http_client_body; pcre:"/(?:^|&|Content-Disposition[\x3a][^\n]*?name\s*?=\s*?[\x22\x27])\%6e\%61m\%65\%5b[^\x5d]*?\W/Pi"; reference:url,pastebin.com/F2Dk9LbX; classtype:web-application-attack; sid:1055141; rev:2; metadata:created_at 2014_10_16, updated_at 2014_10_16, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Possible CVE-2014-3704 Drupal SQLi attempt URLENCODE 29 (web-application-attack) - detector_id: 55142 original_sid: 2019450
alert http any any -> $HTTP_SERVERS any (msg:"ET EXPLOIT Possible CVE-2014-3704 Drupal SQLi attempt URLENCODE 29"; flow:established,to_server; content:"%6e%61%6de["; nocase; fast_pattern:only; http_client_body; pcre:"/(?:^|&|Content-Disposition[\x3a][^\n]*?name\s*?=\s*?[\x22\x27])\%6e\%61\%6de\[[^\x5d]*?\W/Pi"; reference:url,pastebin.com/F2Dk9LbX; classtype:web-application-attack; sid:1055142; rev:2; metadata:created_at 2014_10_16, updated_at 2014_10_16, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Possible CVE-2014-3704 Drupal SQLi attempt URLENCODE 30 (web-application-attack) - detector_id: 55143 original_sid: 2019451
alert http any any -> $HTTP_SERVERS any (msg:"ET EXPLOIT Possible CVE-2014-3704 Drupal SQLi attempt URLENCODE 30"; flow:established,to_server; content:"%6e%61%6de%5b"; nocase; fast_pattern:only; http_client_body; pcre:"/(?:^|&|Content-Disposition[\x3a][^\n]*?name\s*?=\s*?[\x22\x27])\%6e\%61\%6de\%5b[^\x5d]*?\W/Pi"; reference:url,pastebin.com/F2Dk9LbX; classtype:web-application-attack; sid:1055143; rev:2; metadata:created_at 2014_10_16, updated_at 2014_10_16, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Possible CVE-2014-3704 Drupal SQLi attempt URLENCODE 31 (web-application-attack) - detector_id: 55144 original_sid: 2019452
alert http any any -> $HTTP_SERVERS any (msg:"ET EXPLOIT Possible CVE-2014-3704 Drupal SQLi attempt URLENCODE 31"; flow:established,to_server; content:"%6e%61%6d%65["; nocase; fast_pattern:only; http_client_body; pcre:"/(?:^|&|Content-Disposition[\x3a][^\n]*?name\s*?=\s*?[\x22\x27])\%6e\%61\%6d\%65\[[^\x5d]*?\W/Pi"; reference:url,pastebin.com/F2Dk9LbX; classtype:web-application-attack; sid:1055144; rev:2; metadata:created_at 2014_10_16, updated_at 2014_10_16, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Possible CVE-2014-3704 Drupal SQLi attempt URLENCODE 32 (web-application-attack) - detector_id: 55145 original_sid: 2019453
alert http any any -> $HTTP_SERVERS any (msg:"ET EXPLOIT Possible CVE-2014-3704 Drupal SQLi attempt URLENCODE 32"; flow:established,to_server; content:"%6e%61%6d%65%5b"; nocase; fast_pattern:only; http_client_body; pcre:"/(?:^|&|Content-Disposition[\x3a][^\n]*?name\s*?=\s*?[\x22\x27])\%6e\%61\%6d\%65\%5b[^\x5d]*?\W/Pi"; reference:url,pastebin.com/F2Dk9LbX; classtype:web-application-attack; sid:1055145; rev:2; metadata:created_at 2014_10_16, updated_at 2014_10_16, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Belkin N750 Buffer Overflow Attempt (attempted-admin) - detector_id: 55154 original_sid: 2019686
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET EXPLOIT Belkin N750 Buffer Overflow Attempt"; flow:established,to_server; content:"POST"; http_method; urilen:10; content:"/login.cgi"; http_uri; content:"GO=&jump="; http_client_body; depth:9; isdataat:1380,relative; reference:cve,CVE-2014-1635; reference:url,labs.integrity.pt/advisories/cve-2014-1635/; classtype:attempted-admin; sid:1055154; rev:3; metadata:created_at 2014_11_10, updated_at 2014_11_10, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT DLSw Information Disclosure CVE-2014-7992 (trojan-activity) - detector_id: 55175 original_sid: 2019778
alert tcp any 2067 -> $EXTERNAL_NET any (msg:"ET EXPLOIT DLSw Information Disclosure CVE-2014-7992"; flow:established,from_server; content:"Cisco"; nocase; pcre:"/^(?: Systems|\.com\/techsupport)/Ri"; threshold: type both, count 1, seconds 60, track by_dst; reference:url,www.fishnetsecurity.com/6labs/blog/cisco-dlsw-leakage-allows-retrieval-packet-contents-remote-routers; reference:url,github.com/tatehansen/dlsw_exploit; reference:cve,2014-7992; classtype:trojan-activity; sid:1055175; rev:2; metadata:created_at 2014_11_24, updated_at 2014_11_24, flip_endpoints True, server_side True; target:src_ip;)

# ET EXPLOIT D-Link IP Camera Vulnerable HTTP Request (CVE-2013-1599) (attempted-admin) - detector_id: 55176 original_sid: 2019801
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET EXPLOIT D-Link IP Camera Vulnerable HTTP Request (CVE-2013-1599)"; flow:established,to_server; content:"GET"; http_method; content:"/cgi-bin/rtpd.cgi?"; http_uri; fast_pattern:only; reference:url,www.coresecurity.com/advisories/d-link-ip-cameras-multiple-vulnerabilities; classtype:attempted-admin; sid:1055176; rev:2; metadata:created_at 2014_11_25, updated_at 2014_11_25, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT D-Link IP Camera Vulnerable HTTP Request (CVE-2013-1600) (attempted-admin) - detector_id: 55177 original_sid: 2019802
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET EXPLOIT D-Link IP Camera Vulnerable HTTP Request (CVE-2013-1600)"; flow:established,to_server; urilen:17; content:"GET"; http_method; content:"/upnp/asf-mp4.asf"; http_uri; fast_pattern:only; reference:url,www.coresecurity.com/advisories/d-link-ip-cameras-multiple-vulnerabilities; classtype:attempted-admin; sid:1055177; rev:2; metadata:created_at 2014_11_25, updated_at 2014_11_25, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT D-Link IP Camera Vulnerable HTTP Request (CVE-2013-1601) (attempted-admin) - detector_id: 55178 original_sid: 2019803
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET EXPLOIT D-Link IP Camera Vulnerable HTTP Request (CVE-2013-1601)"; flow:established,to_server; urilen:12; content:"GET"; http_method; content:"/md/lums.cgi"; http_uri; fast_pattern:only; reference:url,www.coresecurity.com/advisories/d-link-ip-cameras-multiple-vulnerabilities; classtype:attempted-admin; sid:1055178; rev:2; metadata:created_at 2014_11_25, updated_at 2014_11_25, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Possible PYKEK Priv Esc in-use (attempted-admin) - detector_id: 55183 original_sid: 2019897
alert tcp any any -> $HOME_NET 88 (msg:"ET EXPLOIT Possible PYKEK Priv Esc in-use"; flow:established,to_server; content:"|a4 11 18 0f|19700101000000Z|a5 11 18 0f|19700101000000Z|a6 11 18 0f|19700101000000Z"; content:"|a8 05 30 03 02 01 17|"; distance:8; within:7; threshold: type limit, track by_src, seconds 60, count 1; reference:url,github.com/bidord/pykek; reference:cve,CVE-2014-6324; classtype:attempted-admin; sid:1055183; rev:2; metadata:created_at 2014_12_09, updated_at 2014_12_09, flip_endpoints False, server_side True; target:dest_ip;)

# ET EXPLOIT Possible GoldenPac Priv Esc in-use (attempted-admin) - detector_id: 55184 original_sid: 2019922
alert tcp any any -> $HOME_NET 88 (msg:"ET EXPLOIT Possible GoldenPac Priv Esc in-use"; flow:established,to_server; content:"|a0 07 03 05 00 50 80 00 00|"; content:"|a8 05 30 03 02 01 17|"; distance:0; isdataat:!1,relative; threshold: type limit, track by_src, seconds 60, count 1; reference:url,code.google.com/p/impacket/source/browse/trunk/examples/goldenPac.py; reference:cve,CVE-2014-6324; classtype:attempted-admin; sid:1055184; rev:2; metadata:created_at 2014_12_11, updated_at 2014_12_11, flip_endpoints False, server_side True; target:dest_ip;)

# ET EXPLOIT CVE-2015-0235 Exim Buffer Overflow Attempt (HELO) (attempted-admin) - detector_id: 55196 original_sid: 2020325
alert tcp $EXTERNAL_NET any -> $HOME_NET [25,465,587] (msg:"ET EXPLOIT CVE-2015-0235 Exim Buffer Overflow Attempt (HELO)"; flow:to_server,established; content:"HELO "; nocase; content:!"|0a|"; within:1024; pcre:"/^\s*?\d[\d\x2e]{255}/R"; reference:url,openwall.com/lists/oss-security/2015/01/27/9; classtype:attempted-admin; sid:1055196; rev:2; metadata:created_at 2015_01_28, updated_at 2015_01_28, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT CVE-2015-0235 Exim Buffer Overflow Attempt (EHLO) (attempted-admin) - detector_id: 55197 original_sid: 2020326
alert tcp $EXTERNAL_NET any -> $HOME_NET [25,465,587] (msg:"ET EXPLOIT CVE-2015-0235 Exim Buffer Overflow Attempt (EHLO)"; flow:to_server,established; content:"EHLO "; nocase; content:!"|0a|"; within:1024; pcre:"/^\s*?\d[\d\x2e]{255}/R"; reference:url,openwall.com/lists/oss-security/2015/01/27/9; classtype:attempted-admin; sid:1055197; rev:4; metadata:created_at 2015_01_28, updated_at 2015_01_28, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Possible dlink-DSL2640B DNS Change Attempt (attempted-user) - detector_id: 55204 original_sid: 2020485
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET EXPLOIT Possible dlink-DSL2640B DNS Change Attempt"; flow:to_server,established; content:"GET"; http_method; content:"/ddnsmngr.cmd?action=apply"; http_uri; fast_pattern:only; content:"dnsPrimary="; http_uri; content:"&dnsSecondary="; http_uri; content:"&dnsDynamic="; http_uri; content:"&dnsRefresh="; http_uri; reference:url,packetstormsecurity.com/files/130418/dlink-DSL2640B.txt; classtype:attempted-user; sid:1055204; rev:2; metadata:created_at 2015_02_19, updated_at 2015_02_19, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Possible ShuttleTech 915WM DNS Change Attempt (attempted-user) - detector_id: 55205 original_sid: 2020486
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET EXPLOIT Possible ShuttleTech 915WM DNS Change Attempt"; flow:to_server,established; content:"GET"; http_method; content:"/dnscfg.cgi?"; http_uri; fast_pattern:only; content:"dnsPrimary="; http_uri; content:"&dnsSecondary="; http_uri; content:"&dnsDynamic="; http_uri; content:"&dnsRefresh="; http_uri; reference:url,packetstormsecurity.com/files/130418/dlink-DSL2640B.txt; classtype:attempted-user; sid:1055205; rev:2; metadata:created_at 2015_02_19, updated_at 2015_02_19, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Generic ADSL Router DNS Change GET Request (attempted-user) - detector_id: 55206 original_sid: 2020487
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET EXPLOIT Generic ADSL Router DNS Change GET Request"; flow:to_server,established; content:"GET"; http_method; content:"dnsPrimary="; http_uri; fast_pattern:only; content:"&dnsSecondary="; http_uri; content:"&dnsDynamic="; http_uri; content:"&dnsRefresh="; http_uri; reference:url,packetstormsecurity.com/files/130418/dlink-DSL2640B.txt; classtype:attempted-user; sid:1055206; rev:2; metadata:created_at 2015_02_19, updated_at 2015_02_19, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Generic ADSL Router DNS Change POST Request (attempted-user) - detector_id: 55207 original_sid: 2020488
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET EXPLOIT Generic ADSL Router DNS Change POST Request"; flow:to_server,established; content:"POST"; http_method; content:"dnsPrimary="; http_client_body; fast_pattern:only; content:"dnsSecondary="; http_client_body; content:"dnsDynamic="; http_client_body; content:"dnsRefresh="; http_client_body; reference:url,www.hackersbay.in/2011/02/pwning-routersbsnl.html; classtype:attempted-user; sid:1055207; rev:2; metadata:created_at 2015_02_19, updated_at 2015_02_19, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Seagate Business NAS Unauthenticated Remote Command Execution (attempted-admin) - detector_id: 55209 original_sid: 2020583
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET EXPLOIT Seagate Business NAS Unauthenticated Remote Command Execution"; flow:to_server,established; content:"POST"; http_method; content:"/index.php/mv_system/get_general_setup?_=1413463189043"; http_uri; fast_pattern:only; content:"set_general"; http_client_body; reference:url,beyondbinary.io/advisory/seagate-nas-rce; classtype:attempted-admin; sid:1055209; rev:3; metadata:created_at 2015_03_02, updated_at 2015_03_02, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT PCMan FTP Server 2.0.7 Remote Command Execution (attempted-admin) - detector_id: 55210 original_sid: 2020585
alert ftp $EXTERNAL_NET any -> $HOME_NET any (msg:"ET EXPLOIT PCMan FTP Server 2.0.7 Remote Command Execution"; flow:to_server,established; content:"|65 82 a5 7c|"; fast_pattern; content:"|90 90 90 90 90|"; distance:0; within:10; reference:url,exploit-db.com/exploits/36078; classtype:attempted-admin; sid:1055210; rev:2; metadata:created_at 2015_03_02, updated_at 2015_03_02, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT D-Link and TRENDnet ncc2 Service Vulnerability (ping.ccp) 2015-1187 (attempted-admin) - detector_id: 55211 original_sid: 2020590
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET EXPLOIT D-Link and TRENDnet ncc2 Service Vulnerability (ping.ccp) 2015-1187"; flow:to_server,established; content:"POST"; http_method; urilen:9; content:"/ping.ccp"; http_uri; fast_pattern:only; content:"ccp_act=ping_v6&ping_addr="; http_client_body; depth:26; pcre:"/ping_addr=[\d.]*[^\d.]/P"; reference:url,github.com/darkarnium/secpub/tree/master/Multivendor/ncc2; classtype:attempted-admin; sid:1055211; rev:2; metadata:created_at 2015_03_03, updated_at 2015_03_03, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT D-Link and TRENDnet ncc2 Service Vulnerability (fwupdate.cpp) 2015-1187 (attempted-admin) - detector_id: 55212 original_sid: 2020603
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET EXPLOIT D-Link and TRENDnet ncc2 Service Vulnerability (fwupdate.cpp) 2015-1187"; flow:to_server,established; content:"POST"; http_method; urilen:14; content:"/fwupgrade.ccp"; http_uri; fast_pattern:only; content:"|0d 0a|fwupgrade"; http_client_body; content:"|0d 0a|resolv.conf"; nocase; http_client_body; reference:url,github.com/darkarnium/secpub/tree/master/Multivendor/ncc2; classtype:attempted-admin; sid:1055212; rev:2; metadata:created_at 2015_03_03, updated_at 2015_03_03, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT TP-LINK TL-WR340G Router DNS Change GET Request (attempted-admin) - detector_id: 57266 original_sid: 2020856
alert http any any -> $HOME_NET $HTTP_PORTS (msg:"ET EXPLOIT TP-LINK TL-WR340G Router DNS Change GET Request"; flow:to_server,established; content:"GET"; http_method; content:"/userRpm/WanDynamicIpCfgRpm.htm?"; http_uri; depth:32; content:"&dnsserver="; http_uri; content:"&Save=Save"; http_uri; fast_pattern:only; reference:url,www.exploit-db.com/exploits/34583; classtype:attempted-admin; sid:1057266; rev:2; metadata:created_at 2015_04_07, updated_at 2015_04_07, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Belkin Wireless G Router DNS Change POST Request (attempted-admin) - detector_id: 57267 original_sid: 2020857
alert http any any -> $HOME_NET $HTTP_PORTS (msg:"ET EXPLOIT Belkin Wireless G Router DNS Change POST Request"; flow:to_server,established; content:"POST"; http_method; urilen:22; content:"/cgi-bin/setup_dns.exe"; http_uri; content:"getpage=|2e 2e|/html/setup/dns.htm"; http_client_body; depth:29; fast_pattern:9,20; content:"resolver|3a|settings/nameserver1="; http_client_body; distance:0; reference:url,www.exploit-db.com/exploits/3605; classtype:attempted-admin; sid:1057267; rev:4; metadata:created_at 2015_04_07, updated_at 2015_04_07, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Linksys WRT54GL Router DNS Change POST Request (attempted-admin) - detector_id: 57268 original_sid: 2020858
alert http any any -> $HOME_NET any (msg:"ET EXPLOIT Linksys WRT54GL Router DNS Change POST Request"; flow:to_server,established; content:"POST"; http_method; urilen:10; content:"/apply.cgi"; content:"submit_button=index"; http_client_body; depth:19; fast_pattern; content:"&action=Apply"; http_client_body; distance:0; nocase; content:"&lan_dns0="; http_client_body; distance:0; reference:url,www.s3cur1ty.de/node/640; classtype:attempted-admin; sid:1057268; rev:2; metadata:created_at 2015_04_07, updated_at 2015_04_07, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Netgear WNDR Router DNS Change POST Request (attempted-admin) - detector_id: 57269 original_sid: 2020859
alert http any any -> $HOME_NET any (msg:"ET EXPLOIT Netgear WNDR Router DNS Change POST Request"; flow:to_server,established; content:"POST"; http_method; urilen:26; content:"/apply.cgi?/BAS_update.htm"; http_uri; content:"submit_flag=ether"; http_client_body; depth:17; fast_pattern; content:"&ether_dnsaddr1="; http_client_body; distance:0; nocase; content:"&Apply=Apply"; http_client_body; distance:0; reference:url,www.s3cur1ty.de/node/640; classtype:attempted-admin; sid:1057269; rev:3; metadata:created_at 2015_04_07, updated_at 2015_04_07, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Motorola SBG900 Router DNS Change GET Request (attempted-admin) - detector_id: 57282 original_sid: 2020861
alert http any any -> $HOME_NET any (msg:"ET EXPLOIT Motorola SBG900 Router DNS Change GET Request"; flow:to_server,established; content:"GET"; http_method; content:"/goformFOO/AlFrame?"; http_uri; content:"/goformFOO/AlFrame?"; http_uri; distance:0; content:"Gateway.Wan.dnsAddress1="; http_uri; distance:0; reference:url,github.com/hkm/routerpwn.com/blob/master/index.html; classtype:attempted-admin; sid:1057282; rev:2; metadata:created_at 2015_04_08, updated_at 2015_04_08, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT ASUS RT N56U Router DNS Change GET Request 1 (attempted-admin) - detector_id: 57283 original_sid: 2020862
alert http any any -> $HOME_NET any (msg:"ET EXPLOIT ASUS RT N56U Router DNS Change GET Request 1"; flow:to_server,established; content:"GET"; http_method; content:"/start_apply.htm?"; http_uri; content:"wan_dns1="; http_uri; distance:0; content:"action_mode=apply"; http_uri; distance:0; reference:url,securityevaluators.com/knowledge/case_studies/routers/asus_rtn56u.php; classtype:attempted-admin; sid:1057283; rev:2; metadata:created_at 2015_04_08, updated_at 2015_04_08, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT ASUS RT N56U Router DNS Change GET Request 2 (attempted-admin) - detector_id: 57284 original_sid: 2020863
alert http any any -> $HOME_NET any (msg:"ET EXPLOIT ASUS RT N56U Router DNS Change GET Request 2"; flow:to_server,established; content:"GET"; http_method; content:"/start_apply.htm?"; http_uri; content:"wan_dns1_x="; http_uri; distance:0; reference:url,securityevaluators.com/knowledge/case_studies/routers/asus_rtn56u.php; classtype:attempted-admin; sid:1057284; rev:2; metadata:created_at 2015_04_08, updated_at 2015_04_08, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT FritzBox RCE POST Request (attempted-admin) - detector_id: 57285 original_sid: 2020867
alert http any any -> $HOME_NET any (msg:"ET EXPLOIT FritzBox RCE POST Request"; flow:to_server,established; content:"POST"; http_method; urilen:14; content:"/cgi-bin/webcm"; http_uri; fast_pattern:only; content:"getpage="; http_client_body; depth:10; content:"errorpage="; http_client_body; distance:0; content:"/html/index.html&login|3a|command"; http_client_body; distance:0; reference:url,www.exploit-db.com/exploits/33136; classtype:attempted-admin; sid:1057285; rev:3; metadata:created_at 2015_04_08, updated_at 2015_04_08, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT FritzBox RCE GET Request (attempted-admin) - detector_id: 57286 original_sid: 2020868
alert http any any -> $HOME_NET any (msg:"ET EXPLOIT FritzBox RCE GET Request"; flow:to_server,established; content:"GET"; http_method; content:"/cgi-bin/webcm?"; http_uri; fast_pattern; content:"getpage="; http_uri; distance:0; content:"|2e 2e|/html/menus/menu2.html"; http_raw_uri; content:"&var|3a|lang="; http_uri; reference:url,www.exploit-db.com/exploits/33136; classtype:attempted-admin; sid:1057286; rev:3; metadata:created_at 2015_04_08, updated_at 2015_04_08, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT ASUS RT N56U Router DNS Change GET Request 3 (attempted-admin) - detector_id: 57287 original_sid: 2020871
alert http any any -> $HOME_NET any (msg:"ET EXPLOIT ASUS RT N56U Router DNS Change GET Request 3"; flow:to_server,established; content:"GET"; http_method; content:"/start_apply.htm?"; http_uri; fast_pattern; content:"dnsserver="; http_uri; distance:0; content:"&dnsserver2="; http_uri; distance:0; reference:url,securityevaluators.com/knowledge/case_studies/routers/asus_rtn56u.php; classtype:attempted-admin; sid:1057287; rev:2; metadata:created_at 2015_04_08, updated_at 2015_04_08, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT TP-LINK Known Malicious Router DNS Change GET Request (attempted-admin) - detector_id: 57288 original_sid: 2020872
alert http any any -> $HOME_NET any (msg:"ET EXPLOIT TP-LINK Known Malicious Router DNS Change GET Request"; flow:to_server,established; content:"GET"; http_method; content:"/basic/uiViewIPAddr="; fast_pattern; http_uri; content:"&uiViewDns1Mark="; http_uri; distance:0; content:"&uiViewDns2Mark="; http_uri; distance:0; reference:url,pastebin.com/u0MRLmjp; classtype:attempted-admin; sid:1057288; rev:2; metadata:created_at 2015_04_08, updated_at 2015_04_08, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT D-link DI604 Known Malicious Router DNS Change GET Request (attempted-admin) - detector_id: 57289 original_sid: 2020873
alert http any any -> $HOME_NET any (msg:"ET EXPLOIT D-link DI604 Known Malicious Router DNS Change GET Request"; flow:to_server,established; content:"GET"; http_method; content:"/prim.htm?"; http_uri; depth:10; fast_pattern; nocase; content:"i00110004="; http_uri; distance:0; content:"&i00110005="; http_uri; distance:0; nocase; content:"&i00035007="; http_uri; distance:0; nocase; reference:url,www.gnucitizen.org/blog/router-hacking-challenge; classtype:attempted-admin; sid:1057289; rev:2; metadata:created_at 2015_04_08, updated_at 2015_04_08, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Netgear DGN1000B Router DNS Change GET Request (attempted-admin) - detector_id: 57290 original_sid: 2020874
alert http any any -> $HOME_NET any (msg:"ET EXPLOIT Netgear DGN1000B Router DNS Change GET Request"; flow:to_server,established; content:"GET"; http_method; content:"/setup.cgi?todo=wan_dns1="; http_uri; fast_pattern:only; reference:url,www.rapid7.com/db/modules/exploit/linux/http/netgear_dgn1000b_setup_exec; classtype:attempted-admin; sid:1057290; rev:3; metadata:created_at 2015_04_08, updated_at 2015_04_08, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Belkin G F5D7230-4 Router DNS Change GET Request (attempted-admin) - detector_id: 57291 original_sid: 2020875
alert http any any -> $HOME_NET any (msg:"ET EXPLOIT Belkin G F5D7230-4 Router DNS Change GET Request"; flow:to_server,established; content:"GET"; http_method; content:"/setup_dns.stm?page=setup_dns"; http_uri; content:"&dns1_1="; http_uri; reference:url,www.gnucitizen.org/blog/holes-in-embedded-devices-authentication-bypass-pt-4; classtype:attempted-admin; sid:1057291; rev:2; metadata:created_at 2015_04_08, updated_at 2015_04_08, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Tenda ADSL2/2+ Router DNS Change GET Request (attempted-admin) - detector_id: 57292 original_sid: 2020876
alert http any any -> $HOME_NET any (msg:"ET EXPLOIT Tenda ADSL2/2+ Router DNS Change GET Request"; flow:to_server,established; content:"GET"; http_method; content:"/apply.cgi?wan_primary_dns="; http_uri; fast_pattern:only; content:"&wan_secondary_dns="; http_uri; reference:url,malwr.com/analysis/MGY1ZDFhYjE1MzQ4NDAwM2EyZTI5YmY3MWZjMWE5OGM; classtype:attempted-admin; sid:1057292; rev:2; metadata:created_at 2015_04_08, updated_at 2015_04_08, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Known Malicious Router DNS Change GET Request (attempted-admin) - detector_id: 57293 original_sid: 2020877
alert http any any -> $HOME_NET any (msg:"ET EXPLOIT Known Malicious Router DNS Change GET Request"; flow:to_server,established; content:"GET"; http_method; content:"/router/add_dhcp_segment.cgi?"; http_uri; fast_pattern:only; content:"is_router_as_dns=1"; http_uri; content:"&dns1="; http_uri; content:"submitbutton="; http_uri; reference:url,wepawet.cs.ucsb.edu/view.php?hash=5e14985415814ed1e107c0583a27a1a2&t=1384961238&type=js; classtype:attempted-admin; sid:1057293; rev:2; metadata:created_at 2015_04_08, updated_at 2015_04_08, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT TP-LINK TL-WR841N Router DNS Change GET Request (attempted-admin) - detector_id: 57294 original_sid: 2020878
alert http any any -> $HOME_NET any (msg:"ET EXPLOIT TP-LINK TL-WR841N Router DNS Change GET Request"; flow:to_server,established; content:"GET"; http_method; content:"/userRpm/LanDhcpServerRpm.htm?"; http_uri; fast_pattern; content:"dhcpserver=1"; http_uri; content:"&dnsserver="; http_uri; content:"&Save="; http_uri; reference:url,www.exploit-db.com/exploits/34584; classtype:attempted-admin; sid:1057294; rev:2; metadata:created_at 2015_04_08, updated_at 2015_04_08, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Linksys WRT54GL DNS Change GET Request (attempted-admin) - detector_id: 57295 original_sid: 2020879
alert http any any -> $HOME_NET any (msg:"ET EXPLOIT Linksys WRT54GL DNS Change GET Request"; flow:to_server,established; content:"GET"; http_method; content:"/Basic.tri?"; http_uri; fast_pattern; content:"&dns0_0="; http_uri; content:"&dns0_1="; http_uri; reference:url,sebug.net/paper/Exploits-Archives/2008-exploits/0803-exploits/linksys-bypass.txt; classtype:attempted-admin; sid:1057295; rev:2; metadata:created_at 2015_04_08, updated_at 2015_04_08, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT TP-LINK TL-WR750N DNS Change GET Request (attempted-admin) - detector_id: 57296 original_sid: 2020880
alert http any any -> $HOME_NET any (msg:"ET EXPLOIT TP-LINK TL-WR750N DNS Change GET Request"; flow:to_server,established; content:"GET"; http_method; content:"/userRpm/WanStaticIpCfgRpm.htm"; http_uri; fast_pattern; content:"&dnsserver="; http_uri; content:"&Save=Save"; http_uri; reference:url,www.xexexe.cz/2015/02/bruteforcing-tp-link-routers-with.html; classtype:attempted-admin; sid:1057296; rev:2; metadata:created_at 2015_04_08, updated_at 2015_04_08, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT D-Link Devices Home Network Administration Protocol Command Execution (attempted-admin) - detector_id: 57404 original_sid: 2020899
alert http any any -> $HOME_NET any (msg:"ET EXPLOIT D-Link Devices Home Network Administration Protocol Command Execution"; flow:established,to_server; content:"POST"; http_method; content:"SOAPAction|3a|"; http_header; content:"http|3a|//purenetworks.com/HNAP1/"; fast_pattern; http_header; pcre:"/^SOAPAction\x3a\s+?[^\r\n]*?http\x3a\/\/purenetworks\.com\/HNAP1\/([^\x2f]+?[\x2f])?[^\x2f]/Hmi"; reference:url,devttys0.com/2015/04/hacking-the-d-link-dir-890l/; reference:cve,2016-6563; classtype:attempted-admin; sid:1057404; rev:4; metadata:created_at 2015_04_13, updated_at 2016_11_10, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT WNR2000v4 HTTP POST RCE Attempt Via Timestamp Discovery (attempted-admin) - detector_id: 57676 original_sid: 2021018
alert http any any -> $HOME_NET any (msg:"ET EXPLOIT WNR2000v4 HTTP POST RCE Attempt Via Timestamp Discovery"; flow:to_server,established; content:"POST"; http_method; content:"/apply_noauth.cgi"; http_uri; fast_pattern:only; content:"timestamp="; http_client_body; threshold: type both, track by_dst, count 10, seconds 60; reference:url,seclists.org/fulldisclosure/2015/Apr/72; classtype:attempted-admin; sid:1057676; rev:2; metadata:created_at 2015_04_27, updated_at 2015_04_27, flip_endpoints False, server_side True; target:dest_ip;)

# ET EXPLOIT AirLive RCI HTTP Request (attempted-admin) - detector_id: 59033 original_sid: 2021408
alert http any any -> $HOME_NET any (msg:"ET EXPLOIT AirLive RCI HTTP Request"; flow:to_server,established; content:"GET"; http_method; content:"/cgi_test.cgi?write_"; http_uri; fast_pattern:only; pcre:"/\?write_(?:m(?:ac|sn)|hdv|pid|tan)&[^&]*\x3b/Ui"; reference:url,packetstormsecurity.com/files/132585/CORE-2015-0012.txt; classtype:attempted-admin; sid:1059033; rev:2; metadata:created_at 2015_07_13, updated_at 2015_07_13, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT FireEye Appliance Unauthorized File Disclosure (trojan-activity) - detector_id: 60180 original_sid: 2021756
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET EXPLOIT FireEye Appliance Unauthorized File Disclosure"; flow:established,to_server; content:"/NEI_ModuleDispatch.php"; http_uri; content:"module=NEI_AdvancedConfig"; distance:0; http_uri; content:"&function=HapiGetFileContents"; http_uri; fast_pattern:10,19; distance:0; pcre:"/(?:%2(?:52e(?:%2(?:52e(?:%(?:(?:25)?2|c0%a)f|\/)|e(?:%(?:(?:25)?2|c0%a)f|\/))|\.(?:%(?:(?:25)?2|c0%a)f|\/))|e(?:%2(?:52e(?:%(?:(?:25)?2|c0%a)f|\/)|e(?:%(?:(?:25)?2|c0%a)f|\/))|\.(?:%(?:(?:25)?2|c0%a)f|\/)))|\.(?:%2(?:52e(?:%(?:(?:25)?2|c0%a)f|\/)|e(?:%(?:(?:25)?2|c0%a)f|\/))|\.(?:%(?:(?:25)?2|c0%a)f|\/)))/Ii"; reference:url,www.exploit-db.com/exploits/38090/; classtype:trojan-activity; sid:1060180; rev:3; metadata:created_at 2015_09_09, updated_at 2015_09_09, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Serialized Java Object Calling Common Collection Function (misc-activity) - detector_id: 60572 original_sid: 2022114
alert tcp any any -> $HOME_NET any (msg:"ET EXPLOIT Serialized Java Object Calling Common Collection Function"; flow:to_server,established; content:"rO0ABXNyA"; content:"jb21tb25zLmNvbGxlY3Rpb25z"; fast_pattern; distance:0; reference:url,github.com/foxglovesec/JavaUnserializeExploits; classtype:misc-activity; sid:1060572; rev:1; metadata:created_at 2015_11_17, updated_at 2015_11_17, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Serialized Java Object Calling Common Collection Function (misc-activity) - detector_id: 60573 original_sid: 2022115
alert tcp any any -> $HOME_NET any (msg:"ET EXPLOIT Serialized Java Object Calling Common Collection Function"; flow:to_server,established; content:"|ac ed 00 05 73 72 00|"; fast_pattern; content:"commons.collections"; nocase; distance:0; reference:url,github.com/foxglovesec/JavaUnserializeExploits; classtype:misc-activity; sid:1060573; rev:1; metadata:created_at 2015_11_17, updated_at 2015_11_17, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Serialized Java Object Generated by ysoserial (misc-activity) - detector_id: 60574 original_sid: 2022116
alert tcp any any -> $HOME_NET any (msg:"ET EXPLOIT Serialized Java Object Generated by ysoserial"; flow:to_server,established; content:"|ac ed 00 05 73 72 00|"; fast_pattern; content:"java/io/Serializable"; nocase; distance:0; content:"ysoserial/payloads/util/Gadgets"; reference:url,github.com/foxglovesec/JavaUnserializeExploits; classtype:misc-activity; sid:1060574; rev:1; metadata:created_at 2015_11_17, updated_at 2015_11_17, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Serialized Groovy Java Object Generated by ysoserial (misc-activity) - detector_id: 60575 original_sid: 2022117
alert tcp any any -> $HOME_NET any (msg:"ET EXPLOIT Serialized Groovy Java Object Generated by ysoserial"; flow:to_server,established; content:"|ac ed 00 05 73 72 00|"; fast_pattern; content:"org.codehaus.groovy.runtime.ConversionHandler"; nocase; distance:0; content:"ysoserial/payloads/util/Gadgets"; reference:url,github.com/foxglovesec/JavaUnserializeExploits; classtype:misc-activity; sid:1060575; rev:1; metadata:created_at 2015_11_17, updated_at 2015_11_17, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Serialized Spring Java Object Generated by ysoserial (misc-activity) - detector_id: 60576 original_sid: 2022118
alert tcp any any -> $HOME_NET any (msg:"ET EXPLOIT Serialized Spring Java Object Generated by ysoserial"; flow:to_server,established; content:"|ac ed 00 05 73 72 00|"; fast_pattern; content:"org.springframework.core.SerializableTypeWrapper"; nocase; distance:0; content:"ysoserial/payloads/util/Gadgets"; reference:url,github.com/foxglovesec/JavaUnserializeExploits; classtype:misc-activity; sid:1060576; rev:1; metadata:created_at 2015_11_17, updated_at 2015_11_17, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Joomla RCE (JDatabaseDriverMysqli) (web-application-attack) - detector_id: 60743 original_sid: 2022261
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET EXPLOIT Joomla RCE (JDatabaseDriverMysqli)"; flow:established,to_server; content:"JDatabaseDriverMysqli"; fast_pattern:only; pcre:"/^User-Agent\x3a[^\r\n]*JDatabaseDriverMysqli/Hmi"; reference:url,blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html; classtype:web-application-attack; sid:1060743; rev:2; metadata:created_at 2015_12_14, updated_at 2015_12_14, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Joomla RCE M2 (Serialized PHP in UA) (web-application-attack) - detector_id: 60760 original_sid: 2022263
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET EXPLOIT Joomla RCE M2 (Serialized PHP in UA)"; flow:established,to_server; content:"O|3a|"; http_header; fast_pattern:only; pcre:"/^User-Agent\x3a[^\r\n]*\bO\x3a\d+\x3a[^\r\n]*?\{[^\r\n]*?\}/Hmi"; reference:url,blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html; classtype:web-application-attack; sid:1060760; rev:2; metadata:created_at 2015_12_15, updated_at 2015_12_15, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Joomla RCE M3 (Serialized PHP in XFF) (web-application-attack) - detector_id: 60761 original_sid: 2022268
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET EXPLOIT Joomla RCE M3 (Serialized PHP in XFF)"; flow:established,to_server; content:"O|3a|"; http_header; fast_pattern:only; pcre:"/^X-Forwarded-For\x3a[^\r\n]*\bO\x3a\d+\x3a[^\r\n]*?\{[^\r\n]*?\}/Hmi"; reference:url,blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html; classtype:web-application-attack; sid:1060761; rev:2; metadata:created_at 2015_12_15, updated_at 2015_12_15, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Juniper ScreenOS telnet Backdoor Default Password Attempt (attempted-admin) - detector_id: 60787 original_sid: 2022291
alert tcp any any -> $HOME_NET 23 (msg:"ET EXPLOIT Juniper ScreenOS telnet Backdoor Default Password Attempt"; flow:established,to_server; content:"|3c 3c 3c 20 25 73 28 75 6e 3d 27 25 73 27 29 20 3d 20 25 75|"; fast_pattern; threshold: type limit, count 1, seconds 60, track by_src; reference:cve,2015-7755; reference:url,community.rapid7.com/community/infosec/blog/2015/12/20/cve-2015-7755-juniper-screenos-authentication-backdoor; classtype:attempted-admin; sid:1060787; rev:1; metadata:created_at 2015_12_21, updated_at 2015_12_21, flip_endpoints False, server_side True; target:dest_ip;)

# ET EXPLOIT Possible CVE-2016-1287 Invalid Fragment Size Inbound (trojan-activity) - detector_id: 61078 original_sid: 2022506
alert udp $EXTERNAL_NET any -> $HOME_NET 500 (msg:"ET EXPLOIT Possible CVE-2016-1287 Invalid Fragment Size Inbound"; flow:to_server; content:"|84 00 00|"; byte_test:1,<,9,0,relative; byte_jump:1,0,relative,post_offset -4; content:"|00 00 00|"; within:3; byte_test:1,<,8,0,relative; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:url,blog.exodusintel.com/2016/02/10/firewall-hacking; classtype:trojan-activity; sid:1061078; rev:3; metadata:created_at 2016_02_11, updated_at 2017_05_02; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Possible CVE-2016-1287 Invalid Fragment Size Inbound 2 (trojan-activity) - detector_id: 61083 original_sid: 2022515
alert udp $EXTERNAL_NET any -> $HOME_NET 500 (msg:"ET EXPLOIT Possible CVE-2016-1287 Invalid Fragment Size Inbound 2"; flow:to_server; content:"|84 20|"; depth:2; offset:16; byte_test:2,<,9,12,relative; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:url,blog.exodusintel.com/2016/02/10/firewall-hacking; classtype:trojan-activity; sid:1061083; rev:2; metadata:created_at 2016_02_12, updated_at 2017_05_02; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Possible CVE-2016-1287 Invalid Fragment Size Inbound 3 (trojan-activity) - detector_id: 61084 original_sid: 2022516
alert udp $EXTERNAL_NET any -> $HOME_NET 500 (msg:"ET EXPLOIT Possible CVE-2016-1287 Invalid Fragment Size Inbound 3"; flow:to_server; content:"|84 10|"; depth:2; offset:16; byte_test:2,<,9,12,relative; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:url,blog.exodusintel.com/2016/02/10/firewall-hacking; classtype:trojan-activity; sid:1061084; rev:2; metadata:created_at 2016_02_12, updated_at 2017_05_02; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT D-Link DCS-930L Remote Command Execution attempt (web-application-attack) - detector_id: 61085 original_sid: 2022518
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET EXPLOIT D-Link DCS-930L Remote Command Execution attempt"; flow:to_server,established; urilen:17; content:"POST"; nocase; http_method; content:"/setSystemCommand"; nocase; http_uri; content:"SystemCommand="; nocase; http_client_body; reference:url,www.exploit-db.com/exploits/39437/; classtype:web-application-attack; sid:1061085; rev:2; metadata:created_at 2016_02_12, updated_at 2016_02_12, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT FireEye Detection Evasion %temp% attempt - Inbound (misc-attack) - detector_id: 61132 original_sid: 2022554
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET EXPLOIT FireEye Detection Evasion %temp% attempt - Inbound"; flow:to_server,established; content:"%"; http_raw_uri; content:"temp%"; nocase; http_raw_uri; within:7; pcre:"/\%(?:25)?temp\%/Ii"; content:"temp%"; fast_pattern:only; reference:url,labs.bluefrostsecurity.de/advisories/bfs-sa-2016-001/; classtype:misc-attack; sid:1061132; rev:2; metadata:created_at 2016_02_22, updated_at 2016_02_22, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Quanta LTE Router Information Disclosure Exploit Attempt (attempted-admin) - detector_id: 61361 original_sid: 2022698
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET EXPLOIT Quanta LTE Router Information Disclosure Exploit Attempt"; flow:to_server,established; content:"GET"; http_method; content:"/data.ria?CfgType=get_homeCfg&file="; http_uri; fast_pattern; depth:35; reference:url,pierrekim.github.io/blog/2016-04-04-quanta-lte-routers-vulnerabilities.html; classtype:attempted-admin; sid:1061361; rev:2; metadata:created_at 2016_04_05, updated_at 2016_04_05, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Quanta LTE Router UDP Backdoor Activation Attempt (attempted-admin) - detector_id: 61362 original_sid: 2022699
alert udp $EXTERNAL_NET any -> $HOME_NET 39889 (msg:"ET EXPLOIT Quanta LTE Router UDP Backdoor Activation Attempt"; flow:to_server; content:"HELODBG"; reference:url,pierrekim.github.io/blog/2016-04-04-quanta-lte-routers-vulnerabilities.html; classtype:attempted-admin; sid:1061362; rev:1; metadata:created_at 2016_04_05, updated_at 2016_04_05, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Quanta LTE Router RDE Exploit Attempt 1 (ping) (attempted-admin) - detector_id: 61363 original_sid: 2022700
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET EXPLOIT Quanta LTE Router RDE Exploit Attempt 1 (ping)"; flow:to_server,established; content:"POST"; http_method; content:"/webpost.cgi"; http_uri; content:"|7b 22 43 66 67 54 79 70 65 22 3a 22 70 69 6e 67 22 2c 22 63 6d 64 22 3a 22 70 69 6e 67 22 2c 22 75 72 6c 22 3a 22|"; http_client_body; fast_pattern; pcre:"/^[^\x22]*[\x24\x60]+/PRi"; reference:url,pierrekim.github.io/blog/2016-04-04-quanta-lte-routers-vulnerabilities.html; classtype:attempted-admin; sid:1061363; rev:2; metadata:created_at 2016_04_05, updated_at 2016_04_05, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Quanta LTE Router RDE Exploit Attempt 2 (traceroute) (attempted-admin) - detector_id: 61364 original_sid: 2022701
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET EXPLOIT Quanta LTE Router RDE Exploit Attempt 2 (traceroute)"; flow:to_server,established; content:"POST"; http_method; content:"/webpost.cgi"; http_uri; content:"|7b 22 43 66 67 54 79 70 65 22 3a 22 74 72 61 63 65 72 74 22 2c 22 63 6d 64 22 3a 22 74 72 61 63 65 72 74 22 2c 22 75 72 6c 22 3a 22|"; http_client_body; fast_pattern; pcre:"/^[^\x22]*[\x24\x60]+/PRi"; reference:url,pierrekim.github.io/blog/2016-04-04-quanta-lte-routers-vulnerabilities.html; classtype:attempted-admin; sid:1061364; rev:3; metadata:created_at 2016_04_05, updated_at 2016_04_05, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Linksys Router Unauthenticated Remote Code Execution (attempted-user) - detector_id: 61478 original_sid: 2022758
alert http any any -> $HOME_NET 8080 (msg:"ET EXPLOIT Linksys Router Unauthenticated Remote Code Execution"; flow:to_server,established; content:"POST"; http_method; content:".cgi"; http_uri; nocase; content:"%74%74%63%70%5f%69%70%3d%2d%68%20%60"; http_client_body; fast_pattern:only; content:"Authorization|3a| Basic"; http_header; reference:url,sans.org/reading-room/whitepapers/malicious/analyzing-backdoor-bot-mips-platform-35902; classtype:attempted-user; sid:1061478; rev:2; metadata:created_at 2016_04_25, updated_at 2016_04_25, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Possible Symantec Malicious MIME Doc Name Overflow (EICAR) toserver M3 (attempted-admin) - detector_id: 62045 original_sid: 2022935
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"ET EXPLOIT Possible Symantec Malicious MIME Doc Name Overflow (EICAR) toserver M3"; flow:established,to_server; content:"Content-Type|3a 20|"; nocase; content:"name"; nocase; isdataat:78,relative; pcre:"/^\s*=\s*[\x22\x27][^\x22\x27\r\n]{78}/R"; content:"|57 44 56 50 49 56 41 6c 51 45 46 51 57 7a 52 63 55 46 70 59 4e 54 51 6f 55 46 34 70 4e 30 4e 44 4b 54 64 39 4a 45 56 4a 51 30 46 53|"; reference:url,bugs.chromium.org/p/project-zero/issues/detail?id=823&q=; classtype:attempted-admin; sid:1062045; rev:1; metadata:created_at 2016_06_30, updated_at 2016_06_30, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Possible Symantec Malicious MIME Doc Name Overflow (EICAR) toserver M4 (attempted-admin) - detector_id: 62048 original_sid: 2022938
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"ET EXPLOIT Possible Symantec Malicious MIME Doc Name Overflow (EICAR) toserver M4"; flow:established,to_server; content:"Content-Type|3a 20|"; nocase; content:"name"; nocase; isdataat:78,relative; pcre:"/^\s*=\s*[\x22\x27][^\x22\x27\r\n]{78}/R"; content:"|58 35 4f 21 50 25 40 41 50 5b 34 5c 50 5a 58 35 34 28 50 5e 29 37 43 43 29 37 7d 24 45 49 43 41 52 2d|"; reference:url,bugs.chromium.org/p/project-zero/issues/detail?id=823&q=; classtype:attempted-admin; sid:1062048; rev:1; metadata:created_at 2016_06_30, updated_at 2016_06_30, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Equation Group EGREGIOUSBLUNDER Fortigate Exploit Attempt (attempted-admin) - detector_id: 62205 original_sid: 2023075
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET EXPLOIT Equation Group EGREGIOUSBLUNDER Fortigate Exploit Attempt"; flow:established,to_server; urilen:6; content:"POST"; http_method; content:"/index"; http_uri; content:!"User-Agent|3a|"; http_header; content:!"Content-Type|3a|"; http_header; content:!"Referer|3a|"; http_header; content:!"Accept"; http_header; content:"Host|3a 20|"; depth:6; http_header; content:"Content-length|3a 20|0|0d 0a|"; distance:0; http_header; content:"Content-length|3a 20|0|0d 0a|Cookie|3a 20|APSCOOKIE=Era=0&Payload="; fast_pattern:31,20; pcre:"/^[A-Za-z0-9+/]{0,4}?[^\x20-\x7e]/R"; pcre:"/^Host\x3a[^\r\n]+?\r\nContent-length/H"; classtype:attempted-admin; sid:1062205; rev:2; metadata:affected_product Fortigate, attack_target Server, deployment Datacenter, signature_severity Major, created_at 2016_08_17, performance_impact Low, updated_at 2016_08_17, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Possible MySQL CVE-2016-6662 Attempt (attempted-admin) - detector_id: 62349 original_sid: 2023201
alert tcp any any -> $HOME_NET 3306 (msg:"ET EXPLOIT Possible MySQL CVE-2016-6662 Attempt"; flow:established,to_server; content:"|03|"; offset:4; content:"unhex"; nocase; distance:0; content:"67656e6572616c5f6c6f675f66696c65"; distance:0; nocase; content:"2e636e66"; nocase; content:"6e6d616c6c6f635f6c6962"; reference:cve,2016-6662; reference:url,legalhackers.com/advisories/MySQL-Exploit-Remote-Root-Code-Execution-Privesc-CVE-2016-6662.html; classtype:attempted-admin; sid:1062349; rev:1; metadata:affected_product MySQL, attack_target Server, deployment Datacenter, created_at 2016_09_13, updated_at 2016_09_13, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Possible MySQL cnf overwrite CVE-2016-6662 Attempt (attempted-admin) - detector_id: 62350 original_sid: 2023202
alert tcp any any -> $HOME_NET 3306 (msg:"ET EXPLOIT Possible MySQL cnf overwrite CVE-2016-6662 Attempt"; flow:established,to_server; content:"|03|"; offset:4; content:"global_log_dir"; nocase; distance:0; content:".cnf"; nocase; distance:0; content:"nmalloc_lib"; fast_pattern:only; reference:cve,2016-6662; reference:url,legalhackers.com/advisories/MySQL-Exploit-Remote-Root-Code-Execution-Privesc-CVE-2016-6662.html; classtype:attempted-admin; sid:1062350; rev:1; metadata:affected_product MySQL, attack_target Server, deployment Datacenter, created_at 2016_09_13, updated_at 2016_09_13, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT D-Link DSL-2740R Remote DNS Change Attempt (attempted-admin) - detector_id: 62652 original_sid: 2023466
alert http any any -> $HOME_NET any (msg:"ET EXPLOIT D-Link DSL-2740R Remote DNS Change Attempt"; flow:established,to_server; content:"GET"; http_method; content:"/Forms/dns_1?"; http_uri; fast_pattern; content:"Enable_DNSFollowing=1"; http_uri; distance:0; content:"dnsPrimary="; http_uri; distance:0; reference:url,www.exploit-db.com/exploits/35917; classtype:attempted-admin; sid:1062652; rev:3; metadata:created_at 2015_01_29, updated_at 2016_10_31, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT COMTREND ADSL Router CT-5367 Remote DNS Change Attempt (attempted-admin) - detector_id: 62653 original_sid: 2023467
alert http any any -> $HOME_NET any (msg:"ET EXPLOIT COMTREND ADSL Router CT-5367 Remote DNS Change Attempt"; flow:established,to_server; content:"GET"; http_method; content:"/dnscfg.cgi?"; http_uri; fast_pattern; nocase; content:"dnsPrimary="; http_uri; content:"dnsDynamic="; http_uri; nocase; content:"dnsRefresh="; http_uri; nocase; reference:url,www.expku.com/remote/5853.html; classtype:attempted-admin; sid:1062653; rev:2; metadata:attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2016_10_31, updated_at 2016_10_31, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Unknown Router Remote DNS Change Attempt (attempted-admin) - detector_id: 62654 original_sid: 2023468
alert http any any -> $HOME_NET any (msg:"ET EXPLOIT Unknown Router Remote DNS Change Attempt"; flow:established,to_server; urilen:10; content:"POST"; http_method; content:"/setup.htm"; http_uri; nocase; content:"wan_proto=dhcp"; nocase; http_client_body; content:"dhcps_dns_1="; http_client_body; nocase; fast_pattern:only; content:"dhcps_mode=enabled"; http_client_body; nocase; content:"lan_proto=enable"; http_client_body; nocase; content:!"Cookie|3a|"; content:!"Authorization|3a|"; http_header; classtype:attempted-admin; sid:1062654; rev:2; metadata:attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2016_10_31, updated_at 2016_10_31, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT REDIS Attemted SSH Authorized Key Writing Attempt (attempted-admin) - detector_id: 62717 original_sid: 2023511
alert tcp $EXTERNAL_NET any -> $HOME_NET 6379 (msg:"ET EXPLOIT REDIS Attemted SSH Authorized Key Writing Attempt"; flow:established,to_server; content:"*"; depth:1; content:"config"; content:"set"; distance:0; content:"|0D 0A|dbfilename|0D 0A|"; distance:0; content:"|0D 0A|authorized_keys|0D 0A|"; distance:0; reference:url,antirez.com/news/96; classtype:attempted-admin; sid:1062717; rev:1; metadata:attack_target Client_Endpoint, deployment Datacenter, tag SCAN_Redis_SSH, signature_severity Major, created_at 2016_11_15, updated_at 2016_11_15, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT REDIS Attempted SSH Key Upload (attempted-admin) - detector_id: 62718 original_sid: 2023512
alert tcp $EXTERNAL_NET any -> $HOME_NET 6379 (msg:"ET EXPLOIT REDIS Attempted SSH Key Upload"; flow:established,to_server; content:"*"; depth:1; content:"|0D 0A|set|0D 0A|"; content:"ssh-rsa "; distance:0; reference:url,antirez.com/news/96; classtype:attempted-admin; sid:1062718; rev:1; metadata:attack_target Client_Endpoint, deployment Datacenter, tag SCAN_Redis_SSH, signature_severity Major, created_at 2016_11_15, updated_at 2016_11_15, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Netgear R7000 Command Injection Exploit (attempted-user) - detector_id: 62823 original_sid: 2023628
alert http any any -> $HOME_NET any (msg:"ET EXPLOIT Netgear R7000 Command Injection Exploit"; flow:established,to_server; content:"/cgi-bin/"; http_uri; depth:9; content:"$IFS"; http_uri; fast_pattern; distance:0; content:"|3b|"; http_uri; reference:url,www.kb.cert.org/vuls/id/582384; classtype:attempted-user; sid:1062823; rev:2; metadata:affected_product Netgear_Router, attack_target Networking_Equipment, deployment Perimeter, signature_severity Major, created_at 2016_12_12, performance_impact Low, updated_at 2016_12_12, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Possible CVE-2016-10033 PHPMailer RCE Attempt (attempted-user) - detector_id: 62912 original_sid: 2023686
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET EXPLOIT Possible CVE-2016-10033 PHPMailer RCE Attempt"; flow:to_server,established; content:"POST"; http_method; content:"Content-Type|3a 20|multipart/form-data|3b|"; http_header; content:"<?php"; http_client_body; fast_pattern; content:"|5c 22 20|"; http_client_body; content:"-X"; http_client_body; content:".php"; http_client_body; content:"@"; http_client_body; reference:url,legalhackers.com/advisories/PHPMailer-Exploit-Remote-Code-Exec-CVE-2016-10033-Vuln.html; reference:url,github.com/opsxcq/exploit-CVE-2016-10033; classtype:attempted-user; sid:1062912; rev:2; metadata:affected_product PHPMailer, attack_target Web_Server, deployment Datacenter, signature_severity Major, created_at 2016_12_27, performance_impact Low, updated_at 2016_12_27, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT TP-LINK DNS Change GET Request (DNSChanger EK) (attempted-admin) - detector_id: 63232 original_sid: 2023995
alert http any any -> $HOME_NET any (msg:"ET EXPLOIT TP-LINK DNS Change GET Request (DNSChanger EK)"; flow:to_server,established; content:"GET"; http_method; content:"/userRpm/"; http_uri; depth:9; fast_pattern; content:"&dnsserver="; http_uri; threshold: type both, track by_dst, count 3, seconds 90; reference:url,www.xexexe.cz/2015/02/bruteforcing-tp-link-routers-with.html; classtype:attempted-admin; sid:1063232; rev:1; metadata:affected_product Linux, attack_target Networking_Equipment, deployment Internet, signature_severity Major, created_at 2017_02_17, performance_impact Moderate, updated_at 2017_02_17, flip_endpoints False, server_side True; target:dest_ip;)

# ET EXPLOIT TP-LINK Password Change GET Request (DNSChanger EK) (attempted-admin) - detector_id: 63233 original_sid: 2023996
alert tcp any any -> $HOME_NET $HTTP_PORTS (msg:"ET EXPLOIT TP-LINK Password Change GET Request (DNSChanger EK)"; flow:to_server,established; content:"GET"; http_method; content:"/router/UserPassSet.cgi?"; http_uri; depth:24; fast_pattern; content:"new_user_name="; http_uri; content:"password1="; http_uri; threshold: type limit, track by_dst, count 3, seconds 90; reference:url,www.xexexe.cz/2015/02/bruteforcing-tp-link-routers-with.html; classtype:attempted-admin; sid:1063233; rev:2; metadata:affected_product Linux, attack_target Networking_Equipment, deployment Internal, signature_severity Major, created_at 2017_02_17, performance_impact Moderate, updated_at 2017_02_17, flip_endpoints False, server_side True; target:dest_ip;)

# ET EXPLOIT IBM WebSphere - RCE Java Deserialization (attempted-user) - detector_id: 63348 original_sid: 2024062
alert tcp $EXTERNAL_NET any -> $HOME_NET 8880 (msg:"ET EXPLOIT IBM WebSphere - RCE Java Deserialization"; flow:to_server,established; content:"SOAPAction|3a| |22|urn:AdminService|22|"; content:"<objectname xsi|3a|type=|22|ns1|3a|javax.management.ObjectName|22|>"; content:"vcmcuYXBhY2hlLmNvbW1vbnMuY29sbGVjdGlvbn"; fast_pattern:only; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:cve,2015-7450; classtype:attempted-user; sid:1063348; rev:2; metadata:affected_product IBM_Websphere, attack_target Server, deployment Perimeter, signature_severity Major, created_at 2017_03_15, performance_impact Low, updated_at 2017_03_15; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT HP Smart Storage Administrator Remote Command Injection (attempted-user) - detector_id: 63349 original_sid: 2024063
alert tcp $EXTERNAL_NET any -> $HOME_NET 2381 (msg:"ET EXPLOIT HP Smart Storage Administrator Remote Command Injection"; flow:to_server,established; content:"echo -n|20|"; pcre:"/^\s*(?:f0VMR|9FTE|\/RUxG)/R"; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:cve,2016-8523; classtype:attempted-user; sid:1063349; rev:2; metadata:affected_product HP_Smart_Storage_Administrator, attack_target Server, deployment Datacenter, signature_severity Critical, created_at 2017_03_15, performance_impact Low, updated_at 2017_03_15; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT NETGEAR WNR2000v5 hidden_lang_avi Stack Overflow (CVE-2016-10174) (attempted-admin) - detector_id: 63473 original_sid: 2024121
alert http any any -> $HOME_NET any (msg:"ET EXPLOIT NETGEAR WNR2000v5 hidden_lang_avi Stack Overflow (CVE-2016-10174)"; flow:to_server,established; content:"/lang_check.html"; http_uri; content:"timestamp="; http_uri; content:"&hidden_lang_avi="; isdataat:36,relative; content:!"|00|"; within:36; content:!"|25|"; within:36; content:!"|26|"; within:36; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; classtype:attempted-admin; sid:1063473; rev:4; metadata:affected_product Netgear_Router, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2017_03_30, performance_impact Low, updated_at 2017_03_31; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT TP-Link Archer C2 and Archer C20i Remote Code Execution (attempted-recon) - detector_id: 63537 original_sid: 2024191
alert http any any -> $HOME_NET any (msg:"ET EXPLOIT TP-Link Archer C2 and Archer C20i Remote Code Execution"; flow:to_server,established; content:"POST"; http_method; content:"/cgi?"; http_uri; nocase; content:"/mainFrame.htm"; http_header; content:"IPPING"; nocase; http_client_body; content:"X_TP_ConnName=ewan_ipoe_s"; fast_pattern; http_client_body; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:url,github.com/reverse-shell/routersploit/blob/master/routersploit/modules/exploits/tplink/archer_c2_c20i_rce.py; classtype:attempted-recon; sid:1063537; rev:2; metadata:affected_product TPLINK, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2017_04_07, performance_impact Low, updated_at 2017_04_07; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Cisco Catalyst Remote Code Execution (CVE-2017-3881) (attempted-user) - detector_id: 63560 original_sid: 2024194
alert tcp any any -> $HOME_NET 23 (msg:"ET EXPLOIT Cisco Catalyst Remote Code Execution (CVE-2017-3881)"; flow:to_server,established; content:"|ff fa 24 00 03|CISCO_KITS"; content:"|3a|"; distance:2; within:1; isdataat:160,relative; content:!"|3a|"; within:160; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:url,artkond.com/2017/04/10/cisco-catalyst-remote-code-execution/; classtype:attempted-user; sid:1063560; rev:1; metadata:affected_product CISCO_Catalyst, attack_target IoT, deployment Datacenter, signature_severity Critical, created_at 2017_04_10, performance_impact Low, updated_at 2017_04_10; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Possible Successful ETERNALROMANCE MS17-010 - Windows Executable Observed (trojan-activity) - detector_id: 63576 original_sid: 2024207
alert smb any any -> $HOME_NET any (msg:"ET EXPLOIT Possible Successful ETERNALROMANCE MS17-010 - Windows Executable Observed"; flow:to_server,established; flowbits:isset,ETPRO.ETERNALROMANCE; content:"|FF|SMB|26 00 00 00 00|"; offset:4; depth:9; content:"|4d 5a|"; distance:0; content:"This program cannot be run"; nocase; distance:0; fast_pattern:6,20; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; classtype:trojan-activity; sid:1063576; rev:2; metadata:attack_target SMB_Server, deployment Internal, signature_severity Critical, created_at 2017_04_17, updated_at 2017_04_17; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Possible ETERNALROMANCE MS17-010 (trojan-activity) - detector_id: 63577 original_sid: 2024208
alert smb $HOME_NET any -> any any (msg:"ET EXPLOIT Possible ETERNALROMANCE MS17-010"; flow:from_server,established; content:"|FF|SMB|25 05 00 00 80|"; offset:4; depth:9; content:"LSbfLScnLSepLSlfLSmf"; distance:0; fast_pattern; content:"LSrfLSsrLSscLSblLSss"; within:20; content:"LSshLStrLStcLSopLScd"; within:20; flowbits:set,ETPRO.ETERNALROMANCE; metadata:former_category EXPLOIT, flip_endpoints True, server_side True; classtype:trojan-activity; sid:1063577; rev:1; metadata:attack_target SMB_Server, deployment Internal, signature_severity Critical, created_at 2017_04_17, updated_at 2017_04_17; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET EXPLOIT Possible ETERNALCHAMPION MS17-010 Sync Request (set) (trojan-activity) - detector_id: 63578 original_sid: 2024212
alert smb any any -> $HOME_NET any (msg:"ET EXPLOIT Possible ETERNALCHAMPION MS17-010 Sync Request (set)"; flow:to_server,established; content:"|ff|SMB|25 00 00 00 00 18 03 c0 00 00 00 00 00 00 00 00 00 00 00 00|"; offset:4; depth:24; content:"|00 00 00 00 ff ff ff ff 00 00|"; distance:17; within:10; content:"|5c 00 50 00 49 00 50 00 45 00 5c 00 4c 00 41 00 4e 00 4d 00 41 00 4e 00 00 00|"; distance:13; within:26; content:"|82 00|zb12g12DWrLehig24"; within:19; fast_pattern; flowbits:set,ET.ETERNALCHAMPIONsync; flowbits:noalert; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; classtype:trojan-activity; sid:1063578; rev:2; metadata:attack_target SMB_Server, deployment Internal, signature_severity Critical, created_at 2017_04_17, updated_at 2017_04_17; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Possible ETERNALCHAMPION MS17-010 Sync Response (trojan-activity) - detector_id: 63579 original_sid: 2024213
alert smb $HOME_NET any -> any any (msg:"ET EXPLOIT Possible ETERNALCHAMPION MS17-010 Sync Response"; flow:from_server,established; flowbits:isset,ET.ETERNALCHAMPIONsync; content:"|ff|SMB|25 00 00 00 00 98 03 c0 00 00 00 00 00 00 00 00 00 00 00 00|"; offset:4; depth:24; fast_pattern:4,20; content:"|7c 00|"; distance:32; within:2; content:"|00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00|"; within:20; content:"|00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00|"; distance:100; within:20; content:"|00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00|"; distance:100; within:20; content:"|00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00|"; distance:100; within:20; content:"|00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00|"; distance:0; isdataat:!1,relative; metadata:former_category EXPLOIT, flip_endpoints True, server_side True; classtype:trojan-activity; sid:1063579; rev:2; metadata:attack_target SMB_Server, deployment Internal, signature_severity Critical, created_at 2017_04_17, updated_at 2017_04_17; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET EXPLOIT Possible ECLIPSEDWING RPCTOUCH MS08-067 (trojan-activity) - detector_id: 63580 original_sid: 2024214
alert smb any any -> $HOME_NET any (msg:"ET EXPLOIT Possible ECLIPSEDWING RPCTOUCH MS08-067"; flow:to_server,established; content:"|ff|SMB|2f 00 00 00 00|"; offset:4; depth:9; content:"NTLMSSP|00 03 00 00 00 01 00 01 00|"; distance:0; fast_pattern; content:"|00 00 00 00 49 00 00 00|"; distance:4; within:8; content:"|00 00 00 00 48 00 00 00|"; within:8; content:"|00 00 00 00 48 00 00 00|"; within:8; content:"|00 00 00 00 48 00 00 00|"; within:8; content:"|00 00 00 00 49 00 00 00|"; within:8; content:"|00 00 00 00 00 00 00 00 00|"; distance:4; within:9; isdataat:!1,relative; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; classtype:trojan-activity; sid:1063580; rev:1; metadata:attack_target SMB_Server, deployment Internal, signature_severity Critical, created_at 2017_04_17, updated_at 2017_04_17; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Possible ECLIPSEDWING MS08-067 (trojan-activity) - detector_id: 63581 original_sid: 2024215
alert smb any any -> $HOME_NET any (msg:"ET EXPLOIT Possible ECLIPSEDWING MS08-067"; flow:to_server,established; content:"|ff|SMB|2f 00 00 00 00|"; offset:4; depth:9; content:"|00 00 00 00 ff ff ff ff 08 00|"; distance:30; within:10; content:"|2e 00 00 00 00 00 00 00 2e 00 00 00|"; distance:0; content:"|2f 00 41 00 2f 00 2e 00 2e 00 2f 00|"; within:12; fast_pattern; content:"|2e 00 00 00 00 00 00 00 2e 00 00 00|"; distance:0; content:"|2f 00 41 00 2f 00 2e 00 2e 00 2f 00|"; within:12; content:"|2f 00 41 00 2f 00 2e 00 2e 00 2f 00|"; distance:0; content:"|2f 00 41 00 2f 00 2e 00 2e 00 2f 00|"; distance:0; isdataat:800,relative; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; classtype:trojan-activity; sid:1063581; rev:1; metadata:attack_target SMB_Server, deployment Internal, signature_severity Critical, created_at 2017_04_17, updated_at 2017_04_17; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Possible DOUBLEPULSAR Beacon Response (trojan-activity) - detector_id: 63582 original_sid: 2024216
alert smb $HOME_NET any -> any any (msg:"ET EXPLOIT Possible DOUBLEPULSAR Beacon Response"; flow:from_server,established; content:"|00 00 00 23 ff|SMB2|02 00 00 c0 98 07 c0 00 00|"; depth:18; content:"|00 00 00 08 ff fe 00 08|"; distance:8; within:8; fast_pattern; pcre:"/^[\x50-\x59]/R"; content:"|00 00 00|"; distance:1; within:3; isdataat:!1,relative; metadata:former_category EXPLOIT, flip_endpoints True, server_side True; classtype:trojan-activity; sid:1063582; rev:1; metadata:attack_target SMB_Server, deployment Internal, signature_severity Critical, created_at 2017_04_17, updated_at 2017_04_17; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET EXPLOIT Possible ETERNALBLUE MS17-010 Heap Spray (trojan-activity) - detector_id: 63589 original_sid: 2024217
alert smb any any -> $HOME_NET any (msg:"ET EXPLOIT Possible ETERNALBLUE MS17-010 Heap Spray"; flow:to_server,established; content:"|ff|SMB|33 00 00 00 00 18 07 c0 00 00 00 00 00 00 00 00 00 00 00 00 00 08 ff fe 00 08|"; offset:4; depth:30; fast_pattern:10,20; content:"|00 09 00 00 00 10|"; distance:1; within:6; content:"|00 00 00 00 00 00 00 10|"; within:8; content:"|00 00 00 10|"; distance:4; within:4; pcre:"/^[a-zA-Z0-9+/]{1000,}/R"; threshold: type both, track by_src, count 3, seconds 30; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; classtype:trojan-activity; sid:1063589; rev:3; metadata:attack_target SMB_Server, deployment Internal, signature_severity Critical, created_at 2017_04_17, updated_at 2017_05_13; target:dest_ip;)

# ET EXPLOIT Possible ETERNALBLUE MS17-010 Echo Response (trojan-activity) - detector_id: 63590 original_sid: 2024218
alert smb $HOME_NET any -> any any (msg:"ET EXPLOIT Possible ETERNALBLUE MS17-010 Echo Response"; flow:from_server,established; content:"|00 00 00 31 ff|SMB|2b 00 00 00 00 98 07 c0|"; depth:16; fast_pattern; content:"|4a 6c 4a 6d 49 68 43 6c 42 73 72 00|"; distance:0; flowbits:isset,ET.ETERNALBLUE; metadata:former_category EXPLOIT, flip_endpoints True, server_side True; classtype:trojan-activity; sid:1063590; rev:2; metadata:attack_target SMB_Server, deployment Internal, signature_severity Critical, created_at 2017_04_17, updated_at 2017_11_27; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET EXPLOIT Possible ETERNALROMANCE MS17-010 Heap Spray (trojan-activity) - detector_id: 63591 original_sid: 2024219
alert smb any any -> $HOME_NET any (msg:"ET EXPLOIT Possible ETERNALROMANCE MS17-010 Heap Spray"; flow:to_server,established; content:"|ff|SMB|25 00 00 00 00 18|"; offset:4; depth:10; content:"|07 c0 00 00 00 00 00 00 00 00 00 00 00 00 00 08|"; fast_pattern; within:16; content:"|00 08|"; distance:2; within:2; content:"|0e 00 00 40 00|"; distance:2; within:5; content:"|00 00 00 00 00 00 01 00 00 00 00 00 00 00 00|"; distance:2; within:15; content:"|00 00 00 00 00 00 00 00 00|"; isdataat:!1,relative; threshold: type both, track by_src, count 20, seconds 1; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; classtype:trojan-activity; sid:1063591; rev:1; metadata:attack_target SMB_Server, deployment Internal, signature_severity Critical, created_at 2017_04_17, updated_at 2017_04_17; target:dest_ip;)

# ET EXPLOIT Possible ETERNALBLUE MS17-010 Echo Request (set) (trojan-activity) - detector_id: 63592 original_sid: 2024220
alert smb any any -> $HOME_NET any (msg:"ET EXPLOIT Possible ETERNALBLUE MS17-010 Echo Request (set)"; flow:to_server,established; content:"|00 00 00 31 ff|SMB|2b 00 00 00 00 18 07 c0|"; depth:16; fast_pattern; content:"|4a 6c 4a 6d 49 68 43 6c 42 73 72 00|"; distance:0; flowbits:set,ET.ETERNALBLUE; flowbits:noalert; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; classtype:trojan-activity; sid:1063592; rev:2; metadata:attack_target SMB_Server, deployment Internal, signature_severity Critical, created_at 2017_04_17, updated_at 2017_11_27; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Possible EXPLODINGCAN IIS5.0/6.0 Exploit Attempt (trojan-activity) - detector_id: 63593 original_sid: 2024222
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET EXPLOIT Possible EXPLODINGCAN IIS5.0/6.0 Exploit Attempt"; flow:to_server,established; urilen:1; content:"PROPFIND"; http_method; content:"Content-Length|3a 20|0|0d 0a|Host|3a 20|"; http_header; depth:25; content:"|0d 0a|If|3a 20|<http"; fast_pattern; http_header; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; classtype:trojan-activity; sid:1063593; rev:2; metadata:affected_product Web_Server_Applications, attack_target Web_Server, deployment Perimeter, signature_severity Critical, created_at 2017_04_18, updated_at 2017_04_18; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT BlueCoat CAS v1.3.7.1 Report Email Command Injection attempt (web-application-attack) - detector_id: 63607 original_sid: 2024234
alert http any any -> $HOME_NET 8082 (msg:"ET EXPLOIT BlueCoat CAS v1.3.7.1 Report Email Command Injection attempt"; flow:to_server,established; content:"POST"; nocase; http_method; content:"/report-email/send"; nocase; http_uri; content:"/dev-report-overview.html"; nocase; http_client_body; content:"|3B|"; http_client_body; distance:0; pcre:"/\/dev-report-overview\.html[^\"]*?\x3b/Pi"; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:cve,2016-9091; reference:url,www.exploit-db.com/exploits/41785/; reference:url,bto.bluecoat.com/security-advisory/sa138; classtype:web-application-attack; sid:1063607; rev:2; metadata:affected_product HTTP_Server, attack_target Web_Server, deployment Internal, signature_severity Major, created_at 2017_04_21, performance_impact Moderate, updated_at 2017_04_21; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Intel AMT Login Attempt Detected (CVE 2017-5689) (attempted-admin) - detector_id: 63668 original_sid: 2024287
alert http any any -> $HOME_NET [16992,16993,623,664] (msg:"ET EXPLOIT Intel AMT Login Attempt Detected (CVE 2017-5689)"; flow:to_server,established; content:"Authorization|3a 20|Digest"; http_header; content:"username=|22|"; http_header; content:"response="; http_header; fast_pattern; pcre:"/^\s*\x22{2}/HR"; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:url,mjg59.dreamwidth.org/48429.html; reference:url,www.tenable.com/blog/rediscovering-the-intel-amt-vulnerability; reference:cve,2017-5689; classtype:attempted-admin; sid:1063668; rev:2; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Internal, signature_severity Major, created_at 2017_05_10, performance_impact Moderate, updated_at 2017_05_10; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT NB8-01 - Unauthed RCE via bprd (web-application-attack) - detector_id: 63709 original_sid: 2024308
alert tcp any any -> $HOME_NET 1556 (msg:"ET EXPLOIT NB8-01 - Unauthed RCE via bprd"; flow:established,to_server; content:"ack="; depth:4; content:"extension=bprd"; distance:0; fast_pattern; pcre:"/^.*?[\x24\x60]/R"; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:url,seclists.org/fulldisclosure/2017/May/27; classtype:web-application-attack; sid:1063709; rev:1; metadata:attack_target Server, deployment Internal, signature_severity Major, created_at 2017_05_17, performance_impact Moderate, updated_at 2017_05_17; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT NB8-02 - Possible Unauthed RCE via nbbsdtar (web-application-attack) - detector_id: 63710 original_sid: 2024309
alert tcp any any -> $HOME_NET 1556 (msg:"ET EXPLOIT NB8-02 - Possible Unauthed RCE via nbbsdtar"; flow:established,to_server; content:"ack="; depth:4; content:"extension=bprd"; distance:0; fast_pattern; content:"/bin/"; distance:0; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:url,seclists.org/fulldisclosure/2017/May/27; classtype:web-application-attack; sid:1063710; rev:1; metadata:attack_target Server, deployment Internal, signature_severity Major, created_at 2017_05_17, performance_impact Moderate, updated_at 2017_05_17; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT NB8-04 - Possible Unauthed RCE via whitelist bypass (web-application-attack) - detector_id: 63711 original_sid: 2024310
alert tcp any any -> $HOME_NET 1556 (msg:"ET EXPLOIT NB8-04 - Possible Unauthed RCE via whitelist bypass"; flow:established,to_server; content:"ack="; depth:4; content:"extension=bprd"; distance:0; fast_pattern; content:"BPCD_WHITELIST_PATH"; distance:0; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:url,seclists.org/fulldisclosure/2017/May/27; classtype:web-application-attack; sid:1063711; rev:1; metadata:attack_target Server, deployment Internal, signature_severity Major, created_at 2017_05_17, performance_impact Moderate, updated_at 2017_05_17; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Samba Arbitrary Module Loading Vulnerability (.so file write to share) (CVE-2017-7494) (attempted-admin) - detector_id: 63751 original_sid: 2024335
alert tcp any any -> $HOME_NET 445 (msg:"ET EXPLOIT Samba Arbitrary Module Loading Vulnerability (.so file write to share) (CVE-2017-7494)"; flow:to_server,established; content:"SMB|2d 00|"; offset:5; depth:5; content:"|00 00|"; distance:1; within:2; content:"|12 00|"; distance:40; within:2; content:"|2e|so|00|"; fast_pattern; distance:16; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:cve,2017-7494; reference:url,github.com/rapid7/metasploit-framework/pull/8450; classtype:attempted-admin; sid:1063751; rev:1; metadata:attack_target SMB_Server, deployment Datacenter, signature_severity Critical, created_at 2017_05_25, performance_impact Low, updated_at 2017_05_25; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Samba Arbitrary Module Loading Vulnerability (NT Create AndX .so) (CVE-2017-7494) (attempted-admin) - detector_id: 63752 original_sid: 2024336
alert tcp any any -> $HOME_NET 445 (msg:"ET EXPLOIT Samba Arbitrary Module Loading Vulnerability (NT Create AndX .so) (CVE-2017-7494)"; flow:to_server,established; content:"SMB|a2 00|"; offset:5; depth:5; content:"|00 00|"; distance:1; within:2; content:"|2e|so|00|"; fast_pattern; distance:16; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:cve,2017-7494; reference:url,github.com/rapid7/metasploit-framework/pull/8450; classtype:attempted-admin; sid:1063752; rev:1; metadata:attack_target SMB_Server, deployment Datacenter, signature_severity Critical, created_at 2017_05_25, performance_impact Low, updated_at 2017_05_25; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Samba Arbitrary Module Loading Vulnerability M2 (NT Create AndX .so) (CVE-2017-7494) (attempted-admin) - detector_id: 63812 original_sid: 2024384
alert tcp any any -> $HOME_NET 445 (msg:"ET EXPLOIT Samba Arbitrary Module Loading Vulnerability M2 (NT Create AndX .so) (CVE-2017-7494)"; flow:to_server,established; content:"SMB"; offset:5; depth:3; content:"|05 00|"; distance:8; within:2; content:"|00 2e 00 73 00 6f 00|"; distance:0; fast_pattern; isdataat:!1,relative; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:cve,2017-7494; classtype:attempted-admin; sid:1063812; rev:1; metadata:affected_product Linux, attack_target Server, deployment Perimeter, deployment Internal, signature_severity Major, created_at 2017_06_16, performance_impact Moderate, updated_at 2017_06_16; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT HP Printer Attempted Path Traversal via PJL (attempted-admin) - detector_id: 63813 original_sid: 2024404
alert tcp any any -> $HOME_NET 9100 (msg:"ET EXPLOIT HP Printer Attempted Path Traversal via PJL"; flow:to_server,established; content:"@PJL FS"; depth:7; content:"NAME="; distance:0; pcre:"/^\s*[\x22\x27][^\x22\x27]{0,128}\x2e\x2e/Ri"; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:url,www.tenable.com/blog/rooting-a-printer-from-security-bulletin-to-remote-code-execution; reference:cve,2017-2741; classtype:attempted-admin; sid:1063813; rev:2; metadata:attack_target IoT, deployment Internal, signature_severity Major, created_at 2017_06_16, performance_impact Moderate, updated_at 2017_06_20; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Possible SharePoint XSS (CVE-2017-8514) Inbound (attempted-user) - detector_id: 63836 original_sid: 2024412
alert http any any -> $HOME_NET any (msg:"ET EXPLOIT Possible SharePoint XSS (CVE-2017-8514) Inbound"; flow:to_server,established; content:"FollowSite="; http_uri; nocase; fast_pattern; content:"SiteName="; http_uri; nocase; content:"-confirm"; http_uri; nocase; distance:0; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:url,respectxss.blogspot.fr/2017/06/a-look-at-cve-2017-8514-sharepoints.html; classtype:attempted-user; sid:1063836; rev:2; metadata:affected_product HTTP_Server, attack_target Server, deployment Internal, signature_severity Major, created_at 2017_06_19, performance_impact Moderate, updated_at 2017_06_19; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Possible ETERNALBLUE Exploit M3 MS17-010 (trojan-activity) - detector_id: 63861 original_sid: 2024430
alert smb any any -> $HOME_NET any (msg:"ET EXPLOIT Possible ETERNALBLUE Exploit M3 MS17-010"; flow:to_server,established; content:"|ff|SMB|32 00 00 00 00 18 07 c0|"; offset:4; depth:12; content:"|00 00 00 00 00 00 00 00 00 00 00 08 ff fe 00 08|"; distance:2; within:16; fast_pattern; content:"|0f 0c 00 00 10 01 00 00 00 00 00 00 00 f2 00 00 00 00 00 0c 00 42 00 00 10 4e 00 01 00 0e 00 0d 10 00|"; distance:2; within:34; isdataat:1000,relative; threshold: type both, track by_src, count 10, seconds 1; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; classtype:trojan-activity; sid:1063861; rev:3; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, deployment Internal, signature_severity Critical, created_at 2017_06_27, updated_at 2017_07_06; target:dest_ip;)

# ET EXPLOIT Ubiquiti Networks UniFi Cloud Key Firm v0.6.1 Host Remote Command Execution attempt (web-application-attack) - detector_id: 64087 original_sid: 2024548
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET EXPLOIT Ubiquiti Networks UniFi Cloud Key Firm v0.6.1 Host Remote Command Execution attempt"; flow:to_server,established; content:"GET"; nocase; http_method; urilen:7; content:"/status"; http_uri; fast_pattern; content:"Host|3a|"; nocase; http_header; content:"|3b|"; http_header; within:50; distance:0; pcre:"/^Host\x3a[^\n]{0,50}?\x3b/Hmi"; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:url,cxsecurity.com/issue/WLB-2017080038; classtype:web-application-attack; sid:1064087; rev:2; metadata:affected_product Linux, attack_target IoT, deployment Perimeter, signature_severity Major, created_at 2017_08_14, performance_impact Moderate, updated_at 2017_08_14; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Apache Struts 2 REST Plugin ysoserial Usage (B64) 1 (attempted-user) - detector_id: 64264 original_sid: 2024668
alert http any any -> $HOME_NET any (msg:"ET EXPLOIT Apache Struts 2 REST Plugin ysoserial Usage (B64) 1"; flow:to_server,established; content:"POST"; http_method; content:"eXNvc2VyaWFsL"; http_client_body; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:cve,2017-9805; reference:url,lgtm.com/blog/apache_struts_CVE-2017-9805_announcement; classtype:attempted-user; sid:1064264; rev:2; metadata:affected_product Apache_Struts2, attack_target Web_Server, deployment Datacenter, signature_severity Critical, created_at 2017_09_07, updated_at 2017_09_07; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Apache Struts 2 REST Plugin ysoserial Usage (B64) 2 (attempted-user) - detector_id: 64266 original_sid: 2024669
alert http any any -> $HOME_NET any (msg:"ET EXPLOIT Apache Struts 2 REST Plugin ysoserial Usage (B64) 2"; flow:to_server,established; content:"POST"; http_method; content:"lzb3NlcmlhbC"; http_client_body; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:cve,2017-9805; reference:url,lgtm.com/blog/apache_struts_CVE-2017-9805_announcement; classtype:attempted-user; sid:1064266; rev:2; metadata:affected_product Apache_Struts2, attack_target Web_Server, deployment Datacenter, signature_severity Critical, created_at 2017_09_07, updated_at 2017_09_07; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Apache Struts 2 REST Plugin ysoserial Usage (B64) 3 (attempted-user) - detector_id: 64267 original_sid: 2024670
alert http any any -> $HOME_NET any (msg:"ET EXPLOIT Apache Struts 2 REST Plugin ysoserial Usage (B64) 3"; flow:to_server,established; content:"POST"; http_method; content:"5c29zZXJpYWwv"; http_client_body; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:cve,2017-9805; reference:url,lgtm.com/blog/apache_struts_CVE-2017-9805_announcement; classtype:attempted-user; sid:1064267; rev:2; metadata:affected_product Apache_Struts2, attack_target Web_Server, deployment Datacenter, signature_severity Critical, created_at 2017_09_07, updated_at 2017_09_07; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Apache Struts 2 REST Plugin (B64) 4 (attempted-user) - detector_id: 64268 original_sid: 2024671
alert http any any -> $HOME_NET any (msg:"ET EXPLOIT Apache Struts 2 REST Plugin (B64) 4"; flow:to_server,established; content:"POST"; http_method; content:"|79 76 36 36 76|"; http_client_body; content:"/struts2-rest-showcase/orders/3"; http_uri; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:cve,2017-9805; reference:url,lgtm.com/blog/apache_struts_CVE-2017-9805_announcement; classtype:attempted-user; sid:1064268; rev:2; metadata:affected_product Apache_Struts2, attack_target Web_Server, deployment Datacenter, signature_severity Critical, created_at 2017_09_07, updated_at 2017_09_07; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Apache Struts 2 REST Plugin (B64) 5 (attempted-user) - detector_id: 64269 original_sid: 2024672
alert http any any -> $HOME_NET any (msg:"ET EXPLOIT Apache Struts 2 REST Plugin (B64) 5"; flow:to_server,established; content:"POST"; http_method; content:"|72 2b 75 72|"; http_client_body; content:"/struts2-rest-showcase/orders/3"; http_uri; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:cve,2017-9805; reference:url,lgtm.com/blog/apache_struts_CVE-2017-9805_announcement; classtype:attempted-user; sid:1064269; rev:2; metadata:affected_product Apache_Struts2, attack_target Web_Server, deployment Datacenter, signature_severity Critical, created_at 2017_09_07, updated_at 2017_09_07; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Apache Struts 2 REST Plugin (B64) 6 (attempted-user) - detector_id: 64270 original_sid: 2024673
alert http any any -> $HOME_NET any (msg:"ET EXPLOIT Apache Struts 2 REST Plugin (B64) 6"; flow:to_server,established; content:"POST"; http_method; content:"|4b 2f 72 71 2b|"; http_client_body; content:"/struts2-rest-showcase/orders/3"; http_uri; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:cve,2017-9805; reference:url,lgtm.com/blog/apache_struts_CVE-2017-9805_announcement; classtype:attempted-user; sid:1064270; rev:2; metadata:affected_product Apache_Struts2, attack_target Web_Server, deployment Datacenter, signature_severity Critical, created_at 2017_09_07, updated_at 2017_09_07; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Apache Struts 2 REST Plugin (Runtime.Exec) (attempted-user) - detector_id: 64271 original_sid: 2024674
alert http any any -> $HOME_NET any (msg:"ET EXPLOIT Apache Struts 2 REST Plugin (Runtime.Exec)"; flow:to_server,established; content:"POST"; http_method; content:"java.lang.Runtime"; nocase; http_client_body; fast_pattern; content:"/struts2-rest-showcase/orders/3"; http_uri; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:cve,2017-9805; reference:url,lgtm.com/blog/apache_struts_CVE-2017-9805_announcement; classtype:attempted-user; sid:1064271; rev:2; metadata:affected_product Apache_Struts2, attack_target Web_Server, deployment Datacenter, signature_severity Critical, created_at 2017_09_07, updated_at 2017_09_07; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Apache Struts 2 REST Plugin (ProcessBuilder) (attempted-user) - detector_id: 64272 original_sid: 2024675
alert http any any -> $HOME_NET any (msg:"ET EXPLOIT Apache Struts 2 REST Plugin (ProcessBuilder)"; flow:to_server,established; content:"POST"; http_method; content:"java.lang.ProcessBuilder"; nocase; http_client_body; fast_pattern; content:"/struts2-rest-showcase/orders/3"; http_uri; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:cve,2017-9805; reference:url,lgtm.com/blog/apache_struts_CVE-2017-9805_announcement; classtype:attempted-user; sid:1064272; rev:2; metadata:affected_product Apache_Struts2, attack_target Web_Server, deployment Datacenter, signature_severity Critical, created_at 2017_09_07, updated_at 2017_09_07; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Likely Struts S2-053-CVE-2017-12611 Exploit Attempt M1 (attempted-admin) - detector_id: 64405 original_sid: 2024814
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET EXPLOIT Likely Struts S2-053-CVE-2017-12611 Exploit Attempt M1"; flow:established,to_server; content:"="; http_uri; content:"%"; http_uri; distance:0; content:"{"; http_uri; distance:0; content:"ProcessBuilder"; http_uri; nocase; distance:0; fast_pattern; content:"java"; nocase; http_uri; content:"lang"; http_uri; nocase; pcre:"/=\s*\x25\s*\{\s*.+?\bProcessBuilder\b/Ui"; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; classtype:attempted-admin; sid:1064405; rev:2; metadata:affected_product Apache_Struts2, attack_target Web_Server, deployment Datacenter, signature_severity Major, created_at 2017_10_06, updated_at 2017_10_06; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Likely Struts S2-053-CVE-2017-12611 Exploit Attempt M2 (attempted-admin) - detector_id: 64406 original_sid: 2024815
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"ET EXPLOIT Likely Struts S2-053-CVE-2017-12611 Exploit Attempt M2"; flow:established,to_server; content:"="; http_uri; content:"%"; http_uri; distance:0; content:"{"; http_uri; distance:0; content:"getRunTime"; http_uri; nocase; distance:0; fast_pattern; content:"exec"; nocase; http_uri; pcre:"/=\s*\x25\s*\{\s*(?=.+?\bgetRunTime\b).+?\bexec\b/Ui"; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; classtype:attempted-admin; sid:1064406; rev:1; metadata:affected_product Apache_Struts2, attack_target Web_Server, deployment Datacenter, signature_severity Major, created_at 2017_10_06, updated_at 2017_10_06; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Possible CVE-2017-12629 RCE Exploit Attempt (HTTP POST) (web-application-attack) - detector_id: 64515 original_sid: 2024884
alert http any any -> $HTTP_SERVERS any (msg:"ET EXPLOIT Possible CVE-2017-12629 RCE Exploit Attempt (HTTP POST)"; flow:to_server,established; content:"POST"; http_method; content:"newcollection/config"; http_uri; content:"Content-Type|3a 20|application/json"; http_header; content:"|22|add-listener|22|"; http_client_body; content:"|22|event|22 3a 22|postCommit|22|"; http_client_body; content:"|22|class|22|"; http_client_body; content:"RunExecutableListener|22 2c|"; fast_pattern; http_client_body; content:"|22|exe|22|"; http_client_body; content:"|22|dir|22|"; http_client_body; content:"|22|args|22|"; http_client_body; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:url,www.exploit-db.com/exploits/43009/; classtype:web-application-attack; sid:1064515; rev:2; metadata:affected_product Apache_Solr, attack_target Web_Server, deployment Datacenter, signature_severity Major, created_at 2017_10_20, updated_at 2017_10_20; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Possible CVE-2017-12629 XXE Exploit Attempt (URI) (web-application-attack) - detector_id: 64516 original_sid: 2024885
alert http any any -> $HTTP_SERVERS any (msg:"ET EXPLOIT Possible CVE-2017-12629 XXE Exploit Attempt (URI)"; flow:to_server,established; content:"?q=|7b 21|xmlparser"; http_uri; content:"|3d 27 3c 21|DOCTYPE"; nocase; distance:0; http_uri; fast_pattern; pcre:"/^(?:(?!\x0d\x0a).)+\x22(?:https?|file):\x2f\x2f/UR"; flowbits:set,ET.CVE-2017-12629; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:url,www.exploit-db.com/exploits/43009/; classtype:web-application-attack; sid:1064516; rev:2; metadata:affected_product Apache_Solr, attack_target Web_Server, deployment Datacenter, signature_severity Major, created_at 2017_10_20, updated_at 2017_10_20; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Possible CVE-2017-12629 RCE Exploit Attempt (HTTP GET 1) (web-application-attack) - detector_id: 64517 original_sid: 2024886
alert http any any -> $HTTP_SERVERS any (msg:"ET EXPLOIT Possible CVE-2017-12629 RCE Exploit Attempt (HTTP GET 1)"; flow:to_server,established; content:"GET"; http_method; content:"newcollection/config"; http_uri; content:"|22|add-listener|22 3a|"; http_uri; distance:0; content:"|22|event|22 3a 22|postCommit|22|"; http_uri; distance:0; content:"|22|class|22|"; distance:0; http_uri; content:"RunExecutableListener|22 2c 22|exe|22|"; distance:0; fast_pattern; http_uri; content:"|22|dir|22|"; http_uri; content:"|22|args|22|"; http_uri; flowbits:isset,ET.CVE-2017-12629; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:url,www.exploit-db.com/exploits/43009/; classtype:web-application-attack; sid:1064517; rev:2; metadata:affected_product Apache_Solr, attack_target Web_Server, deployment Datacenter, signature_severity Major, created_at 2017_10_20, updated_at 2017_10_20; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Possible CVE-2017-12629 RCE Exploit Attempt (HTTP GET 2) (web-application-attack) - detector_id: 64518 original_sid: 2024887
alert http any any -> $HTTP_SERVERS any (msg:"ET EXPLOIT Possible CVE-2017-12629 RCE Exploit Attempt (HTTP GET 2)"; flow:to_server,established; content:"GET"; http_method; content:"?q="; http_uri; content:"update?"; distance:0; http_uri; content:"stream.body="; http_uri; content:"commit="; http_uri; content:"overwrite="; http_uri; flowbits:isset,ET.CVE-2017-12629; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:url,www.exploit-db.com/exploits/43009/; classtype:web-application-attack; sid:1064518; rev:2; metadata:affected_product Apache_Solr, attack_target Web_Server, deployment Datacenter, signature_severity Major, created_at 2017_10_20, updated_at 2017_10_20; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT D-Link 850L Password Extract Attempt (attempted-recon) - detector_id: 64553 original_sid: 2024913
alert http any any -> $HOME_NET any (msg:"ET EXPLOIT D-Link 850L Password Extract Attempt"; flow:to_server,established; urilen:11; content:"POST"; http_method; content:"/hedwig.cgi"; http_uri; fast_pattern; content:"DEVICE.ACCOUNT"; http_client_body; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:url,blogs.securiteam.com/index.php/archives/3364; classtype:attempted-recon; sid:1064553; rev:2; metadata:attack_target IoT, deployment Perimeter, signature_severity Minor, created_at 2017_10_25, updated_at 2017_10_25; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Netgear ReadyNAS Surveillance Unauthenticated Remote Command Execution (attempted-recon) - detector_id: 64554 original_sid: 2024914
alert http any any -> $HOME_NET any (msg:"ET EXPLOIT Netgear ReadyNAS Surveillance Unauthenticated Remote Command Execution"; flow:to_server,established; content:"/upgrade_handle.php?cmd=writeuploaddir&uploaddir=|25|27"; depth:52; http_uri; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:url,blogs.securiteam.com/index.php/archives/3409; reference:cve,CVE-2017-18377; classtype:attempted-recon; sid:1064554; rev:2; metadata:attack_target IoT, deployment Perimeter, signature_severity Major, created_at 2017_10_25, updated_at 2017_10_25; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Possible Vacron NVR Remote Command Execution (attempted-recon) - detector_id: 64555 original_sid: 2024915
alert http any any -> $HOME_NET any (msg:"ET EXPLOIT Possible Vacron NVR Remote Command Execution"; flow:to_server,established; content:"/board.cgi?cmd="; depth:15; http_uri; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:url,blogs.securiteam.com/index.php/archives/3445; classtype:attempted-recon; sid:1064555; rev:2; metadata:attack_target IoT, deployment Perimeter, signature_severity Major, created_at 2017_10_25, updated_at 2017_10_25; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Netgear DGN Remote Command Execution (attempted-recon) - detector_id: 64556 original_sid: 2024916
alert http any any -> $HOME_NET any (msg:"ET EXPLOIT Netgear DGN Remote Command Execution"; flow:to_server,established; content:"/setup.cgi?next_file="; nocase; http_uri; content:"&todo=syscmd&cmd="; nocase; distance:0; http_uri; content:"currentsetting.htm"; nocase; fast_pattern; http_uri; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:url,seclists.org/bugtraq/2013/Jun/8; classtype:attempted-recon; sid:1064556; rev:1; metadata:attack_target IoT, deployment Perimeter, signature_severity Major, created_at 2017_10_25, updated_at 2017_10_25; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT AVTECH Unauthenticated Command Injection in DVR Devices (attempted-recon) - detector_id: 64557 original_sid: 2024917
alert http any any -> $HOME_NET any (msg:"ET EXPLOIT AVTECH Unauthenticated Command Injection in DVR Devices"; flow:to_server,established; content:"/Search.cgi?action=cgi_query"; nocase; fast_pattern; http_uri; content:"&username="; nocase; distance:0; http_uri; content:"&password="; nocase; distance:0; http_uri; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:url,github.com/Trietptm-on-Security/AVTECH; classtype:attempted-recon; sid:1064557; rev:1; metadata:attack_target IoT, deployment Perimeter, signature_severity Major, created_at 2017_10_25, updated_at 2017_10_25; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT AVTECH Authenticated Command Injection in CloudSetup.cgi (attempted-recon) - detector_id: 64558 original_sid: 2024918
alert http any any -> $HOME_NET any (msg:"ET EXPLOIT AVTECH Authenticated Command Injection in CloudSetup.cgi"; flow:to_server,established; content:"/cgi-bin/supervisor/CloudSetup.cgi?exefile="; nocase; depth:43; fast_pattern; http_uri; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:url,github.com/Trietptm-on-Security/AVTECH; classtype:attempted-recon; sid:1064558; rev:1; metadata:attack_target IoT, deployment Perimeter, signature_severity Major, created_at 2017_10_25, updated_at 2017_10_25; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT AVTECH Authenticated Command Injection in adcommand.cgi (attempted-recon) - detector_id: 64559 original_sid: 2024919
alert http any any -> $HOME_NET any (msg:"ET EXPLOIT AVTECH Authenticated Command Injection in adcommand.cgi"; urilen:33; flow:to_server,established; content:"POST"; http_method; content:"/cgi-bin/supervisor/adcommand.cgi"; nocase; fast_pattern; http_uri; content:"DoShellCmd"; nocase; http_client_body; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:url,github.com/Trietptm-on-Security/AVTECH; classtype:attempted-recon; sid:1064559; rev:1; metadata:attack_target IoT, deployment Perimeter, signature_severity Major, created_at 2017_10_25, updated_at 2017_10_25; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT AVTECH Authenticated Command Injection in PwdGrp.cgi (attempted-recon) - detector_id: 64560 original_sid: 2024920
alert http any any -> $HOME_NET any (msg:"ET EXPLOIT AVTECH Authenticated Command Injection in PwdGrp.cgi"; flow:to_server,established; content:"/cgi-bin/supervisor/PwdGrp.cgi?action="; nocase; depth:38; fast_pattern; http_uri; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:url,github.com/Trietptm-on-Security/AVTECH; classtype:attempted-recon; sid:1064560; rev:1; metadata:attack_target IoT, deployment Perimeter, signature_severity Major, created_at 2017_10_25, updated_at 2017_10_25; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Possible Oracle Identity Manager Attempt to Logon with default account (attempted-admin) - detector_id: 64657 original_sid: 2024941
alert http any any -> $HTTP_SERVERS any (msg:"ET EXPLOIT Possible Oracle Identity Manager Attempt to Logon with default account"; flow:to_server,established; content:"=OIMINTERNAL"; fast_pattern:only; http_client_body; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:cve,CVE-2017-10151; reference:url,oracle.com/technetwork/security-advisory/alert-cve-2017-10151-4016513.html; classtype:attempted-admin; sid:1064657; rev:2; metadata:affected_product Oracle_Identity_Manager, attack_target Web_Server, deployment Datacenter, signature_severity Critical, created_at 2017_11_01, performance_impact Low, updated_at 2017_11_01; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Actiontec C1000A backdoor account M2 (attempted-admin) - detector_id: 64658 original_sid: 2024980
alert tcp any any -> $HOME_NET [23,2323] (msg:"ET EXPLOIT Actiontec C1000A backdoor account M2"; flow:established,to_server; content:"CenturyL1nk"; fast_pattern; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; classtype:attempted-admin; sid:1064658; rev:3; metadata:affected_product Linux, attack_target IoT, deployment Perimeter, signature_severity Critical, created_at 2017_11_13, malware_family Mirai, performance_impact Low, updated_at 2017_11_29; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Exim4 UAF Attempt (BDAT with non-printable chars) (attempted-admin) - detector_id: 64662 original_sid: 2025063
alert smtp any any -> $SMTP_SERVERS any (msg:"ET EXPLOIT Exim4 UAF Attempt (BDAT with non-printable chars)"; flow:established,to_server; content:"BDAT"; depth:5; pcre:"/^\s*\d*[^\x20-\x7e\r\n\t]/R"; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:url,lists.exim.org/lurker/message/20171125.034842.d1d75cac.en.html; classtype:attempted-admin; sid:1064662; rev:3; metadata:attack_target SMTP_Server, deployment Internal, deployment Datacenter, signature_severity Major, created_at 2017_11_27, performance_impact Moderate, updated_at 2017_11_28; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Actiontec C1000A backdoor account M1 (attempted-admin) - detector_id: 64705 original_sid: 2025080
alert tcp any any -> $HOME_NET [23,2323] (msg:"ET EXPLOIT Actiontec C1000A backdoor account M1"; flow:established,to_server; content:"QwestM0dem"; fast_pattern; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; metadata:former_category EXPLOIT; classtype:attempted-admin; sid:1064705; rev:2; metadata:affected_product Linux, attack_target IoT, deployment Perimeter, signature_severity Major, created_at 2017_11_28, malware_family Mirai, performance_impact Low, updated_at 2017_11_29; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Realtek SDK Miniigd UPnP SOAP Command Execution CVE-2014-8361 (attempted-user) - detector_id: 64742 original_sid: 2025132
alert http any any -> $HOME_NET 52869 (msg:"ET EXPLOIT Realtek SDK Miniigd UPnP SOAP Command Execution CVE-2014-8361"; flow:established,to_server; urilen:12; content:"POST"; http_method; content:"/picdesc.xml"; http_uri; content:"SOAPAction|3a 20|urn|3a|schemas-upnp-org|3a|service|3a|WANIPConnection|3a|"; http_header; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:url,blog.netlab.360.com/warning-satori-a-new-mirai-variant-is-spreading-in-worm-style-on-port-37215-and-52869-en/; reference:cve,CVE-2014-8361; reference:url,github.com/rapid7/metasploit-framework/blob/master/modules/exploits/linux/http/realtek_miniigd_upnp_exec_noauth.rb; reference:url,www.exploit-db.com/exploits/37169/; classtype:attempted-user; sid:1064742; rev:2; metadata:attack_target IoT, created_at 2017_12_05, updated_at 2017_12_05; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Generic ADSL Router DNS Change Request (attempted-user) - detector_id: 64911 original_sid: 2025222
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET EXPLOIT Generic ADSL Router DNS Change Request"; flow:to_server,established; content:"dnsPrimary="; http_uri; fast_pattern:only; content:"dnsSecondary="; http_uri; content:"Enable_DNSFollowing=1"; http_uri; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; classtype:attempted-user; sid:1064911; rev:2; metadata:affected_product D_Link_DSL_2640R, attack_target IoT, deployment Perimeter, signature_severity Major, created_at 2018_01_19, performance_impact Low, updated_at 2018_01_19; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Possible Belkin N600DB Wireless Router Request Forgery Attempt (attempted-user) - detector_id: 64912 original_sid: 2025223
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET EXPLOIT Possible Belkin N600DB Wireless Router Request Forgery Attempt"; flow:to_server,established; content:"/proxy.cgi?chk&url="; http_uri; fast_pattern:only; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; classtype:attempted-user; sid:1064912; rev:1; metadata:attack_target IoT, deployment Perimeter, signature_severity Major, created_at 2018_01_19, performance_impact Low, updated_at 2018_01_19; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT MikroTik RouterOS Chimay Red Remote Code Execution Probe (attempted-admin) - detector_id: 65325 original_sid: 2025426
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET EXPLOIT MikroTik RouterOS Chimay Red Remote Code Execution Probe"; flow:to_server,established; content:"POST"; http_method; urilen:8; content:"/jsproxy"; http_uri; fast_pattern; content:"Content-Length|3a 20|"; http_header; depth:16; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:url,www.exploit-db.com/exploits/44284/; reference:url,www.exploit-db.com/exploits/44283/; classtype:attempted-admin; sid:1065325; rev:2; metadata:attack_target Networking_Equipment, deployment Perimeter, signature_severity Minor, created_at 2018_03_13, performance_impact Moderate, updated_at 2018_03_13; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT [PT Security] Exim <4.90.1 Base64 Overflow RCE (CVE-2018-6789) (attempted-admin) - detector_id: 65326 original_sid: 2025427
alert tcp any any -> $HOME_NET 25 (msg:"ET EXPLOIT [PT Security] Exim <4.90.1 Base64 Overflow RCE (CVE-2018-6789)"; flow:established,to_server,only_stream; content:"|0D 0A|AUTH"; pcre:"/AUTH\s+\S+\s+(?:[a-zA-Z0-9\+\/=]{4})*+[a-zA-Z0-9\+\/=]{3}\s/"; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:cve,2018-6789; reference:url,devco.re/blog/2018/03/06/exim-off-by-one-RCE-exploiting-CVE-2018-6789-en/; reference:url,github.com/ptresearch/AttackDetection/blob/master/CVE-2018-6789/cve-2018-6789.rules; classtype:attempted-admin; sid:1065326; rev:1; metadata:attack_target SMTP_Server, deployment Perimeter, signature_severity Minor, created_at 2018_03_13, performance_impact Moderate, updated_at 2018_03_13; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Apache CouchDB JSON Remote Privesc Attempt (CVE-2017-12636) (attempted-admin) - detector_id: 65327 original_sid: 2025432
alert http any any -> $HOME_NET 5984 (msg:"ET EXPLOIT Apache CouchDB JSON Remote Privesc Attempt (CVE-2017-12636)"; flow:established,to_server,only_stream; content:"PUT"; http_method; content:"/_config/query_servers/cmd"; urilen:26; pcre:"/^\s*[\x22\x27]/P"; content:"Authorization|3a 20|Basic"; http_header; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:cve,2017-12636; reference:url,blog.trendmicro.com/trendlabs-security-intelligence/vulnerabilities-apache-couchdb-open-door-monero-miners/; classtype:attempted-admin; sid:1065327; rev:2; metadata:deployment Datacenter, signature_severity Major, created_at 2018_03_13, performance_impact Moderate, updated_at 2018_03_13; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Apache CouchDB JSON Remote Privesc Attempt (CVE-2017-12635) (attempted-admin) - detector_id: 65340 original_sid: 2025435
alert http any any -> $HOME_NET 5984 (msg:"ET EXPLOIT Apache CouchDB JSON Remote Privesc Attempt (CVE-2017-12635)"; flow:established,to_server,only_stream; content:"PUT"; http_method; content:"/_users/"; content:"_admin"; http_client_body; fast_pattern; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:cve,2017-12635; reference:url,blog.trendmicro.com/trendlabs-security-intelligence/vulnerabilities-apache-couchdb-open-door-monero-miners/; classtype:attempted-admin; sid:1065340; rev:2; metadata:attack_target Server, deployment Datacenter, signature_severity Major, created_at 2018_03_19, malware_family CoinMiner, updated_at 2018_03_19; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Possible CVE-2018-0171 Exploit (PoC based) (attempted-admin) - detector_id: 65414 original_sid: 2025472
alert tcp any any -> $HOME_NET 4786 (msg:"ET EXPLOIT Possible CVE-2018-0171 Exploit (PoC based)"; flow:established,to_server; content:"|00 00 00 01 00 00 00 01 00 00 00 07|"; depth:12; content:"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"; distance:12; within:36; content:"BBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBB"; distance:4; within:44; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:cve,2018-0171; reference:url,embedi.com/blog/cisco-smart-install-remote-code-execution/; classtype:attempted-admin; sid:1065414; rev:1; metadata:affected_product Cisco_ASA, attack_target Networking_Equipment, deployment Perimeter, signature_severity Major, created_at 2018_04_06, updated_at 2018_04_06; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT HackingTrio UA (Hello, World) (attempted-admin) - detector_id: 65605 original_sid: 2025576
alert http any any -> $HOME_NET any (msg:"ET EXPLOIT HackingTrio UA (Hello, World)"; flow:established,to_server; content:"POST"; http_method; content:"Hello, World"; http_user_agent; fast_pattern; isdataat:!1,relative; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:cve,2018-10561; reference:cve,2018-10562; reference:url,github.com/f3d0x0/GPON; classtype:attempted-admin; sid:1065605; rev:2; metadata:attack_target IoT, deployment Perimeter, tag GPON, signature_severity Major, created_at 2018_05_11, performance_impact Low, updated_at 2018_05_15; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Possible ETERNALBLUE Probe MS17-010 (MSF style) (trojan-activity) - detector_id: 65768 original_sid: 2025649
alert smb any any -> $HOME_NET any (msg:"ET EXPLOIT Possible ETERNALBLUE Probe MS17-010 (MSF style)"; flow:to_server,established; content:"|ff|SMB|25 00 00 00 00 18 01 28|"; offset:4; depth:12; content:"|00 00 00 00 00 00 00 00 00 00|"; distance:2; within:10; content:"|23 00 00 00 07 00 5c 50 49 50 45 5c 00|"; fast_pattern; isdataat:!1,relative; threshold: type limit, track by_src, count 1, seconds 30; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:url,github.com/rapid7/metasploit-framework/blob/master/modules/auxiliary/scanner/smb/smb_ms17_010.rb; classtype:trojan-activity; sid:1065768; rev:2; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Internal, tag Metasploit, tag ETERNALBLUE, signature_severity Major, created_at 2018_07_11, updated_at 2018_08_15; target:dest_ip;)

# ET EXPLOIT ETERNALBLUE Probe Vulnerable System Response MS17-010 (trojan-activity) - detector_id: 65769 original_sid: 2025650
alert smb $HOME_NET any -> any any (msg:"ET EXPLOIT ETERNALBLUE Probe Vulnerable System Response MS17-010"; flow:from_server,established; content:"|ff|SMB|25 05 02 00 c0 98 01|"; offset:4; depth:11; content:"|00 00 00 00 00 00 00 00 00 00|"; distance:3; within:10; content:"|00 00 00|"; distance:8; within:3; isdataat:!1,relative; threshold: type limit, track by_src, count 1, seconds 30; metadata:former_category EXPLOIT, flip_endpoints True, server_side True; reference:url,github.com/rapid7/metasploit-framework/blob/master/modules/auxiliary/scanner/smb/smb_ms17_010.rb; classtype:trojan-activity; sid:1065769; rev:2; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Internal, tag Metasploit, tag ETERNALBLUE, signature_severity Major, created_at 2018_07_11, updated_at 2018_08_15; target:src_ip;)

# ET EXPLOIT phpLDAPadmin LDAP Injection (web-application-attack) - detector_id: 65881 original_sid: 2025733
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET EXPLOIT phpLDAPadmin LDAP Injection"; flow:to_server,established; content:"!(()&&!|7c|*|7c|*|7c|"; nocase; http_uri; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; classtype:web-application-attack; sid:1065881; rev:2; metadata:affected_product PHP, attack_target Web_Server, deployment Datacenter, signature_severity Major, created_at 2018_06_22, performance_impact Low, updated_at 2018_07_18; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT phpMyAdmin 4.8.1 - Local File Inclusion (web-application-attack) - detector_id: 65882 original_sid: 2025734
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET EXPLOIT phpMyAdmin 4.8.1 - Local File Inclusion"; flow:to_server,established; content:"db_sql.php"; http_uri; nocase; content:"|2e 2e 2f|"; http_raw_uri; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; classtype:web-application-attack; sid:1065882; rev:2; metadata:affected_product PHP, attack_target Web_Server, deployment Datacenter, signature_severity Major, created_at 2018_06_22, performance_impact Low, updated_at 2018_07_18; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT TP-Link Technologies TL-WA850RE Wi-Fi Range Extender - Command Execution (web-application-attack) - detector_id: 65883 original_sid: 2025735
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET EXPLOIT TP-Link Technologies TL-WA850RE Wi-Fi Range Extender - Command Execution"; flow:to_server,established; content:"/wps.setup.json"; fast_pattern; nocase; http_uri; content:"operation=write"; http_client_body; content:"option=connect"; http_client_body; content:"wps_setup_pin="; http_client_body; content:"%2Fbin%2Fsh"; http_client_body; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:url,exploit-db.com/exploits/44912/; classtype:web-application-attack; sid:1065883; rev:2; metadata:affected_product TPLINK, attack_target IoT, deployment Datacenter, signature_severity Major, created_at 2018_06_22, performance_impact Low, updated_at 2018_07_18; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT TP-Link TL-WR840N/TL-WR841N - Authentication Bypass (Add Port Forwarding) (attempted-user) - detector_id: 65887 original_sid: 2025750
alert http any any -> $HOME_NET any (msg:"ET EXPLOIT TP-Link TL-WR840N/TL-WR841N - Authentication Bypass (Add Port Forwarding)"; flow:established,to_server; content:"/cgi?3"; http_uri; isdataat:!1,relative; content:"/mainFrame.htm"; http_header; content:"IP_CONN_PORTTRIGGERING"; http_client_body; content:"openProtocol"; http_client_body; content:"openPort="; http_client_body; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:url,exploit-db.com/exploits/44781/; classtype:attempted-user; sid:1065887; rev:2; metadata:affected_product TPLINK, attack_target IoT, deployment Datacenter, signature_severity Major, created_at 2018_06_26, updated_at 2018_07_18; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT TP-Link TL-WR840N/TL-WR841N - Authentication Bypass (DMZ enable and Disable) (attempted-user) - detector_id: 65888 original_sid: 2025751
alert http any any -> $HOME_NET any (msg:"ET EXPLOIT TP-Link TL-WR840N/TL-WR841N - Authentication Bypass (DMZ enable and Disable)"; flow:established,to_server; content:"/cgi?2"; http_uri; isdataat:!1,relative; content:"/mainFrame.htm"; http_header; content:"DMZ_HOST_CFG"; fast_pattern; http_client_body; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:url,exploit-db.com/exploits/44781/; classtype:attempted-user; sid:1065888; rev:2; metadata:affected_product TPLINK, attack_target IoT, deployment Datacenter, signature_severity Major, created_at 2018_06_26, updated_at 2018_07_18; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT TP-Link TL-WR840N/TL-WR841N - Authentication Bypass (Enable Guest Network) (attempted-user) - detector_id: 65889 original_sid: 2025752
alert http any any -> $HOME_NET any (msg:"ET EXPLOIT TP-Link TL-WR840N/TL-WR841N - Authentication Bypass (Enable Guest Network)"; flow:established,to_server; content:"/cgi?2&2&2&2&2"; http_uri; content:"/mainFrame.htm"; http_header; content:"LAN_WLAN_MULTISSID"; fast_pattern; http_client_body; content:"multiSSIDEnable"; http_client_body; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:url,exploit-db.com/exploits/44781/; classtype:attempted-user; sid:1065889; rev:2; metadata:affected_product TPLINK, attack_target IoT, deployment Datacenter, signature_severity Major, created_at 2018_06_26, updated_at 2018_07_18; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT TP-Link TL-WR840N/TL-WR841N - Authentication Bypass (GET conf.bin) (attempted-user) - detector_id: 65890 original_sid: 2025753
alert http any any -> $HOME_NET any (msg:"ET EXPLOIT TP-Link TL-WR840N/TL-WR841N - Authentication Bypass (GET conf.bin)"; flow:established,to_server; content:"/cgi/conf.bin"; http_uri; content:"/mainFrame.htm"; http_header; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:url,exploit-db.com/exploits/44781/; classtype:attempted-user; sid:1065890; rev:2; metadata:affected_product TPLINK, attack_target IoT, deployment Datacenter, signature_severity Major, created_at 2018_06_26, updated_at 2018_07_18; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT TP-Link TL-WR840N/TL-WR841N - Authentication Bypass (Reboot Router) (attempted-user) - detector_id: 65891 original_sid: 2025754
alert http any any -> $HOME_NET any (msg:"ET EXPLOIT TP-Link TL-WR840N/TL-WR841N - Authentication Bypass (Reboot Router)"; flow:established,to_server; content:"/cgi?7"; http_uri; content:"mainFrame.htm"; http_header; content:"ACT_REBOOT"; http_client_body; fast_pattern; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:url,exploit-db.com/exploits/44781/; classtype:attempted-user; sid:1065891; rev:2; metadata:affected_product TPLINK, attack_target IoT, deployment Datacenter, signature_severity Major, created_at 2018_06_26, updated_at 2018_07_18; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT TP-Link TL-WR840N/TL-WR841N - Authentication Bypass (WiFi Password Change) (web-application-attack) - detector_id: 65892 original_sid: 2025755
alert http any any -> $HOME_NET any (msg:"ET EXPLOIT TP-Link TL-WR840N/TL-WR841N - Authentication Bypass (WiFi Password Change)"; flow:established,to_server; content:"/cgi?2"; http_uri; isdataat:!1,relative; content:"/mainFrame.htm"; http_header; content:"LAN_WLAN"; fast_pattern; http_client_body; content:"IEEE11iAuthenticationMode"; http_client_body; content:"IEEE11iEncryptionModes"; http_client_body; content:"X_TP_PreSharedKey="; http_client_body; content:"X_TP_GroupKeyUpdateInterval"; http_client_body; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:url,exploit-db.com/exploits/44781/; classtype:web-application-attack; sid:1065892; rev:2; metadata:affected_product TPLINK, attack_target IoT, deployment Datacenter, signature_severity Major, created_at 2018_06_26, updated_at 2018_07_18; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT D-Link DSL-2750B - OS Command Injection (attempted-user) - detector_id: 65893 original_sid: 2025756
alert http any any -> $HOME_NET any (msg:"ET EXPLOIT D-Link DSL-2750B - OS Command Injection"; flow:established,to_server; content:"/login.cgi?cli="; http_uri; pcre:"/^[ a-zA-Z0-9+_]*[\x27\x3b]/URi"; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:url,exploit-db.com/exploits/44760/; classtype:attempted-user; sid:1065893; rev:2; metadata:attack_target IoT, deployment Datacenter, signature_severity Major, created_at 2018_06_27, performance_impact Low, updated_at 2018_07_18; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT HP Enterprise VAN SDN Controller Exec Backdoor (attempted-user) - detector_id: 65894 original_sid: 2025761
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET EXPLOIT HP Enterprise VAN SDN Controller Exec Backdoor"; flow:established,to_server; content:"X-Auth-Token|3a| AuroraSdnToken"; http_header; content:"|7b 22|action|22 3a 20 22|exec|22 2c 20 22|name|22 3a 20 22|"; fast_pattern; http_client_body; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:url,exploit-db.com/exploits/44951/; classtype:attempted-user; sid:1065894; rev:2; metadata:attack_target Networking_Equipment, deployment Datacenter, signature_severity Major, created_at 2018_06_28, updated_at 2018_07_18; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT HP Enterprise VAN SDN Controller Install Backdoor (attempted-user) - detector_id: 65895 original_sid: 2025762
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET EXPLOIT HP Enterprise VAN SDN Controller Install Backdoor"; flow:established,to_server; content:"X-Auth-Token|3a| AuroraSdnToken"; http_header; content:"|7b 22|action|22 3a 20 22|install|22 2c 20 22|name|22 3a 20 22|"; fast_pattern; http_client_body; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:url,exploit-db.com/exploits/44951/; classtype:attempted-user; sid:1065895; rev:2; metadata:attack_target Networking_Equipment, deployment Datacenter, signature_severity Major, created_at 2018_06_28, updated_at 2018_07_18; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT HP Enterprise VAN SDN Controller Upload Backdoor (attempted-user) - detector_id: 65896 original_sid: 2025763
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET EXPLOIT HP Enterprise VAN SDN Controller Upload Backdoor"; flow:established,to_server; content:"/upload"; http_uri; isdataat:!1,relative; content:"X-Auth-Token|3a| AuroraSdnToken"; http_header; content:"!<arch>|0a|debian-binary"; http_client_body; fast_pattern; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:url,exploit-db.com/exploits/44951/; classtype:attempted-user; sid:1065896; rev:2; metadata:attack_target Networking_Equipment, deployment Datacenter, signature_severity Major, created_at 2018_06_28, updated_at 2018_07_18; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Cisco Adaptive Security Appliance - Path Traversal (attempted-user) - detector_id: 65897 original_sid: 2025764
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET EXPLOIT Cisco Adaptive Security Appliance - Path Traversal"; flow:established,to_server; content:"../"; http_raw_uri; content:"+CSCOE+/files/file_list.json?path=+CSCOE+"; fast_pattern; http_uri; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:url,exploit-db.com/exploits/44956/; reference:cve,2018-0296; classtype:attempted-user; sid:1065897; rev:1; metadata:affected_product Cisco_ASA, attack_target Networking_Equipment, deployment Datacenter, signature_severity Major, created_at 2018_06_29, performance_impact Low, updated_at 2018_07_18; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT CloudMe Sync Buffer Overflow (attempted-admin) - detector_id: 65899 original_sid: 2025766
alert tcp $EXTERNAL_NET any -> $HOME_NET 8888 (msg:"ET EXPLOIT CloudMe Sync Buffer Overflow"; flow:established,to_server; content:"|fe e7 d1 61 a8 98 03 69 10 06 e7 6f 6f 0a c4 61 5a ea c8 68 e1 52 d6 68 a2 7c fa 68 ff fd ff ff|"; fast_pattern; distance:0; content:"|92 70 b4 6e 47 27 d5 68 ff ff ff ff bc 48 f9 68|"; distance:0; content:"|3c 06 f8 68 72 a4 f9 68 c0 ff ff ff 92 70 b4 6e|"; distance:0; content:"|ab 57 f0 61 a3 ef b5 6e  d1 14 dc 61 0c ed b4 64 45 62 ba 61|"; distance:0; content:"|90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90 90|"; distance:0; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:url,exploit-db.com/exploits/44784/; reference:cve,2018-6892; classtype:attempted-admin; sid:1065899; rev:2; metadata:attack_target Server, deployment Perimeter, signature_severity Major, created_at 2018_06_29, performance_impact Low, updated_at 2018_07_18; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT VMware NSX SD-WAN Command Injection (attempted-user) - detector_id: 65900 original_sid: 2025767
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET EXPLOIT VMware NSX SD-WAN Command Injection"; flow:established,to_server; content:"/scripts/ajaxPortal.lua"; http_uri; fast_pattern; content:"destination="; http_client_body; content:"source="; http_client_body; content:"test="; http_client_body; content:"&requestTimeout="; http_client_body; content:"auth_token="; http_client_body; content:"cmd=run_diagnostic"; http_client_body; pcre:"/destination=[^&]*\x24\x28/Pi"; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:url,exploit-db.com/exploits/44959/; reference:cve,2018-6961; classtype:attempted-user; sid:1065900; rev:2; metadata:attack_target Server, deployment Datacenter, signature_severity Critical, created_at 2018_07_02, performance_impact Low, updated_at 2018_07_18; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT VMware NSX SD-WAN Command Injection 2 (attempted-user) - detector_id: 65901 original_sid: 2025768
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET EXPLOIT VMware NSX SD-WAN Command Injection 2"; flow:established,to_server; content:"/scripts/ajaxPortal.lua"; http_uri; fast_pattern; content:"name="; http_client_body; content:"source="; http_client_body; content:"test="; http_client_body; content:"&requestTimeout="; http_client_body; content:"auth_token="; http_client_body; content:"cmd=run_diagnostic"; http_client_body; pcre:"/name=[^&]*\x24\x28/Pi"; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:url,exploit-db.com/exploits/44959/; reference:cve,2018-6961; classtype:attempted-user; sid:1065901; rev:2; metadata:attack_target Server, deployment Datacenter, signature_severity Critical, created_at 2018_07_02, performance_impact Low, updated_at 2018_07_18; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Geutebruck Remote Command Execution (attempted-user) - detector_id: 65902 original_sid: 2025769
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET EXPLOIT Geutebruck Remote Command Execution"; flow:established,to_server; content:"/uapi-cgi/viewer/simple_loglistjs.cgi?"; http_uri; fast_pattern; content:"/bin/sh"; http_uri; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:url,exploit-db.com/exploits/44957/; reference:cve,2018-7520; classtype:attempted-user; sid:1065902; rev:1; metadata:attack_target IoT, deployment Perimeter, signature_severity Major, created_at 2018_07_02, performance_impact Low, updated_at 2018_07_18; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Nagios XI SQL Injection (attempted-user) - detector_id: 65903 original_sid: 2025772
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET EXPLOIT Nagios XI SQL Injection"; flow:established,to_server; content:"/nagiosim.php?mode=resolve&host=|27|"; http_uri; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:url,2018-8733; reference:cve,2018-8734; reference:cve,2018-8735; reference:cve,2018-8736; reference:url,exploit-db.com/exploits/44969/; classtype:attempted-user; sid:1065903; rev:1; metadata:attack_target Server, deployment Datacenter, signature_severity Critical, created_at 2018_07_02, updated_at 2018_07_18; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Nagios XI Remote Code Execution 2 (attempted-user) - detector_id: 65904 original_sid: 2025773
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET EXPLOIT Nagios XI Remote Code Execution 2"; flow:established,to_server; content:"/graphApi.php?host="; fast_pattern; http_uri; content:"%3bsudo%20../profile/getprofile.sh%20%23"; http_raw_uri; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:url,2018-8733; reference:cve,2018-8734; reference:cve,2018-8735; reference:cve,2018-8736; reference:url,exploit-db.com/exploits/44969/; classtype:attempted-user; sid:1065904; rev:2; metadata:attack_target Server, deployment Datacenter, signature_severity Critical, created_at 2018_07_02, updated_at 2018_07_18; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Nagios XI Remote Code Execution (attempted-user) - detector_id: 65905 original_sid: 2025774
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET EXPLOIT Nagios XI Remote Code Execution"; flow:established,to_server; content:"/ajaxhelper.php?cmd=getxicoreajax"; http_uri; fast_pattern; content:"&opts=%7b%22func%22%3a%22get_hoststatus_table%22%7d"; http_raw_uri; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:url,2018-8733; reference:cve,2018-8734; reference:cve,2018-8735; reference:cve,2018-8736; reference:url,exploit-db.com/exploits/44969/; classtype:attempted-user; sid:1065905; rev:1; metadata:attack_target Server, deployment Datacenter, signature_severity Critical, created_at 2018_07_02, updated_at 2018_07_18; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Nagios XI SQL Injection 2 (attempted-user) - detector_id: 65906 original_sid: 2025775
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET EXPLOIT Nagios XI SQL Injection 2"; flow:established,to_server; content:"/admin/helpedit.php"; http_uri; fast_pattern; content:"selInfoKey1="; http_client_body; pcre:"/^[^&]+\x2527(?:UNION|SELECT)/PRi"; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:url,2018-8733; reference:cve,2018-8734; reference:cve,2018-8735; reference:cve,2018-8736; reference:url,exploit-db.com/exploits/44969/; classtype:attempted-user; sid:1065906; rev:2; metadata:attack_target Server, deployment Datacenter, signature_severity Critical, created_at 2018_07_03, updated_at 2018_07_18; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Nagios XI Remote Code Execution 3 (attempted-user) - detector_id: 65907 original_sid: 2025776
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET EXPLOIT Nagios XI Remote Code Execution 3"; flow:established,to_server; content:"/index.php?cmd=submitcommand&command="; http_uri; content:"&command_data=$("; http_uri; fast_pattern; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:url,2018-8733; reference:cve,2018-8734; reference:cve,2018-8735; reference:cve,2018-8736; reference:url,exploit-db.com/exploits/44969/; classtype:attempted-user; sid:1065907; rev:2; metadata:attack_target Server, deployment Datacenter, signature_severity Critical, created_at 2018_07_03, updated_at 2018_07_18; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Nagios XI Set DB User Root (attempted-user) - detector_id: 65908 original_sid: 2025777
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET EXPLOIT Nagios XI Set DB User Root"; flow:established,to_server; content:"/admin/settings.php"; http_uri; content:"txtRootPath="; http_client_body; content:"&txtBasePath="; http_client_body; content:"&selProtocol="; http_client_body; content:"&txtTempdir="; http_client_body; content:"&selLanguage="; http_client_body; content:"&txtEncoding="; http_client_body; content:"&txtDBserver="; http_client_body; content:"&txtDBport="; http_client_body; content:"&txtDBname="; http_client_body; content:"&txtDBuser=root"; fast_pattern; http_client_body; content:"&txtDBpass="; http_client_body; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:url,2018-8733; reference:cve,2018-8734; reference:cve,2018-8735; reference:cve,2018-8736; reference:url,exploit-db.com/exploits/44969/; classtype:attempted-user; sid:1065908; rev:1; metadata:attack_target Server, deployment Datacenter, signature_severity Critical, created_at 2018_07_03, updated_at 2018_07_18; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Nagios XI Adding Administrative User (attempted-user) - detector_id: 65909 original_sid: 2025778
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET EXPLOIT Nagios XI Adding Administrative User"; flow:established,to_server; content:"/api/v1/system/user"; http_uri; content:"username="; http_client_body; content:"&password="; http_client_body; content:"&name="; http_client_body; content:"&email="; http_client_body; content:"&auth_level=admin&force_pw_change=0"; fast_pattern; http_client_body; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:url,2018-8733; reference:cve,2018-8734; reference:cve,2018-8735; reference:cve,2018-8736; reference:url,exploit-db.com/exploits/44969/; classtype:attempted-user; sid:1065909; rev:1; metadata:attack_target Server, deployment Datacenter, signature_severity Critical, created_at 2018_07_03, updated_at 2018_07_18; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT ADB Broadband Authorization Bypass (web-application-attack) - detector_id: 65911 original_sid: 2025785
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET EXPLOIT ADB Broadband Authorization Bypass"; flow:established,to_server; content:"/ui/dboard/settings/management/"; http_uri; fast_pattern; content:"/management//"; http_raw_uri; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:cve,2018-13109; reference:url,exploit-db.com/exploits/44982/; classtype:web-application-attack; sid:1065911; rev:1; metadata:attack_target IoT, deployment Datacenter, signature_severity Critical, created_at 2018_07_05, performance_impact Low, updated_at 2018_07_18; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Oracle Weblogic Server Deserialization Remote Command Execution (attempted-user) - detector_id: 65912 original_sid: 2025788
alert tcp $EXTERNAL_NET any -> $HOME_NET 1024: (msg:"ET EXPLOIT Oracle Weblogic Server Deserialization Remote Command Execution"; flow:established,to_server; content:"java.rmi.registry.Registry"; fast_pattern; content:"java.lang.reflect.Proxy"; content:"java.rmi.server.RemoteObjectInvocationHandler"; content:"UnicastRef"; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:url,exploit-db.com/exploits/44553/; reference:cve,2018-2628; classtype:attempted-user; sid:1065912; rev:1; metadata:attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2018_07_05, performance_impact Low, updated_at 2018_07_18; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Exim Internet Mailer Remote Code Execution (attempted-user) - detector_id: 65913 original_sid: 2025793
alert smtp $EXTERNAL_NET any -> $HOME_NET any (msg:"ET EXPLOIT Exim Internet Mailer Remote Code Execution"; flow:established,to_server; content:"JHtydW57L2Jpbi9iYXNoIC1jICIvYmluL2Jhc2ggLWkgPiYgL2Rldi90Y3Av"; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:cve,2018-6789; reference:url,exploit-db.com/exploits/44571/; classtype:attempted-user; sid:1065913; rev:2; metadata:attack_target SMTP_Server, deployment Datacenter, signature_severity Major, created_at 2018_07_09, performance_impact Low, updated_at 2018_07_18; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT xdebug OS Command Execution  (attempted-user) - detector_id: 65914 original_sid: 2025794
alert tcp $EXTERNAL_NET any -> $HOME_NET 9000 (msg:"ET EXPLOIT xdebug OS Command Execution "; flow:established,to_server; content:"eval -i 1 --|0d 0a|ZmlsZV9wdXRfY29udGVudH"; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:url,exploit-db.com/exploits/44568/; classtype:attempted-user; sid:1065914; rev:2; metadata:attack_target Web_Server, deployment Perimeter, signature_severity Major, created_at 2018_07_09, performance_impact Low, updated_at 2018_07_18; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Generic system shell command to php base64 encoded Remote Code Execution 1 (attempted-user) - detector_id: 65915 original_sid: 2025795
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET EXPLOIT Generic system shell command to php base64 encoded Remote Code Execution 1"; flow:established,to_server; content:"c3lzdGVtKCIgcGhw"; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; classtype:attempted-user; sid:1065915; rev:2; metadata:affected_product Web_Server_Applications, attack_target Web_Server, deployment Datacenter, created_at 2018_07_09, updated_at 2018_07_18; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Generic system shell command to php base64 encoded Remote Code Execution 2 (attempted-user) - detector_id: 65916 original_sid: 2025796
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET EXPLOIT Generic system shell command to php base64 encoded Remote Code Execution 2"; flow:established,to_server; content:"N5c3RlbSgiIHBoc"; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; classtype:attempted-user; sid:1065916; rev:2; metadata:affected_product Web_Server_Applications, attack_target Web_Server, deployment Datacenter, created_at 2018_07_09, updated_at 2018_07_18; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Generic system shell command to php base64 encoded Remote Code Execution 3 (attempted-user) - detector_id: 65917 original_sid: 2025797
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET EXPLOIT Generic system shell command to php base64 encoded Remote Code Execution 3"; flow:established,to_server; content:"zeXN0ZW0oIiBwaH"; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; classtype:attempted-user; sid:1065917; rev:2; metadata:affected_product Web_Server_Applications, attack_target Web_Server, deployment Datacenter, created_at 2018_07_09, updated_at 2018_07_18; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Generic system shell command to php base64 encoded Remote Code Execution 4 (attempted-user) - detector_id: 65918 original_sid: 2025798
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET EXPLOIT Generic system shell command to php base64 encoded Remote Code Execution 4"; flow:established,to_server; content:"c3lzdGVtKCJwaH"; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; classtype:attempted-user; sid:1065918; rev:2; metadata:affected_product Web_Server_Applications, attack_target Web_Server, deployment Datacenter, created_at 2018_07_09, updated_at 2018_07_18; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Generic system shell command to php base64 encoded Remote Code Execution 5 (attempted-user) - detector_id: 65919 original_sid: 2025799
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET EXPLOIT Generic system shell command to php base64 encoded Remote Code Execution 5"; flow:established,to_server; content:"N5c3RlbSgicGhw"; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; classtype:attempted-user; sid:1065919; rev:2; metadata:affected_product Web_Server_Applications, attack_target Web_Server, deployment Datacenter, created_at 2018_07_09, updated_at 2018_07_18; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Generic system shell command to php base64 encoded Remote Code Execution 6 (attempted-user) - detector_id: 65920 original_sid: 2025800
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET EXPLOIT Generic system shell command to php base64 encoded Remote Code Execution 6"; flow:established,to_server; content:"zeXN0ZW0oInBoc"; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; classtype:attempted-user; sid:1065920; rev:2; metadata:created_at 2018_07_09, updated_at 2018_07_18; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT file_put_contents php base64 encoded Remote Code Execution 1 (attempted-user) - detector_id: 65921 original_sid: 2025801
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET EXPLOIT file_put_contents php base64 encoded Remote Code Execution 1"; flow:established,to_server; content:"ZmlsZV9wdXRfY29udGVudH"; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; classtype:attempted-user; sid:1065921; rev:2; metadata:affected_product Web_Server_Applications, affected_product PHP, attack_target Web_Server, deployment Datacenter, created_at 2018_07_09, updated_at 2018_07_18; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT file_put_contents php base64 encoded Remote Code Execution 2 (attempted-user) - detector_id: 65922 original_sid: 2025802
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET EXPLOIT file_put_contents php base64 encoded Remote Code Execution 2"; flow:established,to_server; content:"ZpbGVfcHV0X2NvbnRlbnRz"; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; classtype:attempted-user; sid:1065922; rev:2; metadata:affected_product Web_Server_Applications, affected_product PHP, attack_target Web_Server, deployment Datacenter, created_at 2018_07_09, updated_at 2018_07_18; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT file_put_contents php base64 encoded Remote Code Execution 3 (attempted-user) - detector_id: 65923 original_sid: 2025803
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET EXPLOIT file_put_contents php base64 encoded Remote Code Execution 3"; flow:established,to_server; content:"maWxlX3B1dF9jb250ZW50c"; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; classtype:attempted-user; sid:1065923; rev:2; metadata:affected_product Web_Server_Applications, affected_product PHP, attack_target Web_Server, deployment Datacenter, created_at 2018_07_09, updated_at 2018_07_18; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT bin bash base64 encoded Remote Code Execution 1 (attempted-user) - detector_id: 65924 original_sid: 2025804
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET EXPLOIT bin bash base64 encoded Remote Code Execution 1"; flow:established,to_server; content:"L2Jpbi9iYXNo"; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; classtype:attempted-user; sid:1065924; rev:2; metadata:attack_target Web_Server, deployment Datacenter, created_at 2018_07_09, updated_at 2018_07_18; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT bin bash base64 encoded Remote Code Execution 2 (attempted-user) - detector_id: 65925 original_sid: 2025805
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET EXPLOIT bin bash base64 encoded Remote Code Execution 2"; flow:established,to_server; content:"9iaW4vYmFza"; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; classtype:attempted-user; sid:1065925; rev:2; metadata:attack_target Web_Server, deployment Datacenter, created_at 2018_07_09, updated_at 2018_07_18; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT bin bash base64 encoded Remote Code Execution 3 (attempted-user) - detector_id: 65926 original_sid: 2025806
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET EXPLOIT bin bash base64 encoded Remote Code Execution 3"; flow:established,to_server; content:"vYmluL2Jhc2"; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; classtype:attempted-user; sid:1065926; rev:2; metadata:attack_target Web_Server, deployment Datacenter, created_at 2018_07_09, updated_at 2018_07_18; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT php script base64 encoded Remote Code Execution 1 (attempted-user) - detector_id: 65927 original_sid: 2025807
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET EXPLOIT php script base64 encoded Remote Code Execution 1"; flow:established,to_server; content:"Lyo8P3BocC"; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; classtype:attempted-user; sid:1065927; rev:2; metadata:affected_product Web_Server_Applications, attack_target Web_Server, deployment Datacenter, created_at 2018_07_09, updated_at 2018_07_18; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT php script base64 encoded Remote Code Execution 2 (attempted-user) - detector_id: 65928 original_sid: 2025808
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET EXPLOIT php script base64 encoded Remote Code Execution 2"; flow:established,to_server; content:"8qPD9waHAg"; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; classtype:attempted-user; sid:1065928; rev:2; metadata:affected_product Web_Server_Applications, attack_target Web_Server, deployment Datacenter, created_at 2018_07_09, updated_at 2018_07_18; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT php script base64 encoded Remote Code Execution 3 (attempted-user) - detector_id: 65929 original_sid: 2025809
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET EXPLOIT php script base64 encoded Remote Code Execution 3"; flow:established,to_server; content:"vKjw/cGhwI"; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; classtype:attempted-user; sid:1065929; rev:2; metadata:affected_product Web_Server_Applications, attack_target Web_Server, deployment Datacenter, created_at 2018_07_09, updated_at 2018_07_18; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT php script double base64 encoded Remote Code Execution 1 (attempted-user) - detector_id: 65930 original_sid: 2025810
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET EXPLOIT php script double base64 encoded Remote Code Execution 1"; flow:established,to_server; content:"THlvOFAzQm9jQ"; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; classtype:attempted-user; sid:1065930; rev:2; metadata:affected_product Web_Server_Applications, attack_target Web_Server, deployment Datacenter, created_at 2018_07_09, updated_at 2018_07_18; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT php script double base64 encoded Remote Code Execution 2 (attempted-user) - detector_id: 65931 original_sid: 2025811
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET EXPLOIT php script double base64 encoded Remote Code Execution 2"; flow:established,to_server; content:"x5bzhQM0JvY0"; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; classtype:attempted-user; sid:1065931; rev:2; metadata:affected_product Web_Server_Applications, attack_target Web_Server, deployment Datacenter, created_at 2018_07_09, updated_at 2018_07_18; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT php script double base64 encoded Remote Code Execution 3 (attempted-user) - detector_id: 65932 original_sid: 2025812
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET EXPLOIT php script double base64 encoded Remote Code Execution 3"; flow:established,to_server; content:"MeW84UDNCb2ND"; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; classtype:attempted-user; sid:1065932; rev:2; metadata:affected_product Web_Server_Applications, attack_target Web_Server, deployment Datacenter, created_at 2018_07_09, updated_at 2018_07_18; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT php script double base64 encoded Remote Code Execution 4 (attempted-user) - detector_id: 65933 original_sid: 2025813
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET EXPLOIT php script double base64 encoded Remote Code Execution 4"; flow:established,to_server; content:"OHFQRDl3YUhBZ"; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; classtype:attempted-user; sid:1065933; rev:2; metadata:affected_product Web_Server_Applications, attack_target Web_Server, deployment Datacenter, created_at 2018_07_09, updated_at 2018_07_18; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT php script double base64 encoded Remote Code Execution 5 (attempted-user) - detector_id: 65934 original_sid: 2025814
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET EXPLOIT php script double base64 encoded Remote Code Execution 5"; flow:established,to_server; content:"hxUEQ5d2FIQW"; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; classtype:attempted-user; sid:1065934; rev:2; metadata:affected_product Web_Server_Applications, attack_target Web_Server, deployment Datacenter, created_at 2018_07_09, updated_at 2018_07_18; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT php script double base64 encoded Remote Code Execution 6 (attempted-user) - detector_id: 65935 original_sid: 2025815
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET EXPLOIT php script double base64 encoded Remote Code Execution 6"; flow:established,to_server; content:"4cVBEOXdhSEFn"; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; classtype:attempted-user; sid:1065935; rev:2; metadata:affected_product Web_Server_Applications, attack_target Web_Server, deployment Datacenter, created_at 2018_07_09, updated_at 2018_07_18; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT php script double base64 encoded Remote Code Execution 7 (attempted-user) - detector_id: 65936 original_sid: 2025816
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET EXPLOIT php script double base64 encoded Remote Code Execution 7"; flow:established,to_server; content:"dktqdy9jR2h3S"; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; classtype:attempted-user; sid:1065936; rev:2; metadata:affected_product Web_Server_Applications, attack_target Web_Server, deployment Datacenter, created_at 2018_07_09, updated_at 2018_07_18; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT php script double base64 encoded Remote Code Execution 8 (attempted-user) - detector_id: 65937 original_sid: 2025817
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET EXPLOIT php script double base64 encoded Remote Code Execution 8"; flow:established,to_server; content:"ZLancvY0dod0"; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; classtype:attempted-user; sid:1065937; rev:2; metadata:affected_product Web_Server_Applications, attack_target Web_Server, deployment Datacenter, created_at 2018_07_09, updated_at 2018_07_18; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT php script double base64 encoded Remote Code Execution 9 (attempted-user) - detector_id: 65938 original_sid: 2025818
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET EXPLOIT php script double base64 encoded Remote Code Execution 9"; flow:established,to_server; content:"2S2p3L2NHaHdJ"; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; classtype:attempted-user; sid:1065938; rev:2; metadata:affected_product Web_Server_Applications, attack_target Web_Server, deployment Datacenter, created_at 2018_07_09, updated_at 2018_07_18; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT D-Link DIR601 2.02 Credential Disclosure (attempted-recon) - detector_id: 65940 original_sid: 2025823
alert http any any -> $HOME_NET any (msg:"ET EXPLOIT D-Link DIR601 2.02 Credential Disclosure"; flow:established,to_server; content:"/my_cgi.cgi"; http_uri; content:"request=no_auth"; http_client_body; content:"request=load_settings"; http_client_body; content:"table_name=admin_user"; fast_pattern; http_client_body; content:"table_name=user_user"; http_client_body; content:"table_name=wireless_settings"; http_client_body; content:"table_name=wireless_security"; http_client_body; content:"table_name=wireless_wpa_settings"; http_client_body; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:url,exploit-db.com/exploits/45002/; classtype:attempted-recon; sid:1065940; rev:2; metadata:attack_target IoT, deployment Datacenter, signature_severity Major, created_at 2018_07_10, performance_impact Low, updated_at 2018_07_18; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT IBM QRadar SIEM Unauthenticated Remote Code Execution (attempted-user) - detector_id: 65941 original_sid: 2025826
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET EXPLOIT IBM QRadar SIEM Unauthenticated Remote Code Execution"; flow:established,to_server; content:"/ForensicsAnalysisServlet/?"; http_uri; fast_pattern; content:"[pcap]=$("; http_uri; content:"/bin/bash"; http_uri; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:url,exploit-db.com/exploits/45005/; classtype:attempted-user; sid:1065941; rev:1; metadata:attack_target Server, deployment Datacenter, signature_severity Major, created_at 2018_07_11, performance_impact Low, updated_at 2018_07_18; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT SAP NetWeaver AS JAVA CRM - Log injection Remote Command Execution (attempted-user) - detector_id: 65942 original_sid: 2025835
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET EXPLOIT SAP NetWeaver AS JAVA CRM - Log injection Remote Command Execution"; flow:established,to_server; content:"/init.do?"; http_uri; content:"java.util"; http_uri; content:"Runtime.getRuntime().exec"; fast_pattern; http_uri; content:"cmd"; http_uri; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:url,exploit-db.com/exploits/44292/; reference:cve,2018-2380; classtype:attempted-user; sid:1065942; rev:2; metadata:attack_target Web_Server, deployment Datacenter, signature_severity Major, created_at 2018_07_12, performance_impact Low, updated_at 2018_07_18; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Adobe Coldfusion BlazeDS Java Object Deserialization Remote Code Execution (attempted-user) - detector_id: 65943 original_sid: 2025836
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET EXPLOIT Adobe Coldfusion BlazeDS Java Object Deserialization Remote Code Execution"; flow:established,to_server; content:"/amf"; http_uri; content:"sun.rmi.server.UnicastRef"; http_client_body; content:"|f9 6a 76 7b 7c de 68 4f 76 d8 aa 3d 00 00 01 5b b0 4c 1d 81 80 01 00|"; fast_pattern; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:url,exploit-db.com/exploits/43993/; reference:cve,2017-3066; classtype:attempted-user; sid:1065943; rev:2; metadata:attack_target Server, deployment Datacenter, signature_severity Major, created_at 2018_07_13, performance_impact Low, updated_at 2018_07_18; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Oracle WebLogic - wls-wsat Component Deserialization Remote Code Execution Unix (attempted-user) - detector_id: 65944 original_sid: 2025837
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET EXPLOIT Oracle WebLogic - wls-wsat Component Deserialization Remote Code Execution Unix"; flow:established,to_server; content:"/CoordinatorPortType"; http_uri; content:"<soapenv:"; http_client_body; content:"java.lang.ProcessBuilder"; http_client_body; content:"<string>/bin/sh"; http_client_body; content:"<string>-c</string>"; http_client_body; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:url,exploit-db.com/exploits/43924/; classtype:attempted-user; sid:1065944; rev:1; metadata:attack_target Server, deployment Datacenter, created_at 2018_07_13, updated_at 2018_07_18; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Oracle WebLogic - wls-wsat Component Deserialization Remote Code Execution Windows (attempted-user) - detector_id: 65945 original_sid: 2025838
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET EXPLOIT Oracle WebLogic - wls-wsat Component Deserialization Remote Code Execution Windows"; flow:established,to_server; content:"/CoordinatorPortType"; http_uri; content:"<soapenv:"; http_client_body; content:"java.lang.ProcessBuilder"; http_client_body; content:"<string>cmd</string>"; http_client_body; content:"<string>/c</string>"; http_client_body; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:url,exploit-db.com/exploits/43924/; classtype:attempted-user; sid:1065945; rev:1; metadata:attack_target Server, deployment Datacenter, created_at 2018_07_13, updated_at 2018_07_18; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Nanopool Claymore Dual Miner Remote Code Execution Linux (attempted-user) - detector_id: 65946 original_sid: 2025861
alert tcp $EXTERNAL_NET any -> $HOME_NET 3333 (msg:"ET EXPLOIT Nanopool Claymore Dual Miner Remote Code Execution Linux"; flow:established,to_server; content:"jsonrpc"; content:"method"; content:"miner_file"; content:".bash"; content:"5c5c7837665c5c7834355c5c7834635c5c783436"; fast_pattern; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:url,exploit-db.com/exploits/45044/; reference:cve,2018-1000049; classtype:attempted-user; sid:1065946; rev:1; metadata:attack_target Server, deployment Datacenter, created_at 2018_07_17, updated_at 2018_07_18; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Nanopool Claymore Dual Miner Remote Code Execution Windows (attempted-user) - detector_id: 65947 original_sid: 2025862
alert tcp $EXTERNAL_NET any -> $HOME_NET 3333 (msg:"ET EXPLOIT Nanopool Claymore Dual Miner Remote Code Execution Windows"; flow:established,to_server; content:"jsonrpc"; content:"method"; content:"miner_file"; content:".bat"; content:"706f7765727368656c6c2e657865"; fast_pattern; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:url,exploit-db.com/exploits/45044/; reference:cve,2018-1000049; classtype:attempted-user; sid:1065947; rev:2; metadata:attack_target Server, deployment Datacenter, created_at 2018_07_17, updated_at 2018_07_18; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT MVPower DVR Shell UCE MSF Check (attempted-admin) - detector_id: 66050 original_sid: 2025882
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET EXPLOIT MVPower DVR Shell UCE MSF Check"; flow:to_server,established; content:"/shell?echo+"; http_uri; depth:12; fast_pattern; http_header_names; content:!"Referer"; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:url,researchcenter.paloaltonetworks.com/2018/07/unit42-finds-new-mirai-gafgyt-iotlinux-botnet-campaigns/; classtype:attempted-admin; sid:1066050; rev:2; metadata:affected_product Linux, attack_target IoT, deployment Perimeter, signature_severity Minor, created_at 2018_07_23, malware_family Mirai, updated_at 2018_07_23; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT MVPower DVR Shell UCE (attempted-admin) - detector_id: 66051 original_sid: 2025883
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET EXPLOIT MVPower DVR Shell UCE"; flow:to_server,established; content:"/shell?"; http_uri; depth:7; fast_pattern; http_header_names; content:!"Referer"; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:url,researchcenter.paloaltonetworks.com/2018/07/unit42-finds-new-mirai-gafgyt-iotlinux-botnet-campaigns/; classtype:attempted-admin; sid:1066051; rev:2; metadata:affected_product Linux, attack_target IoT, deployment Perimeter, signature_severity Major, created_at 2018_07_23, malware_family Mirai, updated_at 2018_07_23; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Multiple CCTV-DVR Vendors RCE (attempted-admin) - detector_id: 66052 original_sid: 2025884
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET EXPLOIT Multiple CCTV-DVR Vendors RCE"; flow:to_server,established; content:"/language/Swedish${IFS}&&"; http_uri; depth:25; fast_pattern; http_header_names; content:!"Referer"; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:url,researchcenter.paloaltonetworks.com/2018/07/unit42-finds-new-mirai-gafgyt-iotlinux-botnet-campaigns/; classtype:attempted-admin; sid:1066052; rev:2; metadata:affected_product Linux, attack_target IoT, deployment Perimeter, signature_severity Minor, created_at 2018_07_23, malware_family Mirai, updated_at 2018_07_23; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Oracle WebLogic Unrestricted File Upload (CVE-2018-2894) (attempted-admin) - detector_id: 66077 original_sid: 2025907
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET EXPLOIT Oracle WebLogic Unrestricted File Upload (CVE-2018-2894)"; flow:to_server,established; content:"POST"; http_method; content:"/ws_utc/resources/setting/keystore"; http_uri; fast_pattern; content:"ks_filename="; http_client_body; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:url,github.com/LandGrey/CVE-2018-2894/blob/master/CVE-2018-2894.py; reference:cve,2018-2894; classtype:attempted-admin; sid:1066077; rev:2; metadata:attack_target Server, deployment Datacenter, signature_severity Major, created_at 2018_07_25, updated_at 2018_07_25; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Mikrotik Winbox RCE Attempt (CVE-2018-14847) (attempted-admin) - detector_id: 66141 original_sid: 2025972
alert tcp any any -> $HOME_NET any (msg:"ET EXPLOIT Mikrotik Winbox RCE Attempt (CVE-2018-14847)"; flow:established,to_server; content:"|680100664d320500ff010600ff09050700ff090701000021352f2f2f2f2f2e2f2e2e2f2f2f2f2f2f2e2f2e2e2f2f2f2f2f2f2e2f2e2e2f666c6173682f72772f73746f72652f757365722e6461740200ff88020000000000080000000100ff8802000200000002000000|"; offset:0; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:url,github.com/mrmtwoj/0day-mikrotik; reference:url,www.helpnetsecurity.com/2018/08/03/mikrotik-cryptojacking-campaign; reference:cve,2018-14847; classtype:attempted-admin; sid:1066141; rev:3; metadata:affected_product Linux, attack_target Networking_Equipment, deployment Perimeter, signature_severity Major, created_at 2018_08_06, updated_at 2018_09_11; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Possible ETERNALBLUE Probe MS17-010 (Generic Flags) (trojan-activity) - detector_id: 66168 original_sid: 2025992
alert smb any any -> $HOME_NET any (msg:"ET EXPLOIT Possible ETERNALBLUE Probe MS17-010 (Generic Flags)"; flow:to_server,established; content:"|ff|SMB|25 00 00 00 00|"; offset:4; depth:9; content:"|00 00 00 00 00 00 00 00 00 00|"; distance:5; within:10; content:"|23 00 00 00 07 00 5c 50 49 50 45 5c 00|"; fast_pattern; isdataat:!1,relative; threshold: type limit, track by_src, count 1, seconds 30; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:url,github.com/rapid7/metasploit-framework/blob/master/modules/auxiliary/scanner/smb/smb_ms17_010.rb; classtype:trojan-activity; sid:1066168; rev:1; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2018_08_15, malware_family ETERNALBLUE, updated_at 2018_08_15; target:dest_ip;)

# ET EXPLOIT SonicWall Global Management System - XMLRPC set_time_zone Command Injection (CVE-2018-9866) (attempted-user) - detector_id: 66221 original_sid: 2026023
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET EXPLOIT SonicWall Global Management System - XMLRPC set_time_zone Command Injection (CVE-2018-9866)"; flow:established,to_server; content:"<methodName>set_time_"; http_client_body; fast_pattern; content:"<string>|22 60|"; http_client_body; distance:0; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:url,exploit-db.com/exploits/45124/; reference:cve,2018-9866; classtype:attempted-user; sid:1066221; rev:3; metadata:attack_target Server, deployment Datacenter, signature_severity Major, created_at 2018_08_23, performance_impact Low, updated_at 2018_09_10; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT HP Enterprise VAN SDN Controller Root Command Injection (Unix) (attempted-admin) - detector_id: 66237 original_sid: 2026028
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET EXPLOIT HP Enterprise VAN SDN Controller Root Command Injection (Unix)"; flow:established,to_server; content:"X-Auth-Token|3a| AuroraSdnToken"; http_header; fast_pattern; content:"|7b 22|action|22 3a 22|uninstall|22 2c 22|name|22 3a 22|--pre-invoke="; http_client_body; content:"|5c 5c|x73|5c 5c|x68|5c 5c|x20|5c 5c|x2d|5c 5c|x63"; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:url,github.com/rapid7/metasploit-framework/blob/master/modules/exploits/linux/http/hp_van_sdn_cmd_inject.rb; classtype:attempted-admin; sid:1066237; rev:1; metadata:attack_target Client_Endpoint, deployment Datacenter, signature_severity Major, created_at 2018_08_24, updated_at 2018_08_24; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT HP Enterprise VAN SDN Controller Root Command Injection (Linux) (attempted-admin) - detector_id: 66238 original_sid: 2026029
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET EXPLOIT HP Enterprise VAN SDN Controller Root Command Injection (Linux)"; flow:established,to_server; content:"X-Auth-Token|3a| AuroraSdnToken"; http_header; fast_pattern; content:"|7b 22|action|22 3a 22|uninstall|22 2c 22|name|22 3a 22|--pre-invoke="; http_client_body; content:".deb"; http_client_body; content:"/var/lib/sdn/uploads"; http_client_body; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:url,github.com/rapid7/metasploit-framework/blob/master/modules/exploits/linux/http/hp_van_sdn_cmd_inject.rb; classtype:attempted-admin; sid:1066238; rev:1; metadata:attack_target Client_Endpoint, deployment Datacenter, signature_severity Major, created_at 2018_08_24, updated_at 2018_08_24; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT HP Enterprise VAN SDN Controller Upload Backdoor 2 (attempted-admin) - detector_id: 66239 original_sid: 2026030
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET EXPLOIT HP Enterprise VAN SDN Controller Upload Backdoor 2"; flow:established,to_server; content:"/upload"; http_uri; isdataat:!1,relative; content:"X-Auth-Token|3a| AuroraSdnToken"; http_header; fast_pattern; content:".deb|0d 0a|"; http_header; content:"|7f|ELF"; http_client_body; depth:4; metadata:former_category SCAN, flip_endpoints False, server_side True; reference:url,github.com/rapid7/metasploit-framework/blob/master/modules/exploits/linux/http/hp_van_sdn_cmd_inject.rb; classtype:attempted-admin; sid:1066239; rev:2; metadata:attack_target Client_Endpoint, deployment Datacenter, signature_severity Major, created_at 2018_08_24, updated_at 2018_08_24; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Ghostscript invalidcheck escape attempt (SMTP) (attempted-user) - detector_id: 66320 original_sid: 2026084
alert smtp $EXTERNAL_NET any -> $SMTP_SERVERS any (msg:"ET EXPLOIT Ghostscript invalidcheck escape attempt (SMTP)"; flow:to_server,established; file_data; content:"legal"; content:"restore"; distance:0; content:"currentdevice"; content:"putdeviceprops"; pcre:"/legal[^x7B]*\x7B[^\x7D]*restore/smi"; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:url,seclists.org/oss-sec/2018/q3/142; classtype:attempted-user; sid:1066320; rev:2; metadata:attack_target SMTP_Server, deployment Datacenter, signature_severity Major, created_at 2018_09_05, updated_at 2018_09_05; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Ghostscript illegal read undefinedfilename attempt (SMTP) (attempted-user) - detector_id: 66322 original_sid: 2026086
alert smtp $EXTERNAL_NET any -> $SMTP_SERVERS any (msg:"ET EXPLOIT Ghostscript illegal read undefinedfilename attempt (SMTP)"; flow:to_server,established; file_data; content:"undefinedfilename"; fast_pattern; content:"errordict"; content:"invalidfileaccess"; content:"typecheck"; pcre:"/errordict\s+\x2Finvalidfileaccess/smi"; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:url,seclists.org/oss-sec/2018/q3/142; classtype:attempted-user; sid:1066322; rev:2; metadata:attack_target SMTP_Server, deployment Datacenter, signature_severity Audit, created_at 2018_09_05, updated_at 2018_09_05; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Ghostscript illegal delete bindnow attempt (SMTP) (attempted-user) - detector_id: 66324 original_sid: 2026088
alert smtp $EXTERNAL_NET any -> $SMTP_SERVERS any (msg:"ET EXPLOIT Ghostscript illegal delete bindnow attempt (SMTP)"; flow:to_server,established; file_data; content:"unlink("; fast_pattern; content:"|2E|bindnow"; content:"stopped"; distance:0; pcre:"/\x2Ebindnow[^\x7D]*\x7D\s*stopped/smi"; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:url,seclists.org/oss-sec/2018/q3/142; classtype:attempted-user; sid:1066324; rev:2; metadata:attack_target SMTP_Server, deployment Datacenter, signature_severity Audit, created_at 2018_09_05, updated_at 2018_09_05; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Ghostscript setpattern type confusion attempt (SMTP) (attempted-user) - detector_id: 66326 original_sid: 2026090
alert smtp $EXTERNAL_NET any -> $SMTP_SERVERS any (msg:"ET EXPLOIT Ghostscript setpattern type confusion attempt (SMTP)"; flow:to_server,established; file_data; content:"16#"; content:"setpattern"; distance:0; pcre:"/16#[^s]\d+\s*\x3E\x3E\s*setpattern/smi"; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:url,seclists.org/oss-sec/2018/q3/142; classtype:attempted-user; sid:1066326; rev:2; metadata:attack_target SMTP_Server, deployment Datacenter, signature_severity Audit, created_at 2018_09_05, updated_at 2018_09_05; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Ghostscript LockDistillerParams type confusion attempt (SMTP) (attempted-user) - detector_id: 66328 original_sid: 2026092
alert smtp $EXTERNAL_NET any -> $SMTP_SERVERS any (msg:"ET EXPLOIT Ghostscript LockDistillerParams type confusion attempt (SMTP)"; flow:to_server,established; file_data; content:"LockDistillerParams"; content:"16#"; distance:0; pcre:"/16#[^s]\d+\s*\x3E\x3E\s*setpattern/smi"; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:url,seclists.org/oss-sec/2018/q3/142; classtype:attempted-user; sid:1066328; rev:2; metadata:attack_target SMTP_Server, deployment Datacenter, signature_severity Audit, created_at 2018_09_05, updated_at 2018_09_05; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Linksys E-Series Device RCE Attempt (attempted-admin) - detector_id: 66357 original_sid: 2026102
alert http any any -> $HOME_NET any (msg:"ET EXPLOIT Linksys E-Series Device RCE Attempt"; flow:to_server,established; content:"POST"; http_method; content:".cgi"; http_uri; content:"ttcp_ip="; http_client_body; content:"-h"; http_client_body; distance:0; content:"&ttcp_num="; http_client_body; fast_pattern; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:url,www.exploit-db.com/exploits/31683/; reference:url,researchcenter.paloaltonetworks.com/2018/09/unit42-multi-exploit-iotlinux-botnets-mirai-gafgyt-target-apache-struts-sonicwall/; classtype:attempted-admin; sid:1066357; rev:3; metadata:attack_target Networking_Equipment, deployment Perimeter, signature_severity Audit, created_at 2018_09_10, malware_family Mirai, updated_at 2019_03_25; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Possible Vacron NVR Remote Command Execution M2 (attempted-admin) - detector_id: 66358 original_sid: 2026103
alert http any any -> $HOME_NET any (msg:"ET EXPLOIT Possible Vacron NVR Remote Command Execution M2"; flow:to_server,established; content:"/board.cgi"; http_uri; fast_pattern; content:"cmd="; http_client_body; depth:4; pcre:"/[^&]*(?:\x60|\x24)/RP"; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:url,blogs.securiteam.com/index.php/archives/3445; reference:url,researchcenter.paloaltonetworks.com/2018/09/unit42-multi-exploit-iotlinux-botnets-mirai-gafgyt-target-apache-struts-sonicwall/; classtype:attempted-admin; sid:1066358; rev:2; metadata:attack_target Networking_Equipment, deployment Perimeter, signature_severity Minor, created_at 2018_09_10, updated_at 2018_09_10; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT EnGenius EnShare IoT Gigabit Cloud Service RCE (attempted-admin) - detector_id: 66359 original_sid: 2026104
alert http any any -> $HOME_NET any (msg:"ET EXPLOIT EnGenius EnShare IoT Gigabit Cloud Service RCE"; flow:to_server,established; content:"/usbinteract.cgi"; http_uri; content:"action=7&path="; fast_pattern; http_client_body; depth:14; reference:url,researchcenter.paloaltonetworks.com/2018/09/unit42-multi-exploit-iotlinux-botnets-mirai-gafgyt-target-apache-struts-sonicwall/; classtype:attempted-admin; sid:1066359; rev:2; metadata:created_at 2018_09_10, updated_at 2018_09_10, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Zyxel Command Injection RCE (CVE-2017-6884) (attempted-admin) - detector_id: 66360 original_sid: 2026105
alert http any any -> $HOME_NET any (msg:"ET EXPLOIT Zyxel Command Injection RCE (CVE-2017-6884)"; flow:to_server,established; content:"/cgi-bin/luci/"; http_uri; content:"stok="; http_uri; content:"/nslookup?nslookup_button=nslookup_button&"; http_uri; fast_pattern; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:cve,2017-6884; reference:url,researchcenter.paloaltonetworks.com/2018/09/unit42-multi-exploit-iotlinux-botnets-mirai-gafgyt-target-apache-struts-sonicwall/; classtype:attempted-admin; sid:1066360; rev:2; metadata:attack_target Networking_Equipment, deployment Perimeter, signature_severity Minor, created_at 2018_09_10, updated_at 2018_09_10; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT NetGain Enterprise Manager 7.2.562 Ping Command Injection (attempted-admin) - detector_id: 66361 original_sid: 2026106
alert http any any -> $HOME_NET any (msg:"ET EXPLOIT NetGain Enterprise Manager 7.2.562 Ping Command Injection"; flow:to_server,established; content:"/exec.jsp"; http_uri; content:"command=cmd"; http_client_body; fast_pattern; content:"ping&argument="; http_client_body; distance:0; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:url,researchcenter.paloaltonetworks.com/2018/09/unit42-multi-exploit-iotlinux-botnets-mirai-gafgyt-target-apache-struts-sonicwall/; classtype:attempted-admin; sid:1066361; rev:2; metadata:attack_target Networking_Equipment, deployment Perimeter, signature_severity Minor, created_at 2018_09_10, updated_at 2018_09_10; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT NUUO OS Command Injection (attempted-admin) - detector_id: 66362 original_sid: 2026107
alert http any any -> $HOME_NET any (msg:"ET EXPLOIT NUUO OS Command Injection"; flow:to_server,established; content:"/handle_iscsi.php"; http_uri; content:"act=discover&address="; http_client_body; fast_pattern; pcre:"/[^&]*(?:\x60|\x24)/RP"; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:url,researchcenter.paloaltonetworks.com/2018/09/unit42-multi-exploit-iotlinux-botnets-mirai-gafgyt-target-apache-struts-sonicwall/; classtype:attempted-admin; sid:1066362; rev:2; metadata:attack_target Networking_Equipment, deployment Perimeter, signature_severity Minor, created_at 2018_09_10, updated_at 2018_09_10; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT NUUO OS Command Injection M2 (attempted-admin) - detector_id: 66363 original_sid: 2026108
alert http any any -> $HOME_NET any (msg:"ET EXPLOIT NUUO OS Command Injection M2"; flow:to_server,established; content:"/cgi_system?cmd=saveconfig"; http_uri; content:"bfolder="; http_client_body; pcre:"/(?:\x60|\x24)/P"; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:url,researchcenter.paloaltonetworks.com/2018/09/unit42-multi-exploit-iotlinux-botnets-mirai-gafgyt-target-apache-struts-sonicwall/; classtype:attempted-admin; sid:1066363; rev:2; metadata:attack_target Networking_Equipment, deployment Perimeter, signature_severity Major, created_at 2018_09_10, updated_at 2018_09_10; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Possible Cisco RV320 RCE Attempt (CVE-2019-1652) (trojan-activity) - detector_id: 75012 original_sid: 2026860
alert http any any -> $HOME_NET any (msg:"ET EXPLOIT Possible Cisco RV320 RCE Attempt (CVE-2019-1652)"; flow:established,to_server; content:"POST"; http_method; content:"/certificate_handle2.htm?type="; http_uri; content:"page=self_generator.htm&totalRules="; http_client_body; depth:35; fast_pattern; content:"|25 32 37 25 32 34 25 32 38|"; http_client_body; distance:0; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:url,seclists.org/fulldisclosure/2019/Jan/54; classtype:trojan-activity; sid:1075012; rev:1; metadata:attack_target Networking_Equipment, deployment Perimeter, cve 2019_1652, signature_severity Major, created_at 2019_01_29, performance_impact Low, updated_at 2019_01_29; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Possible MicroLogix 1100 PCCC DoS Condition (CVE-2017-7924) (attempted-dos) - detector_id: 75158 original_sid: 2026917
alert tcp $EXTERNAL_NET any -> $HOME_NET 44818 (msg:"ET EXPLOIT Possible MicroLogix 1100 PCCC DoS Condition (CVE-2017-7924)"; flow:to_server,established; content:"|4b 02 20 67 24 01|"; content:"|a2|"; distance:0; content:"|05 47|"; distance:1; within:2; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:cve,2017-7924; reference:url,rapid7.com/db/modules/auxiliary/dos/scada/allen_bradley_pccc; classtype:attempted-dos; sid:1075158; rev:1; metadata:deployment Perimeter, signature_severity Major, created_at 2019_02_18, performance_impact Moderate, updated_at 2019_02_18; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Nuuo NVR RCE Attempt (CVE-2018-15716) (attempted-admin) - detector_id: 75299 original_sid: 2026982
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET EXPLOIT Nuuo NVR RCE Attempt (CVE-2018-15716)"; flow:established,to_server; content:"GET"; http_method; content:"_handle.php?cmd=getupgradinginfo"; http_uri; fast_pattern; isdataat:!1,relative; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; classtype:attempted-admin; sid:1075299; rev:1; metadata:deployment Perimeter, cve 2018_15716, signature_severity Major, created_at 2019_02_26, performance_impact Low, updated_at 2019_02_26; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Possible LG SuperSign EZ CMS 2.5 RCE (CVE-2018-17173) (attempted-admin) - detector_id: 75456 original_sid: 2027089
alert http $EXTERNAL_NET any -> $HOME_NET 9080 (msg:"ET EXPLOIT Possible LG SuperSign EZ CMS 2.5 RCE (CVE-2018-17173)"; flow:established,to_server; content:"GET"; http_method; content:"/qsrserver/device/getThumbnail?sourceUri=|22|"; depth:42; fast_pattern; content:"|3b|"; http_uri; distance:0; within:40; content:"&targetUri="; http_uri; distance:0; content:"&scaleType="; http_uri; distance:0; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:url,www.exploit-db.com/exploits/45448; reference:cve,2018-17173; classtype:attempted-admin; sid:1075456; rev:2; metadata:attack_target IoT, deployment Perimeter, signature_severity Major, created_at 2019_03_18, performance_impact Low, updated_at 2019_03_18; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Possible WePresent WIPG1000 OS Command Injection (attempted-admin) - detector_id: 75457 original_sid: 2027090
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET EXPLOIT Possible WePresent WIPG1000 OS Command Injection"; flow:established,to_server; content:"GET"; http_method; content:"/cgi-bin/rdfs.cgi"; http_uri; depth:17; isdataat:!1,relative; fast_pattern; content:"Client="; http_client_body; depth:7; content:"|3b|"; http_client_body; distance:0; content:"&Download="; http_client_body; distance:0; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; classtype:attempted-admin; sid:1075457; rev:2; metadata:attack_target IoT, deployment Perimeter, signature_severity Major, created_at 2019_03_18, performance_impact Low, updated_at 2019_03_18; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Possible WePresent WIPG1000 File Inclusion (attempted-user) - detector_id: 75458 original_sid: 2027091
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET EXPLOIT Possible WePresent WIPG1000 File Inclusion"; flow:established,to_server; content:"GET"; http_method; content:"/cgi-bin/login.cgi"; http_uri; depth:18; isdataat:!1,relative; content:"&src=|2e 2e 2f 2e 2e 2f 2e 2e 2f|"; fast_pattern; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; classtype:attempted-user; sid:1075458; rev:2; metadata:attack_target IoT, deployment Perimeter, signature_severity Major, created_at 2019_03_18, performance_impact Low, updated_at 2019_03_18; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Possible ZyXEL P660HN-T v1 RCE (attempted-user) - detector_id: 75459 original_sid: 2027092
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET EXPLOIT Possible ZyXEL P660HN-T v1 RCE"; flow:established,to_server; content:"POST"; http_method; content:"/cgi-bin/ViewLog.asp"; http_uri; depth:20; isdataat:!1,relative; content:"remote_submit_Flag="; http_client_body; depth:19; content:"&remote_host="; http_client_body; distance:0; content:"&remoteSubmit=Save"; http_client_body; distance:0; isdataat:!1,relative; fast_pattern; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:url,seclists.org/fulldisclosure/2017/Jan/40; classtype:attempted-user; sid:1075459; rev:1; metadata:attack_target IoT, deployment Perimeter, signature_severity Major, created_at 2019_03_18, performance_impact Low, updated_at 2019_03_18; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Possible Netgear DGN2200 RCE (CVE-2017-6077) (attempted-user) - detector_id: 75460 original_sid: 2027093
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET EXPLOIT Possible Netgear DGN2200 RCE (CVE-2017-6077)"; flow:established,to_server; content:"POST"; http_method; content:"/ping.cgi"; http_uri; depth:9; isdataat:!1,relative; content:"DIAG_diag.htm|0d 0a|"; http_header; fast_pattern; content:"&ping_IPAddr="; http_client_body; content:"|3b|"; http_client_body; distance:0; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:url,www.exploit-db.com/exploits/41394; reference:cve,2017-6077; classtype:attempted-user; sid:1075460; rev:1; metadata:attack_target IoT, deployment Perimeter, signature_severity Major, created_at 2019_03_18, performance_impact Low, updated_at 2019_03_18; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Possible Netgear DGN2200 RCE (CVE-2017-6334) (attempted-user) - detector_id: 75461 original_sid: 2027094
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET EXPLOIT Possible Netgear DGN2200 RCE (CVE-2017-6334)"; flow:established,to_server; content:"POST"; http_method; content:"/dnslookup.cgi"; http_uri; depth:14; isdataat:!1,relative; content:"DIAG_diag.htm|0d 0a|"; http_header; fast_pattern; content:"host_name="; http_client_body; depth:10; content:"|3b|"; http_client_body; distance:0; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:url,www.exploit-db.com/exploits/41394; reference:cve,2017-6334; classtype:attempted-user; sid:1075461; rev:1; metadata:attack_target IoT, deployment Perimeter, signature_severity Major, created_at 2019_03_18, performance_impact Low, updated_at 2019_03_18; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Possible Linksys WAP54Gv3 Remote Debug Root Shell Exploitation Attempt (attempted-user) - detector_id: 75462 original_sid: 2027095
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET EXPLOIT Possible Linksys WAP54Gv3 Remote Debug Root Shell Exploitation Attempt"; flow:established,to_server; content:"POST"; http_method; content:"/debug.cgi"; http_uri; depth:10; isdataat:!1,relative; content:"data1=|3b|"; http_client_body; depth:7; fast_pattern; content:"&command="; http_client_body; distance:0; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:url,seclists.org/bugtraq/2010/Jun/93; classtype:attempted-user; sid:1075462; rev:1; metadata:attack_target Networking_Equipment, deployment Perimeter, signature_severity Major, created_at 2019_03_18, performance_impact Low, updated_at 2019_03_18; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Possible Linksys WRT100/110 RCE Attempt (CVE-2013-3568) (attempted-user) - detector_id: 75486 original_sid: 2027097
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET EXPLOIT Possible Linksys WRT100/110 RCE Attempt (CVE-2013-3568)"; flow:established,to_server; content:"POST"; http_method; content:"/ping.cgi"; http_uri; depth:9; isdataat:!1,relative; content:"pingstr="; http_client_body; depth:8; fast_pattern; content:"|3b|"; http_client_body; distance:0; within:25; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:cve,2013-3568; reference:url,www.exploit-db.com/exploits/28484; classtype:attempted-user; sid:1075486; rev:2; metadata:attack_target IoT, deployment Perimeter, signature_severity Major, created_at 2019_03_19, performance_impact Low, updated_at 2019_03_19; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Possible ZTE ZXV10 H108L Router Root RCE Attempt (attempted-user) - detector_id: 75487 original_sid: 2027098
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET EXPLOIT Possible ZTE ZXV10 H108L Router Root RCE Attempt"; flow:established,to_server; content:"GET"; http_method; content:"/getpage.gch?pid="; http_uri; depth:17; content:"&Host=|3b|"; http_uri; distance:0; fast_pattern; content:"&DataBlockSize="; http_uri; distance:0; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:url,github.com/stasinopoulos/ZTExploit/blob/master/ZTExploit_Source/ztexploit.py; classtype:attempted-user; sid:1075487; rev:2; metadata:attack_target IoT, deployment Perimeter, signature_severity Major, created_at 2019_03_19, performance_impact Low, updated_at 2019_03_19; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Possible Linksys E1500/E2500 apply.cgi RCE Attempt (attempted-user) - detector_id: 75488 original_sid: 2027099
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET EXPLOIT Possible Linksys E1500/E2500 apply.cgi RCE Attempt"; flow:established,to_server; content:"POST"; http_method; content:"/apply.cgi"; http_uri; depth:10; content:"submit_button="; http_client_body; depth:14; content:"&submit_type=start_ping"; http_client_body; distance:0; fast_pattern; content:"&ping_size="; http_client_body; distance:0; content:"|3b|"; http_client_body; distance:0; within:30; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:url,www.exploit-db.com/exploits/24936; classtype:attempted-user; sid:1075488; rev:1; metadata:attack_target IoT, deployment Perimeter, signature_severity Major, created_at 2019_03_19, performance_impact Low, updated_at 2019_03_19; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Unk.IoT IPCamera Exploit Attempt Inbound (trojan-activity) - detector_id: 75704 original_sid: 2027194
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET EXPLOIT Unk.IoT IPCamera Exploit Attempt Inbound"; flow:established,to_server; content:"POST"; http_method; content:"/sysTimeCfgEx"; http_uri; fast_pattern; isdataat:!1,relative; content:"systemdate="; http_client_body; depth:11; nocase; content:"&systemtime="; http_client_body; nocase; content:"&dwTimeZone"; http_client_body; nocase; content:"&updatemode="; http_client_body; nocase; content:"&ntpHost="; http_client_body; nocase; content:"&ntpPort="; http_client_body; nocase; content:"&timezonecon="; http_client_body; nocase; http_header_names; content:!"Referer"; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:url,twitter.com/zom3y3/status/1115481065701830657/photo/1; classtype:trojan-activity; sid:1075704; rev:2; metadata:attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2019_04_12, malware_family Mirai, performance_impact Moderate, updated_at 2019_04_12; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Linksys Smart WiFi Information Disclosure Attempt Inbound (attempted-recon) - detector_id: 75970 original_sid: 2027357
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET EXPLOIT Linksys Smart WiFi Information Disclosure Attempt Inbound"; flow:established,to_server; content:"POST"; http_method; content:"/JNAP/"; http_uri; depth:6; content:"X-JNAP-Action|3a 20|http|3a 2f 2f|"; http_header; fast_pattern; pcre:"/^(?:www\.)?(cisco|linksys)\.com\/jnap\//HRi"; content:"|7b 7d|"; http_client_body; depth:2; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:url,raw.githubusercontent.com/zeropwn/Linksys-Smart-WiFi-Information-Disclosure/master/nss.py; classtype:attempted-recon; sid:1075970; rev:2; metadata:attack_target Networking_Equipment, deployment Perimeter, signature_severity Major, created_at 2019_05_16, performance_impact Low, updated_at 2019_05_16; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT CyberArk Enterprise Password Vault XXE Injection Attempt (attempted-admin) - detector_id: 75971 original_sid: 2027358
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET EXPLOIT CyberArk Enterprise Password Vault XXE Injection Attempt"; flow:established,to_server; content:"POST"; http_method; content:"/PasswordVault/auth/saml/"; http_uri; fast_pattern; isdataat:!1,relative; content:"SAMLResponse=PCFET0NUWVBFIHIgWwo8IUVMRU1F"; http_client_body; depth:41; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:url,www.exploit-db.com/exploits/46828; classtype:attempted-admin; sid:1075971; rev:2; metadata:deployment Perimeter, signature_severity Major, created_at 2019_05_16, performance_impact Low, updated_at 2019_05_16; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Eir D1000 Remote Command Injection Attempt Inbound (attempted-admin) - detector_id: 76031 original_sid: 2027375
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET EXPLOIT Eir D1000 Remote Command Injection Attempt Inbound"; flow:established,to_server; content:"POST"; http_method; content:"/UD/act?1"; http_uri; depth:9; nocase; content:"<u|3a|GetSecurityKeys|20|"; http_client_body; fast_pattern; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:url,www.exploit-db.com/exploits/40740; classtype:attempted-admin; sid:1076031; rev:1; metadata:affected_product Eir_D1000_Modem, attack_target Networking_Equipment, deployment Perimeter, signature_severity Major, created_at 2019_05_23, performance_impact Low, updated_at 2019_05_23; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Possible Exim 4.87-4.91 RCE Attempt Inbound (CVE-2019-10149) (attempted-admin) - detector_id: 76143 original_sid: 2027442
alert smtp any any -> $SMTP_SERVERS any (msg:"ET EXPLOIT Possible Exim 4.87-4.91 RCE Attempt Inbound (CVE-2019-10149)"; flow:established,to_server; content:"RCPT|20|TO"; content:"|24 7b|run|7b|"; distance:0; within:12; fast_pattern; content:"|7d 7d 40|"; distance:0; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:url,www.qualys.com/2019/06/05/cve-2019-10149/return-wizard-rce-exim.txt; classtype:attempted-admin; sid:1076143; rev:3; metadata:attack_target SMTP_Server, deployment Perimeter, cve 2019_10149, signature_severity Major, created_at 2019_06_07, performance_impact Low, updated_at 2019_06_21; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Attempted Remote Command Injection Inbound (CVE-2019-3929) (attempted-admin) - detector_id: 76169 original_sid: 2027451
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET EXPLOIT Attempted Remote Command Injection Inbound (CVE-2019-3929)"; flow:established,to_server; content:"POST"; http_method; content:"/cgi-bin/file_transfer.cgi"; http_uri; isdataat:!1,relative; content:"file_transfer="; http_client_body; depth:14; content:"&dir=|27|Pa_Note"; http_client_body; distance:0; fast_pattern; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:url,unit42.paloaltonetworks.com/new-mirai-variant-adds-8-new-exploits-targets-additional-iot-devices/; classtype:attempted-admin; sid:1076169; rev:1; metadata:attack_target IoT, deployment Perimeter, cve 2019_3929, signature_severity Major, created_at 2019_06_11, performance_impact Low, updated_at 2019_06_11; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Possible OpenDreamBox Attempted Remote Command Injection Inbound (attempted-admin) - detector_id: 76171 original_sid: 2027453
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET EXPLOIT Possible OpenDreamBox Attempted Remote Command Injection Inbound"; flow:established,to_server; content:"POST"; http_method; content:"/webadmin/script?command="; http_uri; fast_pattern; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:url,unit42.paloaltonetworks.com/new-mirai-variant-adds-8-new-exploits-targets-additional-iot-devices/; reference:cve,CVE-2017-14135; classtype:attempted-admin; sid:1076171; rev:2; metadata:attack_target IoT, deployment Perimeter, signature_severity Major, created_at 2019_06_11, performance_impact Low, updated_at 2019_06_11; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Attempted Remote Command Injection Inbound (CVE-2018-7841) (attempted-admin) - detector_id: 76173 original_sid: 2027455
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET EXPLOIT Attempted Remote Command Injection Inbound (CVE-2018-7841)"; flow:established,to_server; content:"POST"; http_method; content:"/track_import_export.php"; http_uri; fast_pattern; isdataat:!1,relative; content:"op="; http_client_body; depth:3; content:"&object_id=|60|"; http_client_body; distance:0; within:100; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:url,unit42.paloaltonetworks.com/new-mirai-variant-adds-8-new-exploits-targets-additional-iot-devices/; classtype:attempted-admin; sid:1076173; rev:1; metadata:deployment Perimeter, cve 2018_7841, signature_severity Major, created_at 2019_06_11, performance_impact Low, updated_at 2019_06_11; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Dell KACE Attempted Remote Command Injection Inbound (attempted-admin) - detector_id: 76175 original_sid: 2027457
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET EXPLOIT Dell KACE Attempted Remote Command Injection Inbound"; flow:established,to_server; content:"POST"; http_method; content:"/krashrpt.php"; http_uri; fast_pattern; isdataat:!1,relative; content:"kuid=|60|"; http_client_body; depth:6; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:url,unit42.paloaltonetworks.com/new-mirai-variant-adds-8-new-exploits-targets-additional-iot-devices/; reference:cve,CVE-2018-11138; classtype:attempted-admin; sid:1076175; rev:2; metadata:attack_target IoT, deployment Perimeter, signature_severity Major, created_at 2019_06_11, performance_impact Low, updated_at 2019_06_11; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Geutebruck Attempted Remote Command Injection Inbound (attempted-admin) - detector_id: 76177 original_sid: 2027459
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET EXPLOIT Geutebruck Attempted Remote Command Injection Inbound"; flow:established,to_server; content:"POST"; http_method; content:"/testaction.cgi"; http_uri; isdataat:!1,relative; content:"ip|3a 20|eth0|20|1.1.1.1|3b|"; http_header; fast_pattern; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:url,unit42.paloaltonetworks.com/new-mirai-variant-adds-8-new-exploits-targets-additional-iot-devices/; reference:cve,CVE-2017-5173; classtype:attempted-admin; sid:1076177; rev:2; metadata:attack_target IoT, deployment Perimeter, signature_severity Major, created_at 2019_06_11, performance_impact Low, updated_at 2019_06_11; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Hootoo TripMate Attempted Remote Command Injection Inbound (attempted-admin) - detector_id: 76179 original_sid: 2027461
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET EXPLOIT Hootoo TripMate Attempted Remote Command Injection Inbound"; flow:established,to_server; content:"POST"; http_method; content:"/protocol.csp?function="; http_uri; depth:23; fast_pattern; content:"&mac=|7c|"; http_uri; distance:0; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:url,unit42.paloaltonetworks.com/new-mirai-variant-adds-8-new-exploits-targets-additional-iot-devices/; reference:cve,CVE-2018-20841; classtype:attempted-admin; sid:1076179; rev:2; metadata:attack_target IoT, deployment Perimeter, signature_severity Major, created_at 2019_06_11, performance_impact Low, updated_at 2019_06_11; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Belkin Wemo Enabled Crock-Pot Unauthenticated Command Injection Inbound (CVE-2019-12780) (attempted-admin) - detector_id: 76244 original_sid: 2027486
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET EXPLOIT Belkin Wemo Enabled Crock-Pot Unauthenticated Command Injection Inbound (CVE-2019-12780)"; flow:established,to_server; content:"POST"; http_method; content:"/upnp/control/basicevent1"; http_uri; depth:25; isdataat:!1,relative; content:"SOAPAction|3a 20|"; http_header; content:"urn|3a|Belkin|3a|service|3a|basicevent|3a|1|23|SetSmartDevInfo"; http_header; distance:0; within:48; fast_pattern; content:"|3c|SmartDevURL|3e 60|"; http_client_body; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:cve,CVE-2019-12780; reference:md5,d6ebabf44849951d754ee2de15a24b92; reference:url,blogs.akamai.com/sitr/2019/06/latest-echobot-26-infection-vectors.html; classtype:attempted-admin; sid:1076244; rev:1; metadata:attack_target IoT, deployment Perimeter, signature_severity Major, created_at 2019_06_18, performance_impact Low, updated_at 2019_06_18; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT MiCasaVerde VeraLite - Remote Code Execution Inbound (CVE-2016-6255) (attempted-admin) - detector_id: 76247 original_sid: 2027489
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET EXPLOIT MiCasaVerde VeraLite - Remote Code Execution Inbound (CVE-2016-6255)"; flow:established,to_server; content:"POST"; http_method; content:"/upnp/control/hag"; http_uri; depth:17; isdataat:!1,relative; fast_pattern; content:"SOAPAction|3a 20|"; http_header; content:"urn|3a|schemas-micasaverde-org|3a|service|3a|HomeAutomationGateway|3a|1|23|RunLua"; http_header; distance:0; within:67; content:"|3c|Code|3e|os|2e|execute|28 60|"; http_client_body; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:cve,CVE-2019-12780; reference:md5,d6ebabf44849951d754ee2de15a24b92; reference:url,blogs.akamai.com/sitr/2019/06/latest-echobot-26-infection-vectors.html; classtype:attempted-admin; sid:1076247; rev:2; metadata:attack_target IoT, deployment Perimeter, signature_severity Major, created_at 2019_06_18, malware_family Mirai, performance_impact Low, updated_at 2019_06_18; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT FCM-MB40 Attempted Remote Command Execution as Root (attempted-admin) - detector_id: 91485 original_sid: 2027513
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET EXPLOIT FCM-MB40 Attempted Remote Command Execution as Root"; flow:established,to_server; content:"GET"; http_method; content:"/cgi-bin/camctrl_save_profile.cgi"; http_uri; depth:33; fast_pattern; content:"num="; http_uri; distance:0; content:"name="; http_uri; distance:0; content:"a|20|-e|20|s|2f 5e|"; http_uri; distance:0; content:"|20 2e 2e|/cgi-bin/ddns.cgi|20|"; http_uri; distance:0; content:"&save=profile"; http_uri; distance:0; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:url,xor.cat/2019/06/19/fortinet-forticam-vulns/; classtype:attempted-admin; sid:1091485; rev:2; metadata:attack_target IoT, deployment Perimeter, signature_severity Major, created_at 2019_06_24, performance_impact Low, updated_at 2019_06_24; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Apache Struts 2 REST Plugin Vulnerability (CVE-2017-9805) (attempted-user) - detector_id: 91497 original_sid: 2027516
alert http any any -> $HOME_NET any (msg:"ET EXPLOIT Apache Struts 2 REST Plugin Vulnerability (CVE-2017-9805)"; flow:to_server,established; content:"GET"; http_method; content:"/struts2"; http_uri; http_content_type; content:"|25 7b 28 23|"; isdataat:500,relative; content:"cmd.exe"; fast_pattern; content:"@java.lang.System@getProperty(|27|os.name|27|)"; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:cve,2017-9805; reference:url,forums.juniper.net/t5/Threat-Research/Anatomy-of-the-Bulehero-Cryptomining-Botnet/ba-p/458787; classtype:attempted-user; sid:1091497; rev:1; metadata:affected_product Apache_Struts2, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2019_06_26, performance_impact Moderate, updated_at 2019_06_26; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Tomcat File Upload Payload Request (CVE-2017-12615) (attempted-user) - detector_id: 91498 original_sid: 2027517
alert http any any -> $HOME_NET any (msg:"ET EXPLOIT Tomcat File Upload Payload Request (CVE-2017-12615)"; flow:to_server,established; content:"GET"; http_method; content:".jsp?wiew="; http_uri; fast_pattern; content:"&os="; http_uri; distance:0; content:"&address="; http_uri; distance:0; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:cve,2017-12615; reference:url,forums.juniper.net/t5/Threat-Research/Anatomy-of-the-Bulehero-Cryptomining-Botnet/ba-p/458787; classtype:attempted-user; sid:1091498; rev:1; metadata:deployment Perimeter, signature_severity Major, created_at 2019_06_26, performance_impact Moderate, updated_at 2019_06_26; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT ThinkPHP Attempted Bypass and Payload Retrieval (attempted-user) - detector_id: 91499 original_sid: 2027518
alert http any any -> $HOME_NET any (msg:"ET EXPLOIT ThinkPHP Attempted Bypass and Payload Retrieval"; flow:to_server,established; content:"GET"; http_method; content:"/public/hydra.php?xcmd=cmd.exe"; http_uri; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:url,forums.juniper.net/t5/Threat-Research/Anatomy-of-the-Bulehero-Cryptomining-Botnet/ba-p/458787; classtype:attempted-user; sid:1091499; rev:1; metadata:attack_target Server, deployment Perimeter, signature_severity Major, created_at 2019_06_26, performance_impact Moderate, updated_at 2019_06_26; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Possible Palo Alto SSL VPN sslmgr Format String Vulnerability (Inbound) (attempted-admin) - detector_id: 91851 original_sid: 2027723
alert http $EXTERNAL_NET any -> any any (msg:"ET EXPLOIT Possible Palo Alto SSL VPN sslmgr Format String Vulnerability (Inbound)"; flow:to_server,established; content:"POST"; http_method; content:"/sslmgr"; isdataat:!1,relative; nocase; http_uri; content:"scep-profile-name=%"; depth:19; http_client_body; fast_pattern; pcre:"/^[0-9]+/PR"; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; reference:url,blog.orange.tw/2019/07/attacking-ssl-vpn-part-1-preauth-rce-on-palo-alto.html; classtype:attempted-admin; sid:1091851; rev:2; metadata:attack_target Server, deployment Perimeter, signature_severity Major, created_at 2019_07_18, updated_at 2019_07_18; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Possible WebShell GIF Upload (attempted-admin) - detector_id: 91875 original_sid: 2027736
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET EXPLOIT Possible WebShell GIF Upload"; flow:established,to_server; content:"POST"; http_method; content:"GIF89a"; http_client_body; depth:6; content:"<%eval|20|request|28 22|"; http_client_body; distance:0; fast_pattern; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; classtype:attempted-admin; sid:1091875; rev:1; metadata:attack_target Web_Server, deployment Perimeter, tag WebShell, signature_severity Major, created_at 2019_07_22, performance_impact Low, updated_at 2019_07_22; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET EXPLOIT Possible WebShell JPEG Upload (attempted-admin) - detector_id: 91876 original_sid: 2027737
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET EXPLOIT Possible WebShell JPEG Upload"; flow:established,to_server; content:"POST"; http_method; content:"|FF D8 FF E0|"; http_client_body; depth:4; content:"JFIF"; http_client_body; distance:2; within:4; content:"<%eval|20|request|28 22|"; http_client_body; distance:0; fast_pattern; metadata:former_category EXPLOIT, flip_endpoints False, server_side True; classtype:attempted-admin; sid:1091876; rev:1; metadata:attack_target Web_Server, deployment Perimeter, tag WebShell, signature_severity Major, created_at 2019_07_22, performance_impact Low, updated_at 2019_07_22; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

