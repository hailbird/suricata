# Emerging Threats
#
# This distribution may contain rules under two different licenses.
#
#  Rules with sids 1 through 3464, and 100000000 through 100000908 are under the GPLv2.
#  A copy of that license is available at http://www.gnu.org/licenses/gpl-2.0.html
#
#  Rules with sids 2000000 through 2799999 are from Emerging Threats and are covered under the BSD License
#  as follows:
#
#*************************************************************
#  Copyright (c) 2003-2017, Emerging Threats
#  All rights reserved.
#
#  Redistribution and use in source and binary forms, with or without modification, are permitted provided that the
#  following conditions are met:
#
#  * Redistributions of source code must retain the above copyright notice, this list of conditions and the following
#    disclaimer.
#  * Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the
#    following disclaimer in the documentation and/or other materials provided with the distribution.
#  * Neither the name of the nor the names of its contributors may be used to endorse or promote products derived
#    from this software without specific prior written permission.
#
#  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY EXPRESS OR IMPLIED WARRANTIES,
#  INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
#  DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
#  SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
#  SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,
#  WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE
#  USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
#
#*************************************************************
#
#
#
#

# ET TROJAN HTran/SensLiceld.A response to infected host (trojan-activity) - detector_id: 2094 original_sid: 2013361
reject tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"ET TROJAN HTran/SensLiceld.A response to infected host"; flow:established,from_server; dsize:<80; content:"|5b|SERVER|5d|connection|20|to|20|"; depth:22; reference:url,www.secureworks.com/research/threats/htran/; reference:url,www.symantec.com/connect/blogs/truth-behind-shady-rat; reference:url,www.symantec.com/security_response/writeup.jsp?docid=2010-120716-4344-99&tabid=2; reference:url,www.securelist.com/en/descriptions/10120120/Trojan-Spy.Win32.Agent.bptu; classtype:trojan-activity; sid:1002094; rev:5; metadata:created_at 2011_08_04, updated_at 2011_08_04, flip_endpoints True, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET TROJAN Zbot UA (trojan-activity) - detector_id: 2596 original_sid: 2015780
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Zbot UA"; flow:established,to_server; content:"Windows NT 7.1"; http_user_agent; content:"Firefox/9.1.2"; http_user_agent; classtype:trojan-activity; sid:1002596; rev:5; metadata:created_at 2012_10_04, updated_at 2012_10_04, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN W32/Zbot.Variant Fake MSIE 6.0 UA (trojan-activity) - detector_id: 2900 original_sid: 2016509
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN W32/Zbot.Variant Fake MSIE 6.0 UA"; flow:to_server,established; content:".htm?"; fast_pattern:only; http_uri; content:"Mozilla/4.0 (compatible|3b| MSIE 6.0|3b| Windows NT 5.1|3b| SV1)"; http_user_agent; pcre:"/\/[a-z]\.htm\?[A-Za-z0-9]+$/U"; flowbits:set,ET.zbot.ua.2106509; classtype:trojan-activity; sid:1002900; rev:5; metadata:created_at 2013_02_26, updated_at 2013_02_26, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Asprox Form Submission to C&C (trojan-activity) - detector_id: 10351 original_sid: 2009054
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Asprox Form Submission to C&C"; flow:established,to_server; content:"POST"; nocase; http_method; content:"/forum.php"; http_uri; nocase; content:"Content-Type|3a| multipart/form-data|3b| boundary=1BEF0A57BE110FD467A"; http_header; reference:url,doc.emergingthreats.net/2009054; classtype:trojan-activity; sid:1010351; rev:8; metadata:created_at 2010_07_30, updated_at 2010_07_30, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Murlo Trojan Checkin (trojan-activity) - detector_id: 10658 original_sid: 2009442
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Murlo Trojan Checkin"; flow:to_server,established; content:"GET"; nocase; http_method; content:".asp?mac="; nocase; http_uri; pcre:"/mac=[a-f0-9]/iU"; content:"&ver="; nocase; http_uri; content:"&os="; nocase; http_uri; reference:url,doc.emergingthreats.net/2009442; classtype:trojan-activity; sid:1010658; rev:10; metadata:created_at 2010_07_30, updated_at 2010_07_30, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN W32.Virut.A joining an IRC Channel (trojan-activity) - detector_id: 10996 original_sid: 2003603
reject tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN W32.Virut.A joining an IRC Channel"; flow:established,to_server; content:"JOIN &virtu"; depth:27; reference:md5,06b522eacdfe51bed5d041fd672e880f; reference:url,doc.emergingthreats.net/2003603; classtype:trojan-activity; sid:1010996; rev:7; metadata:created_at 2010_07_30, updated_at 2010_07_30, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Avzhan DDOS Bot Outbound Hardcoded Malformed GET Request Denial Of Service Attack Detected (trojan-activity) - detector_id: 11130 original_sid: 2011585
alert http $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"ET TROJAN Avzhan DDOS Bot Outbound Hardcoded Malformed GET Request Denial Of Service Attack Detected"; flow:established,to_server; content:"GET ^&&%$%$^%$#^&**(*((&*^%$##$%^&*(*&^%$%^&*.htm"; depth:49; nocase; threshold: type limit, count 1, seconds 60, track by_src; reference:url,asert.arbornetworks.com/2010/09/another-family-of-ddos-bots-avzhan/; classtype:trojan-activity; sid:1011130; rev:3; metadata:created_at 2010_09_29, updated_at 2010_09_29, flip_endpoints False, server_side False; target:src_ip;)

# ET TROJAN Potential Blackhole Exploit Pack Binary Load Request (bad-unknown) - detector_id: 11157 original_sid: 2012169
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Potential Blackhole Exploit Pack Binary Load Request"; flow:established,to_server; content:".php?f="; fast_pattern; http_uri; content:"&e="; http_uri; content:!"Referer|3a|"; http_header; content:"User-Agent|3a|"; http_header; content:"Host|3a|"; http_header; distance:0; pcre:"/^[^?#]+?\.php\?f=\w+&e=\d+$/U"; flowbits:set,et.exploitkitlanding; reference:url,krebsonsecurity.com/2010/10/java-a-gift-to-exploit-pack-makers/; classtype:bad-unknown; sid:1011157; rev:9; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, tag Blackhole, tag Exploit_Kit, signature_severity Critical, created_at 2011_01_07, malware_family Blackhole, updated_at 2016_07_01, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN x0Proto Init (trojan-activity) - detector_id: 11164 original_sid: 2012236
reject tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"ET TROJAN x0Proto Init"; flow:established,from_server; dsize:2; content:"x0"; depth:2; flowbits:noalert; flowbits:set,et.x0proto; classtype:trojan-activity; sid:1011164; rev:2; metadata:created_at 2011_01_27, updated_at 2011_01_27, flip_endpoints True, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET TROJAN x0Proto Client Info (trojan-activity) - detector_id: 11165 original_sid: 2012237
reject tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN x0Proto Client Info"; flow:established,to_server; flowbits:isset,et.x0proto; dsize:<128; content:"x0|0c|"; depth:3; classtype:trojan-activity; sid:1011165; rev:2; metadata:created_at 2011_01_27, updated_at 2011_01_27, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN x0Proto Pong (trojan-activity) - detector_id: 11166 original_sid: 2012238
reject tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN x0Proto Pong"; flow:established,to_server; flowbits:isset,et.x0proto; dsize:9; content:"x53|0c|"; depth:4; content:"|0c|0|0c|1"; distance:1; within:4; classtype:trojan-activity; sid:1011166; rev:2; metadata:created_at 2011_01_27, updated_at 2011_01_27, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN x0Proto Ping (trojan-activity) - detector_id: 11167 original_sid: 2012239
reject tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"ET TROJAN x0Proto Ping"; flow:established,from_server; flowbits:isset,et.x0proto; dsize:7; content:"x53|0c|1|0c|0"; depth:7; classtype:trojan-activity; sid:1011167; rev:2; metadata:created_at 2011_01_27, updated_at 2011_01_27, flip_endpoints True, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET TROJAN SpyEye Checkin version 1.3.25 or later (trojan-activity) - detector_id: 11217 original_sid: 2012686
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN SpyEye Checkin version 1.3.25 or later"; flow:established,to_server; content:"POST"; nocase; http_method; content:"data=vK6yv+"; http_client_body; classtype:trojan-activity; sid:1011217; rev:4; metadata:created_at 2011_04_13, updated_at 2011_04_13, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Win32.Fareit.A/Pony Downloader Checkin (trojan-activity) - detector_id: 11226 original_sid: 2013934
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Win32.Fareit.A/Pony Downloader Checkin"; flow:to_server,established; content:"CRYPTED0"; depth:8; nocase; http_client_body; reference:url,www.microsoft.com/security/portal/Threat/Encyclopedia/Entry.aspx?Name=PWS%3aWin32%2fFareit.A; reference:url,www.microsoft.com/security/portal/Threat/Encyclopedia/Entry.aspx?Name=PWS%3aWin32%2fFareit; reference:url,www.threatexpert.com/report.aspx?md5=99fab94fd824737393f5184685e8edf2; reference:url,www.threatexpert.com/report.aspx?md5=9544c681ae5c4fe3fdbd4d5c6c90e38e; reference:url,www.threatexpert.com/report.aspx?md5=d50c39753ba88daa00bc40848f174168; reference:url,www.threatexpert.com/report.aspx?md5=bf422f3aa215d896f55bbe2ebcd25d17; classtype:trojan-activity; sid:1011226; rev:5; metadata:created_at 2011_05_19, updated_at 2011_05_19, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Backdoor.Win32.Xyligan Checkin (trojan-activity) - detector_id: 11230 original_sid: 2012842
reject tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Backdoor.Win32.Xyligan Checkin"; flow:to_server,established; dsize:16; content:"|00 00 00 11 C8 00 00 00|"; depth:8; reference:url,www.threatexpert.com/report.aspx?md5=bfbc0b106a440c111a42936906d36643; reference:url,www.threatexpert.com/report.aspx?md5=2190a2c0a3775bc9c60629ec2eb6f3b9; classtype:trojan-activity; sid:1011230; rev:3; metadata:created_at 2011_05_25, updated_at 2011_05_25, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN DarkComet-RAT init connection (trojan-activity) - detector_id: 11305 original_sid: 2013283
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"ET TROJAN DarkComet-RAT init connection"; flow:from_server,established; dsize:12; content:"|38 45 41 34 41 42 30 35 46 41 37 45|"; flowbits:set,ET.DarkCometJoin; reference:url,www.darkcomet-rat.com; reference:url,anubis.iseclab.org/?action=result&task_id=1a7326f61fef1ecb4ed4fbf3de3f3b8cb&format=txt; classtype:trojan-activity; sid:1011305; rev:4; metadata:created_at 2011_07_18, updated_at 2011_07_18, flip_endpoints True, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET TROJAN DarkComet-RAT server join acknowledgement (trojan-activity) - detector_id: 11306 original_sid: 2013284
reject tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN DarkComet-RAT server join acknowledgement"; flow:to_server,established; dsize:12; content:"|39 34 41 35 41 44 30 41 45 46 36 39|"; flowbits:isset,ET.DarkCometJoin; reference:url,www.darkcomet-rat.com; reference:url,anubis.iseclab.org/?action=result&task_id=1a7326f61fef1ecb4ed4fbf3de3f3b8cb&format=txt; classtype:trojan-activity; sid:1011306; rev:3; metadata:created_at 2011_07_18, updated_at 2011_07_18, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN DarkComet-RAT Client Keepalive (trojan-activity) - detector_id: 11307 original_sid: 2013285
reject tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN DarkComet-RAT Client Keepalive"; flow:to_server,established; dsize:12; content:"|39 34 41 35 41 44 30 41 45 46 36 39|"; flowbits:isset,ET.DarkCometJoin; reference:url,www.darkcomet-rat.com; classtype:trojan-activity; sid:1011307; rev:2; metadata:created_at 2011_07_18, updated_at 2011_07_18, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Win32.Glupteba/ClIEcker CnC Checkin (trojan-activity) - detector_id: 11312 original_sid: 2013293
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Win32.Glupteba/ClIEcker CnC Checkin"; flow:established,to_server; content:"&downlink="; http_uri; content:"&uplink="; http_uri; content:"&id="; http_uri; content:"&statpass="; fast_pattern:only; http_uri; content:"&version="; http_uri; content:"&features="; http_uri; content:"&guid="; http_uri; content:"&comment="; http_uri; metadata:former_category TROJAN, flip_endpoints False, server_side False; reference:url,blog.eset.com/2011/03/02/tdl4-and-glubteba-piggyback-piggybugs; classtype:trojan-activity; sid:1011312; rev:4; metadata:created_at 2011_07_19, updated_at 2018_02_07; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Win32/Xtrat.A Checkin (trojan-activity) - detector_id: 11545 original_sid: 2016275
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Win32/Xtrat.A Checkin"; flow:established,to_server; content:".functions"; http_uri; fast_pattern; isdataat:!1,relative; pcre:"/^\/\d+\.functions$/U"; content:!"microsoft.com"; http_host; http_header_names; content:!"Referer"; reference:url,threatexpert.com/report.aspx?md5=f45b1b82c849fbbea3374ae7e9200092; classtype:trojan-activity; sid:1011545; rev:10; metadata:created_at 2011_12_12, updated_at 2011_12_12, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN UPDATE Protocol Trojan Communication detected on http ports 2 (trojan-activity) - detector_id: 11617 original_sid: 2014232
reject http $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"ET TROJAN UPDATE Protocol Trojan Communication detected on http ports 2"; flow:to_server,established; content:"POST"; nocase; http_method; content:"/update?id="; http_uri; content:"X-Status|3A|"; http_header; content:"X-Size|3A|"; http_header; content:"X-Sn|3A|"; http_header; fast_pattern; classtype:trojan-activity; sid:1011617; rev:3; metadata:created_at 2012_02_16, updated_at 2012_02_16, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Fareit/Pony Downloader Checkin 3 (trojan-activity) - detector_id: 11618 original_sid: 2014234
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Fareit/Pony Downloader Checkin 3"; flow:established,to_server; content:"GET"; http_method; content:"Mozilla/4.0 (compatible|3b 20|MSIE 5.0"; depth:33; http_user_agent; content:"Windows 98)"; http_user_agent; fast_pattern; distance:0; isdataat:!1,relative; http_accept; content:"*/*"; http_connection; content:"close"; http_header_names; content:"|0d 0a|Host|0d 0a|"; depth:8; content:"|0d 0a|Connection|0d 0a|User-Agent|0d 0a|"; flowbits:set,ET.Fareit.chk; reference:md5,dcc2c110e509fa777ab1460f665bd137; reference:url,www.threatexpert.com/report.aspx?md5=9544c681ae5c4fe3fdbd4d5c6c90e38e; reference:url,www.threatexpert.com/report.aspx?md5=d50c39753ba88daa00bc40848f174168; reference:url,www.threatexpert.com/report.aspx?md5=bf422f3aa215d896f55bbe2ebcd25d17; classtype:trojan-activity; sid:1011618; rev:11; metadata:created_at 2012_02_17, updated_at 2012_02_17, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN IRC Bot Download http Command (trojan-activity) - detector_id: 11672 original_sid: 2014439
reject tcp $EXTERNAL_NET !6661:6668 -> $HOME_NET any (msg:"ET TROJAN IRC Bot Download http Command"; flow:established,from_server; content:"JOIN |3a|#"; nocase; content:"dl|20|http|3a 2f 2f|"; distance:0; content:"|2e|exe"; distance:0; reference:md5,fa6ae89b101a0367cc98798c7333e3a4; classtype:trojan-activity; sid:1011672; rev:4; metadata:created_at 2012_03_28, updated_at 2012_03_28, flip_endpoints True, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET TROJAN OSX/Flashback.K/I User-Agent (trojan-activity) - detector_id: 11686 original_sid: 2014534
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN OSX/Flashback.K/I User-Agent"; flow:established,to_server; content:" WOW64|3b| rv|3a|9.0.1|3b| sv|3a|"; http_header; content:" id|3a|"; http_header; within:6; reference:url,f-secure.com/v-descs/trojan-downloader_osx_flashback_k.shtml; reference:url,vms.drweb.com/virus/?i=1816029; reference:url,f-secure.com/v-descs/trojan-downloader_osx_flashback_i.shtml; classtype:trojan-activity; sid:1011686; rev:4; metadata:created_at 2012_04_05, updated_at 2012_04_05, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Metasploit Meterpreter stdapi_* Command Request (successful-user) - detector_id: 11689 original_sid: 2014530
reject tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"ET TROJAN Metasploit Meterpreter stdapi_* Command Request"; flow:established; content:"|00 01 00 01|stdapi_"; offset:12; depth:11; classtype:successful-user; sid:1011689; rev:3; metadata:affected_product Any, attack_target Client_and_Server, deployment Perimeter, deployment Internet, deployment Internal, deployment Datacenter, tag Metasploit, signature_severity Critical, created_at 2012_04_06, updated_at 2016_07_01, flip_endpoints True, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET TROJAN Metasploit Meterpreter core_channel_* Command Request (successful-user) - detector_id: 11690 original_sid: 2014531
reject tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"ET TROJAN Metasploit Meterpreter core_channel_* Command Request"; flow:established; content:"|00 01 00 01|core_channel_"; offset:12; depth:17; classtype:successful-user; sid:1011690; rev:4; metadata:affected_product Any, attack_target Client_and_Server, deployment Perimeter, deployment Internet, deployment Internal, deployment Datacenter, tag Metasploit, signature_severity Critical, created_at 2012_04_06, updated_at 2016_07_01, flip_endpoints True, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET TROJAN Metasploit Meterpreter stdapi_* Command Response (successful-user) - detector_id: 11691 original_sid: 2014532
reject tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Metasploit Meterpreter stdapi_* Command Response"; flow:established; content:"|00 01 00 01|stdapi_"; offset:11; depth:11; classtype:successful-user; sid:1011691; rev:3; metadata:affected_product Any, attack_target Client_and_Server, deployment Perimeter, deployment Internet, deployment Internal, deployment Datacenter, tag Metasploit, signature_severity Critical, created_at 2012_04_06, updated_at 2016_07_01, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Metasploit Meterpreter core_channel_* Command Response (successful-user) - detector_id: 11692 original_sid: 2014533
reject tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Metasploit Meterpreter core_channel_* Command Response"; flow:established; content:"|00 01 00 01|core_channel_"; offset:11; depth:17; classtype:successful-user; sid:1011692; rev:4; metadata:affected_product Any, attack_target Client_and_Server, deployment Perimeter, deployment Internet, deployment Internal, deployment Datacenter, tag Metasploit, signature_severity Critical, created_at 2012_04_06, updated_at 2016_07_01, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Pony Downloader HTTP Library MSIE 5 Win98 (trojan-activity) - detector_id: 11694 original_sid: 2014562
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Pony Downloader HTTP Library MSIE 5 Win98"; flow:established,to_server; content:"Mozilla/4.0|20|(compatible|3b 20|MSIE 5.0|3b 20|Windows 98)"; http_user_agent; fast_pattern:25,20; content:"*|3b|q=0"; http_header; content:"HTTP/1.0|0d 0a|Host|3a 20|"; classtype:trojan-activity; sid:1011694; rev:3; metadata:created_at 2012_04_13, updated_at 2012_04_13, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Pony Downloader check-in response STATUS-IMPORT-OK (trojan-activity) - detector_id: 11695 original_sid: 2014563
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET TROJAN Pony Downloader check-in response STATUS-IMPORT-OK"; flow:established,from_server; file_data; content:"STATUS-IMPORT-OK"; within:16; classtype:trojan-activity; sid:1011695; rev:3; metadata:created_at 2012_04_13, updated_at 2012_04_13, flip_endpoints True, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET TROJAN Win32/Nitol.A Checkin (trojan-activity) - detector_id: 11704 original_sid: 2014600
reject tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Win32/Nitol.A Checkin"; flow:from_client,established; dsize:1028; content:"|01 00 00 00|"; depth:4; content:!"|00|"; distance:0; within:1; content:"|00|"; distance:1; within:1; content:"|00|"; distance:61; within:1; content:"|00 00 00 00 00|Windows|20|"; fast_pattern; distance:0; content:"|00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00|"; distance:0; content:"|00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00|"; distance:12; within:20; classtype:trojan-activity; sid:1011704; rev:6; metadata:created_at 2012_04_17, updated_at 2012_04_17, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN FakeM RAT CnC Beacon (trojan-activity) - detector_id: 11712 original_sid: 2014636
reject tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN FakeM RAT CnC Beacon"; flow:established,to_server; content:"<html><title>"; depth:13; content:"</title><body>"; within:48; content:!"</body>"; content:"|f6 f6 f6 f6 f6 f6 f6 f6 f6 f6 f6 f6 f6 f6 f6 f6 f6 f6 f6 f6|"; distance:0; reference:md5,3e008471eaa5e788c41c2a0dff3d1a89; classtype:trojan-activity; sid:1011712; rev:5; metadata:created_at 2012_04_25, updated_at 2012_04_25, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Trojan.APT.9002 CnC Traffic (trojan-activity) - detector_id: 11760 original_sid: 2016398
reject tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Trojan.APT.9002 CnC Traffic"; flow:to_server,established; dsize:24; content:"|0c 00 00 00 08 00 00 00 19 ff ff ff ff 00 00 00 00 11 00 00|"; offset:4; depth:20; reference:md5,81687637b7bf2b90258a5006683e781c; reference:url,www.fireeye.com/blog/technical/cyber-exploits/2013/08/the-sunshop-campaign-continues.html; classtype:trojan-activity; sid:1011760; rev:8; metadata:created_at 2012_06_28, updated_at 2012_06_28, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN ZeroAccess Outbound udp traffic detected (trojan-activity) - detector_id: 11776 original_sid: 2015482
reject udp $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN ZeroAccess Outbound udp traffic detected"; content:"|28 94 8d ab c9 c0 d1 99|"; offset:4; depth:8; dsize:16; threshold: type both, track by_src, count 10, seconds 600; classtype:trojan-activity; sid:1011776; rev:8; metadata:created_at 2012_07_16, updated_at 2012_07_16, flip_endpoints False, server_side False; target:src_ip;)

# ET TROJAN Dorkbot GeoIP Lookup to wipmania (trojan-activity) - detector_id: 11823 original_sid: 2015800
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Dorkbot GeoIP Lookup to wipmania"; flow:to_server,established; content:"Mozilla/4.0"; http_user_agent; depth:11; isdataat:!1,relative; content:"api.wipmania.com"; http_host; fast_pattern; http_header_names; content:"|0d 0a|User-Agent|0d 0a|Host|0d 0a 0d 0a|"; depth:22; classtype:trojan-activity; sid:1011823; rev:8; metadata:created_at 2012_10_12, updated_at 2012_10_12, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Taidoor Checkin (trojan-activity) - detector_id: 11828 original_sid: 2015808
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Taidoor Checkin"; urilen:32; content:".php?id="; http_uri; offset:6; depth:8; pcre:"/^[A-Z0-9]{18}$/UR"; content:"MSIE 6.0|3b|"; http_user_agent; reference:md5,f4b8b51b75f67e68d0c1a9639e2488c3; classtype:trojan-activity; sid:1011828; rev:6; metadata:created_at 2012_10_17, updated_at 2012_10_17, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Andromeda Check-in Response (trojan-activity) - detector_id: 11852 original_sid: 2015896
reject tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET TROJAN Andromeda Check-in Response"; flow:established,to_client; content:"Content-Length|3a| 9|0d 0a|"; http_header; file_data; content:"|6C 95 32 CB|"; within:4; metadata:former_category TROJAN, flip_endpoints True, server_side False; classtype:trojan-activity; sid:1011852; rev:3; metadata:created_at 2012_11_19, updated_at 2017_10_09; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET TROJAN W32/Dexter Infostealer CnC POST (trojan-activity) - detector_id: 11873 original_sid: 2016095
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN W32/Dexter Infostealer CnC POST"; flow:established,to_server; content:"POST"; http_method; content:"page="; http_client_body; depth:5; content:"&spec="; distance:0; http_client_body; content:"&opt="; distance:0; http_client_body; content:"var="; distance:0; http_client_body; content:"val="; distance:0; http_client_body; reference:url,contagiodump.blogspot.co.uk/2012/12/dexter-pos-infostealer-samples-and.html; classtype:trojan-activity; sid:1011873; rev:2; metadata:created_at 2012_12_27, updated_at 2012_12_27, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN DNS Reply Sinkhole - Microsoft - 199.2.137.0/24 (trojan-activity) - detector_id: 11876 original_sid: 2016102
alert udp $EXTERNAL_NET 53 -> $HOME_NET any (msg:"ET TROJAN DNS Reply Sinkhole - Microsoft - 199.2.137.0/24"; content:"|00 01 00 01|"; content:"|00 04 c7 02 89|"; distance:4; within:5; classtype:trojan-activity; sid:1011876; rev:2; metadata:created_at 2012_12_27, updated_at 2012_12_27, flip_endpoints True, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET TROJAN Sakula/Mivast RAT CnC Beacon 1 (trojan-activity) - detector_id: 11885 original_sid: 2016139
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Sakula/Mivast RAT CnC Beacon 1"; flow:established,to_server; content:".asp?imageid="; http_uri; fast_pattern; http_header_names; content:!"Content-Type"; content:!"Accept-"; content:!"Referer"; reference:md5,3cd598e8e2fd033134d8784251eff59e; classtype:trojan-activity; sid:1011885; rev:5; metadata:created_at 2013_01_03, updated_at 2013_01_03, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Generic -POST To gate.php w/Extended ASCII Characters (Likely Zeus Derivative) (bad-unknown) - detector_id: 11892 original_sid: 2016173
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Generic -POST To gate.php w/Extended ASCII Characters (Likely Zeus Derivative)"; flow:established,to_server; content:"POST"; http_method; content:"/gate.php"; http_uri; pcre:"/^.{0,3}[\x80-\xff]{1,3}[\x00-\x7f]{1,3}[\x80-\xff]{1,3}[\x80-\xff]{1,3}[\x00-\x7f]{1,3}[\x80-\xff]{1,3}[\x00-\x7f]{1,3}/P"; http_header_names; content:!"Referer"; classtype:bad-unknown; sid:1011892; rev:9; metadata:created_at 2013_01_08, updated_at 2013_01_08, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN WEBC2-UGX User-Agent (Windows+NT+5.x) APT1 (trojan-activity) - detector_id: 11991 original_sid: 2016471
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN WEBC2-UGX User-Agent (Windows+NT+5.x) APT1"; flow:established,to_server; content:"Windows+NT+5"; http_user_agent; depth:12; flowbits:set,ET.webc2ugx; reference:url,www.mandiant.com/apt1; classtype:trojan-activity; sid:1011991; rev:3; metadata:created_at 2013_02_21, updated_at 2013_02_21, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN WEBC2-UGX Embedded CnC Response APT1 (trojan-activity) - detector_id: 11992 original_sid: 2016472
reject http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET TROJAN WEBC2-UGX Embedded CnC Response APT1"; flow:established,from_server; flowbits:isset,ET.webc2ugx; file_data; content:"<!-- dW"; within:20; reference:md5,ae45648a8fc01b71214482d35cf8da54; reference:url,www.mandiant.com/apt1; classtype:trojan-activity; sid:1011992; rev:2; metadata:created_at 2013_02_21, updated_at 2013_02_21, flip_endpoints True, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET TROJAN Dorkbot Loader Payload Request (trojan-activity) - detector_id: 22242 original_sid: 2016578
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Dorkbot Loader Payload Request"; flow:established,to_server; content:"Mozilla/4.0|0D 0A|Host|3a|"; http_header; content:".exe"; http_uri; fast_pattern; urilen:<11; reference:md5,3452c20fd0df69ccfdea520a6515208a; classtype:trojan-activity; sid:1022242; rev:5; metadata:created_at 2013_03_15, updated_at 2013_03_15, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN [CrowdStrike] ANCHOR PANDA Torn RAT Beacon Message (trojan-activity) - detector_id: 22251 original_sid: 2016660
reject tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN [CrowdStrike] ANCHOR PANDA Torn RAT Beacon Message"; dsize:200; flow:to_server,established; flowbits:isset,ET.Torn.toread_header; content:"|40 7e 7e 7e|"; offset:196; depth:4; reference:url,blog.crowdstrike.com/whois-anchor-panda/index.html; classtype:trojan-activity; sid:1022251; rev:2; metadata:created_at 2013_03_22, updated_at 2013_03_22, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Alina Checkin (trojan-activity) - detector_id: 22714 original_sid: 2016837
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Alina Checkin"; flow:established,to_server; content:"POST"; nocase; http_method; content:".php"; http_uri; content:"Alina v"; http_user_agent; content:"act="; http_client_body; content:"&b="; http_client_body; content:"&c="; http_client_body; content:"&v="; http_client_body; reference:url,blog.spiderlabs.com/2013/05/alina-shedding-some-light-on-this-malware-family.html; classtype:trojan-activity; sid:1022714; rev:6; metadata:created_at 2013_05_09, updated_at 2013_05_09, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Alina User-Agent(Alina) (trojan-activity) - detector_id: 22715 original_sid: 2016838
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Alina User-Agent(Alina)"; flow:established,to_server; content:"POST"; nocase; http_method; content:"Alina v"; depth:7; http_user_agent; nocase; reference:url,blog.spiderlabs.com/2013/05/alina-shedding-some-light-on-this-malware-family.html; classtype:trojan-activity; sid:1022715; rev:5; metadata:created_at 2013_05_09, updated_at 2013_05_09, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Possible W32/Citadel Download From CnC Server Self Referenced /files/ attachment (trojan-activity) - detector_id: 22743 original_sid: 2016742
reject http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET TROJAN Possible W32/Citadel Download From CnC Server Self Referenced /files/ attachment"; flow:established,to_client; content:" filename=|22|%2e/files/"; nocase; http_header; pcre:"/\sfilename=\x22\%2e\/files\/[^\x22\x2f\r\n]+?\x22\r\n/H"; reference:url,malwaremustdie.blogspot.co.uk/2013/04/wireshark-analysis-of-citadel-trojan.html; reference:url,seifreed.es/docs/Citadel%20Trojan%20Report_eng.pdf; classtype:trojan-activity; sid:1022743; rev:6; metadata:created_at 2013_04_09, updated_at 2013_04_09, flip_endpoints True, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET TROJAN W32/Nymaim Checkin (2) (trojan-activity) - detector_id: 22748 original_sid: 2016757
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN W32/Nymaim Checkin (2)"; flow:to_server,established; content:"POST"; http_method; content:"Content-Type|3a| application/x-www-form-urlencoded|0d 0a|"; http_header; nocase; content:" MSIE "; http_user_agent; content:"filename="; depth:9; http_client_body; fast_pattern; content:"&data="; distance:0; http_client_body; content:!"Referer"; http_header; pcre:"/^filename=[a-z]+?\.[a-z]+?&data=/P"; classtype:trojan-activity; sid:1022748; rev:10; metadata:created_at 2013_04_15, updated_at 2013_04_15, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Medfos Connectivity Check (misc-activity) - detector_id: 22758 original_sid: 2016800
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Medfos Connectivity Check"; flow:established,to_server; content:"/uploading/id="; http_uri; fast_pattern:only; content:!"Referer|3a 20|"; http_header; pcre:"/^\/uploading\/id=\d{2,20}&u=(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{4})$/I"; classtype:misc-activity; sid:1022758; rev:6; metadata:created_at 2013_04_30, updated_at 2013_04_30, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Known Sinkhole Response Header (trojan-activity) - detector_id: 22759 original_sid: 2016803
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET TROJAN Known Sinkhole Response Header"; flow:established,to_client; content:"X-Sinkhole|3a| "; http_header; nocase; classtype:trojan-activity; sid:1022759; rev:4; metadata:created_at 2013_04_30, updated_at 2013_04_30, flip_endpoints True, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET TROJAN Possible Win32.Bicololo Checkin (trojan-activity) - detector_id: 22811 original_sid: 2016946
alert http $HOME_NET any -> $EXTERNAL_NET !80 (msg:"ET TROJAN Possible Win32.Bicololo Checkin"; flow:established,to_server; content:"GET"; http_method; content:"/stat/"; nocase; http_uri; pcre:"/^\/stat\/[a-z]{3,4}\/\d{1,4}$/U"; flowbits:set,ET.Bicololo.Request; reference:md5,252c95327ce556a21bdd7e9a322e206c; reference:url,www.virusradar.com/Win32_Bicololo.A/description; classtype:trojan-activity; sid:1022811; rev:3; metadata:created_at 2013_05_31, updated_at 2013_05_31, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Win32.Bicololo Response 1 (trojan-activity) - detector_id: 22812 original_sid: 2016947
reject http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET TROJAN Win32.Bicololo Response 1"; flow:established,to_client; content:"ci_session="; http_cookie; file_data; content:"ne_unik"; fast_pattern; within:7; isdataat:!1,relative; reference:md5,691bd07048b09c73f0a979529a66f6e3; classtype:trojan-activity; sid:1022812; rev:2; metadata:created_at 2013_05_31, updated_at 2013_05_31, flip_endpoints True, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET TROJAN Win32.Bicololo Response 2 (trojan-activity) - detector_id: 22813 original_sid: 2016948
reject http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET TROJAN Win32.Bicololo Response 2"; flow:established,to_client; flowbits:isset,ET.Bicololo.Request; content:"ci_session="; http_cookie; fast_pattern; file_data; content:"ok"; depth:2; isdataat:!1,relative; reference:md5,691bd07048b09c73f0a979529a66f6e3; classtype:trojan-activity; sid:1022813; rev:3; metadata:created_at 2013_05_31, updated_at 2019_06_14, flip_endpoints True, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET TROJAN Alina Server Response Code (trojan-activity) - detector_id: 22826 original_sid: 2016991
reject http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET TROJAN Alina Server Response Code"; flow:established,from_server; content:" 666 OK|0d 0a|"; fast_pattern:only; content:"666"; http_stat_code; nocase; reference:url,blog.spiderlabs.com/2013/05/alina-shedding-some-light-on-this-malware-family.html; reference:md5,7d6ec042a38d108899c8985ed7417e4a; classtype:trojan-activity; sid:1022826; rev:4; metadata:created_at 2013_06_07, updated_at 2013_06_07, flip_endpoints True, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET TROJAN W32.Berbew Check-in (trojan-activity) - detector_id: 30678 original_sid: 2017128
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN W32.Berbew Check-in"; flow:to_server,established; content:"POST"; http_method; content:".NET CLR 00000000"; http_user_agent; metadata:former_category TROJAN, flip_endpoints False, server_side False; classtype:trojan-activity; sid:1030678; rev:7; metadata:created_at 2013_07_10, updated_at 2018_07_16; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Win32/Kelihos.F Checkin (trojan-activity) - detector_id: 40408 original_sid: 2017191
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Win32/Kelihos.F Checkin"; flow:established,to_server; content:"GET"; http_method; urilen:<13; content:".htm"; fast_pattern:only; http_uri; pcre:"/^\/[^\x2f]+?\.htm$/U"; content:!"BridgitAgent"; http_user_agent; content:!"Accept"; http_header; content:!"Referer"; http_header; content:!"Content-Type"; http_header; content:"Content-Length|3a 20|"; http_header; content:!"0|0d 0a|"; within:3; http_header; content:"|0d 0a|"; distance:0; http_header; reference:md5,00db349caf2eefc3be5ee30b8b8947a2; classtype:trojan-activity; sid:1040408; rev:3; metadata:created_at 2013_07_24, updated_at 2013_07_24, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN W32/DirCrypt.Ransomware CnC Checkin (trojan-activity) - detector_id: 40462 original_sid: 2017308
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN W32/DirCrypt.Ransomware CnC Checkin"; flow:established,to_server; content:"POST"; http_method; content:"Content-Disposition|3A| form-data|3B| name=|22|cmd|22|"; http_client_body; content:"Content-Disposition|3A| form-data|3B| name=|22|botid|22|"; http_client_body; fast_pattern:24,20; content:"Content-Disposition|3A| form-data|3B| name=|22|lid|22|"; http_client_body; reference:url,anubis.iseclab.org/?action=result&task_id=19e3b6cbfdf8d6bd429ecc75ed016fb91; reference:url,blog.avast.com/2013/11/21/ransomware-annoys-its-victims-by-displaying-child-pornography-pictures/#more-20393; reference:url,blog.avast.com/2013/10/24/what-to-do-if-your-computer-is-attacked-by-ransomware/; reference:url,johannesbader.ch/2015/03/the-dga-of-dircrypt; classtype:trojan-activity; sid:1040462; rev:3; metadata:created_at 2013_08_12, updated_at 2013_08_12, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN DDoS.Win32.Agent.bay Covert Channel (VERSONEX and Mr.Black) (trojan-activity) - detector_id: 40468 original_sid: 2017315
reject ip $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN DDoS.Win32.Agent.bay Covert Channel (VERSONEX and Mr.Black)"; content:"VERSONEX|3a|"; depth:64; fast_pattern; content:"Mr.Black"; within:50; classtype:trojan-activity; sid:1040468; rev:2; metadata:created_at 2013_08_12, updated_at 2013_08_12, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Trojan Related Lame Updater User-Agent (trojan-activity) - detector_id: 40571 original_sid: 2017347
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Trojan Related Lame Updater User-Agent"; flow:established,to_server; content:"LameUpdater"; depth:11; http_user_agent; classtype:trojan-activity; sid:1040571; rev:4; metadata:created_at 2011_04_07, updated_at 2011_04_07, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Win32.Troj.Cidox Checkin (trojan-activity) - detector_id: 40572 original_sid: 2017349
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Win32.Troj.Cidox Checkin"; flow:established,to_server; content:".php?sign="; fast_pattern:only; http_uri; content:"&key="; http_uri; content:"&av="; http_uri; content:"&os="; http_uri; content:"&vm="; http_uri; content:"&digital="; http_uri; reference:md5,0ce7f9dde5c273d7e71c9f1301fe505d; classtype:trojan-activity; sid:1040572; rev:3; metadata:created_at 2013_05_14, updated_at 2013_05_14, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN PoisonIvy.th3bug Keepalive to CnC (trojan-activity) - detector_id: 40582 original_sid: 2017351
reject tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN PoisonIvy.th3bug Keepalive to CnC"; flow:established,to_server; content:"|35 d1 50 14 94 b2 24 ac 9b 00 2e f1 99 a0 82 4d|"; offset:16; depth:16; dsize:48; reference:url,www.fireeye.com/resources/pdfs/fireeye-poison-ivy-report.pdf; classtype:trojan-activity; sid:1040582; rev:2; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, tag PoisonIvy, signature_severity Critical, created_at 2013_08_21, malware_family PoisonIvy, updated_at 2016_07_01, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Bladabindi/njrat CnC Keep-Alive (INBOUND) (trojan-activity) - detector_id: 40902 original_sid: 2017417
reject tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"ET TROJAN Bladabindi/njrat CnC Keep-Alive (INBOUND)"; flow:from_server,established; content:"P[endof]"; dsize:8; reference:md5,0ae2261385c482d55519be9b0e4afef3; reference:url,anubis.iseclab.org/?action=result&task_id=1043e1f5f61319b944d51d0d6d7e23f2e; reference:md5,41a0a4c0831dbcbbfd877c7d37b671e0; reference:url,www.fireeye.com/blog/technical/botnet-activities-research/2012/09/the-story-behind-backdoorlv.html; classtype:trojan-activity; sid:1040902; rev:9; metadata:created_at 2012_07_30, updated_at 2012_07_30, flip_endpoints True, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET TROJAN Bladabindi/njrat CnC Keep-Alive (OUTBOUND) (trojan-activity) - detector_id: 40904 original_sid: 2017418
reject tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Bladabindi/njrat CnC Keep-Alive (OUTBOUND)"; flow:to_server,established; content:"P[endof]"; dsize:8; reference:url,threatgeek.com/2013/07/njrat-detection-rules-using-yara-.html; classtype:trojan-activity; sid:1040904; rev:2; metadata:created_at 2013_09_05, updated_at 2013_09_05, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Bladabindi/njrat CnC Command (File Manager) (trojan-activity) - detector_id: 40906 original_sid: 2017420
reject tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"ET TROJAN Bladabindi/njrat CnC Command (File Manager)"; flow:from_server,established; content:"FM|7c 27 7c 27 7c|"; depth:7; dsize:>0; reference:url,threatgeek.com/2013/07/njrat-detection-rules-using-yara-.html; classtype:trojan-activity; sid:1040906; rev:2; metadata:created_at 2013_09_05, updated_at 2013_09_05, flip_endpoints True, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET TROJAN Bladabindi/njrat CnC Command Response (File Manager) (trojan-activity) - detector_id: 40907 original_sid: 2017421
reject tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Bladabindi/njrat CnC Command Response (File Manager)"; flow:to_server,established; content:"rn|7c 27 7c 27 7c|"; depth:7; dsize:>0; reference:url,threatgeek.com/2013/07/njrat-detection-rules-using-yara-.html; classtype:trojan-activity; sid:1040907; rev:2; metadata:created_at 2013_09_05, updated_at 2013_09_05, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Bladabindi/njrat CnC Command (Remote Desktop) (trojan-activity) - detector_id: 40908 original_sid: 2017422
reject tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"ET TROJAN Bladabindi/njrat CnC Command (Remote Desktop)"; flow:from_server,established; content:"sc~|7c 27 7c 27 7c|"; depth:8; dsize:>0; reference:url,threatgeek.com/2013/07/njrat-detection-rules-using-yara-.html; classtype:trojan-activity; sid:1040908; rev:2; metadata:created_at 2013_09_05, updated_at 2013_09_05, flip_endpoints True, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET TROJAN Bladabindi/njrat CnC Command Response (Remote Desktop) (trojan-activity) - detector_id: 40909 original_sid: 2017423
reject tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Bladabindi/njrat CnC Command Response (Remote Desktop)"; flow:to_server,established; content:"scPK|7c 27 7c 27 7c|"; depth:9; dsize:>0; reference:url,threatgeek.com/2013/07/njrat-detection-rules-using-yara-.html; classtype:trojan-activity; sid:1040909; rev:2; metadata:created_at 2013_09_05, updated_at 2013_09_05, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Bladabindi/njrat CnC Command (Remote Cam) (trojan-activity) - detector_id: 40910 original_sid: 2017424
reject tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"ET TROJAN Bladabindi/njrat CnC Command (Remote Cam)"; flow:from_server,established; content:"CAM|7c 27 7c 27 7c|"; depth:8; dsize:>0; reference:url,threatgeek.com/2013/07/njrat-detection-rules-using-yara-.html; classtype:trojan-activity; sid:1040910; rev:2; metadata:created_at 2013_09_05, updated_at 2013_09_05, flip_endpoints True, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET TROJAN Bladabindi/njrat CnC Command Response (Remote Cam) (trojan-activity) - detector_id: 40911 original_sid: 2017425
reject tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Bladabindi/njrat CnC Command Response (Remote Cam)"; flow:to_server,established; content:"USB Video Device[endof]"; depth:23; fast_pattern:3,20; dsize:>0; reference:url,threatgeek.com/2013/07/njrat-detection-rules-using-yara-.html; classtype:trojan-activity; sid:1040911; rev:2; metadata:created_at 2013_09_05, updated_at 2013_09_05, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Bladabindi/njrat CnC Command (Remote Shell) (trojan-activity) - detector_id: 40912 original_sid: 2017426
reject tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"ET TROJAN Bladabindi/njrat CnC Command (Remote Shell)"; flow:from_server,established; content:"rs|7c 27 7c 27 7c|"; depth:8; dsize:>0; reference:url,threatgeek.com/2013/07/njrat-detection-rules-using-yara-.html; classtype:trojan-activity; sid:1040912; rev:2; metadata:created_at 2013_09_05, updated_at 2013_09_05, flip_endpoints True, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET TROJAN Bladabindi/njrat CnC Command Response (Process listing) (trojan-activity) - detector_id: 40913 original_sid: 2017427
reject tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Bladabindi/njrat CnC Command Response (Process listing)"; flow:to_server,established; content:"proc|7c 27 7c 27 7c|"; depth:9; dsize:>0; reference:url,threatgeek.com/2013/07/njrat-detection-rules-using-yara-.html; classtype:trojan-activity; sid:1040913; rev:2; metadata:created_at 2013_09_05, updated_at 2013_09_05, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Bladabindi/njrat CnC Command (Kill Process) (trojan-activity) - detector_id: 40914 original_sid: 2017428
reject tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"ET TROJAN Bladabindi/njrat CnC Command (Kill Process)"; flow:from_server,established; content:"k|7c 27 7c 27 7c|"; depth:6; dsize:>0; reference:url,threatgeek.com/2013/07/njrat-detection-rules-using-yara-.html; classtype:trojan-activity; sid:1040914; rev:2; metadata:created_at 2013_09_05, updated_at 2013_09_05, flip_endpoints True, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET TROJAN Bladabindi/njrat CnC Command (Registry) (trojan-activity) - detector_id: 40915 original_sid: 2017429
reject tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"ET TROJAN Bladabindi/njrat CnC Command (Registry)"; flow:from_server,established; content:"RG|7c 27 7c 27 7c|"; depth:7; dsize:>0; reference:url,threatgeek.com/2013/07/njrat-detection-rules-using-yara-.html; classtype:trojan-activity; sid:1040915; rev:4; metadata:created_at 2013_09_05, updated_at 2013_09_05, flip_endpoints True, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET TROJAN Bladabindi/njrat CnC Command (Keylogger) (trojan-activity) - detector_id: 40916 original_sid: 2017430
reject tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"ET TROJAN Bladabindi/njrat CnC Command (Keylogger)"; flow:from_server,established; content:"kl|7c 27 7c 27 7c|"; depth:7; reference:url,threatgeek.com/2013/07/njrat-detection-rules-using-yara-.html; classtype:trojan-activity; sid:1040916; rev:7; metadata:created_at 2013_09_05, updated_at 2013_09_05, flip_endpoints True, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET TROJAN Bladabindi/njrat CnC Command (Get Passwords) (trojan-activity) - detector_id: 40917 original_sid: 2017431
reject tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"ET TROJAN Bladabindi/njrat CnC Command (Get Passwords)"; flow:from_server,established; content:"ret|7c 27 7c 27 7c|"; depth:8; dsize:>0; reference:url,threatgeek.com/2013/07/njrat-detection-rules-using-yara-.html; classtype:trojan-activity; sid:1040917; rev:5; metadata:created_at 2013_09_05, updated_at 2013_09_05, flip_endpoints True, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET TROJAN Bladabindi/njrat CnC Command Response (Get Passwords) (trojan-activity) - detector_id: 40918 original_sid: 2017432
reject tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Bladabindi/njrat CnC Command Response (Get Passwords)"; flow:to_server,established; content:"pl|7c 27 7c 27 7c|"; depth:7; dsize:>0; reference:url,threatgeek.com/2013/07/njrat-detection-rules-using-yara-.html; classtype:trojan-activity; sid:1040918; rev:5; metadata:created_at 2013_09_05, updated_at 2013_09_05, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Athena DDoS Bot Checkin (trojan-activity) - detector_id: 42049 original_sid: 2017633
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Athena DDoS Bot Checkin"; flow:established,to_server; content:"POST"; nocase; http_method; content:!"Referer|3a|"; http_header; content:"a=%"; depth:3; http_client_body; fast_pattern; content:"&b="; distance:0; http_client_body; content:"&c="; distance:0; http_client_body; pcre:"/^a=(%[0-9A-Fa-f]{2})+\x26b=[0-9A-Za-z]+(%3[dD]){0,2}\x26c=(%[0-9A-Fa-f]{2})+$/P"; reference:md5,19ca0d830cd7b44e5de1ab85f4e17d82; classtype:trojan-activity; sid:1042049; rev:4; metadata:created_at 2013_04_26, updated_at 2013_04_26, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Darkness DDoS HTTP Target/EXE (trojan-activity) - detector_id: 43538 original_sid: 2017775
reject http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET TROJAN Darkness DDoS HTTP Target/EXE"; flow:from_server,established; file_data; content:"Z"; within:1; content:"PWh0dHA"; distance:2; within:9; pcre:"/^[a-z0-9\+\/]+={0,2}$/Rsi"; classtype:trojan-activity; sid:1043538; rev:7; metadata:created_at 2013_11_27, updated_at 2013_11_27, flip_endpoints True, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET TROJAN Darkness DDoS Common Intial Check-in Response wtf (trojan-activity) - detector_id: 43539 original_sid: 2017776
reject http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET TROJAN Darkness DDoS Common Intial Check-in Response wtf"; flow:from_server,established; file_data; content:"d3Rm"; within:4; pcre:"/^(?:\r\n|$)/R"; reference:md5,a9af388f5a627aa66c34074ef45db1b7; classtype:trojan-activity; sid:1043539; rev:7; metadata:created_at 2013_11_27, updated_at 2013_11_27, flip_endpoints True, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET TROJAN Cybergate/Rebhip/Spyrat Backdoor Keepalive Response (trojan-activity) - detector_id: 44391 original_sid: 2017991
reject tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Cybergate/Rebhip/Spyrat Backdoor Keepalive Response"; flow:to_server,established; dsize:<100; content:"pong|7c|"; depth:5; classtype:trojan-activity; sid:1044391; rev:6; metadata:created_at 2011_04_09, updated_at 2011_04_09, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Worm.VBS Dunihi/Houdini/H-Worm Checkin UA (trojan-activity) - detector_id: 44426 original_sid: 2017994
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Worm.VBS Dunihi/Houdini/H-Worm Checkin UA"; flow:to_server,established; content:"|3c 7c 3e|"; http_user_agent; fast_pattern; content:"|3c 7c 3e|"; http_user_agent; distance:0; metadata:former_category CURRENT_EVENTS, flip_endpoints False, server_side False; reference:md5,d2e799904582f03281060689f5447585; reference:url,www.menlosecurity.com/hubfs/pdfs/Menlo_Houdini_Report%20WEB_R.pdf; classtype:trojan-activity; sid:1044426; rev:7; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_and_Server, deployment Perimeter, signature_severity Major, created_at 2014_01_21, malware_family Houdini, malware_family H_worm, performance_impact Low, updated_at 2019_07_19; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN W32/Madness Checkin (trojan-activity) - detector_id: 44544 original_sid: 2018028
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN W32/Madness Checkin"; flow:established,to_server; content:"GET"; http_method; content:"&mk="; http_uri; fast_pattern:only; content:"&rs="; http_uri; content:"&rq="; http_uri; content:"&ver="; http_uri; pcre:"/\?uid=\d{8}&ver=\d\.\d{2}&mk=[0-9a-zA-Z]{6}&os=[A-Za-z0-9]+&rs=[a-z]+&c=\d+&rq=\d/U"; metadata:former_category TROJAN, flip_endpoints False, server_side False; reference:url,www.arbornetworks.com/asert/2014/01/can-i-play-with-madness/; reference:md5,f1ed53c4665d2893fd116a5b0297fc68; classtype:trojan-activity; sid:1044544; rev:4; metadata:created_at 2014_01_28, updated_at 2017_06_13; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN W32.Blackshades/Shadesrat Backdoor CnC Beacon (trojan-activity) - detector_id: 44708 original_sid: 2018079
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN W32.Blackshades/Shadesrat Backdoor CnC Beacon"; flow:established,to_server; content:"POST"; http_method; content:"/gate.php"; http_uri; content:"crypt"; http_client_body; depth:5; content:"="; http_client_body; within:3; reference:md5,9d11cfb7799089823483b72daec5fd2b; reference:md5,a01451eae2d47872ce796bb85f116710; classtype:trojan-activity; sid:1044708; rev:2; metadata:created_at 2014_02_05, updated_at 2014_02_05, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN W32/Asprox.ClickFraudBot CnC Beacon (trojan-activity) - detector_id: 45069 original_sid: 2018096
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN W32/Asprox.ClickFraudBot CnC Beacon"; flow:established,to_server; urilen:31; content:"/b/eve/"; http_uri; depth:7; fast_pattern; pcre:"/^[a-f0-9]{24}$/URi"; metadata:former_category TROJAN, flip_endpoints False, server_side False; reference:url,research.zscaler.com/2014/02/new-zbot-variant-goes-above-and-beyond.html; reference:url,techhelplist.com/index.php/tech-tutorials/41-misc/465-asprox-botnet-advertising-fraud-general-overview-1; reference:md5,df5ab239bdf09a8716cabbdfa1d6a724; classtype:trojan-activity; sid:1045069; rev:3; metadata:created_at 2014_02_10, updated_at 2017_11_29; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN W32/Dinwod.Dropper Win32/Xtrat.B CnC Beacon (trojan-activity) - detector_id: 45073 original_sid: 2018101
reject tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN W32/Dinwod.Dropper Win32/Xtrat.B CnC Beacon"; flow:established,to_server; dsize:<30; content:"myversion|7C|"; depth:10; pcre:"/^\d/R"; metadata:former_category TROJAN, flip_endpoints False, server_side False; reference:md5,dd6a13ba9177a18a8cf16b52ff643abc; classtype:trojan-activity; sid:1045073; rev:5; metadata:created_at 2014_02_10, updated_at 2017_11_07; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Possible Compromised Host AnubisNetworks Sinkhole Cookie Value Snkz (trojan-activity) - detector_id: 45132 original_sid: 2018141
alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"ET TROJAN Possible Compromised Host AnubisNetworks Sinkhole Cookie Value Snkz"; flow:established,to_client; content:"snkz="; http_cookie; pcre:"/^\d{1,3}\x2E\d{1,3}\x2E\d{1,3}\x2E\d{1,3}/CR"; metadata:former_category TROJAN, flip_endpoints True, server_side False; classtype:trojan-activity; sid:1045132; rev:3; metadata:created_at 2014_02_14, updated_at 2014_02_14; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET TROJAN Havex RAT CnC Server Response (trojan-activity) - detector_id: 45448 original_sid: 2018243
reject http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET TROJAN Havex RAT CnC Server Response"; flow:established,from_server; file_data; content:"|3c 21 2d 2d|havexhavex|2d 2d 3e|"; reference:md5,6557d6518c3f6bcb8b1b2de77165c962; classtype:trojan-activity; sid:1045448; rev:2; metadata:created_at 2014_03_11, updated_at 2014_03_11, flip_endpoints True, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET TROJAN Havex RAT CnC Server Response HTML Tag (trojan-activity) - detector_id: 45449 original_sid: 2018244
reject http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET TROJAN Havex RAT CnC Server Response HTML Tag"; flow:established,from_server; file_data; content:"|3c|mega http|2d|equiv|3d|"; reference:md5,6557d6518c3f6bcb8b1b2de77165c962; classtype:trojan-activity; sid:1045449; rev:2; metadata:created_at 2014_03_11, updated_at 2014_03_11, flip_endpoints True, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET TROJAN Possible Graftor EXE Download Common Header Order (trojan-activity) - detector_id: 45464 original_sid: 2018254
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Possible Graftor EXE Download Common Header Order"; flow:established,to_server; content:".exe"; http_uri; fast_pattern; content:"MSIE"; http_user_agent; http_header_names; content:"|0d 0a|Host|0d 0a|Accept-Language|0d 0a|Accept|0d 0a|Accept-Encoding|0d 0a|Connection|0d 0a|User-Agent|0d 0a 0d 0a|"; depth:76; http_connection; content:"close"; nocase; reference:md5,5d9d5b9089ad464e51ff391b14da1953; classtype:trojan-activity; sid:1045464; rev:4; metadata:created_at 2014_03_12, updated_at 2014_03_12, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Possible Netwire RAT Client HeartBeat C1 (no alert) (trojan-activity) - detector_id: 45487 original_sid: 2018281
reject tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Possible Netwire RAT Client HeartBeat C1 (no alert)"; flow:established,to_server; dsize:5; content:"|01 00 00 00|"; depth:4; flowbits:set,ET.Netwire.HB; flowbits:noalert; reference:md5,154a2366cd3e39e8625f5f737f9da8f1; reference:md5,9475f91a426ac45d1f074373034cbea6; classtype:trojan-activity; sid:1045487; rev:4; metadata:created_at 2014_03_14, updated_at 2014_03_14, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN W32/SpeedingUpMyPC.Rootkit Install CnC Beacon (trojan-activity) - detector_id: 45671 original_sid: 2018331
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN W32/SpeedingUpMyPC.Rootkit Install CnC Beacon"; flow:established,to_server; urilen:9; content:"POST"; http_method; content:"/install/"; http_uri; content:"q="; http_client_body; depth:2; reference:md5,cb6cb201eab321f7a827bb3cb1b311b6; classtype:trojan-activity; sid:1045671; rev:2; metadata:created_at 2014_03_28, updated_at 2014_03_28, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN W32/SpeedingUpMyPC.Rootkit CnC Beacon (trojan-activity) - detector_id: 45672 original_sid: 2018332
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN W32/SpeedingUpMyPC.Rootkit CnC Beacon"; flow:established,to_server; content:"GET"; http_method; content:"/get/?q="; http_uri; content:"win32"; depth:5; http_user_agent; reference:md5,cb6cb201eab321f7a827bb3cb1b311b6; classtype:trojan-activity; sid:1045672; rev:3; metadata:created_at 2014_03_28, updated_at 2014_03_28, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Win32.Sality-GR Checkin (trojan-activity) - detector_id: 45726 original_sid: 2018340
alert http $HOME_NET any -> any any (msg:"ET TROJAN Win32.Sality-GR Checkin"; flow:established,to_server; content:".gif?"; http_uri; fast_pattern; pcre:"/^[0-9a-f]{4,8}\x3d\x2d?\d+(?:&id\x3d\d+)?$/UR"; http_header_names; content:"|0d 0a|User-Agent"; depth:12; content:!"Accept"; content:!"Referer"; reference:md5,3a03a20bfefe3fdd01659d47d2ed76c8; classtype:trojan-activity; sid:1045726; rev:10; metadata:created_at 2013_06_06, updated_at 2013_06_06, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Kazy Checkin (trojan-activity) - detector_id: 45727 original_sid: 2018341
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Kazy Checkin"; flow:to_server,established; content:"/get_"; http_uri; content:"did="; http_uri; content:"Downloader"; depth:10; http_user_agent; reference:md5,73d2dd466df92b77a4c34adcd13e8b50; reference:url,community.emc.com/community/connect/rsaxchange/netwitness/blog/2014/03/28/new-kazy-variant-kazy-forces; classtype:trojan-activity; sid:1045727; rev:7; metadata:created_at 2013_09_11, updated_at 2013_09_11, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Netwire RAT Check-in (trojan-activity) - detector_id: 46080 original_sid: 2018426
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Netwire RAT Check-in"; flow:established,to_server; dsize:>68; content:"|41 00 00 00 03|"; depth:5; flowbits:set,ET.NetwireRAT.Client; flowbits:noalert; reference:url,www.circl.lu/pub/tr-23/; classtype:trojan-activity; sid:1046080; rev:2; metadata:created_at 2014_04_28, updated_at 2014_04_28, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN CryptoWall Check-in (trojan-activity) - detector_id: 46141 original_sid: 2018452
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN CryptoWall Check-in"; flow:established,to_server; urilen:<134; content:"="; offset:1; depth:1; http_client_body; content:" MSIE "; fast_pattern; http_user_agent; pcre:"/[\/=][a-z0-9]{8,}$/U"; pcre:"/^[a-z]=[a-f0-9]{80,}$/P"; http_accept; content:"*/*"; depth:3; isdataat:!1,relative; http_content_type; content:"application/x-www-form-urlencoded"; depth:33; isdataat:!1,relative; http_header_names; content:"|0d 0a|Accept|0d 0a|Content-Type|0d 0a|"; depth:24; content:!"Accept-"; nocase; content:!"Referer"; reference:md5,3c53c9f7ab32a09de89bb44e5f91f9af; classtype:trojan-activity; sid:1046141; rev:16; metadata:created_at 2014_05_05, updated_at 2019_05_22, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Downloader.Win32.Tesch.A Server CnC Checkin Reply (trojan-activity) - detector_id: 46307 original_sid: 2018477
reject tcp $EXTERNAL_NET 443 -> $HOME_NET any (msg:"ET TROJAN Downloader.Win32.Tesch.A Server CnC Checkin Reply"; flow:established,to_client; content:"|02 00 06|"; depth:3; content:"|01 BB|"; distance:4; within:2; fast_pattern; reference:md5,86b5491831522f3c7bdcdacb17417514; reference:md5,2bebb36872b4829f553326e102d014ed; classtype:trojan-activity; sid:1046307; rev:1; metadata:created_at 2014_05_15, updated_at 2014_05_15, flip_endpoints True, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET TROJAN Win32/Urausy.C response (trojan-activity) - detector_id: 46446 original_sid: 2018499
reject http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET TROJAN Win32/Urausy.C response"; flow:from_server,established; file_data; content:"|0d 0a|<?xml version="; depth:16; content:"<interval>"; distance:0; content:"</interval>"; distance:0; content:"<timeout>"; distance:0; content:"</timeout>"; distance:0; content:"|d1 81 d1 81 d1 8b d0 bb d0 be d0 ba 20|c&c -->"; fast_pattern:only; reference:md5,6213597f40ecb3e7cf2ab3ee5c8b1c70; classtype:trojan-activity; sid:1046446; rev:3; metadata:created_at 2014_05_23, updated_at 2014_05_23, flip_endpoints True, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET TROJAN Dyreza RAT Checkin (trojan-activity) - detector_id: 46619 original_sid: 2018579
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Dyreza RAT Checkin"; flow:established,to_server; content:"GET"; http_method; content:"_W"; http_uri; content:"|2e|"; distance:6; within:1; http_uri; content:"/publickey/"; http_uri; fast_pattern:only; content:!"Accept|3a|"; http_header; content:!"Connection|3a|"; http_header; content:!"Referer|3a|"; http_header; reference:md5,b61145a54698753cecf8748359c9d81e; classtype:trojan-activity; sid:1046619; rev:7; metadata:created_at 2014_06_12, updated_at 2014_06_12, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Win32/Neutrino Checkin (trojan-activity) - detector_id: 46621 original_sid: 2018580
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Win32/Neutrino Checkin"; flow:to_server,established; content:"POST"; http_method; content:!"Referer|3a|"; http_header; content:"cmd="; http_client_body; content:"version="; http_client_body; content:"quality="; http_client_body; fast_pattern:only; content:"av="; http_client_body; metadata:former_category TROJAN, flip_endpoints False, server_side False; reference:md5,bef57db893b54c5605d0e3e7d50d6d70; reference:md5,bf555378d935de805f39c2d2d965a888; reference:url,securitykitten.github.io/an-evening-with-n3utrino/; classtype:trojan-activity; sid:1046621; rev:5; metadata:created_at 2014_06_18, updated_at 2017_03_29; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Andromeda Downloading Module (trojan-activity) - detector_id: 46728 original_sid: 2018604
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Andromeda Downloading Module"; flow:to_server,established; content:"GET"; http_method; content:".pack"; nocase; http_uri; fast_pattern:only; content:!"Referer|3a|"; http_header; pcre:"/\.pack$/Ui"; content:"Mozilla"; http_header; pcre:"/^User-Agent\x3a\x20Mozilla(?:\/4\.0)?\r?$/Hmi"; reference:md5,65125129418e07ce1000aa677b66b72f; classtype:trojan-activity; sid:1046728; rev:5; metadata:created_at 2014_06_24, updated_at 2014_06_24, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Likely CryptoWall .onion Proxy domain in SNI (trojan-activity) - detector_id: 46739 original_sid: 2018610
alert tcp $HOME_NET any -> $EXTERNAL_NET 443 (msg:"ET TROJAN Likely CryptoWall .onion Proxy domain in SNI"; flow:established,to_server; content:"kpai7ycr7jxqkilp."; fast_pattern:only; classtype:trojan-activity; sid:1046739; rev:1; metadata:created_at 2014_06_26, updated_at 2014_06_26, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Win32/Zemot Checkin (trojan-activity) - detector_id: 50120 original_sid: 2018644
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Win32/Zemot Checkin"; flow:established,to_server; content:"GET"; http_method; content:"/mod_articles"; depth:13; http_uri; fast_pattern; content:"/"; http_uri; isdataat:!1,relative; http_header_names; content:"User-Agent"; content:!"Accept-"; content:!"Referer"; reference:md5,9a705a2c25a8b30de80e59dbb9adab83; classtype:trojan-activity; sid:1050120; rev:4; metadata:created_at 2014_07_07, updated_at 2014_07_07, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Win32/Zemot Checkin (trojan-activity) - detector_id: 50123 original_sid: 2018643
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Win32/Zemot Checkin"; flow:established,to_server; content:"GET"; http_method; content:"/b/shoe/"; depth:8; http_uri; fast_pattern; pcre:"/^\d+?$/UR"; content:"Mozilla/4.0|20|"; http_user_agent; depth:12; http_header_names; content:!"Referer"; reference:md5,e1cbdba0c57ddb5ab70aa1306dbacaa9; classtype:trojan-activity; sid:1050123; rev:4; metadata:created_at 2014_02_27, updated_at 2014_02_27, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Win32/Zemot Config Download (trojan-activity) - detector_id: 50143 original_sid: 2018661
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Win32/Zemot Config Download"; flow:established,to_server; content:"GET"; http_method; content:"/soft"; http_uri; content:".dll"; http_uri; fast_pattern:only; pcre:"/\/soft(?:32|64)\.dll$/Ui"; content:"Accept|3a 20|*/*|0d 0a|Connection|3a 20|Close|0d 0a|"; depth:32; http_header; content:"User-Agent|3a|"; http_header; content:!"Referer"; http_header; reference:md5,5a99a6a6cd8600ea88a8fcc1409b82f4; classtype:trojan-activity; sid:1050143; rev:3; metadata:created_at 2014_07_09, updated_at 2014_07_09, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Dyreza RAT Checkin 2 (trojan-activity) - detector_id: 50236 original_sid: 2018683
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Dyreza RAT Checkin 2"; flow:established,to_server; content:"GET"; http_method; content:"_W"; http_uri; content:"|2e|"; distance:6; within:1; http_uri; content:"/NAT/"; distance:0; http_uri; fast_pattern; content:"|20|NAT/"; distance:0; http_uri; content:!"Accept|3a|"; http_header; content:!"Connection|3a|"; http_header; content:!"Referer|3a|"; http_header; reference:md5,2a835747b7442b1d58ab30abc90d3b0f; reference:url,phishme.com/project-dyre-new-rat-slurps-bank-credentials-bypasses-ssl/; classtype:trojan-activity; sid:1050236; rev:6; metadata:created_at 2014_07_16, updated_at 2014_07_16, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Dyreza RAT Checkin 3 (trojan-activity) - detector_id: 50321 original_sid: 2018749
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Dyreza RAT Checkin 3"; flow:established,to_server; content:"GET"; http_method; content:"_W"; http_uri; content:"|2e|"; distance:6; within:1; http_uri; content:"/replace/"; http_uri; fast_pattern:only; content:!"Accept|3a|"; http_header; content:!"Connection|3a|"; http_header; content:!"Referer|3a|"; http_header; reference:md5,4d1d43789e038c6a03c07083ca0b0809; reference:url,phishme.com/project-dyre-new-rat-slurps-bank-credentials-bypasses-ssl/; classtype:trojan-activity; sid:1050321; rev:6; metadata:created_at 2014_07_21, updated_at 2014_07_21, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Asterope Checkin (trojan-activity) - detector_id: 50337 original_sid: 2018750
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Asterope Checkin"; flow:established,to_server; content:"GET"; http_method; content:"/?ver="; http_uri; content:"&id="; distance:0; http_uri; content:"&os="; distance:0; http_uri; content:"&res="; distance:0; http_uri; content:"Accept-Asterope|3a|"; http_header; fast_pattern:only; reference:md5,19190ef53877979191f6889c6a795f31; classtype:trojan-activity; sid:1050337; rev:3; metadata:created_at 2014_06_23, updated_at 2014_06_23, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Win32/Spy.Tuscas (trojan-activity) - detector_id: 50793 original_sid: 2018999
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Win32/Spy.Tuscas"; flow:established,to_server; content:"?version="; http_uri; fast_pattern:only; content:"&group="; http_uri; content:"&client="; http_uri; content:"&computer="; http_uri; content:"&os="; http_uri; content:"&latency="; http_uri; content:!"Accept"; http_header; content:!"Referer|3a|"; http_header; reference:url,stopmalvertising.com/malware-reports/analysis-of-tuscas.html; classtype:trojan-activity; sid:1050793; rev:2; metadata:created_at 2014_08_25, updated_at 2014_08_25, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Win32/Frosparf.B Downloading Hosts File (trojan-activity) - detector_id: 51053 original_sid: 2019142
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET TROJAN Win32/Frosparf.B Downloading Hosts File"; flow:established,from_server; file_data; content:"9.9.9.9 "; within:8; pcre:"/^(?:[a-zA-Z0-9\x2d\x5f]{1,63}\.)+?[a-zA-Z0-9\x2d\x5f]{1,63}[\r\n]*?9\.9\.9\.9\s+?(?:[a-zA-Z0-9\_\-]{1,63}\.)+?[a-zA-Z0-9\x2d\x5f]{1,63}[\r\n]/R"; reference:md5,4ad55877464aa92e49231d913d00eb69; classtype:trojan-activity; sid:1051053; rev:2; metadata:created_at 2014_09_09, updated_at 2014_09_09, flip_endpoints True, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET TROJAN W32/Alina.POS-Trojan Checkin (trojan-activity) - detector_id: 51099 original_sid: 2019163
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN W32/Alina.POS-Trojan Checkin"; flow:established,to_server; content:"POST"; http_method; content:".php"; http_uri; content:"Accept|3a 20|application/octet-stream|0d 0a|"; http_header; fast_pattern; content:"User-Agent|3a 20|Mozilla/"; http_header; content:"|20|InfoPath|2e|"; http_header; distance:0; pcre:"/^User-Agent\x3a[^\r\n]+\x20InfoPath\x2e\d[^\x29]+\r?$/Hmi"; content:!"Referer|3a|"; http_header; pcre:"/\.php$/U"; reference:md5,3959fb5b5909d9c6fb9c9a408d35f67a; reference:url,trendmicro.com/cloud-content/us/pdfs/security-intelligence/white-papers/wp-pos-ram-scraper-malware.pdf; classtype:trojan-activity; sid:1051099; rev:3; metadata:created_at 2014_09_11, updated_at 2014_09_11, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN JackPOS XOR Encoded HTTP Client Body (key AA) (trojan-activity) - detector_id: 51100 original_sid: 2019164
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN JackPOS XOR Encoded HTTP Client Body (key AA)"; flow:established,to_server; content:"|AB AB|"; depth:2; http_client_body; content:"|AA AA AA AA AA AA AA AA AA AA AA AA AA AA AA AA|"; http_client_body; fast_pattern:only; reference:md5,3959fb5b5909d9c6fb9c9a408d35f67a; reference:url,trendmicro.com/cloud-content/us/pdfs/security-intelligence/white-papers/wp-pos-ram-scraper-malware.pdf; classtype:trojan-activity; sid:1051100; rev:2; metadata:created_at 2014_09_11, updated_at 2014_09_11, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Tinba Checkin (trojan-activity) - detector_id: 51109 original_sid: 2019168
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Tinba Checkin"; flow:established,to_server; content:"POST"; http_method; content:!"User-Agent|3a|"; http_header; content:!"Accept"; http_header; content:"/|20|HTTP/1.0|0d 0a|Host|3a 20|"; fast_pattern:only; content:"|0d 0a 0d 0a|"; content:!"|00 00 00 00|"; within:4; content:!"|FF FF FF FF|"; within:4; byte_extract:4,0,Tinba.Pivot,relative; byte_test:4,=,Tinba.Pivot,16,relative; byte_test:4,!=,Tinba.Pivot,4,relative; pcre:"/^Host\x3a[^\r\n]+?\r\nContent-Length\x3a\x20\d{2,}\r\n(?:\r\n)?$/H"; flowbits:set,ET.Tinba.Checkin; reference:md5,1e644fe146f62bd2fc585b8df6712ff6; classtype:trojan-activity; sid:1051109; rev:4; metadata:created_at 2014_09_12, updated_at 2014_09_12, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Tinba Server Response (trojan-activity) - detector_id: 51110 original_sid: 2019169
reject http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET TROJAN Tinba Server Response"; flow:established,to_client; flowbits:isset,ET.Tinba.Checkin; file_data; content:"|64 b4 dc a4|"; within:4; reference:md5,1e644fe146f62bd2fc585b8df6712ff6; classtype:trojan-activity; sid:1051110; rev:4; metadata:created_at 2014_09_12, updated_at 2014_09_12, flip_endpoints True, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET TROJAN Linux/BillGates Checkin (trojan-activity) - detector_id: 51214 original_sid: 2019207
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Linux/BillGates Checkin"; flow:established,to_server; content:"|01 00 00 00|"; depth:4; content:"|00 00 00 f4 01 00 00 32 00 00 00 e8 03|"; distance:0; content:"|01 01 02 00 00 00 01 00 00 00|"; distance:0; reference:md5,b4dd0283c73d0b288e7322b95df0cb1b; classtype:trojan-activity; sid:1051214; rev:1; metadata:created_at 2014_09_22, updated_at 2014_09_22, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Linux/BillGates Checkin Response (trojan-activity) - detector_id: 51215 original_sid: 2019208
reject tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"ET TROJAN Linux/BillGates Checkin Response"; flow:established,from_server; dsize:20; content:"|08 00 00 00 0c 00 00 00 00 00 00 00 00 00 00 00 e8 fd 00 00|"; reference:md5,b4dd0283c73d0b288e7322b95df0cb1b; classtype:trojan-activity; sid:1051215; rev:1; metadata:created_at 2014_09_22, updated_at 2014_09_22, flip_endpoints True, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET TROJAN njrat ver 0.7d Malware CnC Callback (Capture) (trojan-activity) - detector_id: 51234 original_sid: 2019214
alert tcp any any -> any any (msg:"ET TROJAN njrat ver 0.7d Malware CnC Callback (Capture)"; flow:established; content:!"GET|20|"; content:"|FF D8 FF E0 00 10 4A 46 49 46|"; content:"|00|CAP|7c 27 7c 27 7c|"; nocase; fast_pattern; pcre:"/^\d{1,6}\x00cap\x7c/i"; reference:md5,bbc68c34bb2dac3ae382ecf785bdb441; classtype:trojan-activity; sid:1051234; rev:2; metadata:created_at 2014_09_23, updated_at 2014_09_23, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN njrat ver 0.7d Malware CnC Callback (Microphone) (trojan-activity) - detector_id: 51235 original_sid: 2019215
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN njrat ver 0.7d Malware CnC Callback (Microphone)"; flow:from_client,established; content:"|00|MIC|7c 27 7c 27 7c|"; nocase; fast_pattern; pcre:"/^\d{1,6}\x00mic\x7c/i"; reference:md5,bbc68c34bb2dac3ae382ecf785bdb441; classtype:trojan-activity; sid:1051235; rev:3; metadata:created_at 2014_09_23, updated_at 2014_09_23, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN njrat ver 0.7d Malware CnC Callback (Message) (trojan-activity) - detector_id: 51236 original_sid: 2019216
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN njrat ver 0.7d Malware CnC Callback (Message)"; flow:from_client,established; content:"|00|MSG|7c 27 7c 27 7c|"; nocase; fast_pattern; pcre:"/^\d{1,6}\x00msg\x7c/i"; reference:md5,bbc68c34bb2dac3ae382ecf785bdb441; classtype:trojan-activity; sid:1051236; rev:3; metadata:created_at 2014_09_23, updated_at 2014_09_23, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN njrat ver 0.7d Malware CnC Callback (Remote Shell) (trojan-activity) - detector_id: 51237 original_sid: 2019217
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN njrat ver 0.7d Malware CnC Callback (Remote Shell)"; flow:from_client,established; content:"|00|rs|7c 27 7c 27 7c|"; nocase; fast_pattern; pcre:"/^\d{1,6}\x00rs\x7c/i"; reference:md5,bbc68c34bb2dac3ae382ecf785bdb441; classtype:trojan-activity; sid:1051237; rev:3; metadata:created_at 2014_09_23, updated_at 2014_09_23, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN njrat ver 0.7d Malware CnC Callback (Services Listing) (trojan-activity) - detector_id: 51238 original_sid: 2019218
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN njrat ver 0.7d Malware CnC Callback (Services Listing)"; flow:from_client,established; content:"|00|srv|7C 27 7C 27 7C|"; nocase; fast_pattern; pcre:"/^\d{1,6}\x00srv\x7c/i"; reference:md5,bbc68c34bb2dac3ae382ecf785bdb441; classtype:trojan-activity; sid:1051238; rev:3; metadata:created_at 2014_09_23, updated_at 2014_09_23, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN njrat ver 0.7d Malware CnC Callback (Registry Listing) (trojan-activity) - detector_id: 51239 original_sid: 2019219
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN njrat ver 0.7d Malware CnC Callback (Registry Listing)"; flow:from_client,established; content:"|00|RG|7C 27 7C 27 7C|"; nocase; fast_pattern; pcre:"/^\d{1,6}\x00rg\x7c/i"; reference:md5,bbc68c34bb2dac3ae382ecf785bdb441; classtype:trojan-activity; sid:1051239; rev:3; metadata:created_at 2014_09_23, updated_at 2014_09_23, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN njrat ver 0.7d Malware CnC Callback (Process Listing) (trojan-activity) - detector_id: 51240 original_sid: 2019220
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN njrat ver 0.7d Malware CnC Callback (Process Listing)"; flow:from_client,established; content:"|00|proc|7C 27 7C 27 7C|"; nocase; fast_pattern; pcre:"/^\d{1,6}\x00proc\x7c/i"; reference:md5,bbc68c34bb2dac3ae382ecf785bdb441; classtype:trojan-activity; sid:1051240; rev:3; metadata:created_at 2014_09_23, updated_at 2014_09_23, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN njrat ver 0.7d Malware CnC Callback (File Manager Actions) (trojan-activity) - detector_id: 51241 original_sid: 2019221
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN njrat ver 0.7d Malware CnC Callback (File Manager Actions)"; flow:from_client,established; content:"|00|fm|7C 27 7C 27 7C|"; nocase; fast_pattern; pcre:"/^\d{1,6}\x00fm\x7c/i"; reference:md5,bbc68c34bb2dac3ae382ecf785bdb441; classtype:trojan-activity; sid:1051241; rev:3; metadata:created_at 2014_09_23, updated_at 2014_09_23, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN njrat ver 0.7d Malware CnC Callback (Keylogging) (trojan-activity) - detector_id: 51242 original_sid: 2019222
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN njrat ver 0.7d Malware CnC Callback (Keylogging)"; flow:from_client,established; content:"|00|kl|7C 27 7C 27 7C|"; nocase; fast_pattern; pcre:"/^\d{1,6}\x00kl\x7c/i"; reference:md5,bbc68c34bb2dac3ae382ecf785bdb441; classtype:trojan-activity; sid:1051242; rev:3; metadata:created_at 2014_09_23, updated_at 2014_09_23, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN ABUSE.CH SSL Blacklist Malicious SSL certificate detected (TorrentLocker CnC) (trojan-activity) - detector_id: 51278 original_sid: 2019279
reject tls $EXTERNAL_NET any -> $HOME_NET any (msg:"ET TROJAN ABUSE.CH SSL Blacklist Malicious SSL certificate detected (TorrentLocker CnC)"; flow:established,from_server; content:"|16|"; content:"|0b|"; within:8; content:"|09 00 bf ac 1a b8 3d 7f 11 16|"; within:35; fast_pattern; content:"|55 04 03|"; distance:0; content:"|06|debian"; distance:1; within:7; reference:url,sslbl.abuse.ch; classtype:trojan-activity; sid:1051278; rev:2; metadata:attack_target Client_Endpoint, deployment Perimeter, tag SSL_Malicious_Cert, signature_severity Major, created_at 2014_09_26, updated_at 2016_07_01, flip_endpoints True, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET TROJAN ABUSE.CH SSL Blacklist Malicious SSL certificate detected (TorrentLocker CnC) (trojan-activity) - detector_id: 51279 original_sid: 2019280
reject tls $EXTERNAL_NET any -> $HOME_NET any (msg:"ET TROJAN ABUSE.CH SSL Blacklist Malicious SSL certificate detected (TorrentLocker CnC)"; flow:established,from_server; content:"|16|"; content:"|0b|"; within:8; content:"|09 00 bf ac 1a b8 3d 7f 11 16|"; within:35; fast_pattern; content:"|55 04 03|"; distance:0; content:"|06|debian"; distance:1; within:7; reference:url,sslbl.abuse.ch; classtype:trojan-activity; sid:1051279; rev:2; metadata:attack_target Client_Endpoint, deployment Perimeter, tag SSL_Malicious_Cert, signature_severity Major, created_at 2014_09_26, updated_at 2016_07_01, flip_endpoints True, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET TROJAN Dyre SSL Cert 2 (trojan-activity) - detector_id: 51322 original_sid: 2019306
alert tls $EXTERNAL_NET any -> $HOME_NET any (msg:"ET TROJAN Dyre SSL Cert 2"; flow:established,from_server; content:"|16|"; content:"|0b|"; within:8; content:"|09 00 8b 77 b3 d1 92 8c 7d 48|"; distance:0; within:35; fast_pattern; content:"|55 04 0A|"; distance:0; content:"|18|Internet Widgits Pty Ltd"; distance:1; within:25; reference:md5,edaaaa6527a6f42c96f27ce2e427cd39; classtype:trojan-activity; sid:1051322; rev:3; metadata:attack_target Client_Endpoint, deployment Perimeter, tag SSL_Malicious_Cert, signature_severity Major, created_at 2014_09_29, updated_at 2016_07_01, flip_endpoints True, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET TROJAN Reply Sinkhole - irc-sinkhole.cert.pl (trojan-activity) - detector_id: 51608 original_sid: 2019354
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"ET TROJAN Reply Sinkhole - irc-sinkhole.cert.pl"; flow:established,from_server; content:"|3a|irc|2d|sinkhole|2e|cert|2e|pl"; nocase; fast_pattern:only; content:"|3a|End of MOTD command|2e|"; classtype:trojan-activity; sid:1051608; rev:1; metadata:created_at 2014_10_06, updated_at 2014_10_06, flip_endpoints True, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET TROJAN Possible Bedep Connectivity Check (trojan-activity) - detector_id: 51677 original_sid: 2019400
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Possible Bedep Connectivity Check"; flow:established,to_server; content:"GET"; http_method; content:"/stats/eurofxref/eurofxref-hist-90d.xml?"; http_uri; fast_pattern:20,20; pcre:"/\?[a-z0-9]{32}$/U"; content:"Host|3a 20|www.ecb.europa.eu|0d 0a|"; http_header; classtype:trojan-activity; sid:1051677; rev:5; metadata:created_at 2014_10_15, updated_at 2014_10_15, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Vawtrak/NeverQuest Posting Data (trojan-activity) - detector_id: 52091 original_sid: 2019500
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Vawtrak/NeverQuest Posting Data"; flow:established,to_server; content:"POST"; http_method; content:"=0"; http_uri; content:"=0000"; http_uri; distance:3; fast_pattern; content:"Content-Type|3a 20|application/octet-stream|0d 0a|User-Agent"; http_header; content:!"Referer|3a|"; http_header; pcre:"/=0[0-2](?:&\w+=[a-fA-F0-9]{8}){2}&\w+=[a-fA-F0-9]+$/U"; classtype:trojan-activity; sid:1052091; rev:2; metadata:created_at 2014_10_24, updated_at 2014_10_24, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN W32/ZxShell Server Checkin Response (trojan-activity) - detector_id: 52330 original_sid: 2019587
reject tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"ET TROJAN W32/ZxShell Server Checkin Response"; flow:established,from_server; dsize:16; content:"|85 19 00 00 25 04 00 00|"; depth:8; reference:url,blogs.cisco.com/talos/opening-zxshell/; classtype:trojan-activity; sid:1052330; rev:1; metadata:created_at 2014_10_29, updated_at 2014_10_29, flip_endpoints True, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET TROJAN Poweliks Abnormal HTTP Headers high likelihood of Poweliks infection (trojan-activity) - detector_id: 52353 original_sid: 2019606
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Poweliks Abnormal HTTP Headers high likelihood of Poweliks infection"; flow:established,to_server; content:"builddate|3a 20|"; http_header; fast_pattern:only; content:"version|3a 20|"; http_header; content:"id|3a 20|"; http_header; content:"GET"; http_method; metadata:former_category TROJAN, flip_endpoints False, server_side False; classtype:trojan-activity; sid:1052353; rev:4; metadata:created_at 2014_10_30, updated_at 2017_05_11; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Cohhoc RAT CnC Request (trojan-activity) - detector_id: 52702 original_sid: 2019625
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Cohhoc RAT CnC Request"; flow:established,to_server; content:"GET"; http_method; content:"gAAAA"; offset:2; depth:5; http_uri; content:"AAAAAAAAAAAAAAMjAx"; distance:1; within:18; http_uri; content:"MiR"; distance:4; within:3; http_uri; http_header_names; content:!"Referer"; reference:url,public.gdatasoftware.com/Presse/Publikationen/Whitepaper/EN/GDATA_TooHash_CaseStudy_102014_EN_v1.pdf; classtype:trojan-activity; sid:1052702; rev:4; metadata:created_at 2014_11_03, updated_at 2014_11_03, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Cohhoc RAT CnC Response (trojan-activity) - detector_id: 52703 original_sid: 2019626
reject http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET TROJAN Cohhoc RAT CnC Response"; flow:established,from_server; content:"Content-Length|3a 20|64|0d 0a|"; file_data; content:"gAAAAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"; distance:1; within:63; reference:url,public.gdatasoftware.com/Presse/Publikationen/Whitepaper/EN/GDATA_TooHash_CaseStudy_102014_EN_v1.pdf; classtype:trojan-activity; sid:1052703; rev:5; metadata:created_at 2014_11_03, updated_at 2014_11_03, flip_endpoints True, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET TROJAN Emotet Checkin (trojan-activity) - detector_id: 52830 original_sid: 2019693
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Emotet Checkin"; flow:established,to_server; content:"POST"; http_method; content:!"Accept-"; http_header; content:!"Referer|3a|"; http_header; content:"/"; offset:1; http_uri; content:"/"; distance:0; http_uri; content:"MSIE 7.0|3b|"; http_user_agent; fast_pattern; content:"Windows NT 6.0"; within:15; http_user_agent; pcre:"/^\/[A-Za-z0-9]+\/[A-Za-z0-9]+\/$/U"; pcre:"/^[\x20-\x7e\r\n]{0,20}[^\x20-\x7e\r\n]/P"; reference:md5,3083b68cb5c2a345972a5f79e735c7b9; classtype:trojan-activity; sid:1052830; rev:5; metadata:created_at 2014_11_11, updated_at 2014_11_11, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Emotet CnC Beacon (trojan-activity) - detector_id: 52840 original_sid: 2019704
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Emotet CnC Beacon"; flow:established,to_server; content:"POST"; http_method; content:".php"; http_uri; content:"<email_accounts_list>"; http_client_body; fast_pattern:only; content:!"User-Agent|3a|"; http_header; content:!"Accept"; http_header; content:!"Referer|3a|"; http_header; pcre:"/\.php$/U"; reference:md5,e24831e3f808116b30d85731c545e3ee; classtype:trojan-activity; sid:1052840; rev:2; metadata:created_at 2014_11_12, updated_at 2014_11_12, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Trojan/W32.KRBanker.60928.C Checkin (trojan-activity) - detector_id: 53170 original_sid: 2019828
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Trojan/W32.KRBanker.60928.C Checkin"; flow:to_server,established; content:"POST"; http_method; nocase; content:"/upload.php"; http_uri; content:"|0d 0a|Accept-Language|3a| zh-cn|0d 0a|"; http_header; content:"User-Agent|3a| Mozilla/4.0 (compatible|3b| MSIE 6.0|3b| Windows NT 5.0|29 0d 0a|"; http_header; content:"name=|22|upload_file1|22 3b 20|"; fast_pattern:only; http_client_body; content:".zip|22 0d 0a|"; http_client_body; content:"Content-Type|3a| application/x-zip-compressed|0d 0a|"; http_client_body; pcre:"/filename=\x22[A-Z]\x3a\\.+?\\[a-f0-9]{32}\.zip\x22\r\n/P"; reference:md5,ec5d7bc9d84551066fff51e36bc41d4d; reference:md5,13bd584bb12ee5dc15c35f5911912b09; classtype:trojan-activity; sid:1053170; rev:3; metadata:created_at 2014_12_01, updated_at 2014_12_01, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Win32/Swrort.A Checkin 2 (trojan-activity) - detector_id: 53183 original_sid: 2019841
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Win32/Swrort.A Checkin 2"; flow:to_server,established; content:"POST"; http_method; nocase; content:"User-Agent|3a| Mozilla/4.0 (compatible|3b| MSIE 6.1|3b| Windows NT|29 0d 0a|"; http_header; content:"RECV"; depth:4; fast_pattern; http_client_body; pcre:"/^\/[A-Za-z0-9-_]{30,}\/$/U"; reference:md5,61dacbf1fc20af3afdc432a0dd78eaf3; reference:md5,a3ef217825ce310c41e6edaee2db5eb9; reference:url,www.microsoft.com/security/portal/threat/encyclopedia/entry.aspx?Name=Trojan%3AWin32/Swrort.A; classtype:trojan-activity; sid:1053183; rev:3; metadata:created_at 2014_12_02, updated_at 2014_12_02, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN VirRansom/VirLock Checkin (trojan-activity) - detector_id: 53276 original_sid: 2019901
reject tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN VirRansom/VirLock Checkin"; flow:established,to_server; dsize:4; content:"|94 00 00 00|"; fast_pattern:only; flowbits:set,ET.VirLock; flowbits:noalert; reference:md5,fbeb6ebd498d85b1f404d7bb4acc3b89; classtype:trojan-activity; sid:1053276; rev:1; metadata:created_at 2014_12_09, updated_at 2014_12_09, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN VirRansom/VirLock Checkin Response (trojan-activity) - detector_id: 53277 original_sid: 2019902
reject tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"ET TROJAN VirRansom/VirLock Checkin Response"; flow:established,from_server; dsize:4; content:"|74 01 00 00|"; fast_pattern:only; flowbits:isset,ET.VirLock; reference:md5,fbeb6ebd498d85b1f404d7bb4acc3b89; classtype:trojan-activity; sid:1053277; rev:1; metadata:created_at 2014_12_09, updated_at 2014_12_09, flip_endpoints True, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET TROJAN HawkEye Keylogger Report SMTP (trojan-activity) - detector_id: 53318 original_sid: 2019926
reject tcp $HOME_NET any -> $EXTERNAL_NET [25,587] (msg:"ET TROJAN HawkEye Keylogger Report SMTP"; flow:established,to_server; content:"From|3a|"; nocase; content:"Subject|3a| HawkEye Keylogger"; nocase; reference:md5,3bbd5ae250b2d912a701f8d74d85353b; classtype:trojan-activity; sid:1053318; rev:1; metadata:created_at 2014_12_12, updated_at 2014_12_12, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN W32/Farfli.BHQ!tr Dropper CnC Beacon (trojan-activity) - detector_id: 53374 original_sid: 2019946
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN W32/Farfli.BHQ!tr Dropper CnC Beacon"; flow:established,to_server; content:"GET"; http_method; urilen:8; content:"/php.php"; fast_pattern; content:"User-Agent|3A| Mozilla/4.0 (compatible)"; pcre:"/^Host\x3A\x20\d{1,3}\x2E\d{1,3}\x2E\d{1,3}\x2E\d{1,3}/Hmi"; reference:md5,cb53a6e8d65d86076fc0c94dac62aa77; classtype:trojan-activity; sid:1053374; rev:2; metadata:created_at 2014_12_16, updated_at 2014_12_16, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Win32/Spy.Banker.AAXV Retrieving key from Pinterest (trojan-activity) - detector_id: 53389 original_sid: 2019961
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Win32/Spy.Banker.AAXV Retrieving key from Pinterest"; flow:established,to_server; content:"GET"; http_method; content:"/pin/"; depth:5; http_uri; content:"User-Agent|3a 20|Internet Explorer 6.0|0d 0a|"; http_header; fast_pattern:15,20; content:!"Accept"; http_header; content:!"Connection|3a|"; http_header; content:!"Referer|3a|"; http_header; reference:md5,f25a8e3f5265a57269590b84a506b672; reference:url,blog.trendmicro.com/trendlabs-security-intelligence/malware-campaign-targets-south-korean-banks-uses-pinterest-as-cc-channel/; classtype:trojan-activity; sid:1053389; rev:3; metadata:created_at 2014_12_17, updated_at 2014_12_17, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Dridex Post Check-in Activity (trojan-activity) - detector_id: 53507 original_sid: 2020064
reject tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Dridex Post Check-in Activity"; flow:established,to_server; content:"POST "; depth:5; content:!"Referer|3a|"; content:"User-Agent|3a 20|Mozilla/5.0 (Windows NT 6.1|3b| Trident/7.0|3b| rv|3a|10.0) like Gecko|0d 0a|"; fast_pattern:53,20; content:"Connection|3a 20|Close|0d 0a|"; content:"HTTP/1.1|0d 0a|Host|3a 20|"; pcre:"/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}\r\n/R"; threshold: type limit, track by_src, count 1, seconds 60; reference:md5,ac6ea1e500de772341a2075a7d916d63; classtype:trojan-activity; sid:1053507; rev:2; metadata:created_at 2014_12_23, updated_at 2014_12_23, flip_endpoints False, server_side False; target:src_ip;)

# ET TROJAN Kronos Checkin M2 (trojan-activity) - detector_id: 53524 original_sid: 2020077
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Kronos Checkin M2"; flow:established,to_server; content:"POST"; http_method; content:"/connect.php?a=1"; http_uri; fast_pattern:only; content:!"Referer|3a|"; http_header; content:!"Accept"; http_header; content:!"Content-Type|3a|"; http_header; classtype:trojan-activity; sid:1053524; rev:2; metadata:created_at 2014_12_29, updated_at 2014_12_29, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Kronos Checkin (trojan-activity) - detector_id: 53529 original_sid: 2020080
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Kronos Checkin"; flow:established,to_server; content:".php"; http_uri; content:!"Referer|3a|"; http_header; content:!"Accept"; http_header; content:"POST"; http_method; content:!"Content-Type"; http_header; content:"Content-Length|3a 20|74|0d 0a|"; http_header; fast_pattern:only; pcre:"/^(?P<v1>.).{33}(?P=v1).{9}(?P<v2>.)(?:.{4}(?P=v2)){3}/Ps"; classtype:trojan-activity; sid:1053529; rev:2; metadata:created_at 2014_12_29, updated_at 2014_12_29, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Win32/Htbot.B Checkin (trojan-activity) - detector_id: 53566 original_sid: 2020089
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Win32/Htbot.B Checkin"; flow:to_server,established; content:".php?command="; fast_pattern:only; http_uri; content:"User-Agent|3A| pb|0D 0A|"; http_header; pcre:"/\.php\?command=(g(hl|et(ip|id|backconnect))|update2?|dl|log)($|&)/U"; reference:md5,bdd2328d466e563a650bb7ccdb9aca79; reference:md5,ba1404af71ecf3ca8b0e30a2b365f6fd; reference:url,www.microsoft.com/security/portal/threat/encyclopedia/Entry.aspx?Name=Backdoor%3AWin32%2FHtbot.B; classtype:trojan-activity; sid:1053566; rev:4; metadata:created_at 2015_01_05, updated_at 2015_01_05, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Win32/Recslurp.D C2 Response (trojan-activity) - detector_id: 53592 original_sid: 2020155
reject tcp $EXTERNAL_NET 9000:10000 -> $HOME_NET any (msg:"ET TROJAN Win32/Recslurp.D C2 Response"; flow:established,from_server; flowbits:isset,ET.Reslurp.D.Client; content:"|e8 03 00 00|"; depth:4; reference:md5,fcf364abd9c82d89f8d0b4b091276b41; classtype:trojan-activity; sid:1053592; rev:2; metadata:created_at 2015_01_07, updated_at 2015_01_07, flip_endpoints True, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET TROJAN WIN32/KOVTER.B Checkin (trojan-activity) - detector_id: 53659 original_sid: 2020181
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN WIN32/KOVTER.B Checkin"; flow:established,to_server; content:"POST"; http_method; content:".php"; http_uri; pcre:"/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{4})$/P"; content:!".foxitservice.com"; http_host; http_content_type; content:"application/x-www-form-urlencoded"; http_header_names; content:"|0d 0a|Content-Type|0d 0a|User-Agent|0d 0a|Host|0d 0a|Content-Length|0d 0a|"; depth:50; fast_pattern; content:!"Referer"; content:!"Accept"; reference:md5,7943a103d7b79f87843655e6b2f8e80c; classtype:trojan-activity; sid:1053659; rev:9; metadata:created_at 2015_01_14, updated_at 2019_05_31, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Win32/Zeprox.B Checkin (trojan-activity) - detector_id: 53688 original_sid: 2020203
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Win32/Zeprox.B Checkin"; flow:to_server,established; content:"GET"; http_method; content:".php?a=n|60|e|3e|"; http_uri; fast_pattern:only; content:"Content-Length|3a| 0|0d 0a|"; http_header; content:"Proxy-Connection|3a|"; http_header; content:!"Referer|3a|"; http_header; reference:md5,bc27f28e5fe47b78202fd3108d39aac1; reference:md5,38c89cca7806fde08bba82b3cb533e5a; reference:url,www.microsoft.com/security/portal/threat/encyclopedia/entry.aspx?Name=Backdoor%3AWin32/Zeprox.B; classtype:trojan-activity; sid:1053688; rev:5; metadata:created_at 2015_01_16, updated_at 2015_01_16, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Win32.ChinaZ.DDoSClient Checkin (trojan-activity) - detector_id: 53704 original_sid: 2020209
reject tcp $HOME_NET any -> $EXTERNAL_NET 1024:65535 (msg:"ET TROJAN Win32.ChinaZ.DDoSClient Checkin"; flow:established,to_server; content:"Windows "; depth:8; content:"|20|MHZ|00|"; fast_pattern; distance:0; content:"|00|Win"; distance:0; content:"|00|"; distance:2; within:2; reference:md5,8643a44febdf73159b2d5c437dc40cd3; classtype:trojan-activity; sid:1053704; rev:2; metadata:created_at 2015_01_19, updated_at 2015_01_19, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Dridex POST CnC Beacon 2 (trojan-activity) - detector_id: 53805 original_sid: 2020301
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Dridex POST CnC Beacon 2"; flow:established,to_server; urilen:1; content:"POST"; http_method; content:!"Referer|3A|"; http_header; content:"Host|3a 20|"; depth:6; http_header; pcre:"/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}(?:\x3a\d{1,5})?\r?$/RHmi"; content:"Content-Type|3a 20|text/css|0d 0a|Accept|3a 20|image/**|0d 0a|"; distance:0; http_header; fast_pattern:21,20; content:"|0d 0a 0d 0a|"; byte_extract:1,0,Dridex.Pivot,relative; byte_test:1,!=,Dridex.Pivot,0,relative; byte_test:1,=,Dridex.Pivot,7,relative; reference:md5,b9de687cdae55d3c9fcfe6fc8bcdd28f; classtype:trojan-activity; sid:1053805; rev:2; metadata:created_at 2015_01_23, updated_at 2015_01_23, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Dridex Post Checkin Activity 2 (trojan-activity) - detector_id: 53806 original_sid: 2020302
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Dridex Post Checkin Activity 2"; flow:established,to_server; urilen:20<>100; content:!"Referer|3a|"; http_header; content:"|20|HTTP/1.1|0d 0a|Host|3a 20|"; pcre:"/^Host\x3a\x20(?=[a-z0-9]{0,19}[A-Z])(?=[A-Z0-9]{0,19}[a-z])[a-zA-Z0-9]{4,20}\.[a-z]{2,3}/H"; content:"|0d 0a|Connection|3a 20|Close|0d 0a|User-Agent|3a 20|Mozilla/"; http_header; within:41; fast_pattern:4,20; reference:md5,b9de687cdae55d3c9fcfe6fc8bcdd28f; classtype:trojan-activity; sid:1053806; rev:6; metadata:created_at 2015_01_23, updated_at 2015_01_23, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Dyre Downloading Mailer (trojan-activity) - detector_id: 53818 original_sid: 2020308
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Dyre Downloading Mailer"; flow:established,to_server; content:"GET"; http_method; content:".tar"; http_uri; content:!"Accept"; http_header; content:!"Connection|3a|"; http_header; content:!"Referer|3a|"; http_header; content:"User-Agent|3a 20|Mozilla/5.0 (Windows NT 6.1|3b| Win64|3b| x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/39.0.2171.71 Safari/537.36|0d 0a|Host|3a|"; depth:132; http_header; fast_pattern:50,20; pcre:"/^[^\r\n]+\r\n(?:\r\n)?$/RH"; pcre:"/\.tar$/U"; classtype:trojan-activity; sid:1053818; rev:3; metadata:created_at 2015_01_26, updated_at 2015_01_26, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Backdoor family PCRat/Gh0st CnC traffic (OUTBOUND) 45 (trojan-activity) - detector_id: 53951 original_sid: 2020371
reject tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Backdoor family PCRat/Gh0st CnC traffic (OUTBOUND) 45"; flow:to_server,established; dsize:>11; content:"|7a 9a|"; offset:13; depth:2; byte_jump:4,0,little,from_beginning,post_offset -1; isdataat:!2,relative; pcre:"/^.{4}[\x20-\x7e]{5}.{4}\x7a\x9a/s"; reference:url,www.securelist.com/en/descriptions/10155706/Trojan-GameThief.Win32.Magania.eogz; reference:url,www.microsoft.com/security/portal/Threat/Encyclopedia/Entry.aspx?Name=Backdoor%3AWin32/PcClient.ZR&ThreatID=-2147325231; reference:md5,eb7909105fd05064b14a21465742952c; classtype:trojan-activity; sid:1053951; rev:2; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, tag PCRAT, tag Gh0st, tag RAT, signature_severity Critical, created_at 2015_02_05, malware_family Gh0st, malware_family PCRAT, updated_at 2016_07_01, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Win32/Rovnix.J Checkin 2 (trojan-activity) - detector_id: 54015 original_sid: 2020396
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Win32/Rovnix.J Checkin 2"; flow:established,to_server; content:"[0]|0d 0a|LP="; http_client_body; content:"|0a|VID="; distance:0; http_client_body; content:!"Referer|3a|"; http_header; content:"POST"; http_method; reference:md5,9471e926eda81b4f797b6cfe273e4e79; classtype:trojan-activity; sid:1054015; rev:2; metadata:created_at 2015_02_11, updated_at 2015_02_11, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN HawkEye Keylogger FTP (trojan-activity) - detector_id: 54018 original_sid: 2020410
reject tcp $HOME_NET any -> $EXTERNAL_NET 21 (msg:"ET TROJAN HawkEye Keylogger FTP"; flow:established,to_server; content:"STOR HawkEye"; nocase; pcre:"/^(?:_|Keylogger)/Ri"; reference:md5,85f3b302afa0989a91053af6092f3882; classtype:trojan-activity; sid:1054018; rev:4; metadata:created_at 2015_02_11, updated_at 2015_02_11, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Tinba Checkin 2 (trojan-activity) - detector_id: 54028 original_sid: 2020418
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Tinba Checkin 2"; flow:established,to_server; urilen:>1; content:"POST"; http_method; content:"/"; http_uri; isdataat:!1,relative; content:"|0d 0a 0d 0a|"; content:!"|00 00 00 00|"; within:4; content:!"|FF FF FF FF|"; within:4; byte_extract:2,2,Tinba.Pivot,relative; byte_test:2,=,Tinba.Pivot,2,relative; byte_test:2,!=,Tinba.Pivot,5,relative; http_protocol; content:"HTTP/1.0"; http_content_len; byte_test:0,>,99,0,string,dec; http_header_names; content:"|0d 0a|Host|0d 0a|Content-Length|0d 0a 0d 0a|"; fast_pattern; content:!"User-Agent"; content:!"Accept"; flowbits:set,ET.Tinba.Checkin; reference:md5,7af6d8de2759b8cc534ffd72fdd8a654; classtype:trojan-activity; sid:1054028; rev:5; metadata:created_at 2015_02_12, updated_at 2015_02_12, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Gamarue/Andromeda Downloading Payload (trojan-activity) - detector_id: 54403 original_sid: 2020683
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Gamarue/Andromeda Downloading Payload"; flow:established,to_server; content:"GET"; http_method; content:".exe"; http_uri; content:!"Accept"; http_header; content:!"Referer|3a|"; http_header; content:"User-Agent|3a 20|Mozilla/4.0|0d 0a|"; fast_pattern:5,20; http_header; pcre:"/^\/[a-z]+\/[a-z]+\.exe$/U"; reference:md5,85d925a76909f29c3f370f35faedb9ea; classtype:trojan-activity; sid:1054403; rev:2; metadata:created_at 2015_03_11, updated_at 2015_03_11, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Win32/Teslacrypt Ransomware HTTP CnC Beacon M1 (trojan-activity) - detector_id: 55327 original_sid: 2020717
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Win32/Teslacrypt Ransomware HTTP CnC Beacon M1"; flow:established,to_server; content:"GET"; http_method; content:"/state"; http_uri; fast_pattern:only; content:".php?"; http_uri; content:!"Accept"; http_header; content:!"Referer|3a|"; http_header; pcre:"/\/state[^\x2f]*\.php\?[A-Za-z0-9+/]*={0,2}$/U"; reference:md5,c075fa8484d52c3978826c2f07ce9a9c; classtype:trojan-activity; sid:1055327; rev:5; metadata:created_at 2015_03_20, updated_at 2015_03_20, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Win32/Teslacrypt Ransomware HTTP CnC Beacon M2 (trojan-activity) - detector_id: 55328 original_sid: 2020718
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Win32/Teslacrypt Ransomware HTTP CnC Beacon M2"; flow:established,to_server; content:"GET"; http_method; content:".php?U3ViamVjdD1"; http_uri; content:!"Accept"; http_header; content:!"Referer|3a|"; http_header; reference:md5,c075fa8484d52c3978826c2f07ce9a9c; classtype:trojan-activity; sid:1055328; rev:3; metadata:created_at 2015_03_20, updated_at 2015_03_20, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN FindPOS Checkin (trojan-activity) - detector_id: 55332 original_sid: 2020723
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN FindPOS Checkin"; flow:established,to_server; content:"POST"; http_method; content:".php"; http_uri; content:"oprat="; http_client_body; fast_pattern:only; content:"&uid="; http_client_body; content:"&uinfo="; http_client_body; content:"&win="; http_client_body; content:"&vers="; http_client_body; reference:md5,fe0f997d81d88bc11cc03e4d1fd61ebe; classtype:trojan-activity; sid:1055332; rev:3; metadata:created_at 2015_03_20, updated_at 2015_03_20, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Possible Adwind SSL Cert (assylias.Inc) (trojan-activity) - detector_id: 55337 original_sid: 2020728
reject tls $EXTERNAL_NET any -> $HOME_NET any (msg:"ET TROJAN Possible Adwind SSL Cert (assylias.Inc)"; flow:established,from_server; content:"|0b|"; content:"|04 1f 23 9d bd|"; distance:18; within:20; content:"|55 04 0a|"; distance:0; content:"|0c|assylias.Inc"; distance:1; within:13; fast_pattern; reference:md5,4e5c28fab23b35dea2d48a1c2db32b56; classtype:trojan-activity; sid:1055337; rev:2; metadata:attack_target Client_Endpoint, deployment Perimeter, tag SSL_Malicious_Cert, signature_severity Major, created_at 2015_03_23, updated_at 2016_07_01, flip_endpoints True, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET TROJAN TinyLoader.B1 Checkin x86 (trojan-activity) - detector_id: 57273 original_sid: 2020849
reject udp $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN TinyLoader.B1 Checkin x86"; dsize:12; content:"|00 00 00 00 00 00 00 00 00 00 00 32|"; fast_pattern:only; reference:md5,bd69714997e839618a7db82484819552; classtype:trojan-activity; sid:1057273; rev:2; metadata:created_at 2015_04_07, updated_at 2015_04_07, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN TinyLoader.B1 Checkin x64 (trojan-activity) - detector_id: 57274 original_sid: 2020850
reject udp $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN TinyLoader.B1 Checkin x64"; dsize:12; content:"|00 00 00 00 00 00 00 00 00 00 00 86|"; fast_pattern:only; reference:md5,bd69714997e839618a7db82484819552; classtype:trojan-activity; sid:1057274; rev:1; metadata:created_at 2015_04_07, updated_at 2015_04_07, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN TinyLoader.B2 Checkin no architecture (trojan-activity) - detector_id: 57275 original_sid: 2020851
reject udp $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN TinyLoader.B2 Checkin no architecture"; dsize:12; content:"|00 00 00 00 00 00 00 00 00 00 00 84|"; fast_pattern:only; reference:md5,b4ce43e1c9e74c549e2bae8cd77d5af1; classtype:trojan-activity; sid:1057275; rev:1; metadata:created_at 2015_04_07, updated_at 2015_04_07, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN W32/Farfli.BHQ!tr Dropper CnC Beacon 2 (trojan-activity) - detector_id: 57464 original_sid: 2020913
reject http $HOME_NET any -> $EXTERNAL_NET !80 (msg:"ET TROJAN W32/Farfli.BHQ!tr Dropper CnC Beacon 2"; flow:established,to_server; content:"GET"; http_method; content:"/do.asp?search="; http_uri; fast_pattern:only; content:!"Referer|3a|"; http_header; pcre:"/^Host\x3A\x20\d{1,3}\x2E\d{1,3}\x2E\d{1,3}\x2E\d{1,3}\x3A\d{1,5}\r?$/Hmi"; reference:md5,93be88ad3816c19d74155f8cd3aae1d2; classtype:trojan-activity; sid:1057464; rev:2; metadata:created_at 2015_04_15, updated_at 2015_04_15, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Win32/Neutrino Bot Fake 404 Checkin Response (trojan-activity) - detector_id: 57559 original_sid: 2020949
reject http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET TROJAN Win32/Neutrino Bot Fake 404 Checkin Response"; flow:to_client,established; content:"404"; http_stat_code; file_data; content:"<!--"; distance:0; content:"NCMD|3a|"; within:6; metadata:former_category TROJAN, flip_endpoints True, server_side False; reference:url,blog.fortinet.com/post/hiding-malicious-traffic-under-the-http-404-error; classtype:trojan-activity; sid:1057559; rev:3; metadata:created_at 2015_04_20, updated_at 2017_03_29; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET TROJAN ABUSE.CH SSL Blacklist Malicious SSL certificate detected (Dridex/Trickbot CnC) (trojan-activity) - detector_id: 57682 original_sid: 2021013
alert tls $EXTERNAL_NET any -> $HOME_NET any (msg:"ET TROJAN ABUSE.CH SSL Blacklist Malicious SSL certificate detected (Dridex/Trickbot CnC)"; flow:established,from_server; content:"|16|"; content:"|0b|"; within:8; content:"|09 00|"; within:30; content:"|55 04 0a|"; distance:0; content:"|0f|Global Security"; distance:1; within:16; fast_pattern; content:"|55 04 0b|"; distance:0; content:"|0d|IT Department"; distance:1; within:14; content:"|55 04 03|"; distance:0; content:"|0b|example."; distance:1; within:9; metadata:former_category TROJAN, flip_endpoints True, server_side False; reference:url,sslbl.abuse.ch; classtype:trojan-activity; sid:1057682; rev:7; metadata:attack_target Client_Endpoint, deployment Perimeter, tag SSL_Malicious_Cert, signature_severity Major, created_at 2015_04_27, updated_at 2018_05_17; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET TROJAN ABUSE.CH SSL Blacklist Malicious SSL certificate detected (Dridex CnC) (trojan-activity) - detector_id: 57939 original_sid: 2021106
alert tls $EXTERNAL_NET any -> $HOME_NET any (msg:"ET TROJAN ABUSE.CH SSL Blacklist Malicious SSL certificate detected (Dridex CnC)"; flow:established,from_server; content:"|16|"; content:"|0b|"; within:8; content:"|09 00|"; within:30; content:"|55 04 0a|"; distance:0; content:"|11|Facebook Porn PTY"; distance:1; within:18; classtype:trojan-activity; sid:1057939; rev:3; metadata:attack_target Client_Endpoint, deployment Perimeter, tag SSL_Malicious_Cert, signature_severity Major, created_at 2015_05_15, updated_at 2016_07_01, flip_endpoints True, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET TROJAN ABUSE.CH SSL Blacklist Malicious SSL certificate detected (Dridex CnC) (trojan-activity) - detector_id: 57942 original_sid: 2021102
alert tls $EXTERNAL_NET any -> $HOME_NET any (msg:"ET TROJAN ABUSE.CH SSL Blacklist Malicious SSL certificate detected (Dridex CnC)"; flow:established,from_server; content:"|55 04 08|"; content:"|07|Glasgow"; distance:1; within:8; content:"|55 04 07|"; distance:0; content:"|06|Glasgo"; distance:1; within:7; content:"|55 04 0a|"; distance:0; content:"|0b|Green Peace"; distance:1; within:12; reference:md5,3cecc935eb92ed03dc9908fc96b0f795; classtype:trojan-activity; sid:1057942; rev:2; metadata:attack_target Client_Endpoint, deployment Perimeter, tag SSL_Malicious_Cert, signature_severity Major, created_at 2015_05_15, updated_at 2016_07_01, flip_endpoints True, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET TROJAN H1N1 Loader CnC Beacon M1 (trojan-activity) - detector_id: 58032 original_sid: 2021139
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN H1N1 Loader CnC Beacon M1"; flow:established,to_server; content:"POST"; http_method; content:"/gate.php"; http_uri; fast_pattern:only; content:!"Referer|3a|"; http_header; content:"Accept|3a 20|*/*|0d 0a|accept-Encoding|3a 20|none|0d 0a|accept-Language|3a 20|"; depth:53; http_header; pcre:"/\/gate\.php$/U"; pcre:"/^[A-Za-z0-9/_]+={0,2}$/P"; reference:url,kernelmode.info/forum/viewtopic.php?f=16&t=3851; classtype:trojan-activity; sid:1058032; rev:2; metadata:created_at 2015_05_22, updated_at 2015_05_22, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Likely Dridex SSL Cert (trojan-activity) - detector_id: 58044 original_sid: 2021145
alert tls $EXTERNAL_NET any -> $HOME_NET any (msg:"ET TROJAN Likely Dridex SSL Cert"; flow:established,from_server; content:"|16|"; content:"|0b|"; within:8; content:"|09 00|"; within:30; content:"|55 04 08|"; distance:0; content:"|07|Montana"; distance:1; within:8; content:"|55 04 07|"; distance:0; content:"|09|Liverpool"; distance:1; within:10; content:"|55 04 03|"; distance:0; content:"|0e|southnorth.org"; distance:1; within:15; fast_pattern; reference:md5,440e5c0aee33cba3c4707ada0856ff6d; classtype:trojan-activity; sid:1058044; rev:2; metadata:attack_target Client_Endpoint, deployment Perimeter, tag SSL_Malicious_Cert, signature_severity Major, created_at 2015_05_26, updated_at 2016_07_01, flip_endpoints True, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET TROJAN Bladabindi/njRAT CnC Command (ll) (trojan-activity) - detector_id: 58160 original_sid: 2021176
reject tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Bladabindi/njRAT CnC Command (ll)"; flow:established,to_server; content:"|00|ll|7c 27 7c 27 7c|"; nocase; fast_pattern; pcre:"/^\d{1,5}\x00ll\x7c/i"; reference:md5,ac7b1fdc679fdbd3cb0cd8a3e30ecddb; classtype:trojan-activity; sid:1058160; rev:3; metadata:created_at 2015_06_02, updated_at 2015_06_02, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Sakula/Mivast RAT CnC Beacon 2 (trojan-activity) - detector_id: 58324 original_sid: 2021200
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Sakula/Mivast RAT CnC Beacon 2"; flow:to_server,established; content:"GET"; http_method; content:".jpg?resid="; http_uri; fast_pattern; http_header_names; content:!"Accept-"; content:!"Referer"; reference:md5,3cd598e8e2fd033134d8784251eff59e; classtype:trojan-activity; sid:1058324; rev:3; metadata:created_at 2015_06_08, updated_at 2015_06_08, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Sakula/Mivast RAT CnC Beacon 3 (trojan-activity) - detector_id: 58325 original_sid: 2021201
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Sakula/Mivast RAT CnC Beacon 3"; flow:to_server,established; content:"GET"; http_method; content:".asp?resid="; http_uri; fast_pattern; content:"&photoid="; http_uri; http_header_names; content:!"Accept-"; content:!"Referer"; reference:md5,3cd598e8e2fd033134d8784251eff59e; classtype:trojan-activity; sid:1058325; rev:3; metadata:created_at 2015_06_08, updated_at 2015_06_08, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN ABUSE.CH SSL Blacklist Malicious SSL certificate detected (Dridex CnC) (trojan-activity) - detector_id: 58807 original_sid: 2021353
reject tls $EXTERNAL_NET any -> $HOME_NET any (msg:"ET TROJAN ABUSE.CH SSL Blacklist Malicious SSL certificate detected (Dridex CnC)"; flow:established,from_server; content:"|16|"; content:"|0b|"; within:8; content:"|09 00|"; within:30; content:"|55 04 08|"; distance:0; content:"|07|Indiana"; distance:1; within:8; content:"|55 04 03|"; distance:0; content:"|0d|koalashelp.au"; distance:1; within:14; fast_pattern; reference:url,sslbl.abuse.ch; classtype:trojan-activity; sid:1058807; rev:2; metadata:attack_target Client_Endpoint, deployment Perimeter, tag SSL_Malicious_Cert, signature_severity Major, created_at 2015_06_26, updated_at 2016_07_01, flip_endpoints True, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET TROJAN Zberp receiving config via image file - SET (trojan-activity) - detector_id: 58936 original_sid: 2021381
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Zberp receiving config via image file - SET"; flow:to_server,established; content:".jpg"; http_uri; isdataat:!1,relative; http_header_names; content:!"Referer"; http_request_line; content:".jpg HTTP/1."; fast_pattern; flowbits:set,ET.Zberp; flowbits:noalert; reference:md5,1e1f44f8a403c4ebc6943eb2dcf731ff; reference:url,securityintelligence.com/new-zberp-trojan-discovered-zeus-zbot-carberp/#.U5Xgpyh4l8u; reference:url,blog.malwarebytes.org/security-threat/2014/02/hiding-in-plain-sight-a-story-about-a-sneaky-banking-trojan/; classtype:trojan-activity; sid:1058936; rev:8; metadata:created_at 2015_07_06, updated_at 2019_06_14, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Zberp/ZeusVM receiving config via image file (steganography) (trojan-activity) - detector_id: 58937 original_sid: 2021382
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET TROJAN Zberp/ZeusVM receiving config via image file (steganography)"; flow:from_server,established; flowbits:isset,ET.Zberp; file_data; content:"|ff fe 3f 10 00 00|"; distance:0; byte_test:4,>,100,4,relative,little; byte_extract:4,4,config_len,relative,little; content:!"|00|"; within:config_len; pcre:"/^[^\x00]+(\xff\xd9)?$/R"; reference:md5,1e1f44f8a403c4ebc6943eb2dcf731ff; reference:url,securityintelligence.com/new-zberp-trojan-discovered-zeus-zbot-carberp/#.U5Xgpyh4l8u; reference:url,blog.malwarebytes.org/security-threat/2014/02/hiding-in-plain-sight-a-story-about-a-sneaky-banking-trojan/; classtype:trojan-activity; sid:1058937; rev:11; metadata:created_at 2015_07_06, updated_at 2016_11_03, flip_endpoints True, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET TROJAN Zberp/ZeusVM receiving config via image file (steganography) 2 (trojan-activity) - detector_id: 58938 original_sid: 2021383
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET TROJAN Zberp/ZeusVM receiving config via image file (steganography) 2"; flow:from_server,established; flowbits:isset,ET.Zberp; file_data; content:"0103F|00|"; distance:0; content:"|ff fe|"; distance:-10; within:2; byte_test:2,>,100,0,relative,little; byte_extract:2,0,config_len,relative,little; content:!"|00|"; distance:6; within:config_len; pcre:"/^0103F\x00[^\x00]+(\xff\xd9)?$/R"; reference:md5,7ba76b0ec1249b19a46e1603e5ab0a90; reference:url,blog.malwarebytes.org/security-threat/2014/02/hiding-in-plain-sight-a-story-about-a-sneaky-banking-trojan/; classtype:trojan-activity; sid:1058938; rev:3; metadata:created_at 2015_07_06, updated_at 2016_11_03, flip_endpoints True, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET TROJAN Matsnu Checkin (trojan-activity) - detector_id: 59026 original_sid: 2021399
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Matsnu Checkin"; flow:to_server,established; content:"POST"; http_method; nocase; content:".php?"; fast_pattern:only; http_uri; content:!"Referer|3a| "; http_header; content:"User-Agent|3a| Mozilla/4.0 (compatible|3b| MSIE 6.0b|3b| Windows NT 5.0|3b| .NET CLR 1.0.2914|29 0d 0a|"; http_header; content:"Connection|3a| Keep-Alive|0d 0a|Cache-Control|3a| no-cache|0d 0a|"; http_header; content:"="; depth:7; http_client_body; content:"AA"; distance:3; within:2; http_client_body; pcre:"/^[a-z]{1,7}=(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{4})$/P"; reference:md5,7ff6912828faedbf39c4c66c7ba0260d; reference:md5,0361c2685bf799c04d796a6d18e1f075; reference:url,blog.checkpoint.com/wp-content/uploads/2015/07/matsnu-malwareid-technical-brief.pdf; classtype:trojan-activity; sid:1059026; rev:3; metadata:created_at 2015_07_10, updated_at 2015_07_10, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Bedep HTTP POST CnC Beacon (trojan-activity) - detector_id: 59122 original_sid: 2021418
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Bedep HTTP POST CnC Beacon"; flow:established,to_server; content:"POST"; http_method; content:".php"; http_uri; pcre:"/\.php(?:\?[a-zA-Z0-9=&]+)?$/U"; pcre:"/^[a-z]+\d*=(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{4})(?:&[a-z]+\d*=(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{4})){2,}$/P"; pcre:"/^(?:Connection\x3a[^\r\n]+\r\n)?(?:Content-Type\x3a[^\r\n]+\r\n)?Accept\x3a[^\r\n]+\r\n(?:Accept-Encoding\x3a[^\r\n]+\r\n)?Accept-Language\x3a[^\r\n]+\r\n(?:Content-Type\x3a[^\r\n]+\r\n)?(?:Referer\x3a[^\r\n]+\.php[^\r\n]*?\r\n)?User-Agent\x3a[^\r\n]+(?: MSIE |rv\x3a11)/Hi"; http_accept; content:"text/html, application/xhtml+xml, */*"; isdataat:!1,relative; fast_pattern; http_header_names; content:"|0d 0a|Accept-Language|0d 0a|"; content:"User-Agent|0d 0a|"; distance:0; classtype:trojan-activity; sid:1059122; rev:10; metadata:created_at 2015_07_15, updated_at 2019_05_29, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN KeyBase Keylogger HTTP Pattern (trojan-activity) - detector_id: 59211 original_sid: 2021440
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN KeyBase Keylogger HTTP Pattern"; flow:to_server,established; content:"GET"; http_method; nocase; content:"/post.php?type="; http_uri; fast_pattern; content:"&machinename="; http_uri; distance:0; content:!"User-Agent|3a 20|"; http_header; pcre:"/^Host\x3a[^\r\n]+\r\n(?:Connection\x3a\x20Keep-Alive\r\n)?(?:\r\n)?/H"; reference:md5,5626771cf6751286de4b90ea4b8df94d; reference:url,researchcenter.paloaltonetworks.com/2015/06/keybase-keylogger-malware-family-exposed/; classtype:trojan-activity; sid:1059211; rev:2; metadata:created_at 2015_07_20, updated_at 2015_07_20, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN PoisonIvy HTTP CnC Beacon (trojan-activity) - detector_id: 59302 original_sid: 2021523
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN PoisonIvy HTTP CnC Beacon"; flow:established,to_server; content:"|20|HTTP|3a 2f 2f|"; offset:3; depth:9; content:!"Host|3a|"; distance:0; content:!"User-Agent|3a|"; distance:0; content:!"Accept"; distance:0; content:!"Referer|3a|"; distance:0; content:"HTTP/1.1|0d 0a|Cookie|3a 20|id="; fast_pattern; pcre:"/^[0-9A-F]{12}/R"; reference:md5,1aca09c5eefb37539e86ec86dd3be72f; reference:url,blog.jpcert.or.jp/2015/07/poisonivy-adapts-to-communicate-through-authentication-proxies.html; classtype:trojan-activity; sid:1059302; rev:3; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, tag PoisonIvy, signature_severity Critical, created_at 2015_07_23, malware_family PoisonIvy, updated_at 2016_07_01, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN W32/Alina.POS-Trojan Checkin (trojan-activity) - detector_id: 59540 original_sid: 2021597
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN W32/Alina.POS-Trojan Checkin"; flow:established,to_server; content:"POST"; http_method; content:".php"; http_uri; content:"Accept|3a 20|application/octet-stream|0d 0a|Content-Type|3a 20|application/octet-stream|0d 0a|"; depth:74; http_header; fast_pattern; content:!"Referer|3a|"; http_header; pcre:"/\.php$/U"; reference:md5,3959fb5b5909d9c6fb9c9a408d35f67a; reference:url,trendmicro.com/cloud-content/us/pdfs/security-intelligence/white-papers/wp-pos-ram-scraper-malware.pdf; classtype:trojan-activity; sid:1059540; rev:4; metadata:created_at 2015_08_05, updated_at 2015_08_05, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Ursnif Variant CnC Beacon (trojan-activity) - detector_id: 60257 original_sid: 2021813
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Ursnif Variant CnC Beacon"; flow:established,to_server; urilen:>125; content:"GET"; http_method; content:"/images/"; http_uri; fast_pattern; content:".gif"; distance:100; http_uri; content:!"Accept"; http_header; content:!"Referer|3a|"; http_header; pcre:"/\/images(?:\/[a-zA-Z0-9_]+)+\.gif$/U"; pcre:"/^User-Agent\x3a\x20(?:Mozilla\/|Shockwave)/Hmi"; reference:md5,f48f626cf746a2c3c73182c752c481b6; reference:md5,8ab21ac9199d3ced2230924b90f49f0d; classtype:trojan-activity; sid:1060257; rev:6; metadata:created_at 2015_09_22, updated_at 2015_09_22, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Ursnif Variant CnC Data Exfil (trojan-activity) - detector_id: 60272 original_sid: 2021830
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Ursnif Variant CnC Data Exfil"; flow:established,to_server; urilen:>125; content:"POST"; http_method; content:!"Accept"; http_header; content:!"Referer|3a|"; http_header; content:"name=|22|upload_file|22 3b 20|filename=|22|"; http_client_body; fast_pattern; content:".bin|22 0d 0a|"; distance:4; within:7; http_client_body; pcre:"/\.[a-z]{3,4}$/U"; reference:md5,f870c0d62691fc39194922e4a59fdc1c; classtype:trojan-activity; sid:1060272; rev:3; metadata:created_at 2015_09_23, updated_at 2015_09_23, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Possible Dridex SSL Cert Oct 12 2015 (trojan-activity) - detector_id: 60416 original_sid: 2021946
reject tls $EXTERNAL_NET any -> $HOME_NET any (msg:"ET TROJAN Possible Dridex SSL Cert Oct 12 2015"; flow:established,from_server; content:"|16|"; content:"|0b|"; within:8; content:"|09 00|"; distance:9; within:25; content:"|30 09 06 03 55 04 06 13 02|AU|31|"; distance:0; fast_pattern; content:!"|55 04 08|"; distance:0; content:!"|55 04 07|"; distance:0; content:"|55 04 0a|"; distance:0; pcre:"/^.{2}(?!GoDaddy)[A-Z][a-z]+\s[A-Z][a-z]+\s(?:NL|Pty|Inc|Corp|Ltd)/Rs"; content:"|55 04 03|"; distance:0; pcre:"/^.{2}[a-z]{5,}\.[a-z]{2,3}[01]/R"; classtype:trojan-activity; sid:1060416; rev:2; metadata:attack_target Client_Endpoint, deployment Perimeter, tag SSL_Malicious_Cert, signature_severity Major, created_at 2015_10_12, updated_at 2016_07_01, flip_endpoints True, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET TROJAN Win32/Kelihos.F Checkin (trojan-activity) - detector_id: 60417 original_sid: 2021947
alert tcp $HOME_NET any -> $EXTERNAL_NET 80 (msg:"ET TROJAN Win32/Kelihos.F Checkin"; flow:to_server,established; dsize:164; content:"|6c 55 55 45 03 10 48 40|"; offset:4; depth:8; reference:md5,dc226166dfbe28eee2576ea5141bc19d; reference:md5,dadee91e0b82fc91a25a66b61bb2f2dc; classtype:trojan-activity; sid:1060417; rev:3; metadata:created_at 2015_10_12, updated_at 2015_10_12, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN MWI Maldoc Stats Callout Oct 28 (trojan-activity) - detector_id: 60485 original_sid: 2022008
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN MWI Maldoc Stats Callout Oct 28"; flow:established,to_server; content:"/pict."; content:"?id="; http_uri; pcre:"/\/pict\.(?:jpg|php|xsp)\?id=\d+((?:&data=|&bid=)[^&]*?)?$/U"; content:"office"; http_header; nocase; fast_pattern:only; pcre:"/^User-Agent\x3a\x20[^\x0d\x0a]+?ms-?office/Hmi"; content:!".money-media.com|0d 0a|"; nocase; http_header; reference:md5,2c9f2a84a346e29c3b262ca1d2d2f123; classtype:trojan-activity; sid:1060485; rev:3; metadata:created_at 2015_10_28, updated_at 2016_10_18, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN njrat ver 0.7d Malware CnC Callback (Remote Desktop) (trojan-activity) - detector_id: 60531 original_sid: 2022060
reject tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN njrat ver 0.7d Malware CnC Callback (Remote Desktop)"; flow:from_client,established; content:"|00|sc~|7c 27 7c 27 7c|"; nocase; fast_pattern; pcre:"/^\d{1,6}\x00sc\x7e\x7c/i"; reference:md5,a42317b9f9d3df375218e650999d48c4; classtype:trojan-activity; sid:1060531; rev:1; metadata:created_at 2015_11_10, updated_at 2015_11_10, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN njrat ver 0.7d Malware CnC Callback Response (Remote Desktop) (trojan-activity) - detector_id: 60532 original_sid: 2022061
reject tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN njrat ver 0.7d Malware CnC Callback Response (Remote Desktop)"; flow:from_client,established; content:"|00|scPK|7c 27 7c 27 7c|"; nocase; fast_pattern; pcre:"/^\d{1,6}\x00scPK\x7c/i"; reference:md5,a42317b9f9d3df375218e650999d48c4; classtype:trojan-activity; sid:1060532; rev:1; metadata:created_at 2015_11_10, updated_at 2015_11_10, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN TinyLoader.B2 Checkin x64 (trojan-activity) - detector_id: 60541 original_sid: 2022072
reject udp $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN TinyLoader.B2 Checkin x64"; dsize:12; content:"|00 00 00 00 00 00 00 00 00 00 00 BA|"; fast_pattern:only; reference:md5,b4ce43e1c9e74c549e2bae8cd77d5af1; classtype:trojan-activity; sid:1060541; rev:1; metadata:created_at 2015_11_11, updated_at 2015_11_11, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Bookworm CnC Beacon (trojan-activity) - detector_id: 60542 original_sid: 2022073
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Bookworm CnC Beacon"; flow:to_server,established; content:"GET"; http_method; content:"/0"; http_uri; fast_pattern; content:!"Accept"; http_header; content:!"Referer|3a|"; http_header; content:!"User-Agent|3a 20|"; http_header; pcre:"/^\/0[a-f0-9]{48}$/Ui"; reference:md5,8ae2468d3f208d07fb47ebb1e0e297d7; reference:url,researchcenter.paloaltonetworks.com/2015/11/bookworm-trojan-a-model-of-modular-architecture/; classtype:trojan-activity; sid:1060542; rev:2; metadata:created_at 2015_11_11, updated_at 2015_11_11, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Bookworm CnC Beacon 2 (trojan-activity) - detector_id: 60543 original_sid: 2022074
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Bookworm CnC Beacon 2"; flow:to_server,established; content:"POST"; http_method; content:"000"; http_uri; fast_pattern; content:!"Accept"; http_header; content:!"Referer|3a|"; http_header; content:!"User-Agent|3a 20|"; http_header; pcre:"/^\/[a-f0-9]+000[a-f0-9]{37}$/Ui"; reference:md5,0f41c853a2d522e326f2c30b4b951b04; reference:url,researchcenter.paloaltonetworks.com/2015/11/bookworm-trojan-a-model-of-modular-architecture/; classtype:trojan-activity; sid:1060543; rev:3; metadata:created_at 2015_11_11, updated_at 2015_11_11, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Vawtrak HTTP CnC Beacon (trojan-activity) - detector_id: 60702 original_sid: 2022225
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Vawtrak HTTP CnC Beacon"; flow:established,to_server; content:"POST"; http_method; pcre:"/^[\x20-\x7e\r\n]{0,20}[^\x20-\x7e\r\n]/P"; content:"PHPSESSID="; http_cookie; depth:10; fast_pattern; pcre:"/^[A-F0-9]{32}$/CR"; http_content_type; content:"application/octet-stream"; depth:24; isdataat:!1,relative; http_header_names; content:!"IBM-PROXY-WTE"; nocase; classtype:trojan-activity; sid:1060702; rev:8; metadata:created_at 2015_12_07, updated_at 2016_11_15, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Win32.Nitol.K Variant CnC (trojan-activity) - detector_id: 60849 original_sid: 2022337
reject tcp $HOME_NET any -> $EXTERNAL_NET 1024: (msg:"ET TROJAN Win32.Nitol.K Variant CnC"; flow:established,to_server; content:"|0b 00 00 00 00|"; depth:5; content:"Windows|20|"; distance:3; within:8; content:"|00|"; within:5; content:"|7c b4 ab b2 a5 7c|"; fast_pattern:only; reference:md5,56bff68317a0af08f749a1c717125cf3; classtype:trojan-activity; sid:1060849; rev:2; metadata:created_at 2016_01_06, updated_at 2016_01_06, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Win32/Neutrino Checkin 2 (trojan-activity) - detector_id: 61019 original_sid: 2022462
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Win32/Neutrino Checkin 2"; flow:to_server,established; content:"POST"; http_method; content:!"Referer|3a|"; http_header; content:"auth=1"; http_client_body; depth:6; pcre:"/^$/RP"; metadata:former_category TROJAN, flip_endpoints False, server_side False; reference:md5,25bd222c947fcbb7e1fb9f6e176ea53f; reference:url,securitykitten.github.io/an-evening-with-n3utrino/; classtype:trojan-activity; sid:1061019; rev:3; metadata:created_at 2016_01_27, updated_at 2017_03_29; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Win32/Neutrino Checkin 3 (trojan-activity) - detector_id: 61020 original_sid: 2022463
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Win32/Neutrino Checkin 3"; flow:to_server,established; content:"POST"; http_method; content:!"Referer|3a|"; http_header; content:"exec=1&task_id="; http_client_body; depth:15; fast_pattern; metadata:former_category TROJAN, flip_endpoints False, server_side False; reference:md5,25bd222c947fcbb7e1fb9f6e176ea53f; reference:url,securitykitten.github.io/an-evening-with-n3utrino/; classtype:trojan-activity; sid:1061020; rev:3; metadata:created_at 2016_01_27, updated_at 2017_03_29; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN JS/Nemucod requesting EXE payload 2016-01-28 (trojan-activity) - detector_id: 61041 original_sid: 2022483
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN JS/Nemucod requesting EXE payload 2016-01-28"; flow:to_server,established; urilen:>82; content:"GET"; http_method; content:"/counter/?id="; http_uri; nocase; content:"&rnd="; http_uri; nocase; pcre:"/\/counter\/\?id=[A-Z0-9_-]{60,}&rnd=\d{1,}$/iU"; flowbits:set,ET.nemucod.exerequest; http_header_names; content:!"Referer"; reference:url,certego.net/en/news/italian-spam-campaigns-using-js-nemucod-downloader/; reference:md5,d5c5cc9cae2e9a7a2d3a77efcb526e4c; classtype:trojan-activity; sid:1061041; rev:6; metadata:created_at 2016_02_02, updated_at 2016_11_18, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Suspicious Accept in HTTP POST - Possible Alphacrypt/TeslaCrypt (trojan-activity) - detector_id: 61076 original_sid: 2022502
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Suspicious Accept in HTTP POST - Possible Alphacrypt/TeslaCrypt"; flow:established,to_server; content:"POST"; http_method; content:".php"; http_uri; isdataat:!1,relative; http_header_names; content:"|0d 0a|Accept|0d 0a|"; depth:10; fast_pattern; content:!"Referer"; content:"Accept"; http_accept; pcre:"/^(?!m(?:ultipart|essage|odel)|a(?:pplication|udio|ccept)|(?:exampl|imag)e|video|text|\*)/i"; reference:md5,35a6de1e8dbea19bc44cf49ae0cae59e; classtype:trojan-activity; sid:1061076; rev:4; metadata:created_at 2016_02_10, updated_at 2016_02_10, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN OSX/KeRanger Ransomware CnC DNS Request 1 (trojan-activity) - detector_id: 61198 original_sid: 2022598
reject udp $HOME_NET any -> any 53 (msg:"ET TROJAN OSX/KeRanger Ransomware CnC DNS Request 1"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|10|lclebb6kvohlkcml"; nocase; distance:0; fast_pattern; reference:url,researchcenter.paloaltonetworks.com/2016/03/new-os-x-ransomware-keranger-infected-transmission-bittorrent-client-installer; classtype:trojan-activity; sid:1061198; rev:1; metadata:created_at 2016_03_07, updated_at 2016_03_07, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN OSX/KeRanger Ransomware CnC DNS Request 2 (trojan-activity) - detector_id: 61199 original_sid: 2022599
reject udp $HOME_NET any -> any 53 (msg:"ET TROJAN OSX/KeRanger Ransomware CnC DNS Request 2"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|10|bmacyzmea723xyaz"; nocase; distance:0; fast_pattern; reference:url,researchcenter.paloaltonetworks.com/2016/03/new-os-x-ransomware-keranger-infected-transmission-bittorrent-client-installer; classtype:trojan-activity; sid:1061199; rev:1; metadata:created_at 2016_03_07, updated_at 2016_03_07, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN OSX/KeRanger Ransomware CnC DNS Request 3 (trojan-activity) - detector_id: 61200 original_sid: 2022600
reject udp $HOME_NET any -> any 53 (msg:"ET TROJAN OSX/KeRanger Ransomware CnC DNS Request 3"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|10|nejdtkok7oz5kjoc"; nocase; distance:0; fast_pattern; reference:url,researchcenter.paloaltonetworks.com/2016/03/new-os-x-ransomware-keranger-infected-transmission-bittorrent-client-installer; classtype:trojan-activity; sid:1061200; rev:1; metadata:created_at 2016_03_07, updated_at 2016_03_07, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Panda Banker CnC (trojan-activity) - detector_id: 61222 original_sid: 2022609
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Panda Banker CnC"; flow:established,to_server; content:"POST"; http_method; content:!".php"; http_uri; pcre:"/^\/[A-Za-z0-9]+(?:\/[A-F0-9]+){3,}$/U"; pcre:"/^[\x20-\x7e\r\n]{0,20}[^\x20-\x7e\r\n]/P"; pcre:"/^User-Agent\x3a[^\r\n]+?(?:MSIE|rv\x3a11)/Hm"; http_header_names; content:!"Content-Type"; content:!"Referer"; http_accept; content:"*/*"; depth:3; isdataat:!1,relative; http_start; content:"P/1.1|0d 0a|Accept|3a 20|*/*|0d 0a|"; fast_pattern; reference:md5,17bd012f145bba62b4e58b376d8002d3; classtype:trojan-activity; sid:1061222; rev:3; metadata:created_at 2016_03_10, updated_at 2019_05_22, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Win32/CryptFile2 Ransomware Checkin (trojan-activity) - detector_id: 61328 original_sid: 2022683
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Win32/CryptFile2 Ransomware Checkin"; flow:established,to_server; content:"POST"; http_method; content:".php"; http_uri; pcre:"/\.php$/U"; content:"|3d 30 78 30 36 2c 30 78 30 32 2c 30 78 30 30 2c 30 78 30 30|"; fast_pattern; http_client_body; content:"|2c 3c 62 72 3e 30 78|"; distance:0; http_client_body; content:"|2c 3c 62 72 3e 30 78|"; distance:0; http_client_body; content:"|2c 3c 62 72 3e 30 78|"; distance:0; http_client_body; reference:md5,5bb7d85f7a5f1d2b01efabe5635e2992; classtype:trojan-activity; sid:1061328; rev:4; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, tag Ransomware, signature_severity Major, created_at 2016_03_29, malware_family Ransomware, malware_family CryptFile2, performance_impact Low, updated_at 2016_10_24, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN LuminosityLink - Data Channel Client Request 2 (trojan-activity) - detector_id: 61370 original_sid: 2022707
reject tcp any any -> any any (msg:"ET TROJAN LuminosityLink - Data Channel Client Request 2"; flow:established,to_server; content:"CONNECT="; depth:8; content:"8_=_8"; distance:0; isdataat:!1,relative; classtype:trojan-activity; sid:1061370; rev:1; metadata:created_at 2016_04_05, updated_at 2016_04_05, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN LuminosityLink - CnC Password Exfil (trojan-activity) - detector_id: 61372 original_sid: 2022709
reject tcp any any -> any any (msg:"ET TROJAN LuminosityLink - CnC Password Exfil"; flow:established,to_server; content:"PASSWORDS="; depth:10; content:"8_=_8"; distance:0; isdataat:!1,relative; classtype:trojan-activity; sid:1061372; rev:1; metadata:created_at 2016_04_05, updated_at 2016_04_05, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN LuminosityLink - CnC (trojan-activity) - detector_id: 61373 original_sid: 2022710
reject tcp any any -> any any (msg:"ET TROJAN LuminosityLink - CnC"; flow:established,to_server; content:"ACT="; depth:4; content:"8_=_8"; distance:0; isdataat:!1,relative; classtype:trojan-activity; sid:1061373; rev:1; metadata:created_at 2016_04_05, updated_at 2016_04_05, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN ABUSE.CH SSL Blacklist Malicious SSL certificate detected (Qadars CnC) (trojan-activity) - detector_id: 61423 original_sid: 2022736
reject tls $EXTERNAL_NET 443 -> $HOME_NET any (msg:"ET TROJAN ABUSE.CH SSL Blacklist Malicious SSL certificate detected (Qadars CnC)"; flow:established,from_server; content:"|2a 86 48 86 f7 0d 01 09 01|"; content:"|17|private@sysprivpop.lkdd"; distance:1; within:24; reference:url,sslbl.abuse.ch; classtype:trojan-activity; sid:1061423; rev:4; metadata:attack_target Client_Endpoint, deployment Perimeter, tag SSL_Malicious_Cert, signature_severity Major, created_at 2016_04_14, updated_at 2016_07_01, flip_endpoints True, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET TROJAN Ransomware Locky CnC Beacon 2 (trojan-activity) - detector_id: 61505 original_sid: 2022769
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Ransomware Locky CnC Beacon 2"; flow:established,to_server; urilen:13; content:"POST"; http_method; content:"/userinfo.php"; http_uri; fast_pattern; pcre:"/[\x80-\xff]/P"; http_content_type; content:"www-form-urlencoded"; isdataat:!1,relative; http_header_names; content:"|0d 0a|User-Agent|0d 0a|"; content:!"Referer"; content:!"Accept"; reference:md5,042b2e41a14b67570a993ef909621954; classtype:trojan-activity; sid:1061505; rev:3; metadata:created_at 2016_04_27, updated_at 2016_04_27, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Win32.Sality-GR Checkin 2 (trojan-activity) - detector_id: 61824 original_sid: 2022804
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Win32.Sality-GR Checkin 2"; flow:to_server,established; content:".png?"; http_uri; fast_pattern:only; content:"User-Agent|3a 20|"; depth:12; http_header; content:!"Accept"; http_header; content:!"Referer"; http_header; pcre:"/\.png\x3f[0-9a-f]{4,8}\x3d\d+?$/U"; reference:md5,99d614964eafe83ec4ed1a4537be35b9; classtype:trojan-activity; sid:1061824; rev:2; metadata:created_at 2016_05_13, updated_at 2016_05_13, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Criptobit/Mobef Ransomware Checkin (trojan-activity) - detector_id: 61880 original_sid: 2022845
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Criptobit/Mobef Ransomware Checkin"; flow:to_server,established; content:"GET"; http_method; content:".php?a="; http_uri; content:"User-Agent|3a 20|Mozilla/5.0 (Windows NT 10.0|3b 20|Win64|3b 20|x64) Edge/13.10586|0d 0a|"; fast_pattern:40,20; http_header; pcre:"/\.php\?a=\d{5,10}.+\x3a\d\x3a\d\x3a\d\.\d\x3a\d$/U"; reference:md5,c90a8039f330ba6660a91113f6c53685; classtype:trojan-activity; sid:1061880; rev:4; metadata:created_at 2016_05_31, updated_at 2016_05_31, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN BandarChor/CryptON Ransomware Checkin (trojan-activity) - detector_id: 61925 original_sid: 2022875
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN BandarChor/CryptON Ransomware Checkin"; flow:to_server,established; content:"POST"; http_method; content:".php"; http_uri; content:"Content-Type|3a 20|application/x-www-form-urlencoded"; http_header; content:"=8ACEFC"; offset:1; depth:7; fast_pattern; http_client_body; pcre:"/=8ACEFC[0-9A-F]{150,}$/P"; pcre:"/\.php$/U"; reference:md5,5ee28035c56c048580c64b67ec4f2124; classtype:trojan-activity; sid:1061925; rev:1; metadata:created_at 2016_06_08, updated_at 2016_06_08, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Bolek HTTP Checkin (trojan-activity) - detector_id: 61946 original_sid: 2022889
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Bolek HTTP Checkin"; flow:to_server,established; content:"GET"; http_method; content:"User-Agent|3a 20|Client 1.2|0d 0a|"; fast_pattern; http_header; pcre:"/\?[a-f0-9]{32}$/Ui"; reference:md5,e89ff40a8832cd27d2aae48ff7cd67d2; reference:url,malware-traffic-analysis.net/2016/06/09/index2.html; classtype:trojan-activity; sid:1061946; rev:2; metadata:created_at 2016_06_10, updated_at 2016_06_10, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Ransomware Locky CnC Beacon 21 May (trojan-activity) - detector_id: 62073 original_sid: 2022952
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Ransomware Locky CnC Beacon 21 May"; flow:established,to_server; content:"POST"; http_method; content:"/_dispatch.php"; fast_pattern; content:"www-form-urlencoded|0d 0a|"; http_header; content:"|0d 0a|x-requested-with|3a 20|XMLHttpRequest|0d 0a|"; http_header; pcre:"/^[0-9a-zA-Z=%-]{0,48}(?:%[A-F0-9]{2}){4}/Psi"; reference:md5,6f8987e28fed878d08858a943e7c6e7c; classtype:trojan-activity; sid:1062073; rev:2; metadata:tag Locky, created_at 2016_07_06, updated_at 2016_07_06, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN W32.Dreambot File Upload (No Data Sent) (trojan-activity) - detector_id: 62091 original_sid: 2022970
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN W32.Dreambot File Upload (No Data Sent)"; flow:established,to_server; content:"POST"; http_method; content:"/images/"; http_uri; content:"_2"; http_uri; content:"User-Agent|3a 20|"; http_header; depth:12; content:"Content-Length|3a 20|2|0d 0a|"; http_header; fast_pattern; content:!"Referer|3a 20|"; http_header; content:!"Accept"; http_header; pcre:"/\/images\/.*_2[FB].*\.(?:avi|gif|bmp|jpeg|png)$/Ui"; reference:md5,e17b1d84da1d2c684f3e67adff7ef582; classtype:trojan-activity; sid:1062091; rev:4; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2016_07_14, malware_family ursnif, malware_family Dreambot, malware_family ISFB, performance_impact Low, updated_at 2016_11_04, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN RAMNIT.A M1 (trojan-activity) - detector_id: 62160 original_sid: 2023028
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET TROJAN RAMNIT.A M1"; flow:established,from_server; file_data; content:"|43 72 65 61 74 65 54 65 78 74 46 69 6c 65 28 44 72 6f 70 50 61 74 68|"; nocase; content:"|57 53 48 73 68 65 6c 6c 2e 52 75 6e 20 44 72 6f 70 50 61 74 68 2c 20 30|"; nocase; reference:url,www.microsoft.com/security/portal/threat/Encyclopedia/Entry.aspx?Name=Virus%3AWin32%2FRamnit.A; classtype:trojan-activity; sid:1062160; rev:2; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2016_08_09, malware_family Ramnit, performance_impact Moderate, updated_at 2016_08_09, flip_endpoints True, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET TROJAN RAMNIT.A M2 (trojan-activity) - detector_id: 62161 original_sid: 2023029
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET TROJAN RAMNIT.A M2"; flow:established,from_server; file_data; content:"|6c 61 6e 67 75 61 67 65 3d 56 42 53 63 72 69 70 74|"; nocase; content:"|57 72 69 74 65 44 61 74 61 20 3d|"; nocase; content:"|22 34 44 35 41 39 30 30|"; nocase; distance:0; content:"|44 72 6f 70 46 69 6c 65 4e 61 6d 65 20 3d 20|"; reference:url,www.microsoft.com/security/portal/threat/Encyclopedia/Entry.aspx?Name=Virus%3AWin32%2FRamnit.A; classtype:trojan-activity; sid:1062161; rev:2; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2016_08_09, malware_family Ramnit, performance_impact Low, updated_at 2016_08_09, flip_endpoints True, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET TROJAN Locky Ransomware Renaming File via SMB (trojan-activity) - detector_id: 62282 original_sid: 2023147
reject tcp $HOME_NET any -> $EXTERNAL_NET [445,139] (msg:"ET TROJAN Locky Ransomware Renaming File via SMB"; flow:to_server,established; content:"|FE|SMB"; offset:4; depth:4; content:"|11 00|"; distance:8; within:2; content:"|00|.|00|z|00|e|00|p|00|t|00|o|00|"; nocase; distance:0; fast_pattern; metadata:former_category TROJAN, flip_endpoints False, server_side False; classtype:trojan-activity; sid:1062282; rev:1; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2016_09_01, malware_family Ransomware, performance_impact Low, updated_at 2017_04_04; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN ABUSE.CH SSL Blacklist Malicious SSL certificate detected (Vawtrak CnC) (trojan-activity) - detector_id: 62305 original_sid: 2023161
reject tls $EXTERNAL_NET any -> $HOME_NET any (msg:"ET TROJAN ABUSE.CH SSL Blacklist Malicious SSL certificate detected (Vawtrak CnC)"; flow:established,from_server; content:"|55 04 03|"; content:"|0f|jmfbrtbsmth.com"; distance:1; within:16; reference:url,sslbl.abuse.ch; classtype:trojan-activity; sid:1062305; rev:2; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, tag SSL_Malicious_Cert, signature_severity Major, created_at 2016_09_06, performance_impact Low, updated_at 2016_09_06, flip_endpoints True, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET TROJAN ABUSE.CH SSL Blacklist Malicious SSL certificate detected (Vawtrak CnC) (trojan-activity) - detector_id: 62306 original_sid: 2023162
reject tls $EXTERNAL_NET any -> $HOME_NET any (msg:"ET TROJAN ABUSE.CH SSL Blacklist Malicious SSL certificate detected (Vawtrak CnC)"; flow:established,from_server; content:"|55 04 03|"; content:"|0f|fxpsjcklcqf.com"; distance:1; within:16; reference:url,sslbl.abuse.ch; classtype:trojan-activity; sid:1062306; rev:2; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, tag SSL_Malicious_Cert, signature_severity Major, created_at 2016_09_06, performance_impact Low, updated_at 2016_09_06, flip_endpoints True, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET TROJAN BleedingLife EK CVE-2014-6332 Exploit (trojan-activity) - detector_id: 62434 original_sid: 2023288
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN BleedingLife EK CVE-2014-6332 Exploit"; flow:to_server,established; content:"GET"; http_method; content:"|2f 32 30 31 34 2d 36 33 33 32 2e 70 68 70 3f|"; http_uri; fast_pattern:only; content:"/index.php?ss="; http_header; pcre:"/\.php\?\d{1,4}$/Ui"; classtype:trojan-activity; sid:1062434; rev:2; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, affected_product Web_Browser_Plugins, attack_target Client_Endpoint, deployment Perimeter, tag BleedingLifeEK, signature_severity Major, created_at 2016_09_23, malware_family Exploit_Kit, malware_family BleedingLife, updated_at 2016_09_23, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Win32.Pony Variant FOX Checkin (trojan-activity) - detector_id: 62442 original_sid: 2023292
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Win32.Pony Variant FOX Checkin"; flow:established,to_server; content:"POST"; http_method; content:".php"; http_uri; content:"os_version="; http_client_body; depth:11; fast_pattern; content:"os_version_full="; http_client_body; distance:0; content:"processorId="; http_client_body; distance:0; content:!"Referer|3a|"; http_header; reference:md5,190c607ef81fa0c27fb1313df5f05266; reference:url,malware.dontneedcoffee.com/2016/09/fox-stealer-another-pony-fork.html; classtype:trojan-activity; sid:1062442; rev:3; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2016_08_10, malware_family Pony, performance_impact Low, updated_at 2016_09_26, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Win32.Pony Variant FOX Reporting Adfraud Activity (trojan-activity) - detector_id: 62443 original_sid: 2023293
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Win32.Pony Variant FOX Reporting Adfraud Activity"; flow:established,to_server; content:"POST"; http_method; content:".php/data"; http_uri; fast_pattern:only; pcre:"/\.php\/data$/U"; content:"http|3a 2f 2f|"; http_client_body; offset:20; depth:7; content:!"Referer|3a|"; http_header; reference:md5,cdfb7e5544c9aa49c17217fdfe04e854; reference:url,malware.dontneedcoffee.com/2016/09/fox-stealer-another-pony-fork.html; classtype:trojan-activity; sid:1062443; rev:3; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2016_09_08, malware_family Pony, performance_impact Low, updated_at 2016_09_26, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN TheTrick Banking Trojan User-Agent (trojan-activity) - detector_id: 62514 original_sid: 2023338
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN TheTrick Banking Trojan User-Agent"; flow:to_server,established; content:"User-Agent|3a 20 54 72 69 63 6b 4c 6f 61 64 65 72|"; fast_pattern:only; reference:md5,f26649fc31ede7594b18f8cd7cdbbc15; classtype:trojan-activity; sid:1062514; rev:3; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2016_10_13, malware_family Banking_Trojan, performance_impact Low, updated_at 2016_10_14, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Win32/CryptFile2 Ransomware Checkin M2 (trojan-activity) - detector_id: 62588 original_sid: 2023397
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Win32/CryptFile2 Ransomware Checkin M2"; flow:established,to_server; content:"POST"; http_method; content:".php"; http_uri; content:"User-Agent|3a 20 70 6f 73 74 5f 65 78 61 6d 70 6c 65|"; http_header; fast_pattern:only; content:"=0x"; http_client_body; content:"|2c|0x"; distance:2; within:5; http_client_body; content:"|3c 62 72 3e|"; distance:0; http_client_body; pcre:"/\.php$/U"; reference:md5,ad2c80611ebc7f6d45bd3e46de38b776; reference:md5,5bb7d85f7a5f1d2b01efabe5635e2992; classtype:trojan-activity; sid:1062588; rev:2; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, tag Ransomware, signature_severity Major, created_at 2016_10_24, malware_family Ransomware, malware_family CryptFile2, performance_impact Low, updated_at 2016_10_24, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Ransomware/Cerber Checkin 2 (trojan-activity) - detector_id: 62643 original_sid: 2023453
reject udp $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Ransomware/Cerber Checkin 2"; dsize:<11; content:"hi"; depth:2; fast_pattern; pcre:"/^[a-f0-9]{7,}$/R"; threshold: type both, track by_src, count 1, seconds 60; reference:md5,ac4d7fb5739862e9914556ed5d50f84f; classtype:trojan-activity; sid:1062643; rev:5; metadata:created_at 2016_03_28, updated_at 2016_10_27, flip_endpoints False, server_side False; target:src_ip;)

# ET TROJAN JS/HTA Downloader Behavior M3 (trojan-activity) - detector_id: 62680 original_sid: 2023485
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN JS/HTA Downloader Behavior M3"; flow:to_server,established; content:".php?cmd=p&id="; fast_pattern:only; http_uri; content:"&rnd="; http_uri; pcre:"/\.php\?cmd=p&id=\w+.*?&rnd=[\x2e\d]+$/Ui"; content:!"Referer"; http_header; metadata:former_category TROJAN, flip_endpoints False, server_side False; reference:md5,d3abaa6736d7d549eca8644c67e9fcfe; classtype:trojan-activity; sid:1062680; rev:4; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2016_11_07, performance_impact Low, updated_at 2017_08_25; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN DistTrack/Shamoon CnC Beacon M1 (trojan-activity) - detector_id: 62788 original_sid: 2023570
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN DistTrack/Shamoon CnC Beacon M1"; flow:established,to_server; content:"GET"; http_method; content:".php?shinu="; http_uri; fast_pattern:only; content:!"Accept"; http_header; content:!"Referer|3a|"; http_header; pcre:"/\.php\?shinu=(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{4})$/U"; reference:md5,5446f46d89124462ae7aca4fce420423; reference:md5,5bac4381c00044d7f4e4cbfd368ba03b; reference:url,researchcenter.paloaltonetworks.com/2016/11/unit42-shamoon-2-return-disttrack-wiper/; classtype:trojan-activity; sid:1062788; rev:2; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2016_12_01, malware_family DistTrack, malware_family Shamoon, performance_impact Low, updated_at 2016_12_01, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN ABUSE.CH SSL Fingerprint Blacklist Malicious SSL Certificate Detected (Gootkit C2) (trojan-activity) - detector_id: 62790 original_sid: 2023572
reject tls $EXTERNAL_NET any -> $HOME_NET any (msg:"ET TROJAN ABUSE.CH SSL Fingerprint Blacklist Malicious SSL Certificate Detected (Gootkit C2)"; flow:established,from_server; content:"|09 00 cf dd b8 9f 9d 14 26 ad|"; content:"|55 04 03|"; distance:0; content:"|15|localhost.localdomain"; reference:url,sslbl.abuse.ch; classtype:trojan-activity; sid:1062790; rev:2; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, tag SSL_Malicious_Cert, signature_severity Major, created_at 2016_12_01, performance_impact Low, updated_at 2016_12_01, flip_endpoints True, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET TROJAN Ransomware/Cerber Checkin M3 (1) (trojan-activity) - detector_id: 62837 original_sid: 2023612
reject udp $HOME_NET any -> $EXTERNAL_NET [6892,6893] (msg:"ET TROJAN Ransomware/Cerber Checkin M3 (1)"; dsize:13<>32; content:"0"; depth:1; pcre:"/^[a-f0-9]{13,30}$/Ri"; threshold: type both, track by_src, count 1, seconds 60; metadata:former_category TROJAN, flip_endpoints False, server_side False; reference:md5,42c677d6d8f42acd8736c4b8c75ce505; reference:md5,7f6290c02465625828cfce6a8014c34a; reference:md5,d8b2d2a5f6da2872e147011d2ea85d71; classtype:trojan-activity; sid:1062837; rev:4; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, tag Ransomware_Cerber, signature_severity Major, created_at 2016_12_12, malware_family Ransomware_Cerber, updated_at 2017_04_14; target:src_ip;)

# ET TROJAN Ransomware/Cerber Checkin M3 (2) (trojan-activity) - detector_id: 62838 original_sid: 2023613
reject udp $HOME_NET any -> $EXTERNAL_NET [6892,6893] (msg:"ET TROJAN Ransomware/Cerber Checkin M3 (2)"; dsize:13<>32; content:"1"; depth:1; pcre:"/^[a-f0-9]{13,30}$/Ri"; threshold: type both, track by_src, count 1, seconds 60; metadata:former_category TROJAN, flip_endpoints False, server_side False; reference:md5,42c677d6d8f42acd8736c4b8c75ce505; reference:md5,7f6290c02465625828cfce6a8014c34a; reference:md5,d8b2d2a5f6da2872e147011d2ea85d71; classtype:trojan-activity; sid:1062838; rev:3; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, tag Ransomware_Cerber, signature_severity Major, created_at 2016_12_12, malware_family Ransomware_Cerber, updated_at 2017_04_14; target:src_ip;)

# ET TROJAN Ransomware/Cerber Checkin M3 (3) (trojan-activity) - detector_id: 62839 original_sid: 2023614
reject udp $HOME_NET any -> $EXTERNAL_NET [6892,6893] (msg:"ET TROJAN Ransomware/Cerber Checkin M3 (3)"; dsize:13<>32; content:"2"; depth:1; pcre:"/^[a-f0-9]{13,30}$/Ri"; threshold: type both, track by_src, count 1, seconds 60; metadata:former_category TROJAN, flip_endpoints False, server_side False; reference:md5,42c677d6d8f42acd8736c4b8c75ce505; reference:md5,7f6290c02465625828cfce6a8014c34a; reference:md5,d8b2d2a5f6da2872e147011d2ea85d71; classtype:trojan-activity; sid:1062839; rev:3; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, tag Ransomware_Cerber, signature_severity Major, created_at 2016_12_12, malware_family Ransomware_Cerber, updated_at 2017_04_14; target:src_ip;)

# ET TROJAN Ransomware/Cerber Checkin M3 (4) (trojan-activity) - detector_id: 62840 original_sid: 2023615
reject udp $HOME_NET any -> $EXTERNAL_NET [6892,6893] (msg:"ET TROJAN Ransomware/Cerber Checkin M3 (4)"; dsize:13<>32; content:"3"; depth:1; pcre:"/^[a-f0-9]{13,30}$/Ri"; threshold: type both, track by_src, count 1, seconds 60; metadata:former_category TROJAN, flip_endpoints False, server_side False; reference:md5,42c677d6d8f42acd8736c4b8c75ce505; reference:md5,7f6290c02465625828cfce6a8014c34a; reference:md5,d8b2d2a5f6da2872e147011d2ea85d71; classtype:trojan-activity; sid:1062840; rev:3; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, tag Ransomware_Cerber, signature_severity Major, created_at 2016_12_12, malware_family Ransomware_Cerber, updated_at 2017_04_14; target:src_ip;)

# ET TROJAN Ransomware/Cerber Checkin M3 (5) (trojan-activity) - detector_id: 62841 original_sid: 2023616
alert udp $HOME_NET any -> $EXTERNAL_NET [6892,6893] (msg:"ET TROJAN Ransomware/Cerber Checkin M3 (5)"; dsize:13<>32; content:"4"; depth:1; pcre:"/^[a-f0-9]{13,30}$/Ri"; threshold: type both, track by_src, count 1, seconds 60; metadata:former_category TROJAN, flip_endpoints False, server_side False; reference:md5,42c677d6d8f42acd8736c4b8c75ce505; reference:md5,7f6290c02465625828cfce6a8014c34a; reference:md5,d8b2d2a5f6da2872e147011d2ea85d71; classtype:trojan-activity; sid:1062841; rev:3; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, tag Ransomware_Cerber, signature_severity Major, created_at 2016_12_12, malware_family Ransomware_Cerber, updated_at 2017_04_14; target:src_ip;)

# ET TROJAN Ransomware/Cerber Checkin M3 (6) (trojan-activity) - detector_id: 62842 original_sid: 2023617
alert udp $HOME_NET any -> $EXTERNAL_NET [6892,6893] (msg:"ET TROJAN Ransomware/Cerber Checkin M3 (6)"; dsize:13<>32; content:"5"; depth:1; pcre:"/^[a-f0-9]{13,30}$/Ri"; threshold: type both, track by_src, count 1, seconds 60; metadata:former_category TROJAN, flip_endpoints False, server_side False; reference:md5,42c677d6d8f42acd8736c4b8c75ce505; reference:md5,7f6290c02465625828cfce6a8014c34a; reference:md5,d8b2d2a5f6da2872e147011d2ea85d71; classtype:trojan-activity; sid:1062842; rev:3; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, tag Ransomware_Cerber, signature_severity Major, created_at 2016_12_12, malware_family Ransomware_Cerber, updated_at 2017_04_14; target:src_ip;)

# ET TROJAN Ransomware/Cerber Checkin M3 (7) (trojan-activity) - detector_id: 62843 original_sid: 2023618
reject udp $HOME_NET any -> $EXTERNAL_NET [6892,6893] (msg:"ET TROJAN Ransomware/Cerber Checkin M3 (7)"; dsize:13<>32; content:"6"; depth:1; pcre:"/^[a-f0-9]{13,30}$/Ri"; threshold: type both, track by_src, count 1, seconds 60; metadata:former_category TROJAN, flip_endpoints False, server_side False; reference:md5,42c677d6d8f42acd8736c4b8c75ce505; reference:md5,7f6290c02465625828cfce6a8014c34a; reference:md5,d8b2d2a5f6da2872e147011d2ea85d71; classtype:trojan-activity; sid:1062843; rev:3; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, tag Ransomware_Cerber, signature_severity Major, created_at 2016_12_12, malware_family Ransomware_Cerber, updated_at 2017_04_14; target:src_ip;)

# ET TROJAN Ransomware/Cerber Checkin M3 (8) (trojan-activity) - detector_id: 62844 original_sid: 2023619
reject udp $HOME_NET any -> $EXTERNAL_NET [6892,6893] (msg:"ET TROJAN Ransomware/Cerber Checkin M3 (8)"; dsize:13<>32; content:"7"; depth:1; pcre:"/^[a-f0-9]{13,30}$/Ri"; threshold: type both, track by_src, count 1, seconds 60; metadata:former_category TROJAN, flip_endpoints False, server_side False; reference:md5,42c677d6d8f42acd8736c4b8c75ce505; reference:md5,7f6290c02465625828cfce6a8014c34a; reference:md5,d8b2d2a5f6da2872e147011d2ea85d71; classtype:trojan-activity; sid:1062844; rev:3; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, tag Ransomware_Cerber, signature_severity Major, created_at 2016_12_12, malware_family Ransomware_Cerber, updated_at 2017_04_14; target:src_ip;)

# ET TROJAN Ransomware/Cerber Checkin M3 (9) (trojan-activity) - detector_id: 62845 original_sid: 2023620
reject udp $HOME_NET any -> $EXTERNAL_NET [6892,6893] (msg:"ET TROJAN Ransomware/Cerber Checkin M3 (9)"; dsize:13<>32; content:"8"; depth:1; pcre:"/^[a-f0-9]{13,30}$/Ri"; threshold: type both, track by_src, count 1, seconds 60; metadata:former_category TROJAN, flip_endpoints False, server_side False; reference:md5,42c677d6d8f42acd8736c4b8c75ce505; reference:md5,7f6290c02465625828cfce6a8014c34a; reference:md5,d8b2d2a5f6da2872e147011d2ea85d71; classtype:trojan-activity; sid:1062845; rev:3; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, tag Ransomware_Cerber, signature_severity Major, created_at 2016_12_12, malware_family Ransomware_Cerber, updated_at 2017_04_14; target:src_ip;)

# ET TROJAN Ransomware/Cerber Checkin M3 (10) (trojan-activity) - detector_id: 62846 original_sid: 2023621
reject udp $HOME_NET any -> $EXTERNAL_NET [6892,6893] (msg:"ET TROJAN Ransomware/Cerber Checkin M3 (10)"; dsize:13<>32; content:"9"; depth:1; pcre:"/^[a-f0-9]{13,30}$/Ri"; threshold: type both, track by_src, count 1, seconds 60; metadata:former_category TROJAN, flip_endpoints False, server_side False; reference:md5,42c677d6d8f42acd8736c4b8c75ce505; reference:md5,7f6290c02465625828cfce6a8014c34a; reference:md5,d8b2d2a5f6da2872e147011d2ea85d71; classtype:trojan-activity; sid:1062846; rev:4; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, tag Ransomware_Cerber, signature_severity Major, created_at 2016_12_12, malware_family Ransomware_Cerber, updated_at 2017_04_14; target:src_ip;)

# ET TROJAN Ransomware/Cerber Checkin M3 (11) (trojan-activity) - detector_id: 62847 original_sid: 2023622
reject udp $HOME_NET any -> $EXTERNAL_NET [6892,6893] (msg:"ET TROJAN Ransomware/Cerber Checkin M3 (11)"; dsize:13<>32; content:"a"; nocase; depth:1; pcre:"/^[a-f0-9]{13,30}$/Ri"; threshold: type both, track by_src, count 1, seconds 60; metadata:former_category TROJAN, flip_endpoints False, server_side False; reference:md5,42c677d6d8f42acd8736c4b8c75ce505; reference:md5,7f6290c02465625828cfce6a8014c34a; reference:md5,d8b2d2a5f6da2872e147011d2ea85d71; classtype:trojan-activity; sid:1062847; rev:3; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, tag Ransomware_Cerber, signature_severity Major, created_at 2016_12_12, malware_family Ransomware_Cerber, updated_at 2017_04_14; target:src_ip;)

# ET TROJAN Ransomware/Cerber Checkin M3 (12) (trojan-activity) - detector_id: 62848 original_sid: 2023623
reject udp $HOME_NET any -> $EXTERNAL_NET [6892,6893] (msg:"ET TROJAN Ransomware/Cerber Checkin M3 (12)"; dsize:13<>32; content:"b"; nocase; depth:1; pcre:"/^[a-f0-9]{13,30}$/Ri"; threshold: type both, track by_src, count 1, seconds 60; metadata:former_category TROJAN, flip_endpoints False, server_side False; reference:md5,42c677d6d8f42acd8736c4b8c75ce505; reference:md5,7f6290c02465625828cfce6a8014c34a; reference:md5,d8b2d2a5f6da2872e147011d2ea85d71; classtype:trojan-activity; sid:1062848; rev:3; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, tag Ransomware_Cerber, signature_severity Major, created_at 2016_12_12, malware_family Ransomware_Cerber, updated_at 2017_04_14; target:src_ip;)

# ET TROJAN Ransomware/Cerber Checkin M3 (13) (trojan-activity) - detector_id: 62849 original_sid: 2023624
reject udp $HOME_NET any -> $EXTERNAL_NET [6892,6893] (msg:"ET TROJAN Ransomware/Cerber Checkin M3 (13)"; dsize:13<>32; content:"c"; nocase; depth:1; pcre:"/^[a-f0-9]{13,30}$/Ri"; threshold: type both, track by_src, count 1, seconds 60; metadata:former_category TROJAN, flip_endpoints False, server_side False; reference:md5,42c677d6d8f42acd8736c4b8c75ce505; reference:md5,7f6290c02465625828cfce6a8014c34a; reference:md5,d8b2d2a5f6da2872e147011d2ea85d71; classtype:trojan-activity; sid:1062849; rev:3; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, tag Ransomware_Cerber, signature_severity Major, created_at 2016_12_12, malware_family Ransomware_Cerber, updated_at 2017_04_14; target:src_ip;)

# ET TROJAN Ransomware/Cerber Checkin M3 (14) (trojan-activity) - detector_id: 62850 original_sid: 2023625
reject udp $HOME_NET any -> $EXTERNAL_NET [6892,6893] (msg:"ET TROJAN Ransomware/Cerber Checkin M3 (14)"; dsize:13<>32; content:"d"; nocase; depth:1; pcre:"/^[a-f0-9]{13,30}$/Ri"; threshold: type both, track by_src, count 1, seconds 60; metadata:former_category TROJAN, flip_endpoints False, server_side False; reference:md5,42c677d6d8f42acd8736c4b8c75ce505; reference:md5,7f6290c02465625828cfce6a8014c34a; reference:md5,d8b2d2a5f6da2872e147011d2ea85d71; classtype:trojan-activity; sid:1062850; rev:3; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, tag Ransomware_Cerber, signature_severity Major, created_at 2016_12_12, malware_family Ransomware_Cerber, updated_at 2017_04_14; target:src_ip;)

# ET TROJAN Ransomware/Cerber Checkin M3 (15) (trojan-activity) - detector_id: 62851 original_sid: 2023626
reject udp $HOME_NET any -> $EXTERNAL_NET [6892,6893] (msg:"ET TROJAN Ransomware/Cerber Checkin M3 (15)"; dsize:13<>32; content:"e"; nocase; depth:1; pcre:"/^[a-f0-9]{13,30}$/Ri"; threshold: type both, track by_src, count 1, seconds 60; metadata:former_category TROJAN, flip_endpoints False, server_side False; reference:md5,42c677d6d8f42acd8736c4b8c75ce505; reference:md5,7f6290c02465625828cfce6a8014c34a; reference:md5,d8b2d2a5f6da2872e147011d2ea85d71; classtype:trojan-activity; sid:1062851; rev:3; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, tag Ransomware_Cerber, signature_severity Major, created_at 2016_12_12, malware_family Ransomware_Cerber, updated_at 2017_04_14; target:src_ip;)

# ET TROJAN Ransomware/Cerber Checkin M3 (16) (trojan-activity) - detector_id: 62852 original_sid: 2023627
alert udp $HOME_NET any -> $EXTERNAL_NET [6892,6893] (msg:"ET TROJAN Ransomware/Cerber Checkin M3 (16)"; dsize:13<>32; content:"f"; nocase; depth:1; pcre:"/^[a-f0-9]{13,30}$/Ri"; threshold: type both, track by_src, count 1, seconds 60; metadata:former_category TROJAN, flip_endpoints False, server_side False; reference:md5,42c677d6d8f42acd8736c4b8c75ce505; reference:md5,7f6290c02465625828cfce6a8014c34a; reference:md5,d8b2d2a5f6da2872e147011d2ea85d71; classtype:trojan-activity; sid:1062852; rev:3; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, tag Ransomware_Cerber, signature_severity Major, created_at 2016_12_12, malware_family Ransomware_Cerber, updated_at 2017_04_14; target:src_ip;)

# ET TROJAN Ransomware/Cerber Onion Domain Lookup (trojan-activity) - detector_id: 62914 original_sid: 2023690
reject udp $HOME_NET any -> any 53 (msg:"ET TROJAN Ransomware/Cerber Onion Domain Lookup"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|10|p27dokhpz2n7nvgr"; nocase; distance:0; fast_pattern; reference:md5,c2f7595a1c394f1dac2e418815c54fd2; classtype:trojan-activity; sid:1062914; rev:1; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, tag DNS_Onion_Query, signature_severity Major, created_at 2016_12_29, malware_family Ransomware_Cerber, performance_impact Low, updated_at 2016_12_30, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN ABUSE.CH Ransomware/Cerber Onion Domain Lookup (trojan-activity) - detector_id: 63439 original_sid: 2024104
reject udp $HOME_NET any -> any 53 (msg:"ET TROJAN ABUSE.CH Ransomware/Cerber Onion Domain Lookup"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|10|hjhqmbxyinislkkt"; fast_pattern; distance:0; nocase; metadata:former_category TROJAN, flip_endpoints False, server_side False; reference:url,ransomwaretracker.abuse.ch; classtype:trojan-activity; sid:1063439; rev:3; metadata:attack_target Client_Endpoint, deployment Perimeter, tag Ransomware_Cerber, signature_severity Major, created_at 2017_03_27, malware_family Ransomware, malware_family Cerber, performance_impact Low, updated_at 2017_04_20; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN MSIL/Karmen Ransomware CnC Activity (trojan-activity) - detector_id: 63620 original_sid: 2024239
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN MSIL/Karmen Ransomware CnC Activity"; flow:established,to_server; content:"GET"; http_method; content:"data.php?id="; http_uri; fast_pattern; content:!"User-Agent|3a|"; http_header; content:!"Accept"; http_header; content:!"Referer|3a|"; http_header; pcre:"/\.php\?id=[A-Za-z0-9]{10,20}(?:&key=[A-Za-z0-9]{10,30})?$/Ui"; pcre:"/^Host\x3a\x20[^\r\n]+\r\n(?:Connection\x3a\x20Keep-Alive\r\n)?(?:\r\n)?$/Hmi"; metadata:former_category TROJAN, flip_endpoints False, server_side False; reference:md5,05427ed1c477cc01910eb9adbf35068d; classtype:trojan-activity; sid:1063620; rev:4; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2017_03_14, malware_family Karmen_Ransomware, performance_impact Moderate, updated_at 2018_05_17; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN W32/Emotet CnC Beacon 1 (trojan-activity) - detector_id: 63654 original_sid: 2024274
reject http $HOME_NET any -> $EXTERNAL_NET [443,7080,8080] (msg:"ET TROJAN W32/Emotet CnC Beacon 1"; flow:established,to_server; urilen:1; content:"GET"; http_method; content:"/"; http_uri; depth:1; content:"Cookie|3A 20|"; content:"User-Agent|3A| Mozilla/5.0 (compatible|3B| MSIE 8.0|3B| Windows NT 5.1|3B| SLCC1|3B| .NET CLR 1.1.4322)|0D 0A|Host|3A|"; http_header; content:!"Referer|3A|"; http_header; pcre:"/^[A-Za-z0-9]{3,4}=(?:[A-Za-z0-9+\/]{4})*(?:[A-Za-z0-9+\/]{2}==|[A-Za-z0-9+\/]{3}=|[A-Za-z0-9+\/]{4})$/Ci"; metadata:former_category TROJAN, flip_endpoints False, server_side False; reference:url,blog.fortinet.com/2017/05/03/deep-analysis-of-new-emotet-variant-part-1; reference:url,www.cyphort.com/emotet-cookies-c2-fakes-404/; reference:url,blogs.forcepoint.com/security-labs/new-variant-geodoemotet-banking-malware-targets-uk; reference:md5,21542133a586782e7c2fa4286d98fd73; classtype:trojan-activity; sid:1063654; rev:2; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2017_05_04, performance_impact Moderate, updated_at 2017_05_04; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Known Hostile Domain ant.trenz .pl Lookup (trojan-activity) - detector_id: 63661 original_sid: 2024281
alert udp $HOME_NET any -> any 53 (msg:"ET TROJAN Known Hostile Domain ant.trenz .pl Lookup"; content:"|03|ant|05|trenz|02|pl|00|"; nocase; metadata:former_category TROJAN, flip_endpoints False, server_side False; classtype:trojan-activity; sid:1063661; rev:1; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2017_05_08, performance_impact Moderate, updated_at 2017_05_08; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Jaff Ransomware Checkin (trojan-activity) - detector_id: 63671 original_sid: 2024288
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Jaff Ransomware Checkin"; flow:to_server,established; content:"GET"; http_method; content:"Host|3a 20|fkksjobnn43.org|0d 0a 0d 0a|"; fast_pattern:only; metadata:former_category TROJAN, flip_endpoints False, server_side False; reference:url,blogs.forcepoint.com/security-labs/jaff-enters-ransomware-scene-locky-style; reference:md5,942c6a039724ed5326c3c247bfce3461; classtype:trojan-activity; sid:1063671; rev:2; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, tag Ransomware, signature_severity Major, created_at 2017_05_11, malware_family Jaff_Ransomware, updated_at 2017_05_11; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN DNS Query to Jaff Domain (fkksjobnn43 . org) (trojan-activity) - detector_id: 63672 original_sid: 2024289
reject udp $HOME_NET any -> any 53 (msg:"ET TROJAN DNS Query to Jaff Domain (fkksjobnn43 . org)"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|0b|fkksjobnn43|03|org|00|"; fast_pattern; distance:0; nocase; metadata:former_category TROJAN, flip_endpoints False, server_side False; reference:md5,924c84415b775af12a10366469d3df69; reference:url,blog.dynamoo.com/2017/05/malware-spam-with-nmpdf-attachment.html; classtype:trojan-activity; sid:1063672; rev:1; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, tag Ransomware, signature_severity Major, created_at 2017_05_11, malware_family Jaff_Ransomware, performance_impact Low, updated_at 2017_05_11; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Jaff Ransomware Checkin M1 (trojan-activity) - detector_id: 63673 original_sid: 2024290
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Jaff Ransomware Checkin M1"; flow:to_server,established; urilen:4; content:"GET"; http_method; content:"/a5/"; fast_pattern; http_uri; content:"Host|3a 20|"; depth:6; http_header; content:!"User-Agent|3a|"; http_header; content:!"Accept"; http_header; content:!"Connection|3a 20|"; http_header; content:!"Referer|3a|"; http_header; content:!"Cache-Control|3a|"; http_header; content:"GET /a5/ HTTP/1."; depth:16; content:"|0d 0a|Host|3a 20|"; distance:1; within:8; pcre:"/^[a-z0-9\-\.]+?\x0d\x0a\x0d\x0a$/R"; metadata:former_category TROJAN, flip_endpoints False, server_side False; reference:md5,924c84415b775af12a10366469d3df69; reference:url,blog.dynamoo.com/2017/05/malware-spam-with-nmpdf-attachment.html; classtype:trojan-activity; sid:1063673; rev:2; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, tag Ransomware, signature_severity Major, created_at 2017_05_11, malware_family Jaff_Ransomware, performance_impact Low, updated_at 2017_05_11; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN LokiBot Application/Credential Data Exfiltration Detected M1 (trojan-activity) - detector_id: 63715 original_sid: 2024312
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN LokiBot Application/Credential Data Exfiltration Detected M1"; flow:established,to_server; content:"POST"; http_method; content:"(Charon|3b 20|Inferno)"; http_user_agent; content:"|00 27 00|"; offset:1; depth:3; http_client_body; pcre:"/^[\x00-\x01]\x00.\x00{3}/PR"; metadata:former_category TROJAN, flip_endpoints False, server_side False; classtype:trojan-activity; sid:1063715; rev:3; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2017_05_17, malware_family lokibot, updated_at 2018_04_13; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN LokiBot Request for C2 Commands Detected M1 (trojan-activity) - detector_id: 63716 original_sid: 2024313
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN LokiBot Request for C2 Commands Detected M1"; flow:established,to_server; content:"POST"; http_method; content:"(Charon|3b 20|Inferno)"; http_user_agent; content:"|00 28 00|"; offset:1; depth:3; http_client_body; pcre:"/^[\x00-\x01]\x00.\x00{3}/PR"; flowbits:set,ET.LokiBot; metadata:former_category TROJAN, flip_endpoints False, server_side False; classtype:trojan-activity; sid:1063716; rev:4; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2017_05_17, malware_family lokibot, updated_at 2018_04_13; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN LokiBot Application/Credential Data Exfiltration Detected M2 (trojan-activity) - detector_id: 63720 original_sid: 2024317
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN LokiBot Application/Credential Data Exfiltration Detected M2"; flow:established,to_server; content:"POST"; http_method; content:"Content-Key|3a 20|"; http_header; content:"|0d 0a|"; distance:8; within:2; http_header; content:"|00 27 00|"; offset:1; depth:3; http_client_body; pcre:"/^[\x00-\x01]\x00.\x00{3}/PR"; content:!"Referer|3a|"; http_header; pcre:"/^User-Agent\x3a\x20[^\r\n]+\r\nHost\x3a\x20[^\r\n]+\r\nAccept\x3a\x20[^\r\n]+\r\nContent-Type\x3a\x20application\x2foctet-stream\r\nContent-Encoding\x3a\x20binary\r\nContent-Key\x3a\x20[A-Z0-9]{8}\r\n/Hi"; metadata:former_category TROJAN, flip_endpoints False, server_side False; classtype:trojan-activity; sid:1063720; rev:3; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2017_05_17, malware_family lokibot, updated_at 2018_04_13; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN LokiBot Request for C2 Commands Detected M2 (trojan-activity) - detector_id: 63721 original_sid: 2024318
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN LokiBot Request for C2 Commands Detected M2"; flow:established,to_server; content:"POST"; http_method; content:"Content-Key|3a 20|"; http_header; content:"|0d 0a|"; distance:8; within:2; http_header; content:"|00 28 00|"; offset:1; depth:3; http_client_body; pcre:"/^[\x00-\x01]\x00.\x00{3}/PR"; content:!"Referer|3a|"; http_header; pcre:"/^User-Agent\x3a\x20[^\r\n]+\r\nHost\x3a\x20[^\r\n]+\r\nAccept\x3a\x20[^\r\n]+\r\nContent-Type\x3a\x20application\x2foctet-stream\r\nContent-Encoding\x3a\x20binary\r\nContent-Key\x3a\x20[A-Z0-9]{8}\r\nContent-Length\x3a\x20[^\r\n]+\r\nConnection\x3a\x20close/Hi"; metadata:former_category TROJAN, flip_endpoints False, server_side False; classtype:trojan-activity; sid:1063721; rev:3; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2017_05_17, malware_family lokibot, updated_at 2018_04_13; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN MalDoc Retrieving Payload May 23 2017 2 (trojan-activity) - detector_id: 63737 original_sid: 2024325
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN MalDoc Retrieving Payload May 23 2017 2"; flow:established,to_server; content:"GET"; http_method; content:!"|2e|"; http_uri; content:"Mozilla/5.2 (Windows NT 6.2|3b| rv|3a|50.2) Gecko/20200103 Firefox/50.2"; http_user_agent; fast_pattern; content:!"Referer|3A|"; http_header; metadata:former_category TROJAN, flip_endpoints False, server_side False; reference:md5,502cb33a03c29a96a4c32ec26dce5395; classtype:trojan-activity; sid:1063737; rev:3; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2017_05_23, malware_family Dridex, performance_impact Moderate, updated_at 2017_05_23; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN X-Malware-Sinkhole Header in HTTP Response (trojan-activity) - detector_id: 63805 original_sid: 2024378
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET TROJAN X-Malware-Sinkhole Header in HTTP Response"; flow:from_server,established; content:"X-Malware-Sinkhole|3a 20|"; http_header; metadata:former_category TROJAN, flip_endpoints True, server_side False; classtype:trojan-activity; sid:1063805; rev:2; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2017_06_13, performance_impact Moderate, updated_at 2017_06_13; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET TROJAN ABUSE.CH Ransomware/Cerber Onion Domain Lookup (trojan-activity) - detector_id: 63875 original_sid: 2024440
reject udp $HOME_NET any -> any 53 (msg:"ET TROJAN ABUSE.CH Ransomware/Cerber Onion Domain Lookup"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|10|xpcx6erilkjced3j"; fast_pattern; distance:0; nocase; metadata:former_category TROJAN, flip_endpoints False, server_side False; reference:url,ransomwaretracker.abuse.ch; classtype:trojan-activity; sid:1063875; rev:2; metadata:attack_target Client_Endpoint, deployment Perimeter, tag Ransomware_Cerber, signature_severity Major, created_at 2017_06_29, malware_family Ransomware, malware_family Cerber, performance_impact Low, updated_at 2017_06_29; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN CopyKittens Cobalt Strike DNS Lookup (cloudflare-analyse . com) (trojan-activity) - detector_id: 63976 original_sid: 2024497
reject udp $HOME_NET any -> any 53 (msg:"ET TROJAN CopyKittens Cobalt Strike DNS Lookup (cloudflare-analyse . com)"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|12|cloudflare|2d|analyse|03|com|00|"; nocase; distance:0; fast_pattern; threshold: type limit, track by_src, count 1, seconds 60; metadata:former_category TROJAN, flip_endpoints False, server_side False; reference:url,www.clearskysec.com/wp-content/uploads/2017/07/Operation_Wilted_Tulip.pdf; reference:md5,752240cddda5acb5e8d026cef82e2b54; classtype:trojan-activity; sid:1063976; rev:2; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2017_07_25, malware_family CobaltStrike, performance_impact Moderate, updated_at 2017_07_26; target:src_ip;)

# ET TROJAN [PTsecurity] Win32/TinyNuke Payload ACF40 Inbound (trojan-activity) - detector_id: 64028 original_sid: 2024513
reject http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET TROJAN [PTsecurity] Win32/TinyNuke Payload ACF40 Inbound"; flow:established,to_client; content:"200"; http_stat_code; content:"Content-Type|3a 20|text|2F|html"; http_header; file_data; byte_extract:8,896,byte0; byte_extract:8,904,byte1; byte_extract:8,912,byte2; byte_extract:8,920,byte3; byte_extract:8,928,byte4; byte_test:8,=,byte0,936; byte_test:8,!=,byte0,944; byte_test:8,=,byte1,944; byte_test:8,!=,byte1,952; byte_test:8,=,byte2,952; byte_test:8,!=,byte2,960; byte_test:8,=,byte3,960; byte_test:8,=,byte4,968; content:!"MZ"; depth:2; pcre:"/[\x80-\xff]{16}/"; flowbits:isset,ET.TinyNuke; metadata:former_category TROJAN, flip_endpoints True, server_side False; reference:url,github.com/ptresearch/AttackDetection; classtype:trojan-activity; sid:1064028; rev:5; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2017_08_02, malware_family TinyNuke, performance_impact Moderate, updated_at 2017_08_03; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET TROJAN [PTsecurity] Gozi/Ursnif Payload v12 (trojan-activity) - detector_id: 64073 original_sid: 2024533
reject http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET TROJAN [PTsecurity] Gozi/Ursnif Payload v12"; flow:established,to_client; content:"200"; http_stat_code; file_data; content:"|58 1b 91 63 b8 aa 05 14 26 b5 4a 87 75 c1 a0 26 9e 3c 11 6e 71 42 96 26 99 7a 08 52 54 2f 31 7f 58 90 87 ef 21 eb 4d ac aa 62 d0 f5 9e 65 dd b1|"; depth:48; fast_pattern; metadata:former_category TROJAN, flip_endpoints True, server_side False; reference:url,github.com/ptresearch/AttackDetection; classtype:trojan-activity; sid:1064073; rev:2; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2017_08_11, malware_family ursnif, malware_family Gozi, performance_impact Moderate, updated_at 2017_08_11; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET TROJAN ABUSE.CH Cerber Ransomware Domain Detected (trojan-activity) - detector_id: 64211 original_sid: 2024635
reject udp $HOME_NET any -> any 53 (msg:"ET TROJAN ABUSE.CH Cerber Ransomware Domain Detected"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|10|oqwygprskqv65j72"; fast_pattern; distance:0; nocase; metadata:former_category TROJAN, flip_endpoints False, server_side False; reference:url,ransomwaretracker.abuse.ch; classtype:trojan-activity; sid:1064211; rev:1; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2017_08_30, performance_impact Moderate, updated_at 2017_08_30; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN ABUSE.CH Cerber Ransomware Domain Detected (trojan-activity) - detector_id: 64212 original_sid: 2024636
reject udp $HOME_NET any -> any 53 (msg:"ET TROJAN ABUSE.CH Cerber Ransomware Domain Detected"; content:"|01 00 00 01 00 00 00 00 00 00|"; depth:10; offset:2; content:"|10|toytyaclucomunit"; fast_pattern; distance:0; nocase; metadata:former_category TROJAN, flip_endpoints False, server_side False; reference:url,ransomwaretracker.abuse.ch; classtype:trojan-activity; sid:1064212; rev:1; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2017_08_30, performance_impact Moderate, updated_at 2017_08_30; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN [PTsecurity] Possible Cobalt Strike payload (trojan-activity) - detector_id: 64364 original_sid: 2024771
reject http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET TROJAN [PTsecurity] Possible Cobalt Strike payload"; flow:established,from_server; content:"200"; http_stat_code; content:"Content-Length|3a 20|"; http_header; content:"|0d 0a|"; http_header; distance:5; within:4; file_data; content:"|fc e8 00 00 00 00 eb|"; depth:7; fast_pattern; metadata:former_category TROJAN, flip_endpoints True, server_side False; classtype:trojan-activity; sid:1064364; rev:2; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2017_09_27, malware_family CobaltStrike, performance_impact Low, updated_at 2019_04_19; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET TROJAN Observed Malicious SSL Cert (IcedID CnC) (trojan-activity) - detector_id: 64607 original_sid: 2024979
reject tls $EXTERNAL_NET any -> $HOME_NET any (msg:"ET TROJAN Observed Malicious SSL Cert (IcedID CnC)"; flow:established,from_server; content:"|09 00 b9 5a 68 02 24 e5 3e 2e|"; fast_pattern; content:"|55 04 03|"; content:"|06|Server"; distance:1; within:7; metadata:former_category TROJAN, flip_endpoints True, server_side False; reference:url,securityintelligence.com/new-banking-trojan-icedid-discovered-by-ibm-x-force-research; reference:md5,de4ef2e24306b35d29891b45c1e3fbfd; classtype:trojan-activity; sid:1064607; rev:1; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2017_11_13, performance_impact Moderate, updated_at 2017_11_13; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET TROJAN Win32/TinyNuke CnC Checkin (trojan-activity) - detector_id: 64617 original_sid: 2024991
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Win32/TinyNuke CnC Checkin"; flow:established,to_server; content:"POST"; http_method; content:!"&"; http_uri; content:".php?"; http_uri; content:"|0d 0a|Content-Length|3a 20|9|0d 0a|"; http_header; fast_pattern; pcre:"/\.php\?[A-F0-9]{15,25}$/Ui"; http_header_names; content:!"Accept"; content:!"User-Agent"; content:!"Referer"; flowbits:set,ET.TinyNuke; metadata:former_category TROJAN, flip_endpoints False, server_side False; reference:md5,917124e4d53057324aa129520fca73fb; classtype:trojan-activity; sid:1064617; rev:7; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2017_02_27, performance_impact Low, updated_at 2019_02_04; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN [PTsecurity] Botnet Nitol.B Checkin (trojan-activity) - detector_id: 64740 original_sid: 2025135
reject tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN [PTsecurity] Botnet Nitol.B Checkin"; flow:established,to_server,no_stream; dsize:<400; content:"|00 00 77 00 00 00|"; depth:30; fast_pattern; content:"MHz"; distance:0; within:350; content:"|00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00|"; depth:120; metadata:former_category TROJAN, flip_endpoints False, server_side False; classtype:trojan-activity; sid:1064740; rev:3; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signature_severity Minor, created_at 2017_12_06, malware_family nitol, performance_impact Moderate, updated_at 2018_01_31; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN VBS.ARS Checkin (trojan-activity) - detector_id: 64923 original_sid: 2025230
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN VBS.ARS Checkin"; flow:established,to_server; content:"POST"; http_method; content:".php?os=windows"; http_uri; nocase; fast_pattern; content:"&user="; http_uri; distance:0; content:"&av="; http_uri; distance:0; content:"&fw="; http_uri; distance:0; content:"&hwid="; http_uri; distance:0; content:"&x="; http_uri; distance:0; content:!"Referer|3a 20|"; http_header; metadata:former_category TROJAN, flip_endpoints False, server_side False; reference:url,twitter.com/B_H101/status/954984729329184768; classtype:trojan-activity; sid:1064923; rev:2; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2018_01_22, performance_impact Moderate, updated_at 2018_01_22; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Arkei Stealer IP Lookup (trojan-activity) - detector_id: 65322 original_sid: 2025429
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Arkei Stealer IP Lookup"; flow:established,to_server; content:"POST"; http_method; content:"Arkei/"; http_user_agent; depth:6; fast_pattern; content:"ip-api.com"; http_host; metadata:former_category TROJAN, flip_endpoints False, server_side False; reference:md5,1f075616f69983f5b3fc7ba068032c6d; classtype:trojan-activity; sid:1065322; rev:2; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, tag Stealer, signature_severity Major, created_at 2018_03_13, malware_family Arkei, updated_at 2018_04_23; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Arkei Stealer Config Download Request (trojan-activity) - detector_id: 65323 original_sid: 2025430
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Arkei Stealer Config Download Request"; flow:established,to_server; content:"POST"; http_method; content:"/grubConfig"; http_uri; content:"Arkei/"; http_user_agent; depth:6; fast_pattern; metadata:former_category TROJAN, flip_endpoints False, server_side False; reference:md5,1f075616f69983f5b3fc7ba068032c6d; classtype:trojan-activity; sid:1065323; rev:2; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, tag Stealer, signature_severity Major, created_at 2018_03_13, malware_family Arkei, updated_at 2018_04_23; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Vidar/Arkei Stealer Client Data Upload (trojan-activity) - detector_id: 65324 original_sid: 2025431
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Vidar/Arkei Stealer Client Data Upload"; flow:established,to_server; content:"POST"; http_method; content:"form-data|3b 20|name=|22|hwid|22|"; http_client_body; nocase; content:"form-data|3b 20|name=|22|os|22|"; http_client_body; nocase; content:"form-data|3b 20|name=|22|platform|22|"; http_client_body; nocase; content:"form-data|3b 20|name=|22|user|22|"; http_client_body; nocase; content:"form-data|3b 20|name=|22|cccount|22|"; http_client_body; nocase; metadata:former_category TROJAN, flip_endpoints False, server_side False; reference:md5,72bcbfd1020d002d2e20e0707b8ef700; classtype:trojan-activity; sid:1065324; rev:4; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, tag Stealer, signature_severity Major, created_at 2018_03_13, malware_family Arkei, updated_at 2019_02_21; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Cobalt Group SSL Certificate Detected (trojan-activity) - detector_id: 65358 original_sid: 2025438
reject tls $EXTERNAL_NET any -> $HOME_NET any (msg:"ET TROJAN Cobalt Group SSL Certificate Detected"; flow:established,from_server; content:"|55 04 03|"; content:"|0f|dns-verifon.com"; distance:1; within:16; metadata:former_category TROJAN, flip_endpoints True, server_side False; reference:md5,26406f5cc72e13c798485f80ad3cbbdb; classtype:trojan-activity; sid:1065358; rev:1; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2018_03_26, malware_family Cobalt_Group, performance_impact Low, updated_at 2018_03_26; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET TROJAN Win32/GandCrab Ransomware CnC Activity M2 (trojan-activity) - detector_id: 65389 original_sid: 2025455
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Win32/GandCrab Ransomware CnC Activity M2"; flow:established,to_server; content:"POST"; http_method; pcre:"/^\/[a-z]{3,20}(?:\?[a-z]{3,20}=[a-z]{0,10}&[a-z]{3,20}=[a-z]{0,10})?$/U"; pcre:"/\.(?:bit|coin|sex|com|gandcrab\d*)$/W"; content:"Mozilla/5.0 (Windows NT 6.1|3b 20|WOW64"; http_user_agent; pcre:"/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{4})$/Psi"; http_content_len; byte_test:0,>,4000,0,string,dec; http_header_names; content:"|0d 0a|Host|0d 0a|Content-Type|0d 0a|User-Agent|0d 0a|Content-Length|0d 0a|Cache-Control|0d 0a 0d 0a|"; depth:67; fast_pattern; content:!"Accept"; content:!"Referer"; metadata:former_category TROJAN, flip_endpoints False, server_side False; reference:md5,8b7d3093c477b2e99effde5065affbd5; classtype:trojan-activity; sid:1065389; rev:5; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2018_03_06, performance_impact Moderate, updated_at 2018_04_10; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN [PTsecurity] Win32/SocStealer.Socelars C2 Response (trojan-activity) - detector_id: 65391 original_sid: 2025458
reject http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET TROJAN [PTsecurity] Win32/SocStealer.Socelars C2 Response"; flow:established,to_client; content:"200"; http_stat_code; content:"[DATA]"; depth:6; http_server_body; fast_pattern; content:"[DATA]"; distance:0; isdataat:!1,relative; content:"Server-Key|3a 20|"; http_header; pcre:"/[A-Za-z0-9]{62}/HR"; metadata:former_category TROJAN, flip_endpoints True, server_side False; classtype:trojan-activity; sid:1065391; rev:1; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2018_04_02, malware_family SocStealer, performance_impact Moderate, updated_at 2018_04_02; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET TROJAN LokiBot Fake 404 Response (trojan-activity) - detector_id: 65442 original_sid: 2025483
reject http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET TROJAN LokiBot Fake 404 Response"; flow:established,from_server; flowbits:isset,ET.LokiBot; content:"404"; http_stat_code; file_data; content:"|08 00 00 00 00 00 00 00|File not found."; depth:23; fast_pattern; isdataat:!1,relative; metadata:former_category TROJAN, flip_endpoints True, server_side False; reference:md5,CA427D578AFA51B262272C78D1C04AB9; classtype:trojan-activity; sid:1065442; rev:2; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2018_04_10, malware_family lokibot, performance_impact Low, updated_at 2018_04_13; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET TROJAN Likely GandCrab Ransomware Domain in HTTP Host M1 (trojan-activity) - detector_id: 65540 original_sid: 2025547
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Likely GandCrab Ransomware Domain in HTTP Host M1"; content:".bit"; http_host; isdataat:!1,relative; pcre:"/^(?:(?:malwarehuntertea|nomoreranso)m|politiaromana|ransomware|carder)\.(?:bit|coin)$/W"; metadata:former_category TROJAN, flip_endpoints False, server_side False; reference:md5,a85907638378377ff357242a7311244d; classtype:trojan-activity; sid:1065540; rev:2; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2018_04_30, malware_family GandCrab, updated_at 2018_04_30; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Win32/Unk.Stealer CnC Activity (trojan-activity) - detector_id: 65610 original_sid: 2025580
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Win32/Unk.Stealer CnC Activity"; flow:established,to_server; content:"POST"; http_method; content:"/check.php"; http_uri; isdataat:!1,relative; fast_pattern; content:"m="; http_client_body; depth:2; pcre:"/^m=[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}$/Psi"; http_header_names; content:!"Referer"; metadata:former_category TROJAN, flip_endpoints False, server_side False; reference:md5,b38a63aea75bcf06fed11067cc75cc7e; classtype:trojan-activity; sid:1065610; rev:2; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2018_05_16, performance_impact Moderate, updated_at 2018_05_16; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN [eSentire] Cobalt Strike Beacon (trojan-activity) - detector_id: 65748 original_sid: 2025635
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN [eSentire] Cobalt Strike Beacon"; flow:established,to_server; content:"GET"; http_method; content:"|43 6f 62 61 6c 74 20 53 74 72 69 6b 65 20 42 65 61 63 6f 6e 29|"; fast_pattern; http_user_agent; isdataat:!1,relative; http_header_names; content:!"Referer"; metadata:former_category TROJAN, flip_endpoints False, server_side False; classtype:trojan-activity; sid:1065748; rev:2; metadata:affected_product Web_Browsers, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2018_07_03, updated_at 2018_07_03; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Cobalt Strike Exfiltration (trojan-activity) - detector_id: 65749 original_sid: 2025636
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Cobalt Strike Exfiltration"; flow:established,to_server; content:"POST"; http_method; content:"|43 6f 62 61 6c 74 20 53 74 72 69 6b 65 20 42 65 61 63 6f 6e 29|"; fast_pattern; http_user_agent; isdataat:!1,relative; http_header_names; content:!"Referer"; metadata:former_category TROJAN, flip_endpoints False, server_side False; classtype:trojan-activity; sid:1065749; rev:1; metadata:affected_product Web_Browsers, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2018_07_03, updated_at 2018_07_03; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Remcos RAT Checkin 23 (trojan-activity) - detector_id: 65754 original_sid: 2025637
reject tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Remcos RAT Checkin 23"; flow:established,to_server; dsize:<700; content:"|1b 84 d5 b0 5d f4 c4 93 c5 30 c2|"; depth:11; fast_pattern; content:"|da b1|"; distance:2; within:2; threshold: type limit, seconds 30, count 1, track by_src; metadata:former_category TROJAN, flip_endpoints False, server_side False; reference:md5,f4f2425e9735f92cc9f75711aa8cb210; classtype:trojan-activity; sid:1065754; rev:3; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, tag RAT, signature_severity Major, created_at 2018_07_03, malware_family Remcos, updated_at 2019_03_22; target:src_ip;)

# ET TROJAN [eSentire] Win32/GandCrab v4/5 Ransomware CnC Activity (trojan-activity) - detector_id: 65755 original_sid: 2025638
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN [eSentire] Win32/GandCrab v4/5 Ransomware CnC Activity"; flow:established,to_server; content:"POST"; http_method; pcre:"/\.(?:bmp|png|gif|jpg)$/U"; content:"Content-Type|3a 20|multipart/form-data"; http_header; content:"Mozilla/5.0 (Windows NT 6.1|3b 20|WOW64"; http_user_agent; content:"wfKD6iudumBkmp"; depth:14; fast_pattern; http_client_body; pcre:"/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{4})$/Psi"; threshold: type limit, count 1, seconds 60, track by_src; http_header_names; content:!"Referer"; content:!"Accept"; metadata:former_category TROJAN, flip_endpoints False, server_side False; classtype:trojan-activity; sid:1065755; rev:3; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, tag Ransomware, signature_severity Major, created_at 2018_07_04, malware_family GandCrab, performance_impact Low, updated_at 2018_09_24; target:src_ip;)

# ET TROJAN DNS Query for DNSpionage CnC Domain (trojan-activity) - detector_id: 69160 original_sid: 2026557
reject dns $HOME_NET any -> any any (msg:"ET TROJAN DNS Query for DNSpionage CnC Domain"; dns_query; content:".0ffice36o.com"; nocase; isdataat:!1,relative; metadata:former_category TROJAN, flip_endpoints False, server_side False; reference:md5,c00c9f6ebf2979292d524acff19dd306; classtype:trojan-activity; sid:1069160; rev:3; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, tag DNSpionage, tag DNS_tunneling, signature_severity Major, created_at 2018_10_26, updated_at 2018_10_26; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN DNSpionage Commands Embedded in Webpage Inbound (trojan-activity) - detector_id: 69372 original_sid: 2026672
reject http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET TROJAN DNSpionage Commands Embedded in Webpage Inbound"; flow:established,from_server; content:"200"; http_stat_code; file_data; content:"|3c 21 2d 2d|eyJjIjogI"; fast_pattern; content:"|3c 21 2d 2d|"; pcre:"/^(?:[A-Z0-9+/]{4})*(?:[A-Z0-9+/]{2}==|[A-Z0-9+/]{3}=|[A-Z0-9+/]{4})/R"; metadata:former_category TROJAN, flip_endpoints True, server_side False; reference:url,blog.talosintelligence.com/2018/11/dnspionage-campaign-targets-middle-east.html; classtype:trojan-activity; sid:1069372; rev:1; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, tag DNSpionage, signature_severity Major, created_at 2018_11_28, performance_impact Low, updated_at 2018_11_28; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET TROJAN DNS Query for DNSpionage CnC Domain (trojan-activity) - detector_id: 69384 original_sid: 2026680
reject dns $HOME_NET any -> any any (msg:"ET TROJAN DNS Query for DNSpionage CnC Domain"; dns_query; content:".microsoftonedrive.org"; distance:0; nocase; fast_pattern; isdataat:!1,relative; metadata:former_category TROJAN, flip_endpoints False, server_side False; reference:url,blog.talosintelligence.com/2018/11/dnspionage-campaign-targets-middle-east.html; classtype:trojan-activity; sid:1069384; rev:2; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, tag DNSpionage, tag DNS_tunneling, signature_severity Major, created_at 2018_11_29, performance_impact Low, updated_at 2018_11_29; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN DNSpionage Requesting Config (trojan-activity) - detector_id: 69385 original_sid: 2026681
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN DNSpionage Requesting Config"; flow:established,to_server; content:"GET"; http_method; content:"/Login?id=Fy"; http_uri; fast_pattern; isdataat:!1,relative; metadata:former_category TROJAN, flip_endpoints False, server_side False; reference:url,blog.talosintelligence.com/2018/11/dnspionage-campaign-targets-middle-east.html; classtype:trojan-activity; sid:1069385; rev:1; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, tag DNSpionage, signature_severity Major, created_at 2018_11_29, performance_impact Low, updated_at 2018_11_29; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN APT DarkHydrus DNS Lookup 11 (trojan-activity) - detector_id: 69594 original_sid: 2026785
reject dns $HOME_NET any -> any any (msg:"ET TROJAN APT DarkHydrus DNS Lookup 11"; dns_query; content:"akdns.live"; nocase; isdataat:!1,relative; metadata:former_category TROJAN, flip_endpoints False, server_side False; classtype:trojan-activity; sid:1069594; rev:1; metadata:attack_target Client_Endpoint, deployment Perimeter, tag APT, tag DNS_tunneling, tag DarkHydrus, signature_severity Major, created_at 2019_01_11, performance_impact Low, updated_at 2019_01_11; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN APT DarkHydrus DNS Lookup 12 (trojan-activity) - detector_id: 69595 original_sid: 2026786
reject dns $HOME_NET any -> any any (msg:"ET TROJAN APT DarkHydrus DNS Lookup 12"; dns_query; content:"akamaiedge.live"; nocase; isdataat:!1,relative; metadata:former_category TROJAN, flip_endpoints False, server_side False; classtype:trojan-activity; sid:1069595; rev:1; metadata:attack_target Client_Endpoint, deployment Perimeter, tag APT, tag DNS_tunneling, tag DarkHydrus, signature_severity Major, created_at 2019_01_11, performance_impact Low, updated_at 2019_01_11; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN APT DarkHydrus DNS Lookup 13 (trojan-activity) - detector_id: 69596 original_sid: 2026787
reject dns $HOME_NET any -> any any (msg:"ET TROJAN APT DarkHydrus DNS Lookup 13"; dns_query; content:"akamaiedge.services"; nocase; isdataat:!1,relative; metadata:former_category TROJAN, flip_endpoints False, server_side False; classtype:trojan-activity; sid:1069596; rev:1; metadata:attack_target Client_Endpoint, deployment Perimeter, tag APT, tag DNS_tunneling, tag DarkHydrus, signature_severity Major, created_at 2019_01_11, performance_impact Low, updated_at 2019_01_11; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN APT DarkHydrus DNS Lookup 14 (trojan-activity) - detector_id: 69597 original_sid: 2026788
reject dns $HOME_NET any -> any any (msg:"ET TROJAN APT DarkHydrus DNS Lookup 14"; dns_query; content:"edgekey.live"; nocase; isdataat:!1,relative; metadata:former_category TROJAN, flip_endpoints False, server_side False; classtype:trojan-activity; sid:1069597; rev:1; metadata:attack_target Client_Endpoint, deployment Perimeter, tag APT, tag DNS_tunneling, tag DarkHydrus, signature_severity Major, created_at 2019_01_11, performance_impact Low, updated_at 2019_01_11; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN APT DarkHydrus DNS Lookup 15 (trojan-activity) - detector_id: 69598 original_sid: 2026789
reject dns $HOME_NET any -> any any (msg:"ET TROJAN APT DarkHydrus DNS Lookup 15"; dns_query; content:"akamaized.live"; nocase; isdataat:!1,relative; metadata:former_category TROJAN, flip_endpoints False, server_side False; classtype:trojan-activity; sid:1069598; rev:1; metadata:attack_target Client_Endpoint, deployment Perimeter, tag APT, tag DNS_tunneling, tag DarkHydrus, signature_severity Major, created_at 2019_01_11, performance_impact Low, updated_at 2019_01_11; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN APT DarkHydrus DNS Lookup 16 (trojan-activity) - detector_id: 69599 original_sid: 2026790
reject dns $HOME_NET any -> any any (msg:"ET TROJAN APT DarkHydrus DNS Lookup 16"; dns_query; content:"trafficmanager.live"; nocase; isdataat:!1,relative; metadata:former_category TROJAN, flip_endpoints False, server_side False; classtype:trojan-activity; sid:1069599; rev:1; metadata:attack_target Client_Endpoint, deployment Perimeter, tag APT, tag DNS_tunneling, tag DarkHydrus, signature_severity Major, created_at 2019_01_11, performance_impact Low, updated_at 2019_01_11; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN OSX/Shlayer CnC Landing M2 (trojan-activity) - detector_id: 75140 original_sid: 2026911
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN OSX/Shlayer CnC Landing M2"; flow:established,to_server; content:"GET"; http_method; content:"/hyllkjit/"; http_uri; depth:10; fast_pattern; content:"/?n="; http_uri; pcre:"/^\/hyllkjit\/[a-f0-9]{8}\/\?n=\d{4,10}$/Ui"; metadata:former_category TROJAN, flip_endpoints False, server_side False; reference:url,www.carbonblack.com/2019/02/12/tau-threat-intelligence-notification-new-macos-malware-variant-of-shlayer-osx-discovered/; classtype:trojan-activity; sid:1075140; rev:2; metadata:affected_product Mac_OSX, deployment Perimeter, signature_severity Major, created_at 2019_02_14, malware_family Shlayer, performance_impact Low, updated_at 2019_02_14; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN OSX/Shlayer CnC Activity M3 (trojan-activity) - detector_id: 75141 original_sid: 2026912
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN OSX/Shlayer CnC Activity M3"; flow:established,to_server; content:"GET"; http_method; content:"/?campid="; http_uri; fast_pattern; content:"&model="; http_uri; distance:0; content:"&os="; http_uri; distance:0; content:"&city="; http_uri; distance:0; content:"&ip="; http_uri; distance:0; content:"&ua="; http_uri; distance:0; content:"&language="; http_uri; distance:0; content:"&isp="; http_uri; distance:0; content:"&carrier="; http_uri; distance:0; metadata:former_category TROJAN, flip_endpoints False, server_side False; reference:url,www.carbonblack.com/2019/02/12/tau-threat-intelligence-notification-new-macos-malware-variant-of-shlayer-osx-discovered/; classtype:trojan-activity; sid:1075141; rev:2; metadata:affected_product Mac_OSX, deployment Perimeter, signature_severity Major, created_at 2019_02_14, malware_family Shlayer, performance_impact Low, updated_at 2019_02_14; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN OSX/Shlayer CnC Activity M4 (trojan-activity) - detector_id: 75142 original_sid: 2026913
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN OSX/Shlayer CnC Activity M4"; flow:established,to_server; content:"GET"; http_method; content:"/sd/?c="; http_uri; depth:7; fast_pattern; pcre:"/^(?:[A-Z0-9+/]{4})*(?:[A-Z0-9+/]{2}==|[A-Z0-9+/]{3}=|[A-Z0-9+/]{4})/RUi"; content:"&u="; http_uri; distance:0; content:"&s="; http_uri; distance:0; content:"&o="; http_uri; distance:0; content:"&b="; http_uri; distance:0; pcre:"/^\d{3,15}$/RU"; metadata:former_category TROJAN, flip_endpoints False, server_side False; reference:url,www.carbonblack.com/2019/02/12/tau-threat-intelligence-notification-new-macos-malware-variant-of-shlayer-osx-discovered/; classtype:trojan-activity; sid:1075142; rev:1; metadata:affected_product Mac_OSX, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2019_02_14, malware_family Shlayer, performance_impact Low, updated_at 2019_02_14; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN HAWKBALL CnC Initial Request (trojan-activity) - detector_id: 76144 original_sid: 2027439
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN HAWKBALL CnC Initial Request"; flow:established,to_server; content:"GET"; http_method; content:"/?t="; depth:4; http_uri; content:"&&s="; http_uri; distance:0; content:"&&p="; http_uri; distance:0; content:"&&k="; http_uri; distance:0; fast_pattern; content:"Mozilla/4.0 (compatible|3b 20|MSIE 8.0|3b 20|Windows NT 6.1|3b 20|Trident/4.0|3b 20|SLCC2|3b 20|.NET CLR 2.0.50727|3b 20|.NET CLR 3.5.30729|3b 20|.NET CLR 3.0.30729|3b 20|Media Center PC 6.0|3b 20|InfoPath.2)"; http_user_agent; http_content_len; content:"0"; http_header_names; content:"|0d 0a|Content-Length|0d 0a|Cache-Control|0d 0a|User-Agent|0d 0a|Host|0d 0a|Connection|0d 0a 0d 0a|"; depth:65; isdataat:!1,relative; reference:md5,d90e45fbf11b5bbdca945b24d155a4b2; reference:url,www.fireeye.com/blog/threat-research/2019/06/government-in-central-asia-targeted-with-hawkball-backdoor.html; classtype:trojan-activity; sid:1076144; rev:2; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2019_06_06, updated_at 2019_06_06, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN HAWKBALL CnC Activity (trojan-activity) - detector_id: 76145 original_sid: 2027440
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN HAWKBALL CnC Activity"; flow:established,to_server; content:"GET"; http_method; content:"/?e="; depth:4; http_uri; content:"&&t="; http_uri; distance:0; content:"&&k="; http_uri; distance:0; fast_pattern; content:"Mozilla/4.0 (compatible|3b 20|MSIE 8.0|3b 20|Windows NT 6.1|3b 20|Trident/4.0|3b 20|SLCC2|3b 20|.NET CLR 2.0.50727|3b 20|.NET CLR 3.5.30729|3b 20|.NET CLR 3.0.30729|3b 20|Media Center PC 6.0|3b 20|InfoPath.2)"; http_user_agent; content:"id="; http_cookie; depth:3; http_content_len; content:"0"; http_header_names; content:"|0d 0a|Content-Length|0d 0a|Cache-Control|0d 0a|Cookie|0d 0a|User-Agent|0d 0a|Host|0d 0a|Connection|0d 0a 0d 0a|"; depth:73; isdataat:!1,relative; reference:md5,d90e45fbf11b5bbdca945b24d155a4b2; reference:url,www.fireeye.com/blog/threat-research/2019/06/government-in-central-asia-targeted-with-hawkball-backdoor.html; classtype:trojan-activity; sid:1076145; rev:1; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2019_06_06, updated_at 2019_06_06, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN HAWKBALL CnC Sending System Information (trojan-activity) - detector_id: 76146 original_sid: 2027441
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN HAWKBALL CnC Sending System Information"; flow:established,to_server; content:"POST"; http_method; content:"/?e="; depth:4; http_uri; content:"&&t="; http_uri; distance:0; content:"&&k="; http_uri; distance:0; fast_pattern; content:"Mozilla/4.0 (compatible|3b 20|MSIE 8.0|3b 20|Windows NT 6.1|3b 20|Trident/4.0|3b 20|SLCC2|3b 20|.NET CLR 2.0.50727|3b 20|.NET CLR 3.5.30729|3b 20|.NET CLR 3.0.30729|3b 20|Media Center PC 6.0|3b 20|InfoPath.2)"; http_user_agent; content:"id="; http_cookie; depth:3; http_header_names; content:"|0d 0a|Content-Length|0d 0a|Cache-Control|0d 0a|Cookie|0d 0a|User-Agent|0d 0a|Host|0d 0a|Connection|0d 0a 0d 0a|"; depth:73; isdataat:!1,relative; reference:md5,d90e45fbf11b5bbdca945b24d155a4b2; reference:url,www.fireeye.com/blog/threat-research/2019/06/government-in-central-asia-targeted-with-hawkball-backdoor.html; classtype:trojan-activity; sid:1076146; rev:1; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2019_06_06, updated_at 2019_06_06, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Observed Buran Ransomware UA (BURAN) (trojan-activity) - detector_id: 76154 original_sid: 2027443
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Observed Buran Ransomware UA (BURAN)"; flow:established,to_server; content:"BURAN"; http_user_agent; depth:5; isdataat:!1,relative; metadata:former_category TROJAN, flip_endpoints False, server_side False; classtype:trojan-activity; sid:1076154; rev:1; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2019_06_10, malware_family Buran, performance_impact Low, updated_at 2019_06_10; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Observed Buran Ransomware UA (GHOST) (trojan-activity) - detector_id: 76155 original_sid: 2027444
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Observed Buran Ransomware UA (GHOST)"; flow:established,to_server; content:"GHOST"; http_user_agent; depth:5; isdataat:!1,relative; metadata:former_category TROJAN, flip_endpoints False, server_side False; classtype:trojan-activity; sid:1076155; rev:1; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2019_06_10, updated_at 2019_06_10; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Buran Ransomware Activity M2 (trojan-activity) - detector_id: 76156 original_sid: 2027445
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Buran Ransomware Activity M2"; flow:established,to_server; content:"GET"; http_method; content:"GHOST"; http_user_agent; depth:5; isdataat:!1,relative; fast_pattern; http_referer; content:!"."; pcre:"/^[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}$/i"; http_header_names; content:!"Connection"; content:!"Cache"; content:!"Accept"; metadata:former_category TROJAN, flip_endpoints False, server_side False; classtype:trojan-activity; sid:1076156; rev:1; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2019_06_10, malware_family Buran, performance_impact Moderate, updated_at 2019_06_10; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN Buran Ransomware Activity M1 (trojan-activity) - detector_id: 76157 original_sid: 2027446
reject http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET TROJAN Buran Ransomware Activity M1"; flow:established,to_server; content:"GET"; http_method; content:"User-Agent|3a 20|BURAN|0d 0a|"; http_header; fast_pattern; http_referer; content:!"."; pcre:"/^[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}$/i"; http_header_names; content:!"Connection"; content:!"Cache"; content:!"Accept"; metadata:former_category TROJAN, flip_endpoints False, server_side False; classtype:trojan-activity; sid:1076157; rev:2; metadata:affected_product Windows_XP_Vista_7_8_10_Server_32_64_Bit, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2019_06_10, malware_family Buran, performance_impact Moderate, updated_at 2019_06_10; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN APT33 CnC Domain in DNS Lookup (trojan-activity) - detector_id: 91619 original_sid: 2027622
alert dns $HOME_NET any -> any any (msg:"ET TROJAN APT33 CnC Domain in DNS Lookup"; dns_query; content:"backupnet.ddns.net"; nocase; isdataat:!1,relative; metadata:former_category TROJAN, flip_endpoints False, server_side False; classtype:trojan-activity; sid:1091619; rev:1; metadata:affected_product Web_Browsers, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2019_06_28, updated_at 2019_06_28; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN APT33 CnC Domain in DNS Lookup (trojan-activity) - detector_id: 91620 original_sid: 2027623
alert dns $HOME_NET any -> any any (msg:"ET TROJAN APT33 CnC Domain in DNS Lookup"; dns_query; content:"hyperservice.ddns.net"; nocase; isdataat:!1,relative; reference:url,go.recordedfuture.com/hubfs/reports/cta-2019-0626.pdf; classtype:trojan-activity; sid:1091620; rev:1; metadata:affected_product Web_Browsers, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2019_06_28, updated_at 2019_06_28, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN APT33 CnC Domain in DNS Lookup (trojan-activity) - detector_id: 91621 original_sid: 2027624
alert dns $HOME_NET any -> any any (msg:"ET TROJAN APT33 CnC Domain in DNS Lookup"; dns_query; content:"mynetwork.cf"; nocase; isdataat:!1,relative; reference:url,go.recordedfuture.com/hubfs/reports/cta-2019-0626.pdf; classtype:trojan-activity; sid:1091621; rev:1; metadata:affected_product Web_Browsers, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2019_06_28, updated_at 2019_06_28, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN APT33 CnC Domain in DNS Lookup (trojan-activity) - detector_id: 91622 original_sid: 2027625
alert dns $HOME_NET any -> any any (msg:"ET TROJAN APT33 CnC Domain in DNS Lookup"; dns_query; content:"mywinnetwork.ddns.net"; nocase; isdataat:!1,relative; reference:url,go.recordedfuture.com/hubfs/reports/cta-2019-0626.pdf; classtype:trojan-activity; sid:1091622; rev:1; metadata:affected_product Web_Browsers, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2019_06_28, updated_at 2019_06_28, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN APT33 CnC Domain in DNS Lookup (trojan-activity) - detector_id: 91623 original_sid: 2027626
alert dns $HOME_NET any -> any any (msg:"ET TROJAN APT33 CnC Domain in DNS Lookup"; dns_query; content:"remote-server.ddns.net"; nocase; isdataat:!1,relative; reference:url,go.recordedfuture.com/hubfs/reports/cta-2019-0626.pdf; classtype:trojan-activity; sid:1091623; rev:1; metadata:affected_product Web_Browsers, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2019_06_28, updated_at 2019_06_28, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN APT33 CnC Domain in DNS Lookup (trojan-activity) - detector_id: 91624 original_sid: 2027627
alert dns $HOME_NET any -> any any (msg:"ET TROJAN APT33 CnC Domain in DNS Lookup"; dns_query; content:"remserver.ddns.net"; nocase; isdataat:!1,relative; reference:url,go.recordedfuture.com/hubfs/reports/cta-2019-0626.pdf; classtype:trojan-activity; sid:1091624; rev:1; metadata:affected_product Web_Browsers, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2019_06_28, updated_at 2019_06_28, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN APT33 CnC Domain in DNS Lookup (trojan-activity) - detector_id: 91625 original_sid: 2027628
alert dns $HOME_NET any -> any any (msg:"ET TROJAN APT33 CnC Domain in DNS Lookup"; dns_query; content:"securityupdated.com"; nocase; isdataat:!1,relative; reference:url,go.recordedfuture.com/hubfs/reports/cta-2019-0626.pdf; classtype:trojan-activity; sid:1091625; rev:1; metadata:affected_product Web_Browsers, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2019_06_28, updated_at 2019_06_28, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN APT33 CnC Domain in DNS Lookup (trojan-activity) - detector_id: 91626 original_sid: 2027629
alert dns $HOME_NET any -> any any (msg:"ET TROJAN APT33 CnC Domain in DNS Lookup"; dns_query; content:"servhost.hopto.org"; nocase; isdataat:!1,relative; reference:url,go.recordedfuture.com/hubfs/reports/cta-2019-0626.pdf; classtype:trojan-activity; sid:1091626; rev:1; metadata:affected_product Web_Browsers, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2019_06_28, updated_at 2019_06_28, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN APT33 CnC Domain in DNS Lookup (trojan-activity) - detector_id: 91627 original_sid: 2027630
alert dns $HOME_NET any -> any any (msg:"ET TROJAN APT33 CnC Domain in DNS Lookup"; dns_query; content:"service-avant.com"; nocase; isdataat:!1,relative; reference:url,go.recordedfuture.com/hubfs/reports/cta-2019-0626.pdf; classtype:trojan-activity; sid:1091627; rev:1; metadata:affected_product Web_Browsers, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2019_06_28, updated_at 2019_06_28, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN APT33 CnC Domain in DNS Lookup (trojan-activity) - detector_id: 91628 original_sid: 2027631
alert dns $HOME_NET any -> any any (msg:"ET TROJAN APT33 CnC Domain in DNS Lookup"; dns_query; content:"srvhost.servehttp.com"; nocase; isdataat:!1,relative; reference:url,go.recordedfuture.com/hubfs/reports/cta-2019-0626.pdf; classtype:trojan-activity; sid:1091628; rev:1; metadata:affected_product Web_Browsers, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2019_06_28, updated_at 2019_06_28, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN APT33 CnC Domain in DNS Lookup (trojan-activity) - detector_id: 91629 original_sid: 2027632
alert dns $HOME_NET any -> any any (msg:"ET TROJAN APT33 CnC Domain in DNS Lookup"; dns_query; content:"fucksaudi.ddns.net"; nocase; isdataat:!1,relative; reference:url,go.recordedfuture.com/hubfs/reports/cta-2019-0626.pdf; classtype:trojan-activity; sid:1091629; rev:1; metadata:affected_product Web_Browsers, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2019_06_28, updated_at 2019_06_28, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN APT33 CnC Domain in DNS Lookup (trojan-activity) - detector_id: 91630 original_sid: 2027633
alert dns $HOME_NET any -> any any (msg:"ET TROJAN APT33 CnC Domain in DNS Lookup"; dns_query; content:"googlechromehost.ddns.net"; nocase; isdataat:!1,relative; reference:url,go.recordedfuture.com/hubfs/reports/cta-2019-0626.pdf; classtype:trojan-activity; sid:1091630; rev:1; metadata:affected_product Web_Browsers, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2019_06_28, updated_at 2019_06_28, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN APT33 CnC Domain in DNS Lookup (trojan-activity) - detector_id: 91631 original_sid: 2027634
alert dns $HOME_NET any -> any any (msg:"ET TROJAN APT33 CnC Domain in DNS Lookup"; dns_query; content:"younesadams.ddns.net"; nocase; isdataat:!1,relative; reference:url,go.recordedfuture.com/hubfs/reports/cta-2019-0626.pdf; classtype:trojan-activity; sid:1091631; rev:1; metadata:affected_product Web_Browsers, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2019_06_28, updated_at 2019_06_28, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN APT33 CnC Domain in DNS Lookup (trojan-activity) - detector_id: 91632 original_sid: 2027635
alert dns $HOME_NET any -> any any (msg:"ET TROJAN APT33 CnC Domain in DNS Lookup"; dns_query; content:"teamnj.ddns.net"; nocase; isdataat:!1,relative; reference:url,go.recordedfuture.com/hubfs/reports/cta-2019-0626.pdf; classtype:trojan-activity; sid:1091632; rev:1; metadata:affected_product Web_Browsers, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2019_06_28, updated_at 2019_06_28, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN APT33 CnC Domain in DNS Lookup (trojan-activity) - detector_id: 91633 original_sid: 2027636
alert dns $HOME_NET any -> any any (msg:"ET TROJAN APT33 CnC Domain in DNS Lookup"; dns_query; content:"bistbotsproxies.ddns.net"; nocase; isdataat:!1,relative; reference:url,go.recordedfuture.com/hubfs/reports/cta-2019-0626.pdf; classtype:trojan-activity; sid:1091633; rev:1; metadata:affected_product Web_Browsers, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2019_06_28, updated_at 2019_06_28, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN APT33 CnC Domain in DNS Lookup (trojan-activity) - detector_id: 91634 original_sid: 2027637
alert dns $HOME_NET any -> any any (msg:"ET TROJAN APT33 CnC Domain in DNS Lookup"; dns_query; content:"hellocookies.ddns.net"; nocase; isdataat:!1,relative; reference:url,go.recordedfuture.com/hubfs/reports/cta-2019-0626.pdf; classtype:trojan-activity; sid:1091634; rev:1; metadata:affected_product Web_Browsers, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2019_06_28, updated_at 2019_06_28, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN APT33 CnC Domain in DNS Lookup (trojan-activity) - detector_id: 91635 original_sid: 2027638
alert dns $HOME_NET any -> any any (msg:"ET TROJAN APT33 CnC Domain in DNS Lookup"; dns_query; content:"n3tc4t.hopto.com"; nocase; isdataat:!1,relative; reference:url,go.recordedfuture.com/hubfs/reports/cta-2019-0626.pdf; classtype:trojan-activity; sid:1091635; rev:1; metadata:affected_product Web_Browsers, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2019_06_28, updated_at 2019_06_28, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN APT33 CnC Domain in DNS Lookup (trojan-activity) - detector_id: 91636 original_sid: 2027639
alert dns $HOME_NET any -> any any (msg:"ET TROJAN APT33 CnC Domain in DNS Lookup"; dns_query; content:"newhost.hopto.org"; nocase; isdataat:!1,relative; reference:url,go.recordedfuture.com/hubfs/reports/cta-2019-0626.pdf; classtype:trojan-activity; sid:1091636; rev:1; metadata:affected_product Web_Browsers, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2019_06_28, updated_at 2019_06_28, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN APT33 CnC Domain in DNS Lookup (trojan-activity) - detector_id: 91637 original_sid: 2027640
alert dns $HOME_NET any -> any any (msg:"ET TROJAN APT33 CnC Domain in DNS Lookup"; dns_query; content:"njrat12.ddns.net"; nocase; isdataat:!1,relative; reference:url,go.recordedfuture.com/hubfs/reports/cta-2019-0626.pdf; classtype:trojan-activity; sid:1091637; rev:1; metadata:affected_product Web_Browsers, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2019_06_28, updated_at 2019_06_28, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN APT33 CnC Domain in DNS Lookup (trojan-activity) - detector_id: 91638 original_sid: 2027641
alert dns $HOME_NET any -> any any (msg:"ET TROJAN APT33 CnC Domain in DNS Lookup"; dns_query; content:"svcexplores.com"; nocase; isdataat:!1,relative; reference:url,go.recordedfuture.com/hubfs/reports/cta-2019-0626.pdf; classtype:trojan-activity; sid:1091638; rev:1; metadata:affected_product Web_Browsers, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2019_06_28, updated_at 2019_06_28, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN APT33 CnC Domain in DNS Lookup (trojan-activity) - detector_id: 91639 original_sid: 2027642
alert dns $HOME_NET any -> any any (msg:"ET TROJAN APT33 CnC Domain in DNS Lookup"; dns_query; content:"trojan1117.hopto.org"; nocase; isdataat:!1,relative; reference:url,go.recordedfuture.com/hubfs/reports/cta-2019-0626.pdf; classtype:trojan-activity; sid:1091639; rev:1; metadata:affected_product Web_Browsers, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2019_06_28, updated_at 2019_06_28, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN APT33 CnC Domain in DNS Lookup (trojan-activity) - detector_id: 91640 original_sid: 2027643
alert dns $HOME_NET any -> any any (msg:"ET TROJAN APT33 CnC Domain in DNS Lookup"; dns_query; content:"update-sec.com"; nocase; isdataat:!1,relative; reference:url,go.recordedfuture.com/hubfs/reports/cta-2019-0626.pdf; classtype:trojan-activity; sid:1091640; rev:1; metadata:affected_product Web_Browsers, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2019_06_28, updated_at 2019_06_28, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN APT33 CnC Domain in DNS Lookup (trojan-activity) - detector_id: 91641 original_sid: 2027644
alert dns $HOME_NET any -> any any (msg:"ET TROJAN APT33 CnC Domain in DNS Lookup"; dns_query; content:"windowsx.sytes.net"; nocase; isdataat:!1,relative; reference:url,go.recordedfuture.com/hubfs/reports/cta-2019-0626.pdf; classtype:trojan-activity; sid:1091641; rev:1; metadata:affected_product Web_Browsers, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2019_06_28, updated_at 2019_06_28, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN APT33 CnC Domain in DNS Lookup (trojan-activity) - detector_id: 91642 original_sid: 2027645
alert dns $HOME_NET any -> any any (msg:"ET TROJAN APT33 CnC Domain in DNS Lookup"; dns_query; content:"wwwgooglecom.sytes.net"; nocase; isdataat:!1,relative; reference:url,go.recordedfuture.com/hubfs/reports/cta-2019-0626.pdf; classtype:trojan-activity; sid:1091642; rev:1; metadata:affected_product Web_Browsers, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2019_06_28, updated_at 2019_06_28, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN APT33 CnC Domain in DNS Lookup (trojan-activity) - detector_id: 91643 original_sid: 2027646
alert dns $HOME_NET any -> any any (msg:"ET TROJAN APT33 CnC Domain in DNS Lookup"; dns_query; content:"xtreme.hopto.org"; nocase; isdataat:!1,relative; reference:url,go.recordedfuture.com/hubfs/reports/cta-2019-0626.pdf; classtype:trojan-activity; sid:1091643; rev:1; metadata:affected_product Web_Browsers, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2019_06_28, updated_at 2019_06_28, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET TROJAN APT33 CnC Domain in DNS Lookup (trojan-activity) - detector_id: 91644 original_sid: 2027647
alert dns $HOME_NET any -> any any (msg:"ET TROJAN APT33 CnC Domain in DNS Lookup"; dns_query; content:"za158155.ddns.net"; nocase; isdataat:!1,relative; reference:url,go.recordedfuture.com/hubfs/reports/cta-2019-0626.pdf; classtype:trojan-activity; sid:1091644; rev:1; metadata:affected_product Web_Browsers, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2019_06_28, updated_at 2019_06_28, flip_endpoints False, server_side False; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

