# Emerging Threats
#
# This distribution may contain rules under two different licenses.
#
#  Rules with sids 1 through 3464, and 100000000 through 100000908 are under the GPLv2.
#  A copy of that license is available at http://www.gnu.org/licenses/gpl-2.0.html
#
#  Rules with sids 2000000 through 2799999 are from Emerging Threats and are covered under the BSD License
#  as follows:
#
#*************************************************************
#  Copyright (c) 2003-2017, Emerging Threats
#  All rights reserved.
#
#  Redistribution and use in source and binary forms, with or without modification, are permitted provided that the
#  following conditions are met:
#
#  * Redistributions of source code must retain the above copyright notice, this list of conditions and the following
#    disclaimer.
#  * Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the
#    following disclaimer in the documentation and/or other materials provided with the distribution.
#  * Neither the name of the nor the names of its contributors may be used to endorse or promote products derived
#    from this software without specific prior written permission.
#
#  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY EXPRESS OR IMPLIED WARRANTIES,
#  INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
#  DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
#  SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
#  SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,
#  WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE
#  USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
#
#*************************************************************
#
#
#
#

# ET WEB_SERVER PHPMyAdmin BackDoor Access (attempted-admin) - detector_id: 2583 original_sid: 2015737
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER PHPMyAdmin BackDoor Access"; flow:established,to_server; content:"POST"; http_method; content:"/server_sync.php?"; fast_pattern:only; http_uri; content:"c="; http_uri; pcre:"/\/server_sync.php\?(?:.+?&)?c=/Ui"; reference:url,www.phpmyadmin.net/home_page/security/PMASA-2012-5.php; classtype:attempted-admin; sid:1002583; rev:6; metadata:created_at 2012_09_25, updated_at 2012_09_25, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Joomla Component SQLi Attempt (web-application-attack) - detector_id: 2716 original_sid: 2015984
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER Joomla Component SQLi Attempt"; flow:established,to_server; content:"option=com_"; http_uri; nocase; content:"union"; http_uri; nocase; distance:0; content:"select"; nocase; http_uri; distance:0; content:"from"; nocase; http_uri; distance:0; content:"jos_users"; distance:0; http_uri; nocase; fast_pattern; classtype:web-application-attack; sid:1002716; rev:3; metadata:created_at 2012_12_04, updated_at 2012_12_04, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Possible CVE-2013-0156 Ruby On Rails XML YAML tag with !ruby (web-application-attack) - detector_id: 2798 original_sid: 2016204
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER Possible CVE-2013-0156 Ruby On Rails XML YAML tag with !ruby"; flow:established,to_server; content:" type"; nocase; fast_pattern; content:"yaml"; distance:0; nocase; content:"!ruby"; nocase; distance:0; pcre:"/<(?P<tname>[^\s]+)[^>]*?\stype\s*=\s*(?P<q>[\x22\x27])yaml(?P=q)((?!<\/(?P=tname)).+?)!ruby/si"; reference:url,groups.google.com/forum/?hl=en&fromgroups=#!topic/rubyonrails-security/61bkgvnSGTQ; classtype:web-application-attack; sid:1002798; rev:4; metadata:created_at 2013_01_11, updated_at 2013_01_11, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Ruby on Rails CVE-2013-0333 Attempt (web-application-activity) - detector_id: 2826 original_sid: 2016305
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER Ruby on Rails CVE-2013-0333 Attempt"; flow:established,to_server; pcre:"/^Content-Type\x3a[^\r\n]*(?:application\/json(?:request)?|text\/x-json)/Hmi"; content:"!ruby/"; http_client_body; nocase; content:"NamedRouteCollection"; http_client_body; nocase; reference:url,gist.github.com/4660248; classtype:web-application-activity; sid:1002826; rev:7; metadata:created_at 2013_01_29, updated_at 2013_01_29, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER SQL sp_password attempt (attempted-user) - detector_id: 69706 original_sid: 2000105
alert http $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"ET WEB_SERVER SQL sp_password attempt"; flow:to_server,established; content:"sp_password"; nocase; reference:url,doc.emergingthreats.net/2000105; classtype:attempted-user; sid:1069706; rev:5; metadata:created_at 2010_07_30, updated_at 2010_07_30, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER SQL sp_delete_alert attempt (attempted-user) - detector_id: 69707 original_sid: 2000106
alert http $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"ET WEB_SERVER SQL sp_delete_alert attempt"; flow:to_server,established; content:"sp_delete_alert"; nocase; reference:url,doc.emergingthreats.net/2000106; classtype:attempted-user; sid:1069707; rev:5; metadata:created_at 2010_07_30, updated_at 2010_07_30, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER MSSQL Server OLEDB asp error (web-application-activity) - detector_id: 69708 original_sid: 2001768
alert http $HOME_NET $HTTP_PORTS -> $EXTERNAL_NET any (msg:"ET WEB_SERVER MSSQL Server OLEDB asp error"; flow:established,from_server; content:"Microsoft OLE DB Provider for SQL Server error"; reference:url,www.wiretrip.net/rfp/p/doc.asp/i2/d42.htm; reference:url,doc.emergingthreats.net/2001768; classtype:web-application-activity; sid:1069708; rev:11; metadata:created_at 2010_07_30, updated_at 2010_07_30, flip_endpoints True, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET WEB_SERVER DataCha0s Web Scanner/Robot (web-application-activity) - detector_id: 69709 original_sid: 2003616
alert http $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"ET WEB_SERVER DataCha0s Web Scanner/Robot"; flow:established,to_server; content:"|0d 0a|User-Agent|3a| DataCha0s"; nocase; reference:url,www.internetofficer.com/web-robot/datacha0s.html; reference:url,doc.emergingthreats.net/2003616; classtype:web-application-activity; sid:1069709; rev:38; metadata:created_at 2010_07_30, updated_at 2010_07_30, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Possible SQL Injection Attempt INSERT INTO (web-application-attack) - detector_id: 69711 original_sid: 2006444
alert http $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"ET WEB_SERVER Possible SQL Injection Attempt INSERT INTO"; flow:established,to_server; uricontent:"INSERT"; nocase; uricontent:"INTO"; nocase; pcre:"/INSERT.+INTO/Ui"; reference:url,en.wikipedia.org/wiki/SQL_injection; reference:url,doc.emergingthreats.net/2006444; classtype:web-application-attack; sid:1069711; rev:10; metadata:affected_product Web_Server_Applications, attack_target Web_Server, deployment Datacenter, tag SQL_Injection, signature_severity Major, created_at 2010_07_30, updated_at 2016_07_01, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Possible SQL Injection Attempt UNION SELECT (web-application-attack) - detector_id: 69713 original_sid: 2006446
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER Possible SQL Injection Attempt UNION SELECT"; flow:established,to_server; uricontent:"UNION"; nocase; uricontent:"SELECT"; nocase; pcre:"/UNION.+SELECT/Ui"; reference:url,en.wikipedia.org/wiki/SQL_injection; reference:url,doc.emergingthreats.net/2006446; classtype:web-application-attack; sid:1069713; rev:12; metadata:affected_product Web_Server_Applications, attack_target Web_Server, deployment Datacenter, tag SQL_Injection, signature_severity Major, created_at 2010_07_30, updated_at 2016_07_01, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Possible SQL Injection Attempt UPDATE SET (web-application-attack) - detector_id: 69714 original_sid: 2006447
alert http $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"ET WEB_SERVER Possible SQL Injection Attempt UPDATE SET"; flow:established,to_server; content:"UPDATE"; nocase; http_uri; content:"SET"; nocase; distance:0; http_uri; pcre:"/\WUPDATE\s+[A-Za-z0-9$_].*?\WSET\s+[A-Za-z0-9$_].*?\x3d/Ui"; reference:url,en.wikipedia.org/wiki/SQL_injection; reference:url,doc.emergingthreats.net/2006447; classtype:web-application-attack; sid:1069714; rev:13; metadata:affected_product Web_Server_Applications, attack_target Web_Server, deployment Datacenter, tag SQL_Injection, signature_severity Major, created_at 2010_07_30, updated_at 2016_07_01, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER HP OpenView Network Node Manager CGI Directory Traversal (web-application-attack) - detector_id: 69715 original_sid: 2008171
alert http $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"ET WEB_SERVER HP OpenView Network Node Manager CGI Directory Traversal"; flow:to_server,established; content:"GET "; depth:4; uricontent:"/OvCgi/"; nocase; uricontent:"/OpenView5.exe?"; nocase; content:"Action=../../"; content:" HTTP/1"; distance:0; within:200; reference:bugtraq,28745; reference:cve,CVE-2008-0068; reference:url,aluigi.altervista.org/adv/closedviewx-adv.txt; reference:url,doc.emergingthreats.net/2008171; classtype:web-application-attack; sid:1069715; rev:7; metadata:created_at 2010_07_30, updated_at 2010_07_30, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Possible SQL Injection (varchar) (attempted-admin) - detector_id: 69716 original_sid: 2008175
alert http $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"ET WEB_SERVER Possible SQL Injection (varchar)"; flow:established,to_server; uricontent:"varchar("; nocase; reference:url,doc.emergingthreats.net/2008175; classtype:attempted-admin; sid:1069716; rev:5; metadata:affected_product Web_Server_Applications, attack_target Web_Server, deployment Datacenter, tag SQL_Injection, signature_severity Major, created_at 2010_07_30, updated_at 2016_07_01, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Possible SQL Injection (exec) (attempted-admin) - detector_id: 69717 original_sid: 2008176
alert http $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"ET WEB_SERVER Possible SQL Injection (exec)"; flow:established,to_server; uricontent:"exec("; nocase; reference:url,doc.emergingthreats.net/2008176; classtype:attempted-admin; sid:1069717; rev:6; metadata:affected_product Web_Server_Applications, attack_target Web_Server, deployment Datacenter, tag SQL_Injection, signature_severity Major, created_at 2010_07_30, updated_at 2016_07_01, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Possible SQL Injection Attempt Danmec related (declare) (attempted-admin) - detector_id: 69718 original_sid: 2008467
alert http $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"ET WEB_SERVER Possible SQL Injection Attempt Danmec related (declare)"; flow:established,to_server; uricontent:"DECLARE "; nocase; uricontent:"CHAR("; nocase; uricontent:"CAST("; nocase; reference:url,doc.emergingthreats.net/2008467; classtype:attempted-admin; sid:1069718; rev:5; metadata:affected_product Web_Server_Applications, attack_target Web_Server, deployment Datacenter, tag SQL_Injection, signature_severity Major, created_at 2010_07_30, updated_at 2016_07_01, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER SQL Injection Attempt (Agent NV32ts) (web-application-attack) - detector_id: 69719 original_sid: 2009029
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_SERVER SQL Injection Attempt (Agent NV32ts)"; flow:to_server,established; content:"User-Agent|3a| NV32ts"; reference:url,doc.emergingthreats.net/2009029; classtype:web-application-attack; sid:1069719; rev:7; metadata:affected_product Web_Server_Applications, attack_target Web_Server, deployment Datacenter, tag SQL_Injection, signature_severity Major, created_at 2010_07_30, updated_at 2016_07_01, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER PHP Generic Remote File Include Attempt (HTTPS) (web-application-attack) - detector_id: 69720 original_sid: 2009152
alert http $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"ET WEB_SERVER PHP Generic Remote File Include Attempt (HTTPS)"; flow:to_server,established; uricontent:".php"; nocase; uricontent:"=https|3a|/"; nocase; pcre:"/\x2Ephp\x3F.{0,300}\x3Dhttps\x3A\x2F[^\x3F\x26]+\x3F/Ui"; reference:url,doc.emergingthreats.net/2009152; classtype:web-application-attack; sid:1069720; rev:8; metadata:affected_product Any, attack_target Server, deployment Datacenter, tag Remote_File_Include, signature_severity Major, created_at 2010_07_30, updated_at 2016_07_01, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER PHP Generic Remote File Include Attempt (FTP) (web-application-attack) - detector_id: 69721 original_sid: 2009153
alert http $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"ET WEB_SERVER PHP Generic Remote File Include Attempt (FTP)"; flow:to_server,established; uricontent:".php"; nocase; uricontent:"=ftp|3a|/"; nocase; pcre:"/\x2Ephp\x3F.{0,300}\x3Dftp\x3A\x2F[^\x3F\x26]+\x3F/Ui"; reference:url,doc.emergingthreats.net/2009153; classtype:web-application-attack; sid:1069721; rev:8; metadata:affected_product Any, attack_target Server, deployment Datacenter, tag Remote_File_Include, signature_severity Major, created_at 2010_07_30, updated_at 2016_07_01, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER PHP Generic Remote File Include Attempt (FTPS) (web-application-attack) - detector_id: 69722 original_sid: 2009155
alert http $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"ET WEB_SERVER PHP Generic Remote File Include Attempt (FTPS)"; flow:to_server,established; uricontent:".php"; nocase; uricontent:"=ftps\:/"; nocase; pcre:"/\x2Ephp\x3F.{0,300}\x3Dftp\x3A\x2F[^\x3F\x26]+\x3F/Ui"; reference:url,doc.emergingthreats.net/2009155; classtype:web-application-attack; sid:1069722; rev:8; metadata:affected_product Any, attack_target Server, deployment Datacenter, tag Remote_File_Include, signature_severity Major, created_at 2010_07_30, updated_at 2016_07_01, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Attack Tool Revolt Scanner (web-application-attack) - detector_id: 69723 original_sid: 2009288
alert http $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"ET WEB_SERVER Attack Tool Revolt Scanner"; flow:established,to_server; content:"|0d 0a|User-Agent|3a| revolt"; reference:url,www.Whitehatsecurityresponse.blogspot.com; reference:url,doc.emergingthreats.net/2009288; classtype:web-application-attack; sid:1069723; rev:56; metadata:created_at 2010_07_30, updated_at 2010_07_30, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER cmd.exe In URI - Possible Command Execution Attempt (attempted-recon) - detector_id: 69724 original_sid: 2009361
alert http $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"ET WEB_SERVER cmd.exe In URI - Possible Command Execution Attempt"; flow:to_server,established; uricontent:"/cmd.exe"; nocase; reference:url,doc.emergingthreats.net/2009361; classtype:attempted-recon; sid:1069724; rev:5; metadata:created_at 2010_07_30, updated_at 2010_07_30, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER /system32/ in Uri - Possible Protected Directory Access Attempt (attempted-recon) - detector_id: 69725 original_sid: 2009362
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER /system32/ in Uri - Possible Protected Directory Access Attempt"; flow:established,to_server; content:"/system32/"; nocase; http_uri; reference:url,doc.emergingthreats.net/2009362; classtype:attempted-recon; sid:1069725; rev:6; metadata:created_at 2010_07_30, updated_at 2010_07_30, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Suspicious Chmod Usage in URI (attempted-admin) - detector_id: 69726 original_sid: 2009363
alert http $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"ET WEB_SERVER Suspicious Chmod Usage in URI"; flow:to_server,established; content:"chmod"; fast_pattern:only; nocase; http_uri; pcre:"/chmod\s+([+-][rwx]|[0-7])/Ui"; reference:url,doc.emergingthreats.net/2009363; classtype:attempted-admin; sid:1069726; rev:6; metadata:created_at 2010_07_30, updated_at 2010_07_30, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER /etc/shadow Detected in URI (attempted-recon) - detector_id: 69727 original_sid: 2009485
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER /etc/shadow Detected in URI"; flow:to_server,established; content:"/etc/shadow"; http_uri; nocase; reference:url,en.wikipedia.org/wiki/Shadow_password; reference:url,doc.emergingthreats.net/2009485; classtype:attempted-recon; sid:1069727; rev:6; metadata:created_at 2010_07_30, updated_at 2010_07_30, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Oracle Secure Enterprise Search 10.1.8 search Script XSS attempt (web-application-attack) - detector_id: 69728 original_sid: 2009643
alert tcp $EXTERNAL_NET any -> $HOME_NET 7777 (msg:"ET WEB_SERVER Oracle Secure Enterprise Search 10.1.8 search Script XSS attempt"; flow:to_server,established; content:"GET "; depth:4; content:"/search/query/search"; nocase; content:"search_p_groups="; nocase; content:"script"; nocase; pcre:"/<?(java|vb)?script>?/i"; reference:url,dsecrg.com/pages/vul/show.php?id=125; reference:url,doc.emergingthreats.net/2009643; classtype:web-application-attack; sid:1069728; rev:5; metadata:created_at 2010_07_30, updated_at 2010_07_30, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Oracle BEA Weblogic Server 10.3 searchQuery XSS attempt (web-application-attack) - detector_id: 69729 original_sid: 2009644
alert tcp $EXTERNAL_NET any -> $HOME_NET 7011 (msg:"ET WEB_SERVER Oracle BEA Weblogic Server 10.3 searchQuery XSS attempt"; flow:to_server,established; content:"GET "; depth:4; content:"/consolehelp/console-help.portal"; nocase; content:"searchQuery="; nocase; content:"script"; nocase; pcre:"/<?(java|vb)?script>?.*<.+\/script>?/i"; reference:url,dsecrg.com/pages/vul/show.php?id=131; reference:url,doc.emergingthreats.net/2009644; classtype:web-application-attack; sid:1069729; rev:5; metadata:created_at 2010_07_30, updated_at 2010_07_30, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Nagios statuswml.cgi Remote Arbitrary Shell Command Injection attempt (web-application-attack) - detector_id: 69730 original_sid: 2009670
alert http $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"ET WEB_SERVER Nagios statuswml.cgi Remote Arbitrary Shell Command Injection attempt"; flow:to_server,established; content:"GET "; nocase; depth:4; uricontent:"/statuswml.cgi?"; nocase; uricontent:"ping"; nocase; pcre:"/ping\s*=\s*([0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}|[^\x26\x0D\x0A]*\x3B)/Ui"; reference:bugtraq,35464; reference:url,doc.emergingthreats.net/2009670; classtype:web-application-attack; sid:1069730; rev:9; metadata:created_at 2010_07_30, updated_at 2010_07_30, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Possible DD-WRT Metacharacter Injection Command Execution Attempt (attempted-admin) - detector_id: 69731 original_sid: 2009678
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"ET WEB_SERVER Possible DD-WRT Metacharacter Injection Command Execution Attempt"; flow:to_server,established; uricontent:"/cgi-bin/|3B|"; nocase; pcre:"/\x2Fcgi\x2Dbin\x2F\x3B.+[a-z]/Ui"; reference:url,isc.sans.org/diary.html?storyid=6853; reference:url,www.theregister.co.uk/2009/07/21/critical_ddwrt_router_vuln/; reference:url,doc.emergingthreats.net/2009678; reference:url,www.dd-wrt.com/phpBB2/viewtopic.php?t=55173; reference:bid,35742; reference:cve,2009-2765; classtype:attempted-admin; sid:1069731; rev:6; metadata:created_at 2010_07_30, updated_at 2010_07_30, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Onmouseover= in URI - Likely Cross Site Scripting Attempt (web-application-attack) - detector_id: 69733 original_sid: 2009715
alert http $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"ET WEB_SERVER Onmouseover= in URI - Likely Cross Site Scripting Attempt"; flow:to_server,established; uricontent:"onmouseover="; nocase; reference:url,www.w3schools.com/jsref/jsref_onmouseover.asp; reference:url,doc.emergingthreats.net/2009715; classtype:web-application-attack; sid:1069733; rev:5; metadata:affected_product Web_Server_Applications, attack_target Web_Server, deployment Datacenter, tag XSS, tag Cross_Site_Scripting, signature_severity Major, created_at 2010_07_30, updated_at 2016_07_01, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Attempt To Access MSSQL xp_cmdshell Stored Procedure Via URI (web-application-attack) - detector_id: 69734 original_sid: 2009815
alert http $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"ET WEB_SERVER Attempt To Access MSSQL xp_cmdshell Stored Procedure Via URI"; flow:established,to_server; uricontent:"EXEC"; nocase; uricontent:"xp_cmdshell"; nocase; reference:url,msdn.microsoft.com/en-us/library/ms175046.aspx; reference:url,www.databasejournal.com/features/mssql/article.php/3372131/Using-xpcmdshell.htm; reference:url,doc.emergingthreats.net/2009815; classtype:web-application-attack; sid:1069734; rev:5; metadata:created_at 2010_07_30, updated_at 2010_07_30, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Attempt To Access MSSQL xp_servicecontrol Stored Procedure Via URI (web-application-attack) - detector_id: 69735 original_sid: 2009816
alert http $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"ET WEB_SERVER Attempt To Access MSSQL xp_servicecontrol Stored Procedure Via URI"; flow:established,to_server; uricontent:"EXEC"; nocase; uricontent:"xp_servicecontrol"; nocase; pcre:"/(start|stop|continue|pause|querystate)/Ui"; reference:url,www.sqlusa.com/bestpractices2005/administration/xpservicecontrol/; reference:url,doc.emergingthreats.net/2009816; classtype:web-application-attack; sid:1069735; rev:5; metadata:created_at 2010_07_30, updated_at 2010_07_30, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Attempt To Access MSSQL sp_adduser Stored Procedure Via URI to Create New Database User (web-application-attack) - detector_id: 69736 original_sid: 2009817
alert http $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"ET WEB_SERVER Attempt To Access MSSQL sp_adduser Stored Procedure Via URI to Create New Database User"; flow:established,to_server; uricontent:"EXEC"; nocase; uricontent:"sp_adduser"; nocase; reference:url,technet.microsoft.com/en-us/library/ms181422.aspx; reference:url,doc.emergingthreats.net/2009817; classtype:web-application-attack; sid:1069736; rev:5; metadata:created_at 2010_07_30, updated_at 2010_07_30, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Attempt To Access MSSQL xp_regread/xp_regwrite/xp_regdeletevalue/xp_regdeletekey Stored Procedure Via URI to Modify Registry (web-application-attack) - detector_id: 69737 original_sid: 2009818
alert http $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"ET WEB_SERVER Attempt To Access MSSQL xp_regread/xp_regwrite/xp_regdeletevalue/xp_regdeletekey Stored Procedure Via URI to Modify Registry"; flow:established,to_server; uricontent:"EXEC"; nocase; uricontent:"xp_reg"; nocase; pcre:"/xp_reg(read|write|delete)/Ui"; reference:url,www.mssqlcity.com/Articles/Undoc/UndocExtSP.htm; reference:url,www.sql-server-performance.com/articles/dev/extended_stored_procedures_p1.aspx; reference:url,doc.emergingthreats.net/2009818; classtype:web-application-attack; sid:1069737; rev:5; metadata:created_at 2010_07_30, updated_at 2010_07_30, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Attempt To Access MSSQL xp_fileexist Stored Procedure Via URI to Locate Files On Disk (web-application-attack) - detector_id: 69738 original_sid: 2009819
alert http $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"ET WEB_SERVER Attempt To Access MSSQL xp_fileexist Stored Procedure Via URI to Locate Files On Disk"; flow:established,to_server; uricontent:"EXEC"; nocase; uricontent:"xp_fileexist"; nocase; reference:url,www.mssqlcity.com/Articles/Undoc/UndocExtSP.htm; reference:url,www.dugger-it.com/articles/xp_fileexist.asp; reference:url,www.sql-server-performance.com/articles/dev/extended_stored_procedures_p1.aspx; reference:url,doc.emergingthreats.net/2009819; classtype:web-application-attack; sid:1069738; rev:5; metadata:created_at 2010_07_30, updated_at 2010_07_30, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Attempt To Access MSSQL xp_enumerrorlogs Stored Procedure Via URI to View Error Logs (web-application-attack) - detector_id: 69739 original_sid: 2009820
alert http $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"ET WEB_SERVER Attempt To Access MSSQL xp_enumerrorlogs Stored Procedure Via URI to View Error Logs"; flow:established,to_server; uricontent:"EXEC"; nocase; uricontent:"xp_enumerrorlogs"; nocase; reference:url,www.mssqlcity.com/Articles/Undoc/UndocExtSP.htm; reference:url,www.sql-server-performance.com/articles/dev/extended_stored_procedures_p1.aspx; reference:url,doc.emergingthreats.net/2009820; classtype:web-application-attack; sid:1069739; rev:5; metadata:created_at 2010_07_30, updated_at 2010_07_30, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Attempt To Access MSSQL xp_readerrorlogs Stored Procedure Via URI to View Error Logs (web-application-attack) - detector_id: 69740 original_sid: 2009822
alert http $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"ET WEB_SERVER Attempt To Access MSSQL xp_readerrorlogs Stored Procedure Via URI to View Error Logs"; flow:established,to_server; uricontent:"EXEC"; nocase; uricontent:"xp_readerrorlogs"; nocase; reference:url,www.sql-server-performance.com/articles/dev/extended_stored_procedures_p1.aspx; reference:url,www.sqlteam.com/article/using-xp_readerrorlog-in-sql-server-2005; reference:url,doc.emergingthreats.net/2009822; classtype:web-application-attack; sid:1069740; rev:5; metadata:created_at 2010_07_30, updated_at 2010_07_30, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Attempt To Access MSSQL xp_enumdsn/xp_enumgroups/xp_ntsec_enumdomains Stored Procedure Via URI (web-application-attack) - detector_id: 69741 original_sid: 2009823
alert http $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"ET WEB_SERVER Attempt To Access MSSQL xp_enumdsn/xp_enumgroups/xp_ntsec_enumdomains Stored Procedure Via URI"; flow:established,to_server; uricontent:"EXEC"; nocase; uricontent:"xp_"; nocase; uricontent:"_enum"; nocase; pcre:"/(xp_enumdsn|xp_enumgroups|xp_ntsec_enumdomains)/Ui"; reference:url,www.mssqlcity.com/Articles/Undoc/UndocExtSP.htm; reference:url,ferruh.mavituna.com/sql-injection-cheatsheet-oku/; reference:url,msdn.microsoft.com/en-us/library/ms173792.aspx; reference:url,doc.emergingthreats.net/2009823; classtype:web-application-attack; sid:1069741; rev:5; metadata:created_at 2010_07_30, updated_at 2010_07_30, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Tilde in URI - potential .pl source disclosure vulnerability (web-application-attack) - detector_id: 69742 original_sid: 2009949
alert http $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"ET WEB_SERVER Tilde in URI - potential .pl source disclosure vulnerability"; flow:established,to_server; content:"GET "; depth:4; nocase; uricontent:".pl~"; nocase; metadata:former_category WEB_SERVER, flip_endpoints False, server_side True; reference:url,seclists.org/fulldisclosure/2009/Sep/0321.html; reference:url,doc.emergingthreats.net/2009949; classtype:web-application-attack; sid:1069742; rev:11; metadata:created_at 2010_07_30, updated_at 2017_04_28; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Tilde in URI - potential .inc source disclosure vulnerability (web-application-attack) - detector_id: 69743 original_sid: 2009950
alert http $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"ET WEB_SERVER Tilde in URI - potential .inc source disclosure vulnerability"; flow:established,to_server; content:"GET "; depth:4; nocase; uricontent:".inc~"; nocase; metadata:former_category WEB_SERVER, flip_endpoints False, server_side True; reference:url,seclists.org/fulldisclosure/2009/Sep/0321.html; reference:url,doc.emergingthreats.net/2009950; classtype:web-application-attack; sid:1069743; rev:11; metadata:created_at 2010_07_30, updated_at 2017_04_28; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Tilde in URI - potential .conf source disclosure vulnerability (web-application-attack) - detector_id: 69744 original_sid: 2009951
alert http $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"ET WEB_SERVER Tilde in URI - potential .conf source disclosure vulnerability"; flow:established,to_server; content:"GET "; depth:4; nocase; uricontent:".conf~"; nocase; metadata:former_category WEB_SERVER, flip_endpoints False, server_side True; reference:url,seclists.org/fulldisclosure/2009/Sep/0321.html; reference:url,doc.emergingthreats.net/2009951; classtype:web-application-attack; sid:1069744; rev:11; metadata:created_at 2010_07_30, updated_at 2017_04_28; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Tilde in URI - potential .asp source disclosure vulnerability (web-application-attack) - detector_id: 69745 original_sid: 2009952
alert http $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"ET WEB_SERVER Tilde in URI - potential .asp source disclosure vulnerability"; flow:established,to_server; content:"GET "; depth:4; nocase; uricontent:".asp~"; nocase; metadata:former_category WEB_SERVER, flip_endpoints False, server_side True; reference:url,seclists.org/fulldisclosure/2009/Sep/0321.html; reference:url,doc.emergingthreats.net/2009952; classtype:web-application-attack; sid:1069745; rev:11; metadata:created_at 2010_07_30, updated_at 2017_04_28; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Tilde in URI - potential .aspx source disclosure vulnerability (web-application-attack) - detector_id: 69746 original_sid: 2009953
alert http $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"ET WEB_SERVER Tilde in URI - potential .aspx source disclosure vulnerability"; flow:established,to_server; content:"GET "; depth:4; nocase; uricontent:".aspx~"; nocase; metadata:former_category WEB_SERVER, flip_endpoints False, server_side True; reference:url,seclists.org/fulldisclosure/2009/Sep/0321.html; reference:url,doc.emergingthreats.net/2009953; classtype:web-application-attack; sid:1069746; rev:11; metadata:created_at 2010_07_30, updated_at 2017_04_28; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Tilde in URI - potential .php~ source disclosure vulnerability (web-application-attack) - detector_id: 69747 original_sid: 2009955
alert http $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"ET WEB_SERVER Tilde in URI - potential .php~ source disclosure vulnerability"; flow:established,to_server; content:"GET "; depth:4; nocase; uricontent:".php~"; nocase; metadata:former_category WEB_SERVER, flip_endpoints False, server_side True; reference:url,seclists.org/fulldisclosure/2009/Sep/0321.html; reference:url,doc.emergingthreats.net/2009955; classtype:web-application-attack; sid:1069747; rev:11; metadata:created_at 2010_07_30, updated_at 2017_04_28; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER SQL sp_start_job attempt (attempted-user) - detector_id: 69748 original_sid: 2010004
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER SQL sp_start_job attempt"; flow:to_server,established; content:"sp_start_job"; http_uri; nocase; reference:url,doc.emergingthreats.net/2010004; classtype:attempted-user; sid:1069748; rev:6; metadata:created_at 2010_07_30, updated_at 2010_07_30, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Possible SQL Injection INTO OUTFILE Arbitrary File Write Attempt (web-application-attack) - detector_id: 69749 original_sid: 2010037
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER Possible SQL Injection INTO OUTFILE Arbitrary File Write Attempt"; flow:established,to_server; content:"INTO"; http_uri; nocase; content:"OUTFILE"; nocase; http_uri; pcre:"/INTO.+OUTFILE/Ui"; reference:url,www.milw0rm.com/papers/372; reference:url,www.greensql.net/publications/backdoor-webserver-using-mysql-sql-injection; reference:url,websec.wordpress.com/2007/11/17/mysql-into-outfile/; reference:url,doc.emergingthreats.net/2010037; classtype:web-application-attack; sid:1069749; rev:4; metadata:affected_product Web_Server_Applications, attack_target Web_Server, deployment Datacenter, tag SQL_Injection, signature_severity Major, created_at 2010_07_30, updated_at 2016_07_01, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Possible ALTER SQL Injection Attempt (web-application-attack) - detector_id: 69750 original_sid: 2010084
alert http $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"ET WEB_SERVER Possible ALTER SQL Injection Attempt"; flow:to_server,established; uricontent:"ALTER"; nocase; pcre:"/ALTER\ +(database|procedure|table|column)/Ui"; reference:url,www.owasp.org/index.php/SQL_Injection; reference:url,www.w3schools.com/SQl/sql_alter.asp; reference:url,doc.emergingthreats.net/2010084; classtype:web-application-attack; sid:1069750; rev:4; metadata:affected_product Web_Server_Applications, attack_target Web_Server, deployment Datacenter, tag SQL_Injection, signature_severity Major, created_at 2010_07_30, updated_at 2016_07_01, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Possible DROP SQL Injection Attempt (web-application-attack) - detector_id: 69751 original_sid: 2010085
alert http $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"ET WEB_SERVER Possible DROP SQL Injection Attempt"; flow:to_server,established; uricontent:"DROP"; nocase; pcre:"/DROP\ +(database|procedure|table|column)/Ui"; reference:url,www.owasp.org/index.php/SQL_Injection; reference:url,www.w3schools.com/SQl/sql_drop.asp; reference:url,doc.emergingthreats.net/2010085; classtype:web-application-attack; sid:1069751; rev:4; metadata:affected_product Web_Server_Applications, attack_target Web_Server, deployment Datacenter, tag SQL_Injection, signature_severity Major, created_at 2010_07_30, updated_at 2016_07_01, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Possible CREATE SQL Injection Attempt in URI (web-application-attack) - detector_id: 69752 original_sid: 2010086
alert http $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"ET WEB_SERVER Possible CREATE SQL Injection Attempt in URI"; flow:to_server,established; uricontent:"CREATE"; nocase; pcre:"/CREATE\ +(database|procedure|table|column|directory)/Ui"; reference:url,www.owasp.org/index.php/SQL_Injection; reference:url,www.w3schools.com/Sql/sql_create_db.asp; reference:url,doc.emergingthreats.net/2010086; classtype:web-application-attack; sid:1069752; rev:5; metadata:affected_product Web_Server_Applications, attack_target Web_Server, deployment Datacenter, tag SQL_Injection, signature_severity Major, created_at 2010_07_30, updated_at 2016_07_01, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Possible 3Com OfficeConnect Router Default User Account Remote Command Execution Attempt (attempted-admin) - detector_id: 69753 original_sid: 2010159
alert http $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"ET WEB_SERVER Possible 3Com OfficeConnect Router Default User Account Remote Command Execution Attempt"; flow:established,to_server; uricontent:"/utility.cgi?testType="; nocase; uricontent:"IP="; nocase; uricontent:"|7C 7C|"; pcre:"/\x7C\x7C.+[a-z]/Ui"; reference:url,securitytracker.com/alerts/2009/Oct/1023051.html; reference:url,www.securityfocus.com/archive/1/507263; reference:url,www.securityfocus.com/bid/36722/info; reference:url,doc.emergingthreats.net/2010159; classtype:attempted-admin; sid:1069753; rev:4; metadata:created_at 2010_07_30, updated_at 2010_07_30, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Possible Successful Juniper NetScreen ScreenOS Firmware Version Disclosure Attempt (attempted-recon) - detector_id: 69754 original_sid: 2010162
alert http $HOME_NET $HTTP_PORTS -> $EXTERNAL_NET any (msg:"ET WEB_SERVER Possible Successful Juniper NetScreen ScreenOS Firmware Version Disclosure Attempt"; flow:established,from_server; content:"Juniper Networks, Inc"; content:"Version|3A|"; within:100; content:"ScreenOS"; distance:0; reference:url,securitytracker.com/alerts/2009/Apr/1022123.html; reference:url,www.securityfocus.com/bid/34710; reference:url,seclists.org/bugtraq/2009/Apr/242; reference:url,www.procheckup.com/vulnerability_manager/vulnerabilities/pr09-05; reference:url,doc.emergingthreats.net/2010162; classtype:attempted-recon; sid:1069754; rev:4; metadata:created_at 2010_07_30, updated_at 2010_07_30, flip_endpoints True, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET WEB_SERVER Possible Cherokee Web Server GET AUX Request Denial Of Service Attempt (attempted-dos) - detector_id: 69755 original_sid: 2010229
alert http $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"ET WEB_SERVER Possible Cherokee Web Server GET AUX Request Denial Of Service Attempt"; flow:established,to_server; content:"GET |2F|AUX HTTP|2F|1|2E|"; nocase; depth:16; reference:url,securitytracker.com/alerts/2009/Oct/1023095.html; reference:url,www.securityfocus.com/bid/36814/info; reference:url,www.securityfocus.com/archive/1/507456; reference:url,doc.emergingthreats.net/2010229; classtype:attempted-dos; sid:1069755; rev:3; metadata:created_at 2010_07_30, updated_at 2010_07_30, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER SELECT INSTR in URI Possible ORACLE Related Blind SQL Injection Attempt (web-application-attack) - detector_id: 69756 original_sid: 2010284
alert http $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"ET WEB_SERVER SELECT INSTR in URI Possible ORACLE Related Blind SQL Injection Attempt"; flow:established,to_server; uricontent:"SELECT"; nocase; uricontent:"INSTR"; nocase; pcre:"/SELECT.+INSTR/Ui"; metadata:former_category WEB_SERVER, flip_endpoints False, server_side True; reference:url,www.psoug.org/reference/substr_instr.html; reference:url,www.easywebtech.com/artical/Oracle_INSTR.html; reference:url,www.owasp.org/index.php/SQL_Injection; reference:url,msdn.microsoft.com/en-us/library/ms161953.aspx; reference:url,doc.emergingthreats.net/2010284; classtype:web-application-attack; sid:1069756; rev:4; metadata:affected_product Web_Server_Applications, attack_target Web_Server, deployment Datacenter, tag SQL_Injection, signature_severity Major, created_at 2010_07_30, updated_at 2017_05_11; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER SELECT SUBSTR/ING in URI Possible Blind SQL Injection Attempt (web-application-attack) - detector_id: 69757 original_sid: 2010285
alert http $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"ET WEB_SERVER SELECT SUBSTR/ING in URI Possible Blind SQL Injection Attempt"; flow:established,to_server; uricontent:"SELECT"; nocase; uricontent:"SUBSTR"; nocase; pcre:"/SELECT.+SUBSTR/Ui"; metadata:former_category WEB_SERVER, flip_endpoints False, server_side True; reference:url,www.1keydata.com/sql/sql-substring.html; reference:url,www.owasp.org/index.php/SQL_Injection; reference:url,msdn.microsoft.com/en-us/library/ms161953.aspx; reference:url,doc.emergingthreats.net/2010285; classtype:web-application-attack; sid:1069757; rev:6; metadata:affected_product Web_Server_Applications, attack_target Web_Server, deployment Datacenter, tag SQL_Injection, signature_severity Major, created_at 2010_07_30, updated_at 2017_05_11; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER JBOSS/JMX REMOTE WAR deployment attempt (POST) (web-application-attack) - detector_id: 69758 original_sid: 2010379
alert http $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"ET WEB_SERVER JBOSS/JMX REMOTE WAR deployment attempt (POST)"; flow:established,to_server; content:"POST "; nocase; depth:5; uricontent:"/jmx-console/HtmlAdaptor"; nocase; content:"action=invokeOp&name=jboss.deployment"; nocase; content:"flavor%253DURL%252Ctype%253DDeploymentScanner"; within:50; nocase; content:"=http%3A%2F%2F"; within:40; reference:url,www.notsosecure.com/folder2/2009/10/27/hacking-jboss-with-jmx-console/; reference:url,www.nruns.com/_downloads/Whitepaper-Hacking-jBoss-using-a-Browser.pdf; reference:url,doc.emergingthreats.net/2010379; classtype:web-application-attack; sid:1069758; rev:5; metadata:created_at 2010_07_30, updated_at 2010_07_30, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER JBOSS/JMX REMOTE WAR deployment attempt (GET) (web-application-attack) - detector_id: 69759 original_sid: 2010380
alert http $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"ET WEB_SERVER JBOSS/JMX REMOTE WAR deployment attempt (GET)"; flow:established,to_server; content:"GET "; nocase; depth:4; uricontent:"/jmx-console/HtmlAdaptor?action=invokeOpByName&name=jboss.deployment"; uricontent:"DeploymentScanner"; nocase; uricontent:"methodName=addURL"; nocase; uricontent:"=http"; nocase; reference:url,www.notsosecure.com/folder2/2009/10/27/hacking-jboss-with-jmx-console/; reference:url,www.nruns.com/_downloads/Whitepaper-Hacking-jBoss-using-a-Browser.pdf; reference:url,doc.emergingthreats.net/2010380; classtype:web-application-attack; sid:1069759; rev:5; metadata:created_at 2010_07_30, updated_at 2010_07_30, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Possible Cisco Adaptive Security Appliance Web VPN FTP or CIFS Authentication Form Phishing Attempt (attempted-user) - detector_id: 69760 original_sid: 2010457
alert http $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"ET WEB_SERVER Possible Cisco Adaptive Security Appliance Web VPN FTP or CIFS Authentication Form Phishing Attempt"; flow:established,to_server; content:"|2B|CSCOE|2B 2F|files|2F|browse|2E|html"; nocase; content:"code|3D|init"; http_uri; nocase; content:"path|3D|ftp"; http_uri; nocase; reference:url,www.securityfocus.com/bid/35475/info; reference:cve,2009-1203; reference:url,doc.emergingthreats.net/2010457; classtype:attempted-user; sid:1069760; rev:6; metadata:attack_target Client_Endpoint, deployment Perimeter, tag Phishing, signature_severity Major, created_at 2010_07_30, updated_at 2016_07_01, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Cisco BBSM Captive Portal AccesCodeStart.asp Cross-Site Scripting Attempt (attempted-user) - detector_id: 69761 original_sid: 2010460
alert http $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"ET WEB_SERVER Cisco BBSM Captive Portal AccesCodeStart.asp Cross-Site Scripting Attempt"; flow:established,to_server; uricontent:"|2F|ekgnkm|2F|AccessCodeStart|2E|asp"; nocase; pcre:"/(script|onmouse[a-z]+|onkey[a-z]+|onload|onunload|ondragdrop|onblur|onfocus|onclick|ondblclick|onsubmit|onreset|onselect|onchange)/Ui"; reference:url,www.securityfocus.com/bid/29191/info; reference:cve,2008-2165; reference:url,doc.emergingthreats.net/2010460; classtype:attempted-user; sid:1069761; rev:4; metadata:created_at 2010_07_30, updated_at 2010_07_30, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Possible Barracuda IM Firewall smtp_test.cgi Cross-Site Scripting Attempt (web-application-attack) - detector_id: 69762 original_sid: 2010462
alert http $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"ET WEB_SERVER Possible Barracuda IM Firewall smtp_test.cgi Cross-Site Scripting Attempt"; flow:established,to_server; uricontent:"|2F|cgi|2D|mod|2F|smtp|5F|test|2E|cgi"; nocase; uricontent:"email|3D|"; nocase; uricontent:"hostname|3D|"; nocase; uricontent:"default|5F|domain|3D|"; nocase; pcre:"/(script|img|src|alert|onmouse|onkey|onload|ondragdrop|onblur|onfocus|onclick)/Ui"; reference:url,www.securityfocus.com/bid/37248/info; reference:url,doc.emergingthreats.net/2010462; classtype:web-application-attack; sid:1069762; rev:3; metadata:created_at 2010_07_30, updated_at 2010_07_30, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER RFI Scanner Success (Fx29ID) (successful-user) - detector_id: 69763 original_sid: 2010463
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET WEB_SERVER RFI Scanner Success (Fx29ID)"; flow:established,from_server; content:"FeeLCoMzFeeLCoMz"; reference:url,doc.emergingthreats.net/2010463; reference:url,opinion.josepino.com/php/howto_website_hack1; classtype:successful-user; sid:1069763; rev:7; metadata:created_at 2010_07_30, updated_at 2010_07_30, flip_endpoints True, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET WEB_SERVER Possible HTTP 401 XSS Attempt (Local Source) (web-application-attack) - detector_id: 69764 original_sid: 2010513
alert http $HTTP_SERVERS $HTTP_PORTS -> $EXTERNAL_NET 1024: (msg:"ET WEB_SERVER Possible HTTP 401 XSS Attempt (Local Source)"; flow:from_server,established; content:"401"; http_stat_code; content:"Unauthorized"; nocase; file_data; content:"<script"; nocase; depth:280; threshold: type both, track by_src, count 10, seconds 60; reference:url,doc.emergingthreats.net/2010513; classtype:web-application-attack; sid:1069764; rev:5; metadata:created_at 2010_07_30, updated_at 2010_07_30, flip_endpoints True, server_side True; target:src_ip;)

# ET WEB_SERVER Possible HTTP 405 XSS Attempt (Local Source) (web-application-attack) - detector_id: 69766 original_sid: 2010519
alert http $HTTP_SERVERS $HTTP_PORTS -> $EXTERNAL_NET 1024: (msg:"ET WEB_SERVER Possible HTTP 405 XSS Attempt (Local Source)"; flow:from_server,established; content:"HTTP/1.1 405 Method Not Allowed|0d 0a|"; depth:33; nocase; content:"<script"; nocase; within:512; reference:url,doc.emergingthreats.net/2010519; classtype:web-application-attack; sid:1069766; rev:3; metadata:created_at 2010_07_30, updated_at 2010_07_30, flip_endpoints True, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET WEB_SERVER Possible HTTP 406 XSS Attempt (Local Source) (web-application-attack) - detector_id: 69767 original_sid: 2010521
alert http $HTTP_SERVERS $HTTP_PORTS -> $EXTERNAL_NET 1024: (msg:"ET WEB_SERVER Possible HTTP 406 XSS Attempt (Local Source)"; flow:from_server,established; content:"HTTP/1.1 406 Not Acceptable|0d 0a|"; depth:29; nocase; content:"<script"; nocase; within:512; reference:url,doc.emergingthreats.net/2010521; classtype:web-application-attack; sid:1069767; rev:3; metadata:created_at 2010_07_30, updated_at 2010_07_30, flip_endpoints True, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET WEB_SERVER Possible HTTP 500 XSS Attempt (Internal Source) (web-application-attack) - detector_id: 69768 original_sid: 2010524
alert http $HTTP_SERVERS $HTTP_PORTS -> $EXTERNAL_NET 1024: (msg:"ET WEB_SERVER Possible HTTP 500 XSS Attempt (Internal Source)"; flow:from_server,established; content:"HTTP/1.1 500 Internal Server Error|0d 0a|"; depth:36; nocase; content:"<script"; nocase; within:512; reference:url,doc.emergingthreats.net/2010524; classtype:web-application-attack; sid:1069768; rev:3; metadata:created_at 2010_07_30, updated_at 2010_07_30, flip_endpoints True, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET WEB_SERVER Possible HTTP 503 XSS Attempt (Internal Source) (web-application-attack) - detector_id: 69769 original_sid: 2010526
alert http $HTTP_SERVERS $HTTP_PORTS -> $EXTERNAL_NET 1024: (msg:"ET WEB_SERVER Possible HTTP 503 XSS Attempt (Internal Source)"; flow:from_server,established; content:"HTTP/1.1 503 Service Unavailable|0d 0a|"; depth:34; nocase; content:"<script"; nocase; within:512; reference:url,doc.emergingthreats.net/2010526; classtype:web-application-attack; sid:1069769; rev:3; metadata:created_at 2010_07_30, updated_at 2010_07_30, flip_endpoints True, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET WEB_SERVER Possible Microsoft Internet Information Services (IIS) .asp Filename Extension Parsing File Upload Security Bypass Attempt (asp) (web-application-attack) - detector_id: 69770 original_sid: 2010592
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER Possible Microsoft Internet Information Services (IIS) .asp Filename Extension Parsing File Upload Security Bypass Attempt (asp)"; flow:established,to_server; content:".asp|3B 2E|"; nocase; http_uri; reference:url,www.securityfocus.com/bid/37460/info; reference:url,doc.emergingthreats.net/2010592; reference:url,www.securityfocus.com/bid/37460/info; reference:url,soroush.secproject.com/downloadable/iis-semicolon-report.pdf; reference:cve,2009-4444; classtype:web-application-attack; sid:1069770; rev:8; metadata:created_at 2010_07_30, updated_at 2010_07_30, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Possible Microsoft Internet Information Services (IIS) .aspx Filename Extension Parsing File Upload Security Bypass Attempt (aspx) (web-application-attack) - detector_id: 69771 original_sid: 2010593
alert http $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"ET WEB_SERVER Possible Microsoft Internet Information Services (IIS) .aspx Filename Extension Parsing File Upload Security Bypass Attempt (aspx)"; flow:established,to_server; uricontent:".aspx|3B 2E|"; nocase; reference:url,www.securityfocus.com/bid/37460/info; reference:url,doc.emergingthreats.net/2010593; reference:url,www.securityfocus.com/bid/37460/info; reference:url,soroush.secproject.com/downloadable/iis-semicolon-report.pdf; reference:cve,2009-4444; classtype:web-application-attack; sid:1069771; rev:7; metadata:created_at 2010_07_30, updated_at 2010_07_30, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER SQL Injection Attempt (Agent CZ32ts) (web-application-attack) - detector_id: 69772 original_sid: 2010621
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_SERVER SQL Injection Attempt (Agent CZ32ts)"; flow:to_server,established; content:"CZ32ts"; nocase; http_user_agent; reference:url,doc.emergingthreats.net/2009029; reference:url,www.Whitehatsecurityresponse.blogspot.com; classtype:web-application-attack; sid:1069772; rev:5; metadata:affected_product Web_Server_Applications, attack_target Web_Server, deployment Datacenter, tag SQL_Injection, signature_severity Major, created_at 2010_07_30, updated_at 2016_07_01, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Possible Cisco Subscriber Edge Services Manager Cross Site Scripting/HTML Injection Attempt (web-application-attack) - detector_id: 69773 original_sid: 2010622
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_SERVER Possible Cisco Subscriber Edge Services Manager Cross Site Scripting/HTML Injection Attempt"; flow:to_server,established; uricontent:"/servlet/JavascriptProbe"; nocase; content:"documentElement=true"; http_uri; nocase; content:"regexp=true"; nocase; http_uri; content:"frames=true"; http_uri; reference:url,www.securityfocus.com/bid/34454/info; reference:url,doc.emergingthreats.net/2010622; classtype:web-application-attack; sid:1069773; rev:4; metadata:affected_product Web_Server_Applications, attack_target Web_Server, deployment Datacenter, tag XSS, tag Cross_Site_Scripting, signature_severity Major, created_at 2010_07_30, updated_at 2016_07_01, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Cisco IOS HTTP Server Exec Command Execution Attempt (web-application-attack) - detector_id: 69774 original_sid: 2010623
alert http $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"ET WEB_SERVER Cisco IOS HTTP Server Exec Command Execution Attempt"; flow:to_server,established; content:"/level/15/exec/-/"; fast_pattern:only; nocase; http_uri; pcre:"/\x2Flevel\x2F15\x2Fexec\x2F\x2D\x2F[a-z]/Ui"; reference:url,doc.emergingthreats.net/2010623; classtype:web-application-attack; sid:1069774; rev:4; metadata:created_at 2010_07_30, updated_at 2010_07_30, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER /bin/bash In URI, Possible Shell Command Execution Attempt Within Web Exploit (web-application-attack) - detector_id: 69775 original_sid: 2010667
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER /bin/bash In URI, Possible Shell Command Execution Attempt Within Web Exploit"; flow:established,to_server; content:"/bin/bash"; http_uri; reference:url,doc.emergingthreats.net/2010667; classtype:web-application-attack; sid:1069775; rev:6; metadata:created_at 2010_07_30, updated_at 2010_07_30, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Possible D-Link Router HNAP Protocol Security Bypass Attempt (web-application-attack) - detector_id: 69776 original_sid: 2010698
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_SERVER Possible D-Link Router HNAP Protocol Security Bypass Attempt"; flow:established,to_server; content:"POST"; http_method; content:"/HNAP1/"; http_uri; nocase; content:"SOAPAction|3A|"; nocase; content:"DeviceSettings"; within:100; nocase; pcre:"/SoapAction\x3A.+\x2FHNAP1\x2F(set|get)DeviceSettings/si"; reference:url,www.securityfocus.com/bid/37690; reference:url,doc.emergingthreats.net/2010698; classtype:web-application-attack; sid:1069776; rev:4; metadata:created_at 2010_07_30, updated_at 2010_07_30, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Possible HP OpenView Network Node Manager ovalarm.exe CGI Buffer Overflow Attempt (web-application-attack) - detector_id: 69777 original_sid: 2010704
alert http $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"ET WEB_SERVER Possible HP OpenView Network Node Manager ovalarm.exe CGI Buffer Overflow Attempt"; flow:established,to_server; content:"GET "; depth:4; nocase; uricontent:"/OvCgi/ovalarm.exe"; nocase; uricontent:"OVABverbose="; nocase; content:"Accept-Language|3A 20|"; nocase; isdataat:100,relative; content:!"|0A|"; within:100; pcre:"/\x2FOvCgi\x2Fovalarm\x2Eexe.+OVABverbose=(1|on|true).+Accept-Language\x3A\x20.{100}/smi"; reference:cve,2009-4179; reference:url,doc.emergingthreats.net/2010704; classtype:web-application-attack; sid:1069777; rev:5; metadata:created_at 2010_07_30, updated_at 2010_07_30, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER PHP Scan Precursor (web-application-attack) - detector_id: 69778 original_sid: 2010720
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_SERVER PHP Scan Precursor"; flow:established,to_server; content:"/thisdoesnotexistahaha.php"; http_uri; reference:url,doc.emergingthreats.net/2010720; classtype:web-application-attack; sid:1069778; rev:4; metadata:created_at 2010_07_30, updated_at 2010_07_30, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER DFind w00tw00t GET-Requests (attempted-recon) - detector_id: 69780 original_sid: 2010794
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER DFind w00tw00t GET-Requests"; flow:established,to_server; content:"GET"; nocase; http_method; content:"/w00tw00t."; nocase; http_uri; depth:10; reference:url,doc.emergingthreats.net/2010794; classtype:attempted-recon; sid:1069780; rev:8; metadata:created_at 2010_07_30, updated_at 2010_07_30, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Tilde in URI - potential .cgi source disclosure vulnerability (web-application-attack) - detector_id: 69781 original_sid: 2010820
alert http $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"ET WEB_SERVER Tilde in URI - potential .cgi source disclosure vulnerability"; flow:established,to_server; content:"GET "; depth:4; nocase; uricontent:".cgi~"; nocase; metadata:former_category WEB_SERVER, flip_endpoints False, server_side True; reference:url,seclists.org/fulldisclosure/2009/Sep/0321.html; reference:url,doc.emergingthreats.net/2010820; classtype:web-application-attack; sid:1069781; rev:5; metadata:created_at 2010_07_30, updated_at 2017_04_28; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER LANDesk Command Injection Attempt (web-application-attack) - detector_id: 69782 original_sid: 2010863
alert http $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"ET WEB_SERVER LANDesk Command Injection Attempt"; flow:established,to_server; content:"POST"; http_method; content:"/gsb/datetime.php"; http_uri; nocase; content:"delBackupName"; nocase; content:"backupRestoreFormSubmitted"; distance:0; nocase; reference:url,www.coresecurity.com/content/landesk-csrf-vulnerability; reference:cve,2010-0369; reference:url,doc.emergingthreats.net/2010863; classtype:web-application-attack; sid:1069782; rev:6; metadata:created_at 2010_07_30, updated_at 2010_07_30, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER HP OpenView /OvCgi/Toolbar.exe Accept Language Heap Buffer Overflow Attempt (web-application-attack) - detector_id: 69783 original_sid: 2010864
alert http $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"ET WEB_SERVER HP OpenView /OvCgi/Toolbar.exe Accept Language Heap Buffer Overflow Attempt"; flow:established,to_server; content:"POST "; depth:5; nocase; uricontent:"/OvCgi/Toolbar.exe"; nocase; content:"Accept-Language|3A|"; nocase; isdataat:1350,relative; content:!"|0A|"; within:1350; content:"Content-Length|3A|"; nocase; distance:1350; pcre:"/Accept-Language\x3A.{1350}.+Content-Length\x3A/smi"; reference:cve,2009-0921; reference:url,doc.emergingthreats.net/2010864; classtype:web-application-attack; sid:1069783; rev:6; metadata:created_at 2010_07_30, updated_at 2010_07_30, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER HP LaserJet Printer Cross Site Scripting Attempt (web-application-attack) - detector_id: 69784 original_sid: 2010919
alert http $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"ET WEB_SERVER HP LaserJet Printer Cross Site Scripting Attempt"; flow:established,to_server; uricontent:"/support_param.html/config"; nocase; uricontent:"Admin_Name=&Admin_Phone="; nocase; uricontent:"Product_URL="; nocase; pcre:"/(script|onmouse[a-z]+|onkey[a-z]+|onload|onunload|ondragdrop|onblur|onfocus|onclick|ondblclick|onsubmit|onreset|onselect|onchange).+Apply\x3DApply/Ui"; reference:url,dsecrg.com/pages/vul/show.php?id=148; reference:cve,2009-2684; reference:url,doc.emergingthreats.net/2010919; classtype:web-application-attack; sid:1069784; rev:3; metadata:affected_product Web_Server_Applications, attack_target Web_Server, deployment Datacenter, tag XSS, tag Cross_Site_Scripting, signature_severity Major, created_at 2010_07_30, updated_at 2016_07_01, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Exploit Suspected PHP Injection Attack (cmd=) (web-application-attack) - detector_id: 69785 original_sid: 2010920
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER Exploit Suspected PHP Injection Attack (cmd=)"; flow:to_server,established; content:"GET"; nocase; http_method; content:".php?"; nocase; http_uri; content:"cmd="; http_uri; fast_pattern; nocase; pcre:"/[&?]cmd=[^\x26\x28]*(?:cd|\;|echo|cat|perl|curl|wget|id|uname|t?ftp)/Ui"; reference:cve,2002-0953; reference:url,doc.emergingthreats.net/2010920; classtype:web-application-attack; sid:1069785; rev:8; metadata:created_at 2010_07_30, updated_at 2010_07_30, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER SELECT USER SQL Injection Attempt in URI (web-application-attack) - detector_id: 69786 original_sid: 2010963
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER SELECT USER SQL Injection Attempt in URI"; flow:established,to_server; content:"SELECT"; nocase; http_uri; content:"USER"; nocase; http_uri; pcre:"/SELECT[^a-z]+USER/Ui"; reference:url,en.wikipedia.org/wiki/SQL_injection; reference:url,doc.emergingthreats.net/2010963; classtype:web-application-attack; sid:1069786; rev:6; metadata:affected_product Web_Server_Applications, attack_target Web_Server, deployment Datacenter, tag SQL_Injection, signature_severity Major, created_at 2010_07_30, updated_at 2016_07_01, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER SHOW CHARACTER SET SQL Injection Attempt in URI (web-application-attack) - detector_id: 69787 original_sid: 2010964
alert http $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"ET WEB_SERVER SHOW CHARACTER SET SQL Injection Attempt in URI"; flow:established,to_server; uricontent:"SHOW"; nocase; uricontent:"CHARACTER"; nocase; content:"SET"; nocase; pcre:"/SHOW.+CHARACTER.+SET/Ui"; reference:url,en.wikipedia.org/wiki/SQL_injection; reference:url,dev.mysql.com/doc/refman/5.0/en/show-character-set.html; reference:url,doc.emergingthreats.net/2010964; classtype:web-application-attack; sid:1069787; rev:3; metadata:affected_product Web_Server_Applications, attack_target Web_Server, deployment Datacenter, tag SQL_Injection, signature_severity Major, created_at 2010_07_30, updated_at 2016_07_01, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER SHOW VARIABLES SQL Injection Attempt in URI (web-application-attack) - detector_id: 69788 original_sid: 2010965
alert http $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"ET WEB_SERVER SHOW VARIABLES SQL Injection Attempt in URI"; flow:established,to_server; uricontent:"SHOW"; nocase; uricontent:"VARIABLES"; nocase; pcre:"/SHOW.+VARIABLES/Ui"; reference:url,en.wikipedia.org/wiki/SQL_injection; reference:url,dev.mysql.com/doc/refman/5.1/en/server-system-variables.html; reference:url,doc.emergingthreats.net/2010965; classtype:web-application-attack; sid:1069788; rev:3; metadata:affected_product Web_Server_Applications, attack_target Web_Server, deployment Datacenter, tag SQL_Injection, signature_severity Major, created_at 2010_07_30, updated_at 2016_07_01, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER SHOW CURDATE/CURTIME SQL Injection Attempt in URI (web-application-attack) - detector_id: 69789 original_sid: 2010966
alert http $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"ET WEB_SERVER SHOW CURDATE/CURTIME SQL Injection Attempt in URI"; flow:established,to_server; uricontent:"SHOW"; nocase; uricontent:"CUR"; nocase; pcre:"/SHOW.+CUR(DATE|TIME)/Ui"; reference:url,en.wikipedia.org/wiki/SQL_injection; reference:url,dev.mysql.com/doc/refman/5.1/en/date-and-time-functions.html#function_curdate; reference:url,dev.mysql.com/doc/refman/5.1/en/date-and-time-functions.html#function_curtime; reference:url,doc.emergingthreats.net/2010966; classtype:web-application-attack; sid:1069789; rev:3; metadata:affected_product Web_Server_Applications, attack_target Web_Server, deployment Datacenter, tag SQL_Injection, signature_severity Major, created_at 2010_07_30, updated_at 2016_07_01, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER SHOW TABLES SQL Injection Attempt in URI (web-application-attack) - detector_id: 69790 original_sid: 2010967
alert http $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"ET WEB_SERVER SHOW TABLES SQL Injection Attempt in URI"; flow:established,to_server; uricontent:"SHOW"; nocase; uricontent:"TABLES"; nocase; pcre:"/SHOW.+TABLES/Ui"; reference:url,en.wikipedia.org/wiki/SQL_injection; reference:url,dev.mysql.com/doc/refman/4.1/en/show-tables.html; reference:url,doc.emergingthreats.net/2010967; classtype:web-application-attack; sid:1069790; rev:3; metadata:affected_product Web_Server_Applications, attack_target Web_Server, deployment Datacenter, tag SQL_Injection, signature_severity Major, created_at 2010_07_30, updated_at 2016_07_01, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER SQL Injection BULK INSERT in URI to Insert File Content into Database Table (web-application-attack) - detector_id: 69791 original_sid: 2011035
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER SQL Injection BULK INSERT in URI to Insert File Content into Database Table"; flow:established,to_server; content:"BULK"; nocase; http_uri; content:"INSERT"; nocase; http_uri; distance:0; reference:url,msdn.microsoft.com/en-us/library/ms188365.aspx; reference:url,msdn.microsoft.com/en-us/library/ms175915.aspx; reference:url,www.sqlteam.com/article/using-bulk-insert-to-load-a-text-file; reference:url,doc.emergingthreats.net/2011035; classtype:web-application-attack; sid:1069791; rev:4; metadata:affected_product Web_Server_Applications, attack_target Web_Server, deployment Datacenter, tag SQL_Injection, signature_severity Major, created_at 2010_07_30, updated_at 2016_07_01, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Possible Attempt to Get SQL Server Version in URI using SELECT VERSION (web-application-attack) - detector_id: 69792 original_sid: 2011037
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER Possible Attempt to Get SQL Server Version in URI using SELECT VERSION"; flow:established,to_server; content:"SELECT"; nocase; http_uri; content:"VERSION"; nocase; distance:1; http_uri; reference:url,support.microsoft.com/kb/321185; reference:url,doc.emergingthreats.net/2011037; classtype:web-application-attack; sid:1069792; rev:5; metadata:created_at 2010_07_30, updated_at 2010_07_30, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Possible INSERT VALUES SQL Injection Attempt (web-application-attack) - detector_id: 69793 original_sid: 2011039
alert http $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"ET WEB_SERVER Possible INSERT VALUES SQL Injection Attempt"; flow:established,to_server; uricontent:"INSERT"; nocase; uricontent:"VALUES"; nocase; pcre:"/INSERT.+VALUES/Ui"; reference:url,ferruh.mavituna.com/sql-injection-cheatsheet-oku/; reference:url,en.wikipedia.org/wiki/Insert_(SQL); reference:url,doc.emergingthreats.net/2011039; classtype:web-application-attack; sid:1069793; rev:3; metadata:affected_product Web_Server_Applications, attack_target Web_Server, deployment Datacenter, tag SQL_Injection, signature_severity Major, created_at 2010_07_30, updated_at 2016_07_01, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER MYSQL Benchmark Command in URI to Consume Server Resources (web-application-attack) - detector_id: 69794 original_sid: 2011041
alert http $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"ET WEB_SERVER MYSQL Benchmark Command in URI to Consume Server Resources"; flow:established,to_server; uricontent:"BENCHMARK("; nocase; uricontent:")"; pcre:"/BENCHMARK\x28[0-9].+\x29/Ui"; reference:url,dev.mysql.com/doc/refman/5.1/en/information-functions.html#function_benchmark; reference:url,doc.emergingthreats.net/2011041; classtype:web-application-attack; sid:1069794; rev:3; metadata:created_at 2010_07_30, updated_at 2010_07_30, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER MYSQL SELECT CONCAT SQL Injection Attempt (web-application-attack) - detector_id: 69795 original_sid: 2011042
alert http $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"ET WEB_SERVER MYSQL SELECT CONCAT SQL Injection Attempt"; flow:established,to_server; uricontent:"SELECT"; nocase; uricontent:"CONCAT"; nocase; pcre:"/SELECT.+CONCAT/Ui"; reference:url,ferruh.mavituna.com/sql-injection-cheatsheet-oku/; reference:url,www.webdevelopersnotes.com/tutorials/sql/a_little_more_on_the_mysql_select_statement.php3; reference:url,doc.emergingthreats.net/2011042; classtype:web-application-attack; sid:1069795; rev:3; metadata:affected_product Web_Server_Applications, attack_target Web_Server, deployment Datacenter, tag SQL_Injection, signature_severity Major, created_at 2010_07_30, updated_at 2016_07_01, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Microsoft SharePoint Server 2007 _layouts/help.aspx Cross Site Scripting Attempt (web-application-attack) - detector_id: 69796 original_sid: 2011073
alert http $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"ET WEB_SERVER Microsoft SharePoint Server 2007 _layouts/help.aspx Cross Site Scripting Attempt"; flow:established,to_server; uricontent:"/_layouts/help.aspx"; nocase; uricontent:"cid0="; nocase; pcre:"/cid0\x3d.+(script|alert|onmouse[a-z]+|onkey[a-z]+|onload|onunload|ondragdrop|onblur|onfocus|onclick|ondblclick|onsubmit|onreset|onselect|onchange)/Ui"; reference:url,www.htbridge.ch/advisory/xss_in_microsoft_sharepoint_server_2007.html; reference:url,tools.cisco.com/security/center/viewAlert.x?alertId=20415; reference:url,www.microsoft.com/technet/security/Bulletin/MS10-039.mspx; reference:url,tools.cisco.com/security/center/viewAlert.x?alertId=20610; reference:cve,2010-0817; reference:url,doc.emergingthreats.net/2011073; classtype:web-application-attack; sid:1069796; rev:5; metadata:affected_product Web_Server_Applications, attack_target Web_Server, deployment Datacenter, tag XSS, tag Cross_Site_Scripting, signature_severity Major, created_at 2010_07_30, updated_at 2016_07_01, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Possible SQL injection obfuscated via REVERSE function (web-application-attack) - detector_id: 69797 original_sid: 2011122
alert http $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"ET WEB_SERVER Possible SQL injection obfuscated via REVERSE function"; flow:established,to_server; uricontent:"REVERSE"; nocase; pcre:"/[^\w]REVERSE[^\w]?\(/Ui"; reference:url,snosoft.blogspot.com/2010/05/reversenoitcejni-lqs-dnilb-bank-hacking.html; reference:url,doc.emergingthreats.net/2011122; classtype:web-application-attack; sid:1069797; rev:3; metadata:affected_product Web_Server_Applications, attack_target Web_Server, deployment Datacenter, tag SQL_Injection, signature_severity Major, created_at 2010_07_30, updated_at 2016_07_01, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER PHP Easteregg Information-Disclosure (phpinfo) (attempted-recon) - detector_id: 69798 original_sid: 2011141
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER PHP Easteregg Information-Disclosure (phpinfo)"; flow:to_server,established; content:"?=PHPB8B5F2A0-3C92-11d3-A3A9-4C7B08C10000"; http_uri; reference:url,osvdb.org/12184; reference:url,www.0php.com/php_easter_egg.php; reference:url,seclists.org/nmap-dev/2010/q2/569; reference:url,doc.emergingthreats.net/2011141; classtype:attempted-recon; sid:1069798; rev:4; metadata:created_at 2010_07_30, updated_at 2010_07_30, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER PHP Easteregg Information-Disclosure (php-logo) (attempted-recon) - detector_id: 69799 original_sid: 2011142
alert http $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"ET WEB_SERVER PHP Easteregg Information-Disclosure (php-logo)"; flow:to_server,established; uricontent:"?=PHPE9568F34-D428-11d2-A769-00AA001ACF42"; reference:url,osvdb.org/12184; reference:url,www.0php.com/php_easter_egg.php; reference:url,seclists.org/nmap-dev/2010/q2/569; reference:url,doc.emergingthreats.net/2011142; classtype:attempted-recon; sid:1069799; rev:3; metadata:created_at 2010_07_30, updated_at 2010_07_30, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER PHP Easteregg Information-Disclosure (zend-logo) (attempted-recon) - detector_id: 69800 original_sid: 2011143
alert http $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"ET WEB_SERVER PHP Easteregg Information-Disclosure (zend-logo)"; flow:to_server,established; uricontent:"?=PHPE9568F35-D428-11d2-A769-00AA001ACF42"; reference:url,osvdb.org/12184; reference:url,www.0php.com/php_easter_egg.php; reference:url,seclists.org/nmap-dev/2010/q2/569; reference:url,doc.emergingthreats.net/2011143; classtype:attempted-recon; sid:1069800; rev:3; metadata:created_at 2010_07_30, updated_at 2010_07_30, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER PHP Easteregg Information-Disclosure (funny-logo) (attempted-recon) - detector_id: 69801 original_sid: 2011144
alert http $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"ET WEB_SERVER PHP Easteregg Information-Disclosure (funny-logo)"; flow:to_server,established; uricontent:"?=PHPE9568F36-D428-11d2-A769-00AA001ACF42"; reference:url,osvdb.org/12184; reference:url,www.0php.com/php_easter_egg.php; reference:url,seclists.org/nmap-dev/2010/q2/569; reference:url,doc.emergingthreats.net/2011144; classtype:attempted-recon; sid:1069801; rev:3; metadata:created_at 2010_07_30, updated_at 2010_07_30, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER 3Com Intelligent Management Center Cross Site Scripting Attempt (web-application-attack) - detector_id: 69802 original_sid: 2011145
alert http $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"ET WEB_SERVER 3Com Intelligent Management Center Cross Site Scripting Attempt"; flow:established,to_server; uricontent:"/imc/login.jsf"; nocase; uricontent:"loginForm"; nocase; uricontent:"javax.faces.ViewState="; nocase; pcre:"/ViewState\x3D.+(script|alert|onmouse[a-z]+|onkey[a-z]+|onload|onunload|ondragdrop|onblur|onfocus|onclick|ondblclick|onsubmit|onreset|onselect|onchange)/Ui"; reference:url,securitytracker.com/alerts/2010/May/1024022.html; reference:url,support.3com.com/documents/netmgr/imc/3Com_IMC_readme_plat_3.30-SP2.html; reference:url,www.procheckup.com/vulnerability_manager/vulnerabilities/pr10-02; reference:url,doc.emergingthreats.net/2011145; classtype:web-application-attack; sid:1069802; rev:3; metadata:affected_product Web_Server_Applications, attack_target Web_Server, deployment Datacenter, tag XSS, tag Cross_Site_Scripting, signature_severity Major, created_at 2010_07_30, updated_at 2016_07_01, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER SQL Injection Attempt (Agent CZxt2s) (web-application-attack) - detector_id: 69803 original_sid: 2011174
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_SERVER SQL Injection Attempt (Agent CZxt2s)"; flow:to_server,established; content:"User-Agent|3a| czxt2s|0d 0a|"; nocase; http_header; reference:url,doc.emergingthreats.net/2011174; classtype:web-application-attack; sid:1069803; rev:4; metadata:affected_product Web_Server_Applications, attack_target Web_Server, deployment Datacenter, tag SQL_Injection, signature_severity Major, created_at 2010_07_30, updated_at 2016_07_01, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Casper Bot Search RFI Scan (web-application-attack) - detector_id: 69804 original_sid: 2011175
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_SERVER Casper Bot Search RFI Scan"; flow:established,to_server; content:"Casper Bot"; nocase; http_user_agent; reference:url,doc.emergingthreats.net/2011175; classtype:web-application-attack; sid:1069804; rev:7; metadata:created_at 2010_07_30, updated_at 2010_07_30, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Bot Search RFI Scan (ByroeNet/Casper-Like planetwork) (web-application-attack) - detector_id: 69805 original_sid: 2011243
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_SERVER Bot Search RFI Scan (ByroeNet/Casper-Like planetwork)"; flow:established,to_server; content:"plaNETWORK Bot"; nocase; http_user_agent; metadata:former_category WEB_SERVER, flip_endpoints False, server_side True; reference:url,eromang.zataz.com/2010/07/13/byroenet-casper-bot-search-e107-rce-scanner/; reference:url,doc.emergingthreats.net/2011243; classtype:web-application-attack; sid:1069805; rev:7; metadata:created_at 2010_07_30, updated_at 2017_05_11; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Bot Search RFI Scan (ByroeNet/Casper-Like sun4u) (web-application-attack) - detector_id: 69806 original_sid: 2011244
alert http $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"ET WEB_SERVER Bot Search RFI Scan (ByroeNet/Casper-Like sun4u)"; flow:established,to_server; content:"|0D 0A|User-Agent|3a| Mozilla/4.76 [ru] (X11|3b| U|3b| SunOS 5.7 sun4u)"; nocase; reference:url,eromang.zataz.com/2010/07/13/byroenet-casper-bot-search-e107-rce-scanner/; reference:url,doc.emergingthreats.net/2011244; classtype:web-application-attack; sid:1069806; rev:5; metadata:created_at 2010_07_30, updated_at 2010_07_30, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Phoenix Exploit Kit - Admin Login Page Detected Outbound (bad-unknown) - detector_id: 69807 original_sid: 2011280
alert http $HTTP_SERVERS any -> any any (msg:"ET WEB_SERVER Phoenix Exploit Kit - Admin Login Page Detected Outbound"; flow:established,to_client; content:"<title>Phoenix Exploit's Kit - Log In</title>"; classtype:bad-unknown; sid:1069807; rev:3; metadata:created_at 2010_09_28, updated_at 2010_09_28, flip_endpoints True, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET WEB_SERVER Bot Search RFI Scan (Casper-Like Jcomers Bot scan) (web-application-attack) - detector_id: 69808 original_sid: 2011285
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_SERVER Bot Search RFI Scan (Casper-Like Jcomers Bot scan)"; flow:established,to_server; content:"User-Agent|3a| Jcomers Bot"; nocase; http_header; metadata:former_category WEB_SERVER, flip_endpoints False, server_side True; reference:url,eromang.zataz.com/2010/07/13/byroenet-casper-bot-search-e107-rce-scanner/; reference:url,doc.emergingthreats.net/2011285; classtype:web-application-attack; sid:1069808; rev:6; metadata:created_at 2010_07_30, updated_at 2017_05_11; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Bot Search RFI Scan (Casper-Like MaMa Cyber/ebes) (web-application-attack) - detector_id: 69809 original_sid: 2011286
alert http $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"ET WEB_SERVER Bot Search RFI Scan (Casper-Like MaMa Cyber/ebes)"; flow:established,to_server; content:"|0D 0A|User-Agent|3a| MaMa "; nocase; reference:url,eromang.zataz.com/2010/07/13/byroenet-casper-bot-search-e107-rce-scanner/; reference:url,doc.emergingthreats.net/2011286; classtype:web-application-attack; sid:1069809; rev:4; metadata:created_at 2010_07_30, updated_at 2010_07_30, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Local Website Infected By Gootkit (web-application-attack) - detector_id: 69811 original_sid: 2011289
alert http $HTTP_SERVERS $HTTP_PORTS -> $EXTERNAL_NET any (msg:"ET WEB_SERVER Local Website Infected By Gootkit"; flow:established,from_server; content:"Gootkit iframer component"; nocase; reference:url,www.m86security.com/labs/i/GootKit--Automated-Website-Infection,trace.1368~.asp; reference:url,doc.emergingthreats.net/2011285; classtype:web-application-attack; sid:1069811; rev:3; metadata:created_at 2010_09_28, updated_at 2010_09_28, flip_endpoints True, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET WEB_SERVER ColdFusion Path Traversal (locale 1/5) (web-application-attack) - detector_id: 69813 original_sid: 2011358
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER ColdFusion Path Traversal (locale 1/5)"; flow:to_server,established; content:"POST"; nocase; http_method; content:"/CFIDE/wizards/common/_logintowizard.cfm"; http_uri; content:"locale=../../"; nocase; reference:url,h30507.www3.hp.com/t5/Following-the-White-Rabbit-A/Adobe-ColdFusion-s-Directory-Traversal-Disaster/ba-p/81964; reference:url,www.gnucitizen.org/blog/coldfusion-directory-traversal-faq-cve-2010-2861/; reference:cve,CVE-2010-2861; reference:url,www.exploit-db.com/exploits/14641/; classtype:web-application-attack; sid:1069813; rev:4; metadata:created_at 2010_09_28, updated_at 2010_09_28, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER ColdFusion Path Traversal (locale 2/5) (web-application-attack) - detector_id: 69814 original_sid: 2011359
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER ColdFusion Path Traversal (locale 2/5)"; flow:to_server,established; content:"POST"; http_method; content:"/CFIDE/administrator/archives/index.cfm"; nocase; http_uri; content:"locale=../../"; nocase; reference:url,h30507.www3.hp.com/t5/Following-the-White-Rabbit-A/Adobe-ColdFusion-s-Directory-Traversal-Disaster/ba-p/81964; reference:url,www.gnucitizen.org/blog/coldfusion-directory-traversal-faq-cve-2010-2861/; reference:cve,CVE-2010-2861; reference:url,www.exploit-db.com/exploits/14641/; classtype:web-application-attack; sid:1069814; rev:5; metadata:created_at 2010_09_28, updated_at 2010_09_28, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER ColdFusion Path Traversal (locale 3/5) (web-application-attack) - detector_id: 69815 original_sid: 2011360
alert http $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"ET WEB_SERVER ColdFusion Path Traversal (locale 3/5)"; flow:to_server,established; content:"POST"; http_method; content:"/CFIDE/administrator/entman/index.cfm"; nocase; http_uri; content:"locale=../../"; nocase; reference:url,h30507.www3.hp.com/t5/Following-the-White-Rabbit-A/Adobe-ColdFusion-s-Directory-Traversal-Disaster/ba-p/81964; reference:url,www.gnucitizen.org/blog/coldfusion-directory-traversal-faq-cve-2010-2861/; reference:cve,CVE-2010-2861; reference:url,www.exploit-db.com/exploits/14641/; classtype:web-application-attack; sid:1069815; rev:5; metadata:created_at 2010_09_28, updated_at 2010_09_28, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER ColdFusion Path Traversal (locale 5/5) (web-application-attack) - detector_id: 69816 original_sid: 2011362
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER ColdFusion Path Traversal (locale 5/5)"; flow:to_server,established; content:"POST"; http_method; content:"/CFIDE/administrator/enter.cfm"; http_uri; nocase; content:"locale=../../"; nocase; reference:url,h30507.www3.hp.com/t5/Following-the-White-Rabbit-A/Adobe-ColdFusion-s-Directory-Traversal-Disaster/ba-p/81964; reference:url,www.gnucitizen.org/blog/coldfusion-directory-traversal-faq-cve-2010-2861/; reference:cve,CVE-2010-2861; reference:url,www.exploit-db.com/exploits/14641/; classtype:web-application-attack; sid:1069816; rev:5; metadata:created_at 2010_09_28, updated_at 2010_09_28, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Possible SQL Injection Using MSSQL sp_configure Command (web-application-attack) - detector_id: 69817 original_sid: 2011424
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER Possible SQL Injection Using MSSQL sp_configure Command"; flow:established,to_server; content:"sp_configure"; http_uri; nocase; reference:url,technet.microsoft.com/en-us/library/ms188787.aspx; reference:url,technet.microsoft.com/en-us/library/ms190693.aspx; classtype:web-application-attack; sid:1069817; rev:3; metadata:affected_product Web_Server_Applications, attack_target Web_Server, deployment Datacenter, tag SQL_Injection, signature_severity Major, created_at 2010_09_28, updated_at 2016_07_01, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER /bin/csh In URI Possible Shell Command Execution Attempt (web-application-attack) - detector_id: 69818 original_sid: 2011464
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER /bin/csh In URI Possible Shell Command Execution Attempt"; flow:established,to_server; content:"/bin/csh"; nocase; http_uri; classtype:web-application-attack; sid:1069818; rev:4; metadata:created_at 2010_09_09, updated_at 2010_09_09, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER /bin/sh In URI Possible Shell Command Execution Attempt (web-application-attack) - detector_id: 69819 original_sid: 2011465
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER /bin/sh In URI Possible Shell Command Execution Attempt"; flow:established,to_server; content:"/bin/sh"; http_uri; nocase; classtype:web-application-attack; sid:1069819; rev:7; metadata:created_at 2010_10_13, updated_at 2010_10_13, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER /bin/tsh In URI Possible Shell Command Execution Attempt (web-application-attack) - detector_id: 69820 original_sid: 2011466
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER /bin/tsh In URI Possible Shell Command Execution Attempt"; flow:established,to_server; content:"/bin/tsh"; http_uri; nocase; classtype:web-application-attack; sid:1069820; rev:5; metadata:created_at 2010_09_09, updated_at 2010_09_09, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER /bin/ksh In URI Possible Shell Command Execution Attempt (web-application-attack) - detector_id: 69821 original_sid: 2011467
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER /bin/ksh In URI Possible Shell Command Execution Attempt"; flow:established,to_server; content:"/bin/ksh"; nocase; http_uri; classtype:web-application-attack; sid:1069821; rev:5; metadata:created_at 2010_09_09, updated_at 2010_09_09, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Possible Cisco PIX/ASA HTTP Web Interface HTTP Response Splitting Attempt (web-application-attack) - detector_id: 69822 original_sid: 2011763
alert http $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"ET WEB_SERVER Possible Cisco PIX/ASA HTTP Web Interface HTTP Response Splitting Attempt"; flow:established,to_server; content:"GET "; depth:4; uricontent:"|0D 0A|Location|3A|"; nocase; reference:url,www.secureworks.com/ctu/advisories/SWRX-2010-001/; reference:url,tools.cisco.com/security/center/viewAlert.x?alertId=20737; reference:cve,2008-7257; reference:url,doc.emergingthreats.net/2011763; classtype:web-application-attack; sid:1069822; rev:3; metadata:created_at 2010_07_30, updated_at 2010_07_30, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER PHP tags in HTTP POST (web-application-attack) - detector_id: 69823 original_sid: 2011768
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_SERVER PHP tags in HTTP POST"; flow:established,to_server; content:"POST"; nocase; http_method; content:"<?php"; nocase; http_client_body; fast_pattern:only; reference:url,isc.sans.edu/diary.html?storyid=9478; classtype:web-application-attack; sid:1069823; rev:6; metadata:created_at 2010_09_28, updated_at 2010_09_28, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER DD-WRT Information Disclosure Attempt (attempted-recon) - detector_id: 69826 original_sid: 2012116
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_SERVER DD-WRT Information Disclosure Attempt"; flow:established,to_server; content:"/Info.live.htm"; nocase; http_uri; flowbits:set,et.ddwrt.infodis; reference:url,www.exploit-db.com/exploits/15842/; classtype:attempted-recon; sid:1069826; rev:5; metadata:created_at 2010_12_30, updated_at 2010_12_30, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Successful DD-WRT Information Disclosure (successful-recon-limited) - detector_id: 69827 original_sid: 2012117
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET WEB_SERVER Successful DD-WRT Information Disclosure"; flowbits:isset,et.ddwrt.infodis; flow:established,from_server; content:"lan_mac|3A 3A|"; content:"wlan_mac|3A 3A|"; distance:0; content:"lan_ip|3A 3A|"; distance:0; content:"mem_info|3A 3A|"; distance:0; reference:url,www.exploit-db.com/exploits/15842/; classtype:successful-recon-limited; sid:1069827; rev:3; metadata:created_at 2010_12_30, updated_at 2010_12_30, flip_endpoints True, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET WEB_SERVER PHP Large Subnormal Double Precision Floating Point Number PHP DoS in URI (attempted-dos) - detector_id: 69828 original_sid: 2012150
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_SERVER PHP Large Subnormal Double Precision Floating Point Number PHP DoS in URI"; flow:established,to_server; content:"2.2250738585072011e-308"; http_uri; nocase; reference:url,bugs.php.net/bug.php?id=53632; classtype:attempted-dos; sid:1069828; rev:3; metadata:created_at 2011_01_06, updated_at 2011_01_06, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER PHP Large Subnormal Double Precision Floating Point Number PHP DoS Inbound (attempted-dos) - detector_id: 69829 original_sid: 2012151
alert tcp $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"ET WEB_SERVER PHP Large Subnormal Double Precision Floating Point Number PHP DoS Inbound"; flow:established,to_server; content:"2.2250738585072011e-308"; nocase; reference:url,bugs.php.net/bug.php?id=53632; classtype:attempted-dos; sid:1069829; rev:1; metadata:created_at 2011_01_06, updated_at 2011_01_06, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Likely Malicious Request for /proc/self/environ (web-application-attack) - detector_id: 69830 original_sid: 2012230
alert http $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS (msg:"ET WEB_SERVER Likely Malicious Request for /proc/self/environ"; flow:established,to_server; content:"/proc/self/environ"; http_uri; nocase; classtype:web-application-attack; sid:1069830; rev:4; metadata:created_at 2011_01_25, updated_at 2011_01_25, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Automated Site Scanning for backupdata (attempted-recon) - detector_id: 69831 original_sid: 2012286
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_SERVER Automated Site Scanning for backupdata"; flow:established,to_server; content:"backupdata"; nocase; http_uri; content:"User-Agent|3a| Mozilla/4.0|0d 0a|"; http_header; classtype:attempted-recon; sid:1069831; rev:5; metadata:created_at 2011_02_04, updated_at 2011_02_04, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Automated Site Scanning for backup_data (attempted-recon) - detector_id: 69832 original_sid: 2012287
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_SERVER Automated Site Scanning for backup_data"; flow:established,to_server; content:"backup_data"; nocase; http_uri; content:"User-Agent|3a| Mozilla/4.0|0d 0a|"; http_header; classtype:attempted-recon; sid:1069832; rev:4; metadata:created_at 2011_02_04, updated_at 2011_02_04, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER HTTP 414 Request URI Too Large (web-application-attack) - detector_id: 69833 original_sid: 2012708
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET WEB_SERVER HTTP 414 Request URI Too Large"; flow:from_server,established; content:"HTTP/1.1 414 Request-URI Too Large"; depth:35; nocase; classtype:web-application-attack; sid:1069833; rev:2; metadata:created_at 2011_04_22, updated_at 2011_04_22, flip_endpoints True, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET WEB_SERVER Apache APR apr_fnmatch Stack Overflow Denial of Service (attempted-dos) - detector_id: 69834 original_sid: 2012926
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_SERVER Apache APR apr_fnmatch Stack Overflow Denial of Service"; flow:to_server,established; urilen:>1400; content:"|2F 3F|P|3D 2A 3F 2A 3F 2A 3F 2A 3F 2A 3F|"; http_uri; pcre:"/(\x2a\x3f){700}/U"; reference:cve,2011-0419; reference:url,cxib.net/stuff/apr_fnmatch.txt; reference:url,bugzilla.redhat.com/show_bug.cgi?id=703390; classtype:attempted-dos; sid:1069834; rev:3; metadata:created_at 2011_06_02, updated_at 2011_06_02, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER PHP Possible ftp Remote File Inclusion Attempt (web-application-attack) - detector_id: 69836 original_sid: 2012999
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_SERVER PHP Possible ftp Remote File Inclusion Attempt"; flow:established,to_server; content:".php?"; http_uri; content:"=ftp|3a|//"; http_uri; reference:cve,2002-0953; reference:url,diablohorn.wordpress.com/2010/01/16/interesting-local-file-inclusion-method/; classtype:web-application-attack; sid:1069836; rev:4; metadata:created_at 2011_06_10, updated_at 2011_06_10, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER PHP Possible ftps Local File Inclusion Attempt (web-application-attack) - detector_id: 69837 original_sid: 2013000
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_SERVER PHP Possible ftps Local File Inclusion Attempt"; flow:established,to_server; content:".php?"; http_uri; content:"=ftps|3a|//"; http_uri; reference:cve,2002-0953; reference:url,diablohorn.wordpress.com/2010/01/16/interesting-local-file-inclusion-method/; classtype:web-application-attack; sid:1069837; rev:4; metadata:affected_product Web_Server_Applications, attack_target Server, deployment Datacenter, tag Local_File_Inclusion, signature_severity Major, created_at 2011_06_10, updated_at 2016_07_01, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER PHP Possible php Remote File Inclusion Attempt (web-application-attack) - detector_id: 69838 original_sid: 2013001
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_SERVER PHP Possible php Remote File Inclusion Attempt"; flow:established,to_server; content:".php?"; http_uri; content:"=php|3a|//"; http_uri; reference:cve,2002-0953; reference:url,diablohorn.wordpress.com/2010/01/16/interesting-local-file-inclusion-method/; classtype:web-application-attack; sid:1069838; rev:4; metadata:created_at 2011_06_10, updated_at 2011_06_10, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER PHP Possible file Remote File Inclusion Attempt (web-application-attack) - detector_id: 69839 original_sid: 2013002
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_SERVER PHP Possible file Remote File Inclusion Attempt"; flow:established,to_server; content:".php?"; http_uri; content:"=file|3a|//"; http_uri; reference:cve,2002-0953; reference:url,diablohorn.wordpress.com/2010/01/16/interesting-local-file-inclusion-method/; classtype:web-application-attack; sid:1069839; rev:5; metadata:created_at 2011_06_10, updated_at 2011_06_10, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER PHP Possible data Remote File Inclusion Attempt (web-application-attack) - detector_id: 69840 original_sid: 2013003
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_SERVER PHP Possible data Remote File Inclusion Attempt"; flow:established,to_server; content:".php?"; http_uri; content:"=data|3a|//"; http_uri; reference:cve,2002-0953; reference:url,diablohorn.wordpress.com/2010/01/16/interesting-local-file-inclusion-method/; classtype:web-application-attack; sid:1069840; rev:4; metadata:created_at 2011_06_10, updated_at 2011_06_10, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER PHP Possible glob Remote File Inclusion Attempt (web-application-attack) - detector_id: 69841 original_sid: 2013004
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_SERVER PHP Possible glob Remote File Inclusion Attempt"; flow:established,to_server; content:".php?"; http_uri; content:"=glob|3a|//"; http_uri; reference:cve,2002-0953; reference:url,diablohorn.wordpress.com/2010/01/16/interesting-local-file-inclusion-method/; classtype:web-application-attack; sid:1069841; rev:4; metadata:created_at 2011_06_10, updated_at 2011_06_10, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER PHP Possible phar Remote File Inclusion Attempt (web-application-attack) - detector_id: 69842 original_sid: 2013005
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_SERVER PHP Possible phar Remote File Inclusion Attempt"; flow:established,to_server; content:".php?"; http_uri; content:"=phar|3a|//"; http_uri; reference:cve,2002-0953; reference:url,diablohorn.wordpress.com/2010/01/16/interesting-local-file-inclusion-method/; classtype:web-application-attack; sid:1069842; rev:5; metadata:created_at 2011_06_10, updated_at 2011_06_10, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER PHP Possible ssh2 Remote File Inclusion Attempt (web-application-attack) - detector_id: 69843 original_sid: 2013006
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_SERVER PHP Possible ssh2 Remote File Inclusion Attempt"; flow:established,to_server; content:".php?"; http_uri; content:"=ssh2|3a|//"; http_uri; reference:cve,2002-0953; reference:url,diablohorn.wordpress.com/2010/01/16/interesting-local-file-inclusion-method/; classtype:web-application-attack; sid:1069843; rev:4; metadata:created_at 2011_06_10, updated_at 2011_06_10, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER PHP Possible rar Remote File Inclusion Attempt (web-application-attack) - detector_id: 69844 original_sid: 2013007
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_SERVER PHP Possible rar Remote File Inclusion Attempt"; flow:established,to_server; content:".php?"; http_uri; content:"=rar|3a|//"; http_uri; reference:cve,2002-0953; reference:url,diablohorn.wordpress.com/2010/01/16/interesting-local-file-inclusion-method/; classtype:web-application-attack; sid:1069844; rev:4; metadata:created_at 2011_06_10, updated_at 2011_06_10, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER PHP Possible ogg Remote File Inclusion Attempt (web-application-attack) - detector_id: 69845 original_sid: 2013008
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_SERVER PHP Possible ogg Remote File Inclusion Attempt"; flow:established,to_server; content:".php?"; http_uri; content:"=ogg|3a|//"; http_uri; reference:cve,2002-0953; reference:url,diablohorn.wordpress.com/2010/01/16/interesting-local-file-inclusion-method/; classtype:web-application-attack; sid:1069845; rev:4; metadata:created_at 2011_06_10, updated_at 2011_06_10, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER PHP Possible expect Remote File Inclusion Attempt (web-application-attack) - detector_id: 69846 original_sid: 2013009
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_SERVER PHP Possible expect Remote File Inclusion Attempt"; flow:established,to_server; content:".php?"; http_uri; content:"=expect|3a|//"; http_uri; reference:cve,2002-0953; reference:url,diablohorn.wordpress.com/2010/01/16/interesting-local-file-inclusion-method/; classtype:web-application-attack; sid:1069846; rev:4; metadata:created_at 2011_06_10, updated_at 2011_06_10, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER PHP Possible zlib Remote File Inclusion Attempt (web-application-attack) - detector_id: 69847 original_sid: 2013014
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_SERVER PHP Possible zlib Remote File Inclusion Attempt"; flow:established,to_server; content:".php?"; http_uri; content:"=zlib|3a|//"; http_uri; reference:cve,2002-0953; reference:url,diablohorn.wordpress.com/2010/01/16/interesting-local-file-inclusion-method/; classtype:web-application-attack; sid:1069847; rev:5; metadata:created_at 2011_06_10, updated_at 2011_06_10, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Binget PHP Library User Agent Inbound (attempted-recon) - detector_id: 69848 original_sid: 2013049
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_SERVER Binget PHP Library User Agent Inbound"; flow:established,to_server; content:"User-Agent|3a| Binget/"; nocase; http_header; reference:url,www.bin-co.com/php/scripts/load/; reference:url,www.useragentstring.com/pages/useragentstring.php; classtype:attempted-recon; sid:1069848; rev:2; metadata:created_at 2011_06_17, updated_at 2011_06_17, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER pxyscand Suspicious User Agent Inbound (attempted-recon) - detector_id: 69849 original_sid: 2013051
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_SERVER pxyscand Suspicious User Agent Inbound"; flow:established,to_server; content:"User-Agent|3a| pxyscand/"; nocase; http_header; reference:url,www.useragentstring.com/pages/useragentstring.php; classtype:attempted-recon; sid:1069849; rev:2; metadata:created_at 2011_06_17, updated_at 2011_06_17, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER PyCurl Suspicious User Agent Inbound (attempted-recon) - detector_id: 69850 original_sid: 2013053
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_SERVER PyCurl Suspicious User Agent Inbound"; flow:established,to_server; content:"User-Agent|3a| PyCurl"; nocase; http_header; reference:url,www.useragentstring.com/pages/useragentstring.php; classtype:attempted-recon; sid:1069850; rev:2; metadata:created_at 2011_06_17, updated_at 2011_06_17, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Inbound PHP User-Agent (attempted-recon) - detector_id: 69851 original_sid: 2013057
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_SERVER Inbound PHP User-Agent"; flow:established,to_server; content:"User-Agent|3a| PHP/"; nocase; http_header; reference:url,www.useragentstring.com/pages/useragentstring.php; classtype:attempted-recon; sid:1069851; rev:3; metadata:created_at 2011_06_17, updated_at 2011_06_17, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Muieblackcat scanner (attempted-recon) - detector_id: 69853 original_sid: 2013115
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_SERVER Muieblackcat scanner"; flow:established,to_server; content:"GET /muieblackcat HTTP/1.1"; depth:26; classtype:attempted-recon; sid:1069853; rev:3; metadata:created_at 2011_06_24, updated_at 2011_06_24, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER PUT Website Defacement Attempt (web-application-attack) - detector_id: 69854 original_sid: 2013365
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER PUT Website Defacement Attempt"; flow:established,to_server; content:"PUT"; http_method; content:"<title>.|3a 3a|[+] Defaced by "; nocase; http_client_body; classtype:web-application-attack; sid:1069854; rev:2; metadata:created_at 2011_08_05, updated_at 2011_08_05, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER DNS changer cPanel attempt (web-application-attack) - detector_id: 69855 original_sid: 2013921
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_SERVER DNS changer cPanel attempt"; flow:to_server,established; content:"pwCfm=Dn5Ch4ng3"; http_client_body; classtype:web-application-attack; sid:1069855; rev:2; metadata:created_at 2011_11_17, updated_at 2011_11_17, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Weevely PHP backdoor detected (system() function used) (web-application-activity) - detector_id: 69856 original_sid: 2013937
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER Weevely PHP backdoor detected (system() function used)"; flow:to_server,established; content:"QHN5c3Rl"; http_header; reference:url,bechtsoudis.com/security/put-weevely-on-the-your-nids-radar; classtype:web-application-activity; sid:1069856; rev:6; metadata:created_at 2011_11_21, updated_at 2011_11_21, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Weevely PHP backdoor detected (passthru() function used) M1 (web-application-activity) - detector_id: 69857 original_sid: 2013938
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER Weevely PHP backdoor detected (passthru() function used) M1"; flow:to_server,established; content:"QHBhc3N0aHJ1KC"; http_header; metadata:former_category WEB_SERVER, flip_endpoints False, server_side True; reference:url,bechtsoudis.com/security/put-weevely-on-the-your-nids-radar; classtype:web-application-activity; sid:1069857; rev:5; metadata:created_at 2011_11_21, updated_at 2018_06_14; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Weevely PHP backdoor detected (shell_exec() function used) (web-application-activity) - detector_id: 69858 original_sid: 2013939
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER Weevely PHP backdoor detected (shell_exec() function used)"; flow:to_server,established; content:"aGVsbF9l"; http_header; reference:url,bechtsoudis.com/security/put-weevely-on-the-your-nids-radar; classtype:web-application-activity; sid:1069858; rev:4; metadata:created_at 2011_11_21, updated_at 2011_11_21, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Weevely PHP backdoor detected (proc_open() function used) (web-application-activity) - detector_id: 69859 original_sid: 2013940
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER Weevely PHP backdoor detected (proc_open() function used)"; flow:to_server,established; content:"JHAgPSBhcnJheShhcnJh"; http_header; reference:url,bechtsoudis.com/security/put-weevely-on-the-your-nids-radar; classtype:web-application-activity; sid:1069859; rev:4; metadata:created_at 2011_11_21, updated_at 2011_11_21, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Weevely PHP backdoor detected (popen() function used) (web-application-activity) - detector_id: 69860 original_sid: 2013941
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER Weevely PHP backdoor detected (popen() function used)"; flow:to_server,established; content:"JGggPSBwb3Bl"; http_header; reference:url,bechtsoudis.com/security/put-weevely-on-the-your-nids-radar; classtype:web-application-activity; sid:1069860; rev:4; metadata:created_at 2011_11_21, updated_at 2011_11_21, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Weevely PHP backdoor detected (python_eval() function used) (web-application-activity) - detector_id: 69861 original_sid: 2013942
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER Weevely PHP backdoor detected (python_eval() function used)"; flow:to_server,established; content:"QHB5dGhvbl9l"; http_header; metadata:former_category WEB_SERVER, flip_endpoints False, server_side True; reference:url,bechtsoudis.com/security/put-weevely-on-the-your-nids-radar; classtype:web-application-activity; sid:1069861; rev:5; metadata:created_at 2011_11_21, updated_at 2017_03_21; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Weevely PHP backdoor detected (pcntl_exec() function used) (web-application-activity) - detector_id: 69862 original_sid: 2013943
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER Weevely PHP backdoor detected (pcntl_exec() function used)"; flow:to_server,established; content:"JGFyZ3MgPSBh"; http_header; reference:url,bechtsoudis.com/security/put-weevely-on-the-your-nids-radar; classtype:web-application-activity; sid:1069862; rev:6; metadata:created_at 2011_11_21, updated_at 2011_11_21, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Weevely PHP backdoor detected (perl->system() function used) (web-application-activity) - detector_id: 69863 original_sid: 2013944
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER Weevely PHP backdoor detected (perl->system() function used)"; flow:to_server,established; content:"JHBlcmwgPSBuZXcg"; http_header; reference:url,bechtsoudis.com/security/put-weevely-on-the-your-nids-radar; classtype:web-application-activity; sid:1069863; rev:4; metadata:created_at 2011_11_21, updated_at 2011_11_21, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Weevely PHP backdoor detected (exec() function used) (web-application-activity) - detector_id: 69864 original_sid: 2013945
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER Weevely PHP backdoor detected (exec() function used)"; flow:to_server,established; content:"ZXhlYygn"; http_header; reference:url,bechtsoudis.com/security/put-weevely-on-the-your-nids-radar; classtype:web-application-activity; sid:1069864; rev:4; metadata:created_at 2011_11_21, updated_at 2011_11_21, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER JBoss jmx-console Probe (web-application-activity) - detector_id: 69865 original_sid: 2014017
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_SERVER JBoss jmx-console Probe"; flow:to_server,established; content:"HEAD"; http_method; content:"/jmx-console/HtmlAdaptor?"; http_uri; nocase; reference:cve,2010-0738; classtype:web-application-activity; sid:1069865; rev:2; metadata:created_at 2011_12_09, updated_at 2011_12_09, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER JBoss jmx-console Access Control Bypass Attempt (web-application-activity) - detector_id: 69866 original_sid: 2014018
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_SERVER JBoss jmx-console Access Control Bypass Attempt"; flow:to_server,established; content:"HEAD"; http_method; content:"/jmx-console/HtmlAdaptor?"; http_uri; nocase; content:"Runtime.getRuntime().exec("; http_uri; reference:cve,2010-0738; classtype:web-application-activity; sid:1069866; rev:2; metadata:created_at 2011_12_09, updated_at 2011_12_09, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Wordpress Login Bruteforcing Detected (attempted-recon) - detector_id: 69867 original_sid: 2014020
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER Wordpress Login Bruteforcing Detected"; flow:to_server,established; content:"/wp-login.php"; nocase; http_uri; content:"POST"; http_method; content:"log|3d|"; http_client_body; content:"pwd|3d|"; http_client_body; threshold: type both, track by_src, count 5, seconds 60; classtype:attempted-recon; sid:1069867; rev:4; metadata:affected_product Wordpress, affected_product Wordpress_Plugins, attack_target Web_Server, deployment Datacenter, tag Wordpress, signature_severity Major, created_at 2011_12_12, updated_at 2016_07_01, flip_endpoints False, server_side True; target:dest_ip;)

# ET WEB_SERVER ASP.NET Forms Authentication Bypass (attempted-user) - detector_id: 69868 original_sid: 2014100
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER ASP.NET Forms Authentication Bypass"; flow:to_server,established; content:"/CreatingUserAccounts.aspx"; http_uri; content:"CreateUserStepContainer"; content:"UserName="; distance:0; content:"%00"; distance:0; pcre:"/UserName\x3d[^\x26]+\x2500/"; reference:cve,2011-3416; classtype:attempted-user; sid:1069868; rev:3; metadata:created_at 2012_01_03, updated_at 2012_01_03, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Unusually Fast HTTP Requests With Referer Url Matching DoS Tool (web-application-activity) - detector_id: 69869 original_sid: 2014103
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER Unusually Fast HTTP Requests With Referer Url Matching DoS Tool"; flow:to_server,established; content:"Referer|3a 20|"; http_header; content:"/slowhttptest/"; http_header; fast_pattern:only; pcre:"/Referer\x3a\x20[^\r\n]*\/slowhttptest\//Hi"; threshold: type both, track by_src, count 15, seconds 30; reference:url,community.qualys.com/blogs/securitylabs/2012/01/05/slow-read; classtype:web-application-activity; sid:1069869; rev:4; metadata:created_at 2012_01_09, updated_at 2012_01_09, flip_endpoints False, server_side True; target:dest_ip;)

# ET WEB_SERVER LOIC Javascript DDoS Inbound (attempted-dos) - detector_id: 69870 original_sid: 2014140
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_SERVER LOIC Javascript DDoS Inbound"; flow:established,to_server; content:"GET"; http_method; content:"?id="; http_uri; content:"&msg="; http_uri; distance:13; within:5; pcre:"/\?id=[0-9]{13}&msg=[^&]+$/U"; threshold: type both, track by_src, count 5, seconds 60; reference:url,isc.sans.org/diary/Javascript+DDoS+Tool+Analysis/12442; reference:url,www.wired.com/threatlevel/2012/01/anons-rickroll-botnet; classtype:attempted-dos; sid:1069870; rev:5; metadata:created_at 2012_01_23, updated_at 2012_01_23, flip_endpoints False, server_side True; target:dest_ip;)

# ET WEB_SERVER eval/base64_decode Exploit Attempt Inbound (web-application-attack) - detector_id: 69871 original_sid: 2014296
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER eval/base64_decode Exploit Attempt Inbound"; flow:established,to_server; content:"eval|28|base64_decode|28|"; http_uri; classtype:web-application-attack; sid:1069871; rev:2; metadata:created_at 2012_02_29, updated_at 2012_02_29, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Possible SQL Injection Attempt char() Danmec related (attempted-admin) - detector_id: 69872 original_sid: 2014352
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_SERVER Possible SQL Injection Attempt char() Danmec related"; flow:established,to_server; content:"CHAR("; http_uri; nocase; pcre:"/CHAR\([0-9]{2,3}\)char\([^\x0d\x0a\x20]{98}/Ui"; classtype:attempted-admin; sid:1069872; rev:3; metadata:affected_product Web_Server_Applications, attack_target Web_Server, deployment Datacenter, tag SQL_Injection, signature_severity Major, created_at 2012_03_09, updated_at 2016_07_01, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER IIS INDEX_ALLOCATION Auth Bypass Attempt (bad-unknown) - detector_id: 69873 original_sid: 2014886
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_SERVER IIS INDEX_ALLOCATION Auth Bypass Attempt"; flow:established,to_server; content:"|3a|$INDEX_ALLOCATION"; http_uri; nocase; reference:url,lists.grok.org.uk/pipermail/full-disclosure/2012-June/087269.html; classtype:bad-unknown; sid:1069873; rev:2; metadata:created_at 2012_06_11, updated_at 2012_06_11, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Possible attempt to enumerate MS SQL Server version (attempted-admin) - detector_id: 69874 original_sid: 2014890
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_SERVER Possible attempt to enumerate MS SQL Server version"; flow:established,to_server; content:"@@version"; nocase; http_uri; reference:url,support.microsoft.com/kb/321185; classtype:attempted-admin; sid:1069874; rev:2; metadata:created_at 2012_06_13, updated_at 2012_06_13, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER possible IBM Rational Directory Server (RDS) Help system href browser redirect (web-application-attack) - detector_id: 69875 original_sid: 2014986
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER possible IBM Rational Directory Server (RDS) Help system href browser redirect"; flow:established,to_server; content:"/rds-help/advanced/deferredView.jsp?"; nocase; http_uri; content:"href="; nocase; http_uri; pcre:"/href=\s*(ftps?|https?|php)\:\//Ui"; reference:url,secunia.com/advisories/49627/; classtype:web-application-attack; sid:1069875; rev:2; metadata:created_at 2012_06_29, updated_at 2012_06_29, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER possible IBM Rational Directory Server (RDS) Help system href Cross Site Scripting Attempt (web-application-attack) - detector_id: 69876 original_sid: 2014987
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER possible IBM Rational Directory Server (RDS) Help system href Cross Site Scripting Attempt"; flow:established,to_server; content:"/rds-help/advanced/deferredView.jsp?"; nocase; http_uri; content:"href="; nocase; http_uri; pcre:"/href\x3D.+(script|alert|onmouse[a-z]+|onkey[a-z]+|onload|onunload|ondragdrop|onblur|onfocus|onclick|ondblclick|onsubmit|onreset|onselect|onchange|javascript)/Ui"; reference:url,secunia.com/advisories/49627/; classtype:web-application-attack; sid:1069876; rev:2; metadata:affected_product Web_Server_Applications, attack_target Web_Server, deployment Datacenter, tag XSS, tag Cross_Site_Scripting, signature_severity Major, created_at 2012_06_29, updated_at 2016_07_01, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER IIS 8.3 Filename With Wildcard (Possible File/Dir Bruteforce) (network-scan) - detector_id: 69877 original_sid: 2015023
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER IIS 8.3 Filename With Wildcard (Possible File/Dir Bruteforce)"; flow:established,to_server; content:"~1"; http_uri; fast_pattern:only; pcre:"/([\*\?]~1|~1\.?[\*\?]|\/~1\/)/U"; reference:url,soroush.secproject.com/downloadable/microsoft_iis_tilde_character_vulnerability_feature.pdf; classtype:network-scan; sid:1069877; rev:3; metadata:created_at 2012_07_04, updated_at 2012_07_04, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER possible SAP Crystal Report Server 2008 path parameter Directory Traversal vulnerability (web-application-attack) - detector_id: 69878 original_sid: 2015035
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER possible SAP Crystal Report Server 2008 path parameter Directory Traversal vulnerability"; flow:established,to_server; content:"/PerformanceManagement/jsp/qa.jsp?"; nocase; http_uri; content:"func="; nocase; http_uri; content:"root="; nocase; http_uri; content:"path="; nocase; http_uri; content:"|2e 2e 2f|"; nocase; depth:200; reference:url,1337day.com/exploits/15332; classtype:web-application-attack; sid:1069878; rev:2; metadata:created_at 2012_07_06, updated_at 2012_07_06, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Fake Googlebot UA 2 Inbound (network-scan) - detector_id: 69879 original_sid: 2015527
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_SERVER Fake Googlebot UA 2 Inbound"; flow:established,to_server; content:"User-Agent|3a|"; http_header; content:!"Googlebot-News|0d 0a|"; within:16; http_header; content:!" Googlebot-Image/1.0|0d 0a|"; within:22; http_header; content:!" Googlebot-Video/1.0|0d 0a|"; within:22; http_header; content:"Googlebot-"; fast_pattern; http_header; nocase; distance:0; content:!"Mobile/2.1|3b| +http|3a|//www.google.com/bot.html)|0d 0a|"; within:46; http_header; pcre:"/^User-Agent\x3a[^\r\n]+?Googlebot-.+?\r$/Hmi"; reference:url,www.incapsula.com/the-incapsula-blog/item/369-was-that-really-a-google-bot-crawling-my-site; reference:url,support.google.com/webmasters/bin/answer.py?hl=en&answer=1061943; classtype:network-scan; sid:1069879; rev:2; metadata:created_at 2012_07_25, updated_at 2012_07_25, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Brutus Scan Inbound (attempted-recon) - detector_id: 69881 original_sid: 2015703
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_SERVER Brutus Scan Inbound"; flow:established,to_server; content:"Brutus/AET"; http_user_agent; classtype:attempted-recon; sid:1069881; rev:3; metadata:created_at 2012_09_17, updated_at 2012_09_17, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Possible Oracle SQL Injection utl_inaddr call in URI (attempted-admin) - detector_id: 69882 original_sid: 2015749
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_SERVER Possible Oracle SQL Injection utl_inaddr call in URI"; flow:established,to_server; content:"utl_inaddr.get_host"; nocase; http_uri; fast_pattern:only; classtype:attempted-admin; sid:1069882; rev:2; metadata:affected_product Web_Server_Applications, attack_target Web_Server, deployment Datacenter, tag SQL_Injection, signature_severity Major, created_at 2012_09_28, updated_at 2016_07_01, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER FaTaLisTiCz_Fx Webshell Detected (web-application-activity) - detector_id: 69884 original_sid: 2015811
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"ET WEB_SERVER FaTaLisTiCz_Fx Webshell Detected"; flow:established,from_server; content:"visitz="; http_cookie; file_data; content:"FaTaLisTiCz_Fx"; classtype:web-application-activity; sid:1069884; rev:2; metadata:created_at 2012_10_18, updated_at 2012_10_18, flip_endpoints True, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET WEB_SERVER WebShell - D.K - Title (bad-unknown) - detector_id: 69885 original_sid: 2015917
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET WEB_SERVER WebShell - D.K - Title"; flow:established,to_client; file_data; content:"<title>"; content:" - D.K "; fast_pattern; distance:0; content:"</title>"; distance:0; classtype:bad-unknown; sid:1069885; rev:2; metadata:created_at 2012_11_21, updated_at 2012_11_21, flip_endpoints True, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET WEB_SERVER WebShell - Generic - c99shell based header (attempted-user) - detector_id: 69886 original_sid: 2015918
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET WEB_SERVER WebShell - Generic - c99shell based header"; flow:established,to_client; file_data; content:"<span>Uname<br>User<br>Php<br>Hdd<br>Cwd</span>"; classtype:attempted-user; sid:1069886; rev:2; metadata:created_at 2012_11_21, updated_at 2012_11_21, flip_endpoints True, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET WEB_SERVER WebShell - Generic - c99shell based header w/colons (attempted-user) - detector_id: 69887 original_sid: 2015919
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET WEB_SERVER WebShell - Generic - c99shell based header w/colons"; flow:established,to_client; file_data; content:"<span>Uname|3a|<br>User|3a|<br>Php|3a|<br>Hdd|3a|<br>Cwd|3a|</span>"; classtype:attempted-user; sid:1069887; rev:3; metadata:created_at 2012_11_21, updated_at 2012_11_21, flip_endpoints True, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET WEB_SERVER WebShell - Generic - c99shell based POST structure w/multipart (attempted-user) - detector_id: 69888 original_sid: 2015920
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_SERVER WebShell - Generic - c99shell based POST structure w/multipart"; flow:established,to_server; content:"POST"; http_method; content:"form-data\; name=|22|a|22|"; http_client_body; content:"form-data\; name=|22|c|22|"; http_client_body; content:"form-data\; name=|22|p1|22|"; http_client_body; classtype:attempted-user; sid:1069888; rev:2; metadata:created_at 2012_11_21, updated_at 2012_11_21, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER WebShell - PHP eMailer (web-application-activity) - detector_id: 69889 original_sid: 2015924
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_SERVER WebShell - PHP eMailer"; flow:established,to_server; content:"POST"; http_method; content:"form-data|3b| name=|22|from|22|"; http_client_body; content:"form-data|3b| name=|22|realname|22|"; http_client_body; content:"form-data|3b| name=|22|amount|22|"; http_client_body; classtype:web-application-activity; sid:1069889; rev:2; metadata:created_at 2012_11_23, updated_at 2012_11_23, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER WebShell - Unknown - self-kill (web-application-activity) - detector_id: 69890 original_sid: 2015925
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET WEB_SERVER WebShell - Unknown - self-kill"; flow:established,to_client; file_data; content:"<a href=|22|?x=selfremove|22|>[Self-Kill]</a>"; classtype:web-application-activity; sid:1069890; rev:2; metadata:created_at 2012_11_23, updated_at 2012_11_23, flip_endpoints True, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET WEB_SERVER WebShell - Unknown - .php?x=img&img= (web-application-activity) - detector_id: 69891 original_sid: 2015926
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_SERVER WebShell - Unknown - .php?x=img&img="; flow:established,to_server; content:".php?x=img&img="; http_uri; fast_pattern:only; classtype:web-application-activity; sid:1069891; rev:2; metadata:created_at 2012_11_23, updated_at 2012_11_23, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER WebShell - PostMan (misc-activity) - detector_id: 69892 original_sid: 2015937
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_SERVER WebShell - PostMan"; flow:established,to_server; content:"POST"; http_method; content:"form-data|3b| name=|22|formSubmited|22|"; http_client_body; content:"form-data|3b| name=|22|scriptPassword|22|"; http_client_body; classtype:misc-activity; sid:1069892; rev:7; metadata:created_at 2012_11_26, updated_at 2012_11_26, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER WebShell - JSP RAT (attempted-user) - detector_id: 69894 original_sid: 2016151
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"ET WEB_SERVER WebShell - JSP RAT"; flow:established,to_client; file_data; content:"<table id=\"filetable\" class=\"filelist\" cellspacing=\"1px\" cellpadding=\"0px\">"; classtype:attempted-user; sid:1069894; rev:3; metadata:created_at 2013_01_04, updated_at 2013_01_04, flip_endpoints True, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET WEB_SERVER WebShell - JSP File Admin (attempted-user) - detector_id: 69895 original_sid: 2016152
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"ET WEB_SERVER WebShell - JSP File Admin"; flow:established,to_client; file_data; content:"<h2>(L)aunch external program</h2>"; classtype:attempted-user; sid:1069895; rev:4; metadata:created_at 2013_01_04, updated_at 2013_01_04, flip_endpoints True, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET WEB_SERVER WebShell - JSP File Admin - POST Structure - dir (attempted-user) - detector_id: 69896 original_sid: 2016153
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER WebShell - JSP File Admin - POST Structure - dir"; flow:established,to_server; content:"POST"; http_method; content:"dir="; http_client_body; content:"&sort="; http_client_body; content:"&command="; http_client_body; content:"&Submit="; http_client_body; classtype:attempted-user; sid:1069896; rev:3; metadata:created_at 2013_01_04, updated_at 2013_01_04, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER ColdFusion componentutils access (web-application-attack) - detector_id: 69897 original_sid: 2016182
alert http any any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER ColdFusion componentutils access"; flow:established,to_server; content:"GET"; http_method; nocase; content:"/CFIDE/componentutils"; http_uri; nocase; reference:url,www.adobe.com/support/security/advisories/apsa13-01.html; classtype:web-application-attack; sid:1069897; rev:6; metadata:created_at 2013_01_09, updated_at 2013_01_09, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER ColdFusion adminapi access (web-application-attack) - detector_id: 69898 original_sid: 2016183
alert http any any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER ColdFusion adminapi access"; flow:established,to_server; content:"GET"; http_method; nocase; content:"/CFIDE/adminapi"; http_uri; nocase; reference:url,www.adobe.com/support/security/advisories/apsa13-01.html; classtype:web-application-attack; sid:1069898; rev:4; metadata:created_at 2013_01_09, updated_at 2013_01_09, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER ColdFusion administrator access (web-application-attack) - detector_id: 69899 original_sid: 2016184
alert http any any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER ColdFusion administrator access"; flow:established,to_server; content:"GET"; http_method; nocase; content:"/CFIDE/administrator"; http_uri; nocase; reference:url,www.adobe.com/support/security/advisories/apsa13-01.html; classtype:web-application-attack; sid:1069899; rev:5; metadata:created_at 2013_01_09, updated_at 2013_01_09, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER WebShell - Symlink_Sa (bad-unknown) - detector_id: 69900 original_sid: 2016244
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"ET WEB_SERVER WebShell - Symlink_Sa"; flow:established,to_client; file_data; content:"<title>Symlink_Sa"; classtype:bad-unknown; sid:1069900; rev:2; metadata:created_at 2013_01_21, updated_at 2013_01_21, flip_endpoints True, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET WEB_SERVER WebShell - Generic - c99shell based header (bad-unknown) - detector_id: 69901 original_sid: 2016245
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"ET WEB_SERVER WebShell - Generic - c99shell based header"; flow:established,to_client; file_data; content:"<b>Software|3a|"; content:"<b>uname -a|3a|"; content:"<b>uid="; classtype:bad-unknown; sid:1069901; rev:3; metadata:created_at 2013_01_21, updated_at 2013_01_21, flip_endpoints True, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET WEB_SERVER PHP tag in UA (bad-unknown) - detector_id: 69902 original_sid: 2016415
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER PHP tag in UA"; flow:established,to_server; content:"<?php"; http_user_agent; nocase; fast_pattern:only; reference:url,blog.spiderlabs.com/2013/02/honeypot-alert-user-agent-field-php-injection-attacks.html; classtype:bad-unknown; sid:1069902; rev:3; metadata:created_at 2013_02_16, updated_at 2013_02_16, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER base64_decode in UA (bad-unknown) - detector_id: 69903 original_sid: 2016416
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER base64_decode in UA"; flow:established,to_server; content:"base64_decode("; http_user_agent; nocase; fast_pattern:only; reference:url,blog.spiderlabs.com/2013/02/honeypot-alert-user-agent-field-php-injection-attacks.html; classtype:bad-unknown; sid:1069903; rev:3; metadata:created_at 2013_02_16, updated_at 2013_02_16, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER WebShell - zecmd - Form (attempted-user) - detector_id: 69904 original_sid: 2016501
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET WEB_SERVER WebShell - zecmd - Form"; flow:established,to_client; file_data; content:"<FORM METHOD=|22|GET|22| NAME=|22|comments|22| ACTION=|22 22|>"; classtype:attempted-user; sid:1069904; rev:2; metadata:created_at 2013_02_25, updated_at 2013_02_25, flip_endpoints True, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET WEB_SERVER WebShell - Generic - c99shell based POST structure (attempted-user) - detector_id: 69905 original_sid: 2016516
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_SERVER WebShell - Generic - c99shell based POST structure"; flow:established,to_server; content:"POST"; http_method; content:"act="; depth:4; fast_pattern; http_client_body; content:"&d="; http_client_body; within:20; classtype:attempted-user; sid:1069905; rev:2; metadata:created_at 2013_03_04, updated_at 2013_03_04, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER WebShell - MySQL Interface - Database List (bad-unknown) - detector_id: 69906 original_sid: 2016574
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"ET WEB_SERVER WebShell - MySQL Interface - Database List"; flow:established,to_client; file_data; content:"<h1>Databases List</h1>"; classtype:bad-unknown; sid:1069906; rev:2; metadata:created_at 2013_03_13, updated_at 2013_03_13, flip_endpoints True, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET WEB_SERVER WebShell - MySQL Interface - Client Cookie mysql_web_admin*= (bad-unknown) - detector_id: 69907 original_sid: 2016575
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER WebShell - MySQL Interface - Client Cookie mysql_web_admin*="; flow:established,to_server; content:"mysql_web_admin_"; http_cookie; classtype:bad-unknown; sid:1069907; rev:3; metadata:created_at 2013_03_13, updated_at 2013_03_13, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER WebShell - MySQL Interface - Server Set Cookie mysql_web_admin*= (bad-unknown) - detector_id: 69908 original_sid: 2016576
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"ET WEB_SERVER WebShell - MySQL Interface - Server Set Cookie mysql_web_admin*="; flow:established,to_client; content:"mysql_web_admin_"; http_cookie; classtype:bad-unknown; sid:1069908; rev:2; metadata:created_at 2013_03_13, updated_at 2013_03_13, flip_endpoints True, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET WEB_SERVER WebShell - Romanian Webshell (bad-unknown) - detector_id: 69909 original_sid: 2016577
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"ET WEB_SERVER WebShell - Romanian Webshell"; flow:established,to_client; file_data; content:"Incarca fisier|3a|"; content:"Exeuta comada|3a|"; classtype:bad-unknown; sid:1069909; rev:4; metadata:created_at 2013_03_13, updated_at 2013_03_13, flip_endpoints True, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET WEB_SERVER Possible SQL Injection (varchar2) (attempted-admin) - detector_id: 69910 original_sid: 2016596
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_SERVER Possible SQL Injection (varchar2)"; flow:established,to_server; content:"varchar2("; nocase; http_uri; reference:url,doc.emergingthreats.net/2008175; classtype:attempted-admin; sid:1069910; rev:6; metadata:affected_product Web_Server_Applications, attack_target Web_Server, deployment Datacenter, tag SQL_Injection, signature_severity Major, created_at 2013_03_19, updated_at 2016_07_01, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Possible Perl Shell in HTTP POST (web-application-attack) - detector_id: 69911 original_sid: 2016641
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER Possible Perl Shell in HTTP POST"; flow:established,to_server; content:"POST"; nocase; http_method; content:"#!/usr/bin/perl"; nocase; http_client_body; fast_pattern:only; reference:url,isc.sans.edu/diary.html?storyid=9478; classtype:web-application-attack; sid:1069911; rev:6; metadata:created_at 2013_03_21, updated_at 2013_03_21, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Possible Perl Shell in HTTP POST (web-application-attack) - detector_id: 69912 original_sid: 2016642
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER Possible Perl Shell in HTTP POST"; flow:established,to_server; content:"POST"; nocase; http_method; content:"#!/bin/sh"; nocase; http_client_body; fast_pattern:only; reference:url,isc.sans.edu/diary.html?storyid=9478; classtype:web-application-attack; sid:1069912; rev:6; metadata:created_at 2013_03_21, updated_at 2013_03_21, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER SQL Errors in HTTP 200 Response (mssql_query) (bad-unknown) - detector_id: 69913 original_sid: 2016664
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"ET WEB_SERVER SQL Errors in HTTP 200 Response (mssql_query)"; flow:from_server,established; content:"200"; http_stat_code; file_data; content:"mssql_query"; distance:0; classtype:bad-unknown; sid:1069913; rev:2; metadata:created_at 2013_03_27, updated_at 2013_03_27, flip_endpoints True, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET WEB_SERVER SQL Errors in HTTP 500 Response (mssql_query) (bad-unknown) - detector_id: 69914 original_sid: 2016665
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"ET WEB_SERVER SQL Errors in HTTP 500 Response (mssql_query)"; flow:from_server,established; content:"500"; http_stat_code; file_data; content:"mssql_query"; distance:0; classtype:bad-unknown; sid:1069914; rev:2; metadata:created_at 2013_03_27, updated_at 2013_03_27, flip_endpoints True, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET WEB_SERVER SQL Errors in HTTP 200 Response (pgsql_query) (bad-unknown) - detector_id: 69915 original_sid: 2016666
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"ET WEB_SERVER SQL Errors in HTTP 200 Response (pgsql_query)"; flow:from_server,established; content:"200"; http_stat_code; file_data; content:"pgsql_query"; distance:0; classtype:bad-unknown; sid:1069915; rev:2; metadata:created_at 2013_03_27, updated_at 2013_03_27, flip_endpoints True, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET WEB_SERVER SQL Errors in HTTP 500 Response (pgsql_query) (bad-unknown) - detector_id: 69916 original_sid: 2016667
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"ET WEB_SERVER SQL Errors in HTTP 500 Response (pgsql_query)"; flow:from_server,established; content:"500"; http_stat_code; file_data; content:"pgsql_query"; distance:0; classtype:bad-unknown; sid:1069916; rev:2; metadata:created_at 2013_03_27, updated_at 2013_03_27, flip_endpoints True, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET WEB_SERVER SQL Errors in HTTP 200 Response (mysql_query) (bad-unknown) - detector_id: 69917 original_sid: 2016668
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"ET WEB_SERVER SQL Errors in HTTP 200 Response (mysql_query)"; flow:from_server,established; content:"200"; http_stat_code; file_data; content:"mysql_query"; distance:0; classtype:bad-unknown; sid:1069917; rev:2; metadata:created_at 2013_03_27, updated_at 2013_03_27, flip_endpoints True, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET WEB_SERVER SQL Errors in HTTP 500 Response (mysql_query) (bad-unknown) - detector_id: 69918 original_sid: 2016669
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"ET WEB_SERVER SQL Errors in HTTP 500 Response (mysql_query)"; flow:from_server,established; content:"500"; http_stat_code; file_data; content:"mysql_query"; distance:0; classtype:bad-unknown; sid:1069918; rev:2; metadata:created_at 2013_03_27, updated_at 2013_03_27, flip_endpoints True, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET WEB_SERVER SQL Errors in HTTP 200 Response (SqlException) (bad-unknown) - detector_id: 69919 original_sid: 2016670
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"ET WEB_SERVER SQL Errors in HTTP 200 Response (SqlException)"; flow:from_server,established; content:"200"; http_stat_code; file_data; content:"SqlException"; distance:0; classtype:bad-unknown; sid:1069919; rev:2; metadata:created_at 2013_03_27, updated_at 2013_03_27, flip_endpoints True, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET WEB_SERVER SQL Errors in HTTP 500 Response (SqlException) (bad-unknown) - detector_id: 69920 original_sid: 2016671
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"ET WEB_SERVER SQL Errors in HTTP 500 Response (SqlException)"; flow:from_server,established; content:"500"; http_stat_code; file_data; content:"SqlException"; distance:0; classtype:bad-unknown; sid:1069920; rev:2; metadata:created_at 2013_03_27, updated_at 2013_03_27, flip_endpoints True, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET WEB_SERVER SQL Errors in HTTP 200 Response (error in your SQL syntax) (bad-unknown) - detector_id: 69921 original_sid: 2016672
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"ET WEB_SERVER SQL Errors in HTTP 200 Response (error in your SQL syntax)"; flow:from_server,established; content:"200"; http_stat_code; file_data; content:"error in your SQL syntax"; fast_pattern:only; classtype:bad-unknown; sid:1069921; rev:2; metadata:created_at 2013_03_27, updated_at 2013_03_27, flip_endpoints True, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET WEB_SERVER SQL Errors in HTTP 500 Response (error in your SQL syntax) (bad-unknown) - detector_id: 69922 original_sid: 2016673
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"ET WEB_SERVER SQL Errors in HTTP 500 Response (error in your SQL syntax)"; flow:from_server,established; content:"500"; http_stat_code; file_data; content:"error in your SQL syntax"; distance:0; classtype:bad-unknown; sid:1069922; rev:2; metadata:created_at 2013_03_27, updated_at 2013_03_27, flip_endpoints True, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET WEB_SERVER SQL Errors in HTTP 200 Response (ERROR syntax error at or near) (bad-unknown) - detector_id: 69923 original_sid: 2016674
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"ET WEB_SERVER SQL Errors in HTTP 200 Response (ERROR syntax error at or near)"; flow:from_server,established; content:"200"; http_stat_code; file_data; content:"ERROR|3a|  syntax error at or near"; distance:0; classtype:bad-unknown; sid:1069923; rev:3; metadata:created_at 2013_03_27, updated_at 2013_03_27, flip_endpoints True, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET WEB_SERVER SQL Errors in HTTP 500 Response (ERROR syntax error at or near) (bad-unknown) - detector_id: 69924 original_sid: 2016675
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"ET WEB_SERVER SQL Errors in HTTP 500 Response (ERROR syntax error at or near)"; flow:from_server,established; content:"500"; http_stat_code; file_data; content:"ERROR|3a|  syntax error at or near"; distance:0; classtype:bad-unknown; sid:1069924; rev:3; metadata:created_at 2013_03_27, updated_at 2013_03_27, flip_endpoints True, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET WEB_SERVER WebShell Generic - net user (bad-unknown) - detector_id: 69926 original_sid: 2016680
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER WebShell Generic - net user"; flow:established,to_server; content:"POST"; http_method; content:"net"; nocase; http_client_body; content:!"work"; within:4; nocase; http_client_body; content:"user"; nocase; within:11; http_client_body; content:!"-agent"; nocase; http_client_body; within:6; pcre:"/net(?:%(?:25)?20|\s)+user/Pi"; classtype:bad-unknown; sid:1069926; rev:6; metadata:created_at 2013_03_27, updated_at 2013_03_27, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER WebShell Generic - netsh firewall (bad-unknown) - detector_id: 69927 original_sid: 2016681
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER WebShell Generic - netsh firewall"; flow:established,to_server; content:"netsh"; nocase; fast_pattern; http_client_body; content:"firewall"; within:15; http_client_body; classtype:bad-unknown; sid:1069927; rev:2; metadata:created_at 2013_03_27, updated_at 2013_03_27, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER WebShell Generic - reg HKEY_LOCAL_MACHINE (bad-unknown) - detector_id: 69928 original_sid: 2016682
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER WebShell Generic - reg HKEY_LOCAL_MACHINE"; flow:established,to_server; content:"reg"; nocase; http_client_body; content:"HKEY_LOCAL_MACHINE"; nocase; within:80; http_client_body; classtype:bad-unknown; sid:1069928; rev:2; metadata:created_at 2013_03_27, updated_at 2013_03_27, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER WebShell Generic - wget http - POST (bad-unknown) - detector_id: 69929 original_sid: 2016683
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER WebShell Generic - wget http - POST"; flow:established,to_server; content:"wget"; nocase; http_client_body; content:"http"; nocase; http_client_body; within:11; classtype:bad-unknown; sid:1069929; rev:2; metadata:created_at 2013_03_27, updated_at 2013_03_27, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER WebShell - JSPCMD - Form (bad-unknown) - detector_id: 69930 original_sid: 2016684
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"ET WEB_SERVER WebShell - JSPCMD - Form"; flow:established,to_client; file_data; content:"<FORM METHOD=\"GET\" NAME=\"comments\" ACTION=\"\">"; classtype:bad-unknown; sid:1069930; rev:2; metadata:created_at 2013_03_27, updated_at 2013_03_27, flip_endpoints True, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET WEB_SERVER WebShell - MySQL Interface - Auth Prompt (bad-unknown) - detector_id: 69931 original_sid: 2016689
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"ET WEB_SERVER WebShell - MySQL Interface - Auth Prompt"; flow:established,to_client; file_data; content:"bG9nb25fc3VibWl0"; classtype:bad-unknown; sid:1069931; rev:2; metadata:created_at 2013_04_01, updated_at 2013_04_01, flip_endpoints True, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET WEB_SERVER WebShell - PHPShell - Comment (attempted-user) - detector_id: 69932 original_sid: 2016760
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"ET WEB_SERVER WebShell - PHPShell - Comment"; flow:established,to_client; file_data; content:"<!-- PHPShell "; classtype:attempted-user; sid:1069932; rev:2; metadata:created_at 2013_04_16, updated_at 2013_04_16, flip_endpoints True, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET WEB_SERVER WebShell - PHPShell - Haxplorer URI (attempted-user) - detector_id: 69933 original_sid: 2016761
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER WebShell - PHPShell - Haxplorer URI"; flow:established,to_server; content:".php?&s=r&cmd=dir&dir="; http_uri; classtype:attempted-user; sid:1069933; rev:2; metadata:created_at 2013_04_16, updated_at 2013_04_16, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER WebShell - PHPShell - PHPKonsole URI (attempted-user) - detector_id: 69934 original_sid: 2016762
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER WebShell - PHPShell - PHPKonsole URI"; flow:established,to_server; content:".php?&s=r&cmd=con"; http_uri; classtype:attempted-user; sid:1069934; rev:2; metadata:created_at 2013_04_16, updated_at 2013_04_16, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Plesk Panel Possible HTTP_AUTH_LOGIN SQLi CVE-2012-1557 (attempted-user) - detector_id: 69935 original_sid: 2016792
alert http $EXTERNAL_NET any -> $HOME_NET 8880 (msg:"ET WEB_SERVER Plesk Panel Possible HTTP_AUTH_LOGIN SQLi CVE-2012-1557"; flow:established,to_server; content:"POST"; http_method; content:"/enterprise/control/agent.php"; http_uri; content:"HTTP_AUTH_LOGIN|3a|"; http_header; pcre:"/^[^\r\n]*?[\x27\x22\t\\%\x00\x08\x26]/HR"; reference:cve,CVE-2012-1557; classtype:attempted-user; sid:1069935; rev:3; metadata:created_at 2013_04_26, updated_at 2013_04_26, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER ColdFusion password.properties access (web-application-attack) - detector_id: 69936 original_sid: 2016836
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER ColdFusion password.properties access"; flow:established,to_server; content:"GET"; http_method; nocase; content:"password.properties"; http_uri; nocase; reference:url,cxsecurity.com/issue/WLB-2013050065; classtype:web-application-attack; sid:1069936; rev:3; metadata:created_at 2013_05_08, updated_at 2013_05_08, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER  ColdFusion path disclosure to get the absolute path (web-application-attack) - detector_id: 69937 original_sid: 2016841
alert http any any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER  ColdFusion path disclosure to get the absolute path"; flow:established,to_server; content:"GET"; http_method; nocase; content:"/administrator/analyzer/index.cfm"; http_uri; nocase; content:"|2e 2e 2f|"; http_raw_uri; reference:url,www.exploit-db.com/exploits/25305/; classtype:web-application-attack; sid:1069937; rev:4; metadata:created_at 2013_05_09, updated_at 2013_05_09, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER ColdFusion scheduletasks access (web-application-attack) - detector_id: 69938 original_sid: 2016842
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER ColdFusion scheduletasks access"; flow:established,to_server; content:"/CFIDE/administrator/scheduler/scheduletasks.cfm"; http_uri; nocase; reference:url,exploit-db.com/exploits/24946/; classtype:web-application-attack; sid:1069938; rev:2; metadata:created_at 2013_05_14, updated_at 2013_05_14, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER ColdFusion scheduleedit access (web-application-attack) - detector_id: 69939 original_sid: 2016843
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER ColdFusion scheduleedit access"; flow:established,to_server; content:"/CFIDE/administrator/scheduler/scheduleedit.cfm"; http_uri; nocase; reference:url,exploit-db.com/exploits/24946/; classtype:web-application-attack; sid:1069939; rev:2; metadata:created_at 2013_05_14, updated_at 2013_05_14, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Possible NGINX Overflow CVE-2013-2028 Exploit Specific (attempted-admin) - detector_id: 69941 original_sid: 2016918
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER Possible NGINX Overflow CVE-2013-2028 Exploit Specific"; flow:established,to_server; content:"chunked"; http_header; nocase; fast_pattern:only; pcre:"/Transfer-Encoding\x3a[^\r\n]*?chunked/Hi"; pcre:"/^[\r\n\s]*?[^\r\n]+HTTP\/1\.\d[^\r\n]*?\r?\n((?!(\r?\n\r?\n)).)*?Transfer-Encoding\x3a[^\r\n]*?Chunked((?!(\r?\n\r?\n)).)*?\r?\n\r?\n[\r\n\s]*?(f{6}[8-9a-f][0-9a-f]|[a-f0-9]{9})/si"; reference:url,www.vnsecurity.net/2013/05/analysis-of-nginx-cve-2013-2028/; reference:url,github.com/rapid7/metasploit-framework/blob/master/modules/exploits/linux/http/nginx_chunked_size.rb; classtype:attempted-admin; sid:1069941; rev:6; metadata:created_at 2013_05_22, updated_at 2013_05_22, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER SQL Injection Select Sleep Time Delay (web-application-attack) - detector_id: 69943 original_sid: 2016935
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER SQL Injection Select Sleep Time Delay"; flow:established,to_server; content:"SELECT"; http_uri; nocase; content:"SLEEP|28|"; http_uri; nocase; distance:0; pcre:"/\bSELECT.*?\bSLEEP\x28/Ui"; reference:url,pentestmonkey.net/cheat-sheet/sql-injection/mysql-sql-injection-cheat-sheet; classtype:web-application-attack; sid:1069943; rev:3; metadata:affected_product Web_Server_Applications, attack_target Web_Server, deployment Datacenter, tag SQL_Injection, signature_severity Major, created_at 2013_05_28, updated_at 2016_07_01, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER SQL Injection Local File Access Attempt Using LOAD_FILE (web-application-attack) - detector_id: 69944 original_sid: 2016936
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER SQL Injection Local File Access Attempt Using LOAD_FILE"; flow:established,to_server; content:"LOAD_FILE("; http_uri; nocase; fast_pattern:only; reference:url,dev.mysql.com/doc/refman/5.1/en/string-functions.html#function_load-file; reference:url,pentestmonkey.net/cheat-sheet/sql-injection/mysql-sql-injection-cheat-sheet; classtype:web-application-attack; sid:1069944; rev:2; metadata:affected_product Web_Server_Applications, attack_target Web_Server, deployment Datacenter, tag SQL_Injection, signature_severity Major, created_at 2013_05_28, updated_at 2016_07_01, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER allow_url_include PHP config option in uri (trojan-activity) - detector_id: 69945 original_sid: 2016977
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER allow_url_include PHP config option in uri"; flow:established,to_server; content:"allow_url_include"; http_uri; fast_pattern:only; pcre:"/\ballow_url_include\s*?=/U"; reference:url,seclists.org/fulldisclosure/2013/Jun/21; classtype:trojan-activity; sid:1069945; rev:3; metadata:created_at 2013_06_05, updated_at 2013_06_05, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER safe_mode PHP config option in uri (trojan-activity) - detector_id: 69946 original_sid: 2016978
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER safe_mode PHP config option in uri"; flow:established,to_server; content:"safe_mode"; http_uri; fast_pattern:only; pcre:"/\bsafe_mode\s*?=/U"; reference:url,seclists.org/fulldisclosure/2013/Jun/21; classtype:trojan-activity; sid:1069946; rev:3; metadata:created_at 2013_06_05, updated_at 2013_06_05, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER suhosin.simulation PHP config option in uri (trojan-activity) - detector_id: 69947 original_sid: 2016979
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER suhosin.simulation PHP config option in uri"; flow:established,to_server; content:"suhosin.simulation"; http_uri; fast_pattern:only; pcre:"/\bsuhosin\.simulation\s*?=/U"; reference:url,seclists.org/fulldisclosure/2013/Jun/21; classtype:trojan-activity; sid:1069947; rev:4; metadata:created_at 2013_06_05, updated_at 2013_06_05, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER disable_functions PHP config option in uri (trojan-activity) - detector_id: 69948 original_sid: 2016980
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER disable_functions PHP config option in uri"; flow:established,to_server; content:"disable_functions"; http_uri; fast_pattern:only; pcre:"/\bdisable_functions[\s\+]*?=/U"; reference:url,seclists.org/fulldisclosure/2013/Jun/21; classtype:trojan-activity; sid:1069948; rev:5; metadata:created_at 2013_06_05, updated_at 2013_06_05, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER open_basedir PHP config option in uri (trojan-activity) - detector_id: 69949 original_sid: 2016981
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER open_basedir PHP config option in uri"; flow:established,to_server; content:"open_basedir"; http_uri; fast_pattern:only; pcre:"/\bopen_basedir\s*?=/U"; reference:url,seclists.org/fulldisclosure/2013/Jun/21; classtype:trojan-activity; sid:1069949; rev:4; metadata:created_at 2013_06_05, updated_at 2013_06_05, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER auto_prepend_file PHP config option in uri (trojan-activity) - detector_id: 69950 original_sid: 2016982
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER auto_prepend_file PHP config option in uri"; flow:established,to_server; content:"auto_prepend_file"; http_uri; fast_pattern:only; pcre:"/\bauto_prepend_file\s*?=/U"; reference:url,seclists.org/fulldisclosure/2013/Jun/21; classtype:trojan-activity; sid:1069950; rev:3; metadata:created_at 2013_06_05, updated_at 2013_06_05, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Access to /phppath/php Possible Plesk 0-day Exploit June 05 2013 (attempted-admin) - detector_id: 69951 original_sid: 2016983
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER Access to /phppath/php Possible Plesk 0-day Exploit June 05 2013"; flow:established,to_server; content:"/phppath/php"; http_uri; pcre:"/\/phppath\/php\b/Ui"; reference:url,seclists.org/fulldisclosure/2013/Jun/21; classtype:attempted-admin; sid:1069951; rev:2; metadata:created_at 2013_06_05, updated_at 2013_06_05, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER WebShell Generic - *.tar.gz in POST body (bad-unknown) - detector_id: 69952 original_sid: 2016992
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER WebShell Generic - *.tar.gz in POST body"; flow:established,to_server; content:".tar.gz"; nocase; http_client_body; classtype:bad-unknown; sid:1069952; rev:2; metadata:created_at 2013_06_07, updated_at 2013_06_07, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Possible SQLi xp_cmdshell POST body (bad-unknown) - detector_id: 69953 original_sid: 2017010
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER Possible SQLi xp_cmdshell POST body"; flow:established,to_server; content:"xp_cmdshell"; nocase; http_client_body; fast_pattern:only; classtype:bad-unknown; sid:1069953; rev:3; metadata:created_at 2013_06_12, updated_at 2013_06_12, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER WebShell Generic - ELF File Uploaded (bad-unknown) - detector_id: 69954 original_sid: 2017054
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER WebShell Generic - ELF File Uploaded"; flow:established,to_server; content:"|7F|ELF"; http_client_body; classtype:bad-unknown; sid:1069954; rev:2; metadata:created_at 2013_06_21, updated_at 2013_06_21, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER WebShell - GODSpy - GOD Hacker (trojan-activity) - detector_id: 69955 original_sid: 2017083
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"ET WEB_SERVER WebShell - GODSpy - GOD Hacker"; flow:established,to_client; file_data; content:"GOD Hacker"; classtype:trojan-activity; sid:1069955; rev:2; metadata:created_at 2013_07_02, updated_at 2013_07_02, flip_endpoints True, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET WEB_SERVER WebShell - GODSpy - GODSpy title (trojan-activity) - detector_id: 69956 original_sid: 2017084
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"ET WEB_SERVER WebShell - GODSpy - GODSpy title"; flow:established,to_client; file_data; content:"GODSpy</title>"; classtype:trojan-activity; sid:1069956; rev:3; metadata:created_at 2013_07_02, updated_at 2013_07_02, flip_endpoints True, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET WEB_SERVER WebShell - GODSpy - MySQL (trojan-activity) - detector_id: 69958 original_sid: 2017086
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER WebShell - GODSpy - MySQL"; flow:established,to_server; content:"dbhost="; http_client_body; content:"dbuser="; http_client_body; content:"dbpass="; classtype:trojan-activity; sid:1069958; rev:2; metadata:created_at 2013_07_02, updated_at 2013_07_02, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER WebShell - GODSpy - Auth Prompt (trojan-activity) - detector_id: 69959 original_sid: 2017087
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"ET WEB_SERVER WebShell - GODSpy - Auth Prompt"; flow:established,to_client; file_data; content:"name=|22|haz|22| value=|22|pasa|22|>"; classtype:trojan-activity; sid:1069959; rev:3; metadata:created_at 2013_07_02, updated_at 2013_07_02, flip_endpoints True, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET WEB_SERVER WebShell - GODSPy - Auth Creds (trojan-activity) - detector_id: 69960 original_sid: 2017088
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER WebShell - GODSPy - Auth Creds"; flow:established,to_server; content:"ctr="; http_client_body; content:"haz=pasa"; http_client_body; classtype:trojan-activity; sid:1069960; rev:2; metadata:created_at 2013_07_02, updated_at 2013_07_02, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER WebShell - Pouya - Pouya_Server Shell (trojan-activity) - detector_id: 69961 original_sid: 2017089
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"ET WEB_SERVER WebShell - Pouya - Pouya_Server Shell"; flow:established,to_client; file_data; content:"Pouya_Server Shell"; classtype:trojan-activity; sid:1069961; rev:2; metadata:created_at 2013_07_02, updated_at 2013_07_02, flip_endpoints True, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET WEB_SERVER WebShell - Pouya - URI - raiz (trojan-activity) - detector_id: 69962 original_sid: 2017090
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER WebShell - Pouya - URI - raiz"; flow:established,to_server; content:".asp?raiz="; http_uri; classtype:trojan-activity; sid:1069962; rev:2; metadata:created_at 2013_07_02, updated_at 2013_07_02, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER WebShell - Pouya - URI - action= (trojan-activity) - detector_id: 69963 original_sid: 2017091
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER WebShell - Pouya - URI - action="; flow:established,to_server; content:".asp?action="; http_uri; nocase; fast_pattern:only; pcre:"/\.asp\?action=(?:txt(?:edit|view)|upload|info|del)(&|$)/Ui"; classtype:trojan-activity; sid:1069963; rev:2; metadata:created_at 2013_07_02, updated_at 2013_07_02, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER WebShell - Generic - GIF Header With HTML Form (trojan-activity) - detector_id: 69964 original_sid: 2017134
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"ET WEB_SERVER WebShell - Generic - GIF Header With HTML Form"; flow:established,to_client; file_data; content:"GIF89a"; within:6; content:"<form "; nocase; fast_pattern; within:150; content:!"_VIEWSTATE"; classtype:trojan-activity; sid:1069964; rev:5; metadata:created_at 2013_07_11, updated_at 2013_07_11, flip_endpoints True, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET WEB_SERVER CRLF Injection - Newline Characters in URL (web-application-attack) - detector_id: 69965 original_sid: 2017143
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER CRLF Injection - Newline Characters in URL"; flow:established,to_server; content:"|0D 0A|"; fast_pattern:only; http_uri; pcre:"/[\n\r](?:content-(type|length)|set-cookie|location)\x3a/Ui"; reference:url,www.owasp.org/index.php/CRLF_Injection; classtype:web-application-attack; sid:1069965; rev:3; metadata:created_at 2013_07_12, updated_at 2013_07_12, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Possible Apache Struts OGNL Command Execution CVE-2013-2251 redirectAction (attempted-user) - detector_id: 69970 original_sid: 2017175
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER Possible Apache Struts OGNL Command Execution CVE-2013-2251 redirectAction"; flow:established,to_server; content:"redirectAction|3a|"; http_client_body; content:"{"; http_client_body; pcre:"/\bredirectAction\x3a/P"; reference:url,struts.apache.org/release/2.3.x/docs/s2-016.html; classtype:attempted-user; sid:1069970; rev:5; metadata:created_at 2013_07_23, updated_at 2013_07_23, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Possible Apache Struts OGNL Command Execution CVE-2013-2251 action (attempted-user) - detector_id: 69971 original_sid: 2017176
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER Possible Apache Struts OGNL Command Execution CVE-2013-2251 action"; flow:established,to_server; content:"action|3a|"; http_client_body; content:"{"; http_client_body; distance:0; pcre:"/\baction\x3a/P"; reference:url,struts.apache.org/release/2.3.x/docs/s2-016.html; classtype:attempted-user; sid:1069971; rev:5; metadata:created_at 2013_07_23, updated_at 2013_07_23, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER WebShell ASPXShell - Title (trojan-activity) - detector_id: 69972 original_sid: 2017183
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"ET WEB_SERVER WebShell ASPXShell - Title"; flow:established,to_client; file_data; content:"<title>"; content:"ASPX Shell"; fast_pattern; nocase; content:"</title>"; distance:0; classtype:trojan-activity; sid:1069972; rev:4; metadata:created_at 2013_07_24, updated_at 2013_07_24, flip_endpoints True, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET WEB_SERVER WebShell Generic - ASP File Uploaded (trojan-activity) - detector_id: 69973 original_sid: 2017260
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER WebShell Generic - ASP File Uploaded"; flow:established,to_server; content:"|0D 0A|"; http_client_body; content:"<%"; within:5; http_client_body; fast_pattern; content:"%>"; http_client_body; distance:0; pcre:"/<%[\x00-\x7f]{20}/P"; classtype:trojan-activity; sid:1069973; rev:11; metadata:created_at 2013_07_31, updated_at 2013_07_31, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Possible Apache Struts OGNL in Dynamic Action (attempted-user) - detector_id: 69974 original_sid: 2017277
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER Possible Apache Struts OGNL in Dynamic Action"; flow:established,to_server; content:"/${"; http_uri; fast_pattern:only; pcre:"/\/\$\{[^\}\x2c]+?=/U"; reference:cve,2013-2135; reference:bugtraq,60345; reference:url,cwiki.apache.org/confluence/display/WW/S2-015; classtype:attempted-user; sid:1069974; rev:4; metadata:created_at 2013_08_06, updated_at 2013_08_06, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Possible OpenX Backdoor Backdoor Access POST to flowplayer (trojan-activity) - detector_id: 69975 original_sid: 2017280
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER Possible OpenX Backdoor Backdoor Access POST to flowplayer"; flow:established,to_server; content:"POST"; http_method; nocase; content:"/flowplayer-3.1.1.min.js"; http_uri; nocase; reference:url,blog.sucuri.net/2013/08/openx-org-compromised-and-downloads-injected-with-a-backdoor.html; classtype:trojan-activity; sid:1069975; rev:3; metadata:created_at 2013_08_06, updated_at 2013_08_06, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER - EXE File Uploaded - Hex Encoded (bad-unknown) - detector_id: 69976 original_sid: 2017293
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER - EXE File Uploaded - Hex Encoded"; flow:established,to_server; content:"4d5a"; nocase; http_client_body; content:"50450000"; distance:0; http_client_body; classtype:bad-unknown; sid:1069976; rev:2; metadata:created_at 2013_08_06, updated_at 2013_08_06, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Joomla Upload File Filter Bypass (attempted-user) - detector_id: 69977 original_sid: 2017327
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER Joomla Upload File Filter Bypass"; flow:established,to_server; content:"option=com_media"; http_uri; nocase; fast_pattern:only; content:"Filedata[]"; http_client_body; nocase; pcre:"/filename[\r\n\s]*?=[\r\n\s]*?[\x22\x27]?[^\r\n\x22\x27\x3b]+?\.[\r\n\x3b\x22\x27]/Pi"; classtype:attempted-user; sid:1069977; rev:2; metadata:created_at 2013_08_14, updated_at 2013_08_14, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER SQLi - SELECT and sysobject (attempted-admin) - detector_id: 69978 original_sid: 2017330
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER SQLi - SELECT and sysobject"; flow:established,to_server; content:"SELECT"; nocase; content:"sysobjects"; distance:0; nocase; classtype:attempted-admin; sid:1069978; rev:2; metadata:created_at 2013_08_14, updated_at 2013_08_14, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER ATTACKER SQLi - SELECT and Schema Columns (attempted-user) - detector_id: 69979 original_sid: 2017337
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER ATTACKER SQLi - SELECT and Schema Columns"; flow:established,to_server; content:"SELECT"; nocase; content:"information_schema.columns"; distance:0; nocase; classtype:attempted-user; sid:1069979; rev:2; metadata:created_at 2013_08_19, updated_at 2013_08_19, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Coldfusion 9 Auth Bypass CVE-2013-0632 (attempted-user) - detector_id: 69980 original_sid: 2017366
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER Coldfusion 9 Auth Bypass CVE-2013-0632"; flow:to_server; content:"POST"; http_method; content:"/adminapi/administrator.cfc?"; http_uri; nocase; content:"method"; http_uri; nocase; content:"login"; http_uri; nocase; content:"rdsPasswordAllowed"; nocase; http_client_body; fast_pattern:only; pcre:"/rdsPasswordAllowed[\r\n\s]*?=[\r\n\s]*?(true|1)/Pi"; reference:url,www.exploit-db.com/exploits/27755/; reference:cve,2013-0632; classtype:attempted-user; sid:1069980; rev:2; metadata:created_at 2013_08_21, updated_at 2013_08_21, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER WebShell - ASPyder - Auth Creds (trojan-activity) - detector_id: 69981 original_sid: 2017389
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER WebShell - ASPyder - Auth Creds"; flow:established,to_server; content:!"&date="; http_client_body; content:"code="; http_client_body; depth:5; content:"&submit="; distance:0; http_client_body; classtype:trojan-activity; sid:1069981; rev:6; metadata:created_at 2013_08_28, updated_at 2013_08_28, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER WebShell - ASPyder - File Browser - Interface (trojan-activity) - detector_id: 69982 original_sid: 2017390
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"ET WEB_SERVER WebShell - ASPyder - File Browser - Interface"; flow:established,to_client; file_data; content:"document.myform.txtpath.value"; classtype:trojan-activity; sid:1069982; rev:3; metadata:created_at 2013_08_28, updated_at 2013_08_28, flip_endpoints True, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET WEB_SERVER WebShell - ASPyder - Auth Prompt (trojan-activity) - detector_id: 69983 original_sid: 2017391
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"ET WEB_SERVER WebShell - ASPyder - Auth Prompt"; flow:established,to_client; file_data; content:"<INPUT type=password name=code >"; classtype:trojan-activity; sid:1069983; rev:2; metadata:created_at 2013_08_28, updated_at 2013_08_28, flip_endpoints True, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET WEB_SERVER WebShell - ASPyder - File Browser - POST Structure (trojan-activity) - detector_id: 69984 original_sid: 2017392
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER WebShell - ASPyder - File Browser - POST Structure"; flow:established,to_server; content:"POST"; http_method; nocase; content:"txtpath="; http_client_body; depth:8; content:"&cmd="; http_client_body; classtype:trojan-activity; sid:1069984; rev:2; metadata:created_at 2013_08_28, updated_at 2013_08_28, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER WebShell - ASPyder -File Upload - POST Structure (trojan-activity) - detector_id: 69985 original_sid: 2017393
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER WebShell - ASPyder -File Upload - POST Structure"; flow:established,to_server; content:"POST"; http_method; nocase; content:"?upload=@&txtpath="; http_uri; content:"Upload !"; http_client_body; classtype:trojan-activity; sid:1069985; rev:2; metadata:created_at 2013_08_28, updated_at 2013_08_28, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER WebShell - ASPyder - File Upload - Response (trojan-activity) - detector_id: 69986 original_sid: 2017394
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"ET WEB_SERVER WebShell - ASPyder - File Upload - Response"; flow:established,to_client; file_data; content:"<title>ASPYDrvsInfo</title>"; classtype:trojan-activity; sid:1069986; rev:2; metadata:created_at 2013_08_28, updated_at 2013_08_28, flip_endpoints True, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET WEB_SERVER PHP SERVER SuperGlobal in URI (bad-unknown) - detector_id: 69992 original_sid: 2017436
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER PHP SERVER SuperGlobal in URI"; flow:established,to_server; content:"_SERVER["; fast_pattern:only; http_uri; pcre:"/[&\?]_SERVER\[[^\]]+?\][^=]*?=/U"; reference:url,imperva.com/download.asp?id=421; classtype:bad-unknown; sid:1069992; rev:2; metadata:created_at 2013_09_10, updated_at 2013_09_10, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER PHP GET SuperGlobal in URI (bad-unknown) - detector_id: 69993 original_sid: 2017437
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER PHP GET SuperGlobal in URI"; flow:established,to_server; content:"_GET["; fast_pattern:only; http_uri; pcre:"/[&\?]_GET\[[^\]]+?\][^=]*?=/U"; reference:url,imperva.com/download.asp?id=421; classtype:bad-unknown; sid:1069993; rev:2; metadata:created_at 2013_09_10, updated_at 2013_09_10, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER PHP POST SuperGlobal in URI (bad-unknown) - detector_id: 69994 original_sid: 2017438
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER PHP POST SuperGlobal in URI"; flow:established,to_server; content:"_POST["; fast_pattern:only; http_uri; pcre:"/[&\?]_POST\[[^\]]+?\][^=]*?=/U"; reference:url,imperva.com/download.asp?id=421; classtype:bad-unknown; sid:1069994; rev:2; metadata:created_at 2013_09_10, updated_at 2013_09_10, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER PHP COOKIE SuperGlobal in URI (bad-unknown) - detector_id: 69995 original_sid: 2017439
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER PHP COOKIE SuperGlobal in URI"; flow:established,to_server; content:"_COOKIE["; fast_pattern:only; http_uri; pcre:"/[&\?]_COOKIE\[[^\]]+?\][^=]*?=/U"; reference:url,imperva.com/download.asp?id=421; classtype:bad-unknown; sid:1069995; rev:2; metadata:created_at 2013_09_10, updated_at 2013_09_10, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER PHP SESSION SuperGlobal in URI (bad-unknown) - detector_id: 69996 original_sid: 2017440
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER PHP SESSION SuperGlobal in URI"; flow:established,to_server; content:"_SESSION["; fast_pattern:only; http_uri; pcre:"/[&\?]_SESSION\[[^\]]+?\][^=]*?=/U"; reference:url,imperva.com/download.asp?id=421; classtype:bad-unknown; sid:1069996; rev:2; metadata:created_at 2013_09_10, updated_at 2013_09_10, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER PHP REQUEST SuperGlobal in URI (bad-unknown) - detector_id: 69997 original_sid: 2017441
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER PHP REQUEST SuperGlobal in URI"; flow:established,to_server; content:"_REQUEST["; fast_pattern:only; http_uri; pcre:"/[&\?]_REQUEST\[[^\]]+?\][^=]*?=/U"; reference:url,imperva.com/download.asp?id=421; classtype:bad-unknown; sid:1069997; rev:2; metadata:created_at 2013_09_10, updated_at 2013_09_10, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER PHP ENV SuperGlobal in URI (bad-unknown) - detector_id: 69998 original_sid: 2017442
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER PHP ENV SuperGlobal in URI"; flow:established,to_server; content:"_ENV["; fast_pattern:only; http_uri; pcre:"/[&\?]_ENV\[[^\]]+?\][^=]*?=/U"; reference:url,imperva.com/download.asp?id=421; classtype:bad-unknown; sid:1069998; rev:2; metadata:created_at 2013_09_10, updated_at 2013_09_10, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER PHP SERVER SuperGlobal in POST (bad-unknown) - detector_id: 69999 original_sid: 2017443
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER PHP SERVER SuperGlobal in POST"; flow:established,to_server; content:"_SERVER["; fast_pattern:only; http_client_body; pcre:"/(?:[&\?\r\n]|^)_SERVER\[[^\]]+?\][^=]*?=/P"; reference:url,imperva.com/download.asp?id=421; classtype:bad-unknown; sid:1069999; rev:2; metadata:created_at 2013_09_10, updated_at 2013_09_10, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER PHP GET SuperGlobal in POST (bad-unknown) - detector_id: 70000 original_sid: 2017444
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER PHP GET SuperGlobal in POST"; flow:established,to_server; content:"_GET["; fast_pattern:only; http_client_body; pcre:"/(?:[&\?\r\n]|^)_GET\[[^\]]+?\][^=]*?=/P"; reference:url,imperva.com/download.asp?id=421; classtype:bad-unknown; sid:1070000; rev:2; metadata:created_at 2013_09_10, updated_at 2013_09_10, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER PHP POST SuperGlobal in POST (bad-unknown) - detector_id: 70001 original_sid: 2017445
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER PHP POST SuperGlobal in POST"; flow:established,to_server; content:"_POST["; fast_pattern:only; http_client_body; pcre:"/(?:[&\?\r\n]|^)_POST\[[^\]]+?\][^=]*?=/P"; reference:url,imperva.com/download.asp?id=421; classtype:bad-unknown; sid:1070001; rev:2; metadata:created_at 2013_09_10, updated_at 2013_09_10, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER PHP COOKIE SuperGlobal in POST (bad-unknown) - detector_id: 70002 original_sid: 2017446
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER PHP COOKIE SuperGlobal in POST"; flow:established,to_server; content:"_COOKIE["; fast_pattern:only; http_client_body; pcre:"/[&\?]_COOKIE\[[^\]]+?\][^=]*?=/P"; reference:url,imperva.com/download.asp?id=421; classtype:bad-unknown; sid:1070002; rev:2; metadata:created_at 2013_09_10, updated_at 2013_09_10, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER PHP SESSION SuperGlobal in POST (bad-unknown) - detector_id: 70003 original_sid: 2017447
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER PHP SESSION SuperGlobal in POST"; flow:established,to_server; content:"_SESSION["; fast_pattern:only; http_client_body; pcre:"/[&\?]_SESSION\[[^\]]+?\][^=]*?=/P"; reference:url,imperva.com/download.asp?id=421; classtype:bad-unknown; sid:1070003; rev:2; metadata:created_at 2013_09_10, updated_at 2013_09_10, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER PHP REQUEST SuperGlobal in POST (bad-unknown) - detector_id: 70004 original_sid: 2017448
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER PHP REQUEST SuperGlobal in POST"; flow:established,to_server; content:"_REQUEST["; fast_pattern:only; http_client_body; pcre:"/[&\?]_REQUEST\[[^\]]+?\][^=]*?=/P"; reference:url,imperva.com/download.asp?id=421; classtype:bad-unknown; sid:1070004; rev:2; metadata:created_at 2013_09_10, updated_at 2013_09_10, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER PHP ENV SuperGlobal in POST (bad-unknown) - detector_id: 70005 original_sid: 2017449
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER PHP ENV SuperGlobal in POST"; flow:established,to_server; content:"_ENV["; fast_pattern:only; http_client_body; pcre:"/[&\?]_ENV\[[^\]]+?\][^=]*?=/P"; reference:url,imperva.com/download.asp?id=421; classtype:bad-unknown; sid:1070005; rev:2; metadata:created_at 2013_09_10, updated_at 2013_09_10, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER UA WordPress probable DDOS-Attack (bad-unknown) - detector_id: 70006 original_sid: 2017528
alert http any any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER UA WordPress probable DDOS-Attack"; flow:established,to_server; content:"Wordpress/"; http_user_agent; depth:10; metadata:former_category WEB_SERVER, flip_endpoints False, server_side True; reference:url,thehackernews.com/2013/09/thousands-of-wordpress-blogs.html; reference:url,pastebin.com/NP64hTQr; classtype:bad-unknown; sid:1070006; rev:5; metadata:affected_product Wordpress, affected_product Wordpress_Plugins, attack_target Web_Server, deployment Datacenter, tag Wordpress, signature_severity Major, created_at 2013_09_30, updated_at 2017_05_11; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER PHP WebShell Embedded In GIF (OUTBOUND) (successful-admin) - detector_id: 70007 original_sid: 2017604
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"ET WEB_SERVER PHP WebShell Embedded In GIF (OUTBOUND)"; flow:established,to_client; file_data; content:"GIF89"; within:5; content:"<?php"; fast_pattern; distance:0; reference:url,blog.spiderlabs.com/2013/10/hiding-webshell-backdoor-code-in-image-files.html; classtype:successful-admin; sid:1070007; rev:2; metadata:created_at 2013_10_17, updated_at 2013_10_17, flip_endpoints True, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET WEB_SERVER PHP WebShell Embedded In JPG (OUTBOUND) (successful-admin) - detector_id: 70008 original_sid: 2017605
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"ET WEB_SERVER PHP WebShell Embedded In JPG (OUTBOUND)"; flow:established,to_client; file_data; content:"JFIF|00|"; distance:6; within:5; content:"<?php"; fast_pattern; distance:0; reference:url,blog.spiderlabs.com/2013/10/hiding-webshell-backdoor-code-in-image-files.html; classtype:successful-admin; sid:1070008; rev:2; metadata:created_at 2013_10_17, updated_at 2013_10_17, flip_endpoints True, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET WEB_SERVER PHP WebShell Embedded In PNG (OUTBOUND) (successful-admin) - detector_id: 70009 original_sid: 2017606
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"ET WEB_SERVER PHP WebShell Embedded In PNG (OUTBOUND)"; flow:established,to_client; file_data; content:"PNG|0D 0A 1A 0A|"; distance:1; within:7; content:"<?php"; fast_pattern; distance:0; reference:url,blog.spiderlabs.com/2013/10/hiding-webshell-backdoor-code-in-image-files.html; classtype:successful-admin; sid:1070009; rev:2; metadata:created_at 2013_10_17, updated_at 2013_10_17, flip_endpoints True, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET WEB_SERVER Possible Encrypted Webshell in POST (bad-unknown) - detector_id: 70014 original_sid: 2017641
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER Possible Encrypted Webshell in POST"; flow:established,to_server; content:"POST"; http_method; content:"eval"; http_client_body; content:"mcrypt_decrypt"; http_client_body; distance:0; reference:url,blog.sucuri.net/2013/10/backdoor-evasion-using-encrypted-content.html; classtype:bad-unknown; sid:1070014; rev:3; metadata:created_at 2013_10_28, updated_at 2013_10_28, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Possible SUPERMICRO IPMI login.cgi Name Parameter Buffer Overflow Attempt CVE-2013-3621 (attempted-admin) - detector_id: 70015 original_sid: 2017684
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_SERVER Possible SUPERMICRO IPMI login.cgi Name Parameter Buffer Overflow Attempt CVE-2013-3621"; flow:established,to_server; content:"POST"; http_method; nocase; content:"/cgi/login.cgi"; http_uri; nocase; content:"name="; nocase; http_client_body; content:"pwd="; http_client_body; nocase; pcre:"/(?:^|[\n\&])pwd=/Pi"; pcre:"/(?:^|[\n\&])name=(?:%\d{2}|[^%&]){129}/Pi"; reference:cve,CVE-2013-3621; reference:url,community.rapid7.com/community/metasploit/blog/2013/11/06/supermicro-ipmi-firmware-vulnerabilities; classtype:attempted-admin; sid:1070015; rev:2; metadata:created_at 2013_11_07, updated_at 2013_11_07, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Possible SUPERMICRO IPMI login.cgi PWD Parameter Buffer Overflow Attempt CVE-2013-3621 (attempted-admin) - detector_id: 70016 original_sid: 2017685
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_SERVER Possible SUPERMICRO IPMI login.cgi PWD Parameter Buffer Overflow Attempt CVE-2013-3621"; flow:established,to_server; content:"POST"; http_method; nocase; content:"/cgi/login.cgi"; http_uri; nocase; content:"name="; http_client_body; nocase; content:"pwd="; http_client_body; nocase; pcre:"/(?:^|[\n\&])name=/Pi"; pcre:"/(?:^|[\n\&])pwd=(?:%\d{2}|[^%&]){25}/Pi"; reference:cve,CVE-2013-3621; reference:url,community.rapid7.com/community/metasploit/blog/2013/11/06/supermicro-ipmi-firmware-vulnerabilities; classtype:attempted-admin; sid:1070016; rev:2; metadata:created_at 2013_11_07, updated_at 2013_11_07, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Possible SUPERMICRO IPMI close_window.cgi sess_sid Parameter Buffer Overflow Attempt CVE-2013-3623 (attempted-admin) - detector_id: 70017 original_sid: 2017686
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_SERVER Possible SUPERMICRO IPMI close_window.cgi sess_sid Parameter Buffer Overflow Attempt CVE-2013-3623"; flow:established,to_server; content:"POST"; http_method; nocase; content:"/cgi/close_window.cgi"; http_uri; nocase; content:"sess_sid="; http_client_body; nocase; pcre:"/(?:^|[\n\&])sess_sid=(?:%\d{2}|[^%&]){21}/P"; reference:cve,CVE-2013-3623; reference:url,community.rapid7.com/community/metasploit/blog/2013/11/06/supermicro-ipmi-firmware-vulnerabilities; classtype:attempted-admin; sid:1070017; rev:2; metadata:created_at 2013_11_07, updated_at 2013_11_07, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Possible SUPERMICRO IPMI close_window.cgi ACT Parameter Buffer Overflow Attempt CVE-2013-3623 (attempted-admin) - detector_id: 70018 original_sid: 2017687
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_SERVER Possible SUPERMICRO IPMI close_window.cgi ACT Parameter Buffer Overflow Attempt CVE-2013-3623"; flow:established,to_server; content:"POST"; http_method; nocase; content:"/cgi/close_window.cgi"; http_uri; nocase; content:"ACT="; http_client_body; nocase; pcre:"/(?:^|[\n\&])ACT=(?:%\d{2}|[^%&]){21}/Pi"; reference:cve,CVE-2013-3623; reference:url,community.rapid7.com/community/metasploit/blog/2013/11/06/supermicro-ipmi-firmware-vulnerabilities; classtype:attempted-admin; sid:1070018; rev:2; metadata:created_at 2013_11_07, updated_at 2013_11_07, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Possible SUPERMICRO IPMI url_redirect.cgi Directory Traversal Attempt (attempted-admin) - detector_id: 70019 original_sid: 2017688
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_SERVER Possible SUPERMICRO IPMI url_redirect.cgi Directory Traversal Attempt"; flow:established,to_server; content:"GET"; http_method; nocase; content:"/cgi/url_redirect.cgi"; http_uri; nocase; content:"|2e 2e 2f|"; http_raw_uri; reference:url,community.rapid7.com/community/metasploit/blog/2013/11/06/supermicro-ipmi-firmware-vulnerabilities; classtype:attempted-admin; sid:1070019; rev:2; metadata:created_at 2013_11_07, updated_at 2013_11_07, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER WEBSHELL pwn.jsp shell (attempted-admin) - detector_id: 70020 original_sid: 2017734
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER WEBSHELL pwn.jsp shell"; flow:established,to_server; content:"/pwn.jsp?"; http_uri; nocase; fast_pattern:only; content:"cmd="; http_uri; nocase; reference:url,nickhumphreyit.blogspot.co.il/2013/10/jboss-42-hacked-by-pwnjsp.html; reference:url,blog.imperva.com/2013/11/threat-advisory-a-jboss-as-exploit-web-shell-code-injection.html; classtype:attempted-admin; sid:1070020; rev:4; metadata:created_at 2013_11_19, updated_at 2013_11_19, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Possible WebLogic Admin Login With Default Creds (attempted-admin) - detector_id: 70021 original_sid: 2017803
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_SERVER Possible WebLogic Admin Login With Default Creds"; flow:to_server,established; content:"POST"; nocase; http_method; content:"/console/j_security_check"; http_uri; nocase; content:"j_username=system"; http_client_body; nocase; content:"j_password=Passw0rd"; http_client_body; reference:url,media.blackhat.com/us-13/US-13-Polyakov-Practical-Pentesting-of-ERPs-and-Business-Applications-Slides.pdf; classtype:attempted-admin; sid:1070021; rev:4; metadata:created_at 2013_12_06, updated_at 2013_12_06, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Possible WebLogic Admin Login With Default Creds (attempted-admin) - detector_id: 70022 original_sid: 2017804
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_SERVER Possible WebLogic Admin Login With Default Creds"; flow:to_server,established; content:"POST"; nocase; http_method; content:"/console/j_security_check"; http_uri; nocase; content:"j_username=system"; http_client_body; content:"j_password=password"; http_client_body; reference:url,media.blackhat.com/us-13/US-13-Polyakov-Practical-Pentesting-of-ERPs-and-Business-Applications-Slides.pdf; classtype:attempted-admin; sid:1070022; rev:3; metadata:created_at 2013_12_06, updated_at 2013_12_06, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Possible WebLogic Monitor Login With Default Creds (attempted-user) - detector_id: 70023 original_sid: 2017805
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_SERVER Possible WebLogic Monitor Login With Default Creds"; flow:to_server,established; content:"POST"; nocase; http_method; content:"/console/j_security_check"; http_uri; nocase; content:"j_username=monitor"; http_client_body; content:"j_password=password"; http_client_body; reference:url,media.blackhat.com/us-13/US-13-Polyakov-Practical-Pentesting-of-ERPs-and-Business-Applications-Slides.pdf; classtype:attempted-user; sid:1070023; rev:3; metadata:created_at 2013_12_06, updated_at 2013_12_06, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Possible WebLogic Operator Login With Default Creds (attempted-user) - detector_id: 70024 original_sid: 2017806
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_SERVER Possible WebLogic Operator Login With Default Creds"; flow:to_server,established; content:"POST"; nocase; http_method; content:"/console/j_security_check"; http_uri; nocase; content:"j_username=operator"; http_client_body; content:"j_password=password"; http_client_body; reference:url,media.blackhat.com/us-13/US-13-Polyakov-Practical-Pentesting-of-ERPs-and-Business-Applications-Slides.pdf; classtype:attempted-user; sid:1070024; rev:2; metadata:created_at 2013_12_06, updated_at 2013_12_06, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Possible MySQL SQLi User-Dump Attempt (web-application-attack) - detector_id: 70025 original_sid: 2017807
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_SERVER Possible MySQL SQLi User-Dump Attempt"; flow:to_server,established; content:"select"; nocase; http_uri; content:"mysql.user"; http_uri; nocase; distance:1; reference:url,pentestmonkey.net/cheat-sheet/sql-injection/mysql-sql-injection-cheat-sheet; classtype:web-application-attack; sid:1070025; rev:3; metadata:created_at 2013_12_06, updated_at 2013_12_06, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Possible MySQL SQLi Attempt Information Schema Access (web-application-attack) - detector_id: 70026 original_sid: 2017808
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_SERVER Possible MySQL SQLi Attempt Information Schema Access"; flow:to_server,established; content:"information_schema"; nocase; http_uri; reference:url,pentestmonkey.net/cheat-sheet/sql-injection/mysql-sql-injection-cheat-sheet; classtype:web-application-attack; sid:1070026; rev:2; metadata:created_at 2013_12_06, updated_at 2013_12_06, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER IIS ISN BackDoor Command GetLog (trojan-activity) - detector_id: 70027 original_sid: 2017820
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_SERVER IIS ISN BackDoor Command GetLog"; flow:established,to_server; content:"isn_getlog"; http_uri; nocase; fast_pattern:only; pcre:"/[?&]isn_getlog/Ui"; reference:url,blog.spiderlabs.com/2013/12/the-curious-case-of-the-malicious-iis-module.html; classtype:trojan-activity; sid:1070027; rev:5; metadata:created_at 2013_12_09, updated_at 2013_12_09, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER IIS ISN BackDoor Command Delete Log (trojan-activity) - detector_id: 70028 original_sid: 2017821
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER IIS ISN BackDoor Command Delete Log"; flow:established,to_server; content:"isn_logdel"; http_uri; nocase; fast_pattern:only; pcre:"/[?&]isn_logdel/Ui"; reference:url,blog.spiderlabs.com/2013/12/the-curious-case-of-the-malicious-iis-module.html; classtype:trojan-activity; sid:1070028; rev:6; metadata:created_at 2013_12_09, updated_at 2013_12_09, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER IIS ISN BackDoor Command Get Logpath (trojan-activity) - detector_id: 70029 original_sid: 2017822
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER IIS ISN BackDoor Command Get Logpath"; flow:established,to_server; content:"isn_logpath"; http_uri; nocase; fast_pattern:only; pcre:"/[?&]isn_logpath/Ui"; reference:url,blog.spiderlabs.com/2013/12/the-curious-case-of-the-malicious-iis-module.html; classtype:trojan-activity; sid:1070029; rev:6; metadata:created_at 2013_12_09, updated_at 2013_12_09, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Coldfusion cfcexplorer Directory Traversal (attempted-user) - detector_id: 70038 original_sid: 2017875
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER Coldfusion cfcexplorer Directory Traversal"; flow:established,to_server; content:"/cfcexplorer.cfc"; nocase; http_uri; fast_pattern:only; content:"path="; nocase; pcre:"/^[^&]*?(?:%(?:25)?2e(?:%(?:(?:25)?2e(?:%(?:25)?5c|\/|\\)|2e(?:25)?%(?:25)?2f)|\.(?:%(?:25)?(?:2f|5c)|\/|\\))|\.(?:%(?:25)?2e(?:%(?:25)?(?:2f|5c)|\/|\\)|\.(?:%(?:25)?(?:2f|5c)|\/|\\)))/Ri"; reference:url,blog.spiderlabs.com/2013/12/the-curious-case-of-the-malicious-iis-module-prologue-method-of-entry-analysis.html; classtype:attempted-user; sid:1070038; rev:2; metadata:created_at 2013_12_16, updated_at 2013_12_16, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Apache Solr Arbitrary XSLT inclusion attack (attempted-user) - detector_id: 70039 original_sid: 2017882
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER Apache Solr Arbitrary XSLT inclusion attack"; flow:to_server,established; content:"../../"; fast_pattern:only; content:"&wt=xslt"; nocase; content:"&tr="; reference:cve,CVE-2013-6397; reference:url,www.agarri.fr/kom/archives/2013/11/27/compromising_an_unreachable_solr_server_with_cve-2013-6397/index.html; classtype:attempted-user; sid:1070039; rev:2; metadata:created_at 2013_12_17, updated_at 2013_12_17, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER ATTACKER WebShell - PHP Offender - Title (web-application-attack) - detector_id: 70040 original_sid: 2017951
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"ET WEB_SERVER ATTACKER WebShell - PHP Offender - Title"; flow:established,to_client; file_data; content:"<title>PHP Shell offender</title>"; nocase; classtype:web-application-attack; sid:1070040; rev:3; metadata:created_at 2014_01_10, updated_at 2014_01_10, flip_endpoints True, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET WEB_SERVER ATTACKER WebShell - PHP Offender - POST Command (web-application-attack) - detector_id: 70041 original_sid: 2017952
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER ATTACKER WebShell - PHP Offender - POST Command"; flow:established,to_server; content:"work_dir="; http_client_body; content:"command="; http_client_body; content:"submit_btn=Execute+Command"; http_client_body; classtype:web-application-attack; sid:1070041; rev:2; metadata:created_at 2014_01_10, updated_at 2014_01_10, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Possible XXE SYSTEM ENTITY in POST BODY. (trojan-activity) - detector_id: 70042 original_sid: 2018056
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER Possible XXE SYSTEM ENTITY in POST BODY."; flow:established,to_server; content:"DOCTYPE"; http_client_body; nocase; fast_pattern:only; content:"SYSTEM"; nocase; http_client_body; content:"ENTITY"; nocase; pcre:"/^\s+?[^\s\>]+?\s+?SYSTEM\s/Ri"; classtype:trojan-activity; sid:1070042; rev:2; metadata:created_at 2014_02_03, updated_at 2014_02_03, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Possible Oracle Reports Forms RCE CVE-2012-3152 (web-application-attack) - detector_id: 70043 original_sid: 2018092
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER Possible Oracle Reports Forms RCE CVE-2012-3152"; flow:established,to_server; content:"/reports/rwservlet?"; http_uri; nocase; content:"JOBTYPE"; http_uri; nocase; content:"rwurl"; nocase; http_uri; content:"URLPARAMETER"; http_uri; nocase; pcre:"/URLPARAMETER\s*?=\s*?[\x22\x27]?(?:f(?:ile|tp)|gopher|https?|mailto)\s*?\x3a/Ui"; reference:url,netinfiltration.com; classtype:web-application-attack; sid:1070043; rev:2; metadata:created_at 2014_02_06, updated_at 2014_02_06, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Oracle Reports Parse Query Returned Creds CVE-2012-3153 (web-application-attack) - detector_id: 70044 original_sid: 2018093
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"ET WEB_SERVER Oracle Reports Parse Query Returned Creds CVE-2012-3153"; flow:established,to_client; file_data; content:"Result Reports Server Command"; content:"userid="; distance:0; content:"/"; distance:0; content:"@"; distance:0; reference:url,netinfiltration.com; classtype:web-application-attack; sid:1070044; rev:2; metadata:created_at 2014_02_06, updated_at 2014_02_06, flip_endpoints True, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET WEB_SERVER Apache Tomcat Boundary Overflow DOS/File Upload Attempt (web-application-attack) - detector_id: 70045 original_sid: 2018113
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER Apache Tomcat Boundary Overflow DOS/File Upload Attempt"; flow:established,to_server; content:"POST"; http_method; content:"multipart/form-data"; http_header; fast_pattern:only; content:"Content-Type|3A|"; nocase; pcre:"/^[^\r\n]*?boundary\s*?=\s*?[^\r\n]/Ri"; isdataat:4091,relative; content:!"|0A|"; within:4091; reference:url,blog.spiderlabs.com/2014/02/cve-2014-0050-exploit-with-boundaries-loops-without-boundaries.html; reference:cve,2014-0050; classtype:web-application-attack; sid:1070045; rev:2; metadata:created_at 2014_02_12, updated_at 2014_02_12, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Recon-ng User-Agent (attempted-recon) - detector_id: 70046 original_sid: 2018118
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER Recon-ng User-Agent"; flow:established,to_server; content:"Recon-ng"; http_user_agent; reference:url,itbucket.org/LaNMaSteR53/recon-ng/overview; classtype:attempted-recon; sid:1070046; rev:3; metadata:created_at 2014_02_12, updated_at 2014_02_12, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER log4jAdmin access from non-local network (can modify logging levels) (web-application-activity) - detector_id: 70047 original_sid: 2018202
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER log4jAdmin access from non-local network (can modify logging levels)"; flow:established,to_server; content:"/log4jAdmin.jsp"; http_uri; fast_pattern:only; reference:url, gist.github.com/iamkristian/943918; classtype:web-application-activity; sid:1070047; rev:2; metadata:created_at 2014_03_03, updated_at 2014_03_03, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER log4jAdmin access from non-local network Page Body (can modify logging levels) (web-application-activity) - detector_id: 70048 original_sid: 2018203
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"ET WEB_SERVER log4jAdmin access from non-local network Page Body (can modify logging levels)"; flow:established,from_server; file_data; content:"<title>Log4J Administration</title>"; fast_pattern:only; content:"Change Log Level To"; reference:url, gist.github.com/iamkristian/943918; classtype:web-application-activity; sid:1070048; rev:2; metadata:created_at 2014_03_03, updated_at 2014_03_03, flip_endpoints True, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET WEB_SERVER WEBSHELL CFM Shell Access (successful-admin) - detector_id: 70049 original_sid: 2018290
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"ET WEB_SERVER WEBSHELL CFM Shell Access"; flow:established,from_server; file_data; content:"<title>CFM shell"; nocase; reference:url,blog.spiderlabs.com/2014/03/coldfusion-admin-compromise-analysis-cve-2010-2861.html; classtype:successful-admin; sid:1070049; rev:2; metadata:created_at 2014_03_18, updated_at 2014_03_18, flip_endpoints True, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET WEB_SERVER WEBSHELL K-Shell/ZHC Shell 1.0/Aspx Shell Backdoor NetCat_Listener (web-application-attack) - detector_id: 70050 original_sid: 2018369
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"ET WEB_SERVER WEBSHELL K-Shell/ZHC Shell 1.0/Aspx Shell Backdoor NetCat_Listener"; flow:established,from_server; file_data; content:"Silentz's Tricks:"; content:"action=cmd2"; content:"Start NC"; reference:url,www.fidelissecurity.com/webfm_send/377; reference:url,pastebin.com/XAG1Hnfd; classtype:web-application-attack; sid:1070050; rev:2; metadata:created_at 2014_04_07, updated_at 2014_04_07, flip_endpoints True, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET WEB_SERVER ATTACKER WebShell - Zehir4.asp (web-application-attack) - detector_id: 70051 original_sid: 2018370
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER ATTACKER WebShell - Zehir4.asp"; flow:established,to_server; content:".asp?mevla=1"; http_uri; nocase; fast_pattern:only; reference:url,pastebin.com/m44e60e60; reference:url,www.fidelissecurity.com/webfm_send/377; classtype:web-application-attack; sid:1070051; rev:4; metadata:created_at 2014_04_07, updated_at 2014_04_07, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER ATTACKER WebShell - Zehir4.asp - content (web-application-attack) - detector_id: 70052 original_sid: 2018371
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"ET WEB_SERVER ATTACKER WebShell - Zehir4.asp - content"; flow:established,from_server; file_data; content:"<title>zehir3--> powered by zehir"; content:"Sistem Bilgileri"; content:"color=red>Local Adres</td"; content:"zehirhacker"; reference:url,pastebin.com/m44e60e60; reference:url,www.fidelissecurity.com/webfm_send/377; classtype:web-application-attack; sid:1070052; rev:2; metadata:created_at 2014_04_07, updated_at 2014_04_07, flip_endpoints True, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET WEB_SERVER SUSPICIOUS Possible WebShell Login Form (Outbound) (trojan-activity) - detector_id: 70053 original_sid: 2018459
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"ET WEB_SERVER SUSPICIOUS Possible WebShell Login Form (Outbound)"; flow:established,from_server; file_data; content:"<pre align=center><form method=post>Password|3a| <input type=password name=pass><input type=submit value=|27|>>|27|></form></pre>"; within:120; isdataat:!2,relative; reference:url,blog.malwaremustdie.org/2014/05/elf-shared-so-dynamic-library-malware.html; classtype:trojan-activity; sid:1070053; rev:2; metadata:created_at 2014_05_09, updated_at 2014_05_09, flip_endpoints True, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET WEB_SERVER Possible CVE-2014-3120 Elastic Search Remote Code Execution Attempt (attempted-admin) - detector_id: 70054 original_sid: 2018495
alert http $EXTERNAL_NET any -> $HOME_NET [9200,9292] (msg:"ET WEB_SERVER Possible CVE-2014-3120 Elastic Search Remote Code Execution Attempt"; flow:established,to_server; content:"search"; http_uri; nocase; content:"source="; nocase; distance:0; http_uri; content:"script_fields"; http_uri; nocase; distance:0; content:"import"; distance:0; http_uri; nocase; content:"java."; http_uri; nocase; distance:0; reference:url,bouk.co/blog/elasticsearch-rce/; classtype:attempted-admin; sid:1070054; rev:3; metadata:created_at 2014_05_21, updated_at 2014_05_21, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER c99 Shell Backdoor Var Override URI (trojan-activity) - detector_id: 70055 original_sid: 2018601
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_SERVER c99 Shell Backdoor Var Override URI"; flow:to_server,established; content:"c99shcook["; nocase; http_uri; fast_pattern:only; pcre:"/[&?]c99shcook\[/Ui"; reference:url,thehackerblog.com/every-c99-php-shell-is-backdoored-aka-free-shells/; classtype:trojan-activity; sid:1070055; rev:2; metadata:created_at 2014_06_24, updated_at 2014_06_24, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER c99 Shell Backdoor Var Override Cookie (trojan-activity) - detector_id: 70056 original_sid: 2018602
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_SERVER c99 Shell Backdoor Var Override Cookie"; flow:to_server,established; content:"c99shcook"; nocase; fast_pattern:only; pcre:"/c99shcook/Ci"; reference:url,thehackerblog.com/every-c99-php-shell-is-backdoored-aka-free-shells/; classtype:trojan-activity; sid:1070056; rev:2; metadata:created_at 2014_06_24, updated_at 2014_06_24, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER c99 Shell Backdoor Var Override Client Body (trojan-activity) - detector_id: 70057 original_sid: 2018603
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_SERVER c99 Shell Backdoor Var Override Client Body"; flow:to_server,established; content:"c99shcook["; nocase; fast_pattern:only; http_client_body; pcre:"/(?:^|&)c99shcook\[/Pi"; reference:url,thehackerblog.com/every-c99-php-shell-is-backdoored-aka-free-shells/; classtype:trojan-activity; sid:1070057; rev:2; metadata:created_at 2014_06_24, updated_at 2014_06_24, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER PHP Crawler (attempted-user) - detector_id: 70058 original_sid: 2018607
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER PHP Crawler"; flow:established,to_server; content:"PHPCrawl"; depth:8; http_user_agent; threshold: type limit, track by_src, count 1, seconds 300; reference:url,phpcrawl.cuab.de/; classtype:attempted-user; sid:1070058; rev:2; metadata:created_at 2014_06_25, updated_at 2014_06_25, flip_endpoints False, server_side True; target:dest_ip;)

# ET WEB_SERVER Adobe Flash Player Rosetta Flash compressed CWS in URI (attempted-user) - detector_id: 70059 original_sid: 2018740
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER Adobe Flash Player Rosetta Flash compressed CWS in URI"; flow:established,to_server; urilen:>70; content:"callback=CWS"; nocase; http_uri; content:"hC"; nocase; distance:5; within:2; http_uri; pcre:"/callback=CWS[a-z0-9\.\_]{5}hC[a-z0-9\.\_]{50}/Ui"; reference:url,miki.it/blog/2014/7/8/abusing-jsonp-with-rosetta-flash/; reference:cve,2014-4671; classtype:attempted-user; sid:1070059; rev:2; metadata:created_at 2014_07_18, updated_at 2014_07_18, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Likely Malicious Request for /proc/self/fd/ (web-application-attack) - detector_id: 70060 original_sid: 2019110
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER Likely Malicious Request for /proc/self/fd/"; flow:established,to_server; content:"/proc/self/fd/"; nocase; http_uri; fast_pattern:only; classtype:web-application-attack; sid:1070060; rev:2; metadata:created_at 2014_09_04, updated_at 2014_09_04, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER HTTP POST Generic eval of base64_decode (trojan-activity) - detector_id: 70061 original_sid: 2019182
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER HTTP POST Generic eval of base64_decode"; flow:established,to_server; content:"base64_decode"; nocase; http_client_body; fast_pattern:only; content:"eval"; nocase; pcre:"/^[\r\n\s]*?\x28[\r\n\s]*?base64_decode/Rsi"; classtype:trojan-activity; sid:1070061; rev:2; metadata:created_at 2014_09_16, updated_at 2014_09_16, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Possible CVE-2014-6271 Attempt in URI (attempted-admin) - detector_id: 70062 original_sid: 2019231
alert http any any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER Possible CVE-2014-6271 Attempt in URI"; flow:established,to_server; content:"|28 29 20 7b|"; http_uri; fast_pattern:only; pcre:"/[=?&\x2f]\s*?\x28\x29\x20\x7b/U"; reference:url,blogs.akamai.com/2014/09/environment-bashing.html; classtype:attempted-admin; sid:1070062; rev:4; metadata:created_at 2014_09_24, updated_at 2014_09_24, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Possible CVE-2014-6271 Attempt in Headers (attempted-admin) - detector_id: 70063 original_sid: 2019232
alert http any any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER Possible CVE-2014-6271 Attempt in Headers"; flow:established,to_server; content:"|28 29 20 7b|"; http_header; fast_pattern:only; reference:url,blogs.akamai.com/2014/09/environment-bashing.html; classtype:attempted-admin; sid:1070063; rev:4; metadata:created_at 2014_09_24, updated_at 2014_09_24, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Possible CVE-2014-6271 Attempt in Client Body (attempted-admin) - detector_id: 70064 original_sid: 2019233
alert http any any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER Possible CVE-2014-6271 Attempt in Client Body"; flow:established,to_server; content:"|28 29 20 7b|"; http_client_body; fast_pattern:only; pcre:"/(?:^|[=?&])\s*?\x28\x29\x20\x7b/P"; reference:url,blogs.akamai.com/2014/09/environment-bashing.html; classtype:attempted-admin; sid:1070064; rev:4; metadata:created_at 2014_09_24, updated_at 2014_09_24, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Possible CVE-2014-6271 Attempt in Client Body 2 (attempted-admin) - detector_id: 70065 original_sid: 2019234
alert http any any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER Possible CVE-2014-6271 Attempt in Client Body 2"; flow:established,to_server; content:"|25|28|25|29|25|20|25|7b|25|20"; http_client_body; fast_pattern:only; pcre:"/(:?(:?\x5e|%5e)|(:?[=?&]|\x25(:?3d|3f|26)))\s*?(:?%28|\x28)(:?%29|\x29)(:?%20|\x20)(:?%7b|\x7b)(:?%20|\x20)/Pi"; reference:url,blogs.akamai.com/2014/09/environment-bashing.html; classtype:attempted-admin; sid:1070065; rev:4; metadata:created_at 2014_09_24, updated_at 2014_09_24, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Possible CVE-2014-6271 Attempt in HTTP Cookie (attempted-admin) - detector_id: 70067 original_sid: 2019239
alert http any any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER Possible CVE-2014-6271 Attempt in HTTP Cookie"; flow:established,to_server; content:"|28 29 20 7b|"; http_cookie; reference:url,blogs.akamai.com/2014/09/environment-bashing.html; classtype:attempted-admin; sid:1070067; rev:4; metadata:created_at 2014_09_25, updated_at 2014_09_25, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Possible CVE-2014-6271 Attempt in Client Body 3 (attempted-admin) - detector_id: 70068 original_sid: 2019241
alert http any any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER Possible CVE-2014-6271 Attempt in Client Body 3"; flow:established,to_server; content:"()|25|20|25|7b"; http_client_body; fast_pattern:only; pcre:"/(:?(?:\x5e|%5e)|([=?&]|\x25(?:3d|3f|26)))\s*?\(\)(?:%20|\x20)(?:%7b|\x7b)/Pi"; reference:url,blogs.akamai.com/2014/09/environment-bashing.html; classtype:attempted-admin; sid:1070068; rev:3; metadata:created_at 2014_09_25, updated_at 2014_09_25, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Possible CVE-2014-6271 Attempt in HTTP URLENCODE Generic 1 (attempted-admin) - detector_id: 70069 original_sid: 2019244
alert http any any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER Possible CVE-2014-6271 Attempt in HTTP URLENCODE Generic 1"; flow:established,to_server; pcre:"/[\?\=\x3a\s\x2f]/"; content:"%28%29|20|{|20|"; nocase; fast_pattern; within:9; reference:url,blogs.akamai.com/2014/09/environment-bashing.html; classtype:attempted-admin; sid:1070069; rev:4; metadata:created_at 2014_09_25, updated_at 2014_09_25, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Possible CVE-2014-6271 Attempt in HTTP URLENCODE Generic 2 (attempted-admin) - detector_id: 70070 original_sid: 2019245
alert http any any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER Possible CVE-2014-6271 Attempt in HTTP URLENCODE Generic 2"; flow:established,to_server; pcre:"/[\?\=\x3a\s\x2f]/"; content:"%28%29|20|{%20"; nocase; fast_pattern; within:11; reference:url,blogs.akamai.com/2014/09/environment-bashing.html; classtype:attempted-admin; sid:1070070; rev:4; metadata:created_at 2014_09_25, updated_at 2014_09_25, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Possible CVE-2014-6271 Attempt in HTTP URLENCODE Generic 3 (attempted-admin) - detector_id: 70071 original_sid: 2019246
alert http any any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER Possible CVE-2014-6271 Attempt in HTTP URLENCODE Generic 3"; flow:established,to_server; pcre:"/[\?\=\x3a\s\x2f]/"; content:"%28%29|20|%7b|20|"; nocase; fast_pattern; within:11; reference:url,blogs.akamai.com/2014/09/environment-bashing.html; classtype:attempted-admin; sid:1070071; rev:4; metadata:created_at 2014_09_25, updated_at 2014_09_25, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Possible CVE-2014-6271 Attempt in HTTP URLENCODE Generic 4 (attempted-admin) - detector_id: 70072 original_sid: 2019247
alert http any any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER Possible CVE-2014-6271 Attempt in HTTP URLENCODE Generic 4"; flow:established,to_server; pcre:"/[\?\=\x3a\s\x2f]/"; content:"%28%29|20|%7b%20"; nocase; fast_pattern; within:13; reference:url,blogs.akamai.com/2014/09/environment-bashing.html; classtype:attempted-admin; sid:1070072; rev:4; metadata:created_at 2014_09_25, updated_at 2014_09_25, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Possible CVE-2014-6271 Attempt in HTTP URLENCODE Generic 5 (attempted-admin) - detector_id: 70073 original_sid: 2019248
alert http any any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER Possible CVE-2014-6271 Attempt in HTTP URLENCODE Generic 5"; flow:established,to_server; pcre:"/[\?\=\x3a\s\x2f]/"; content:"%28%29%20{|20|"; nocase; fast_pattern; within:11; reference:url,blogs.akamai.com/2014/09/environment-bashing.html; classtype:attempted-admin; sid:1070073; rev:4; metadata:created_at 2014_09_25, updated_at 2014_09_25, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Possible CVE-2014-6271 Attempt in HTTP URLENCODE Generic 6 (attempted-admin) - detector_id: 70074 original_sid: 2019249
alert http any any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER Possible CVE-2014-6271 Attempt in HTTP URLENCODE Generic 6"; flow:established,to_server; pcre:"/[\?\=\x3a\s\x2f]/"; content:"%28%29%20{%20"; nocase; fast_pattern; within:13; reference:url,blogs.akamai.com/2014/09/environment-bashing.html; classtype:attempted-admin; sid:1070074; rev:4; metadata:created_at 2014_09_25, updated_at 2014_09_25, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Possible CVE-2014-6271 Attempt in HTTP URLENCODE Generic 7 (attempted-admin) - detector_id: 70075 original_sid: 2019250
alert http any any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER Possible CVE-2014-6271 Attempt in HTTP URLENCODE Generic 7"; flow:established,to_server; pcre:"/[\?\=\x3a\s\x2f]/"; content:"%28%29%20%7b|20|"; nocase; fast_pattern; within:13; reference:url,blogs.akamai.com/2014/09/environment-bashing.html; classtype:attempted-admin; sid:1070075; rev:4; metadata:created_at 2014_09_25, updated_at 2014_09_25, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Possible CVE-2014-6271 Attempt in HTTP URLENCODE Generic 8 (attempted-admin) - detector_id: 70076 original_sid: 2019251
alert http any any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER Possible CVE-2014-6271 Attempt in HTTP URLENCODE Generic 8"; flow:established,to_server; pcre:"/[\?\=\x3a\s\x2f]/"; content:"%28%29%20%7b%20"; nocase; fast_pattern; within:15; reference:url,blogs.akamai.com/2014/09/environment-bashing.html; classtype:attempted-admin; sid:1070076; rev:4; metadata:created_at 2014_09_25, updated_at 2014_09_25, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Possible CVE-2014-6271 Attempt in HTTP URLENCODE Generic 9 (attempted-admin) - detector_id: 70077 original_sid: 2019252
alert http any any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER Possible CVE-2014-6271 Attempt in HTTP URLENCODE Generic 9"; flow:established,to_server; pcre:"/[\?\=\x3a\s\x2f]/"; content:"%28|20|{|20|"; nocase; fast_pattern; within:6; reference:url,blogs.akamai.com/2014/09/environment-bashing.html; classtype:attempted-admin; sid:1070077; rev:4; metadata:created_at 2014_09_25, updated_at 2014_09_25, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Possible CVE-2014-6271 Attempt in HTTP URLENCODE Generic 10 (attempted-admin) - detector_id: 70078 original_sid: 2019253
alert http any any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER Possible CVE-2014-6271 Attempt in HTTP URLENCODE Generic 10"; flow:established,to_server; pcre:"/[\?\=\x3a\s\x2f]/"; content:"%28|20|{%20"; nocase; fast_pattern; within:8; reference:url,blogs.akamai.com/2014/09/environment-bashing.html; classtype:attempted-admin; sid:1070078; rev:4; metadata:created_at 2014_09_25, updated_at 2014_09_25, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Possible CVE-2014-6271 Attempt in HTTP URLENCODE Generic 11 (attempted-admin) - detector_id: 70079 original_sid: 2019254
alert http any any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER Possible CVE-2014-6271 Attempt in HTTP URLENCODE Generic 11"; flow:established,to_server; pcre:"/[\?\=\x3a\s\x2f]/"; content:"%28|20|%7b|20|"; nocase; fast_pattern; within:8; reference:url,blogs.akamai.com/2014/09/environment-bashing.html; classtype:attempted-admin; sid:1070079; rev:4; metadata:created_at 2014_09_25, updated_at 2014_09_25, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Possible CVE-2014-6271 Attempt in HTTP URLENCODE Generic 12 (attempted-admin) - detector_id: 70080 original_sid: 2019255
alert http any any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER Possible CVE-2014-6271 Attempt in HTTP URLENCODE Generic 12"; flow:established,to_server; pcre:"/[\?\=\x3a\s\x2f]/"; content:"%28|20|%7b%20"; nocase; fast_pattern; within:10; reference:url,blogs.akamai.com/2014/09/environment-bashing.html; classtype:attempted-admin; sid:1070080; rev:4; metadata:created_at 2014_09_25, updated_at 2014_09_25, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Possible CVE-2014-6271 Attempt in HTTP URLENCODE Generic 13 (attempted-admin) - detector_id: 70081 original_sid: 2019256
alert http any any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER Possible CVE-2014-6271 Attempt in HTTP URLENCODE Generic 13"; flow:established,to_server; pcre:"/[\?\=\x3a\s\x2f]/"; content:"%28%20{|20|"; nocase; fast_pattern; within:8; reference:url,blogs.akamai.com/2014/09/environment-bashing.html; classtype:attempted-admin; sid:1070081; rev:4; metadata:created_at 2014_09_25, updated_at 2014_09_25, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Possible CVE-2014-6271 Attempt in HTTP URLENCODE Generic 14 (attempted-admin) - detector_id: 70082 original_sid: 2019257
alert http any any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER Possible CVE-2014-6271 Attempt in HTTP URLENCODE Generic 14"; flow:established,to_server; pcre:"/[\?\=\x3a\s\x2f]/"; content:"%28%20{%20"; nocase; fast_pattern; within:10; reference:url,blogs.akamai.com/2014/09/environment-bashing.html; classtype:attempted-admin; sid:1070082; rev:4; metadata:created_at 2014_09_25, updated_at 2014_09_25, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Possible CVE-2014-6271 Attempt in HTTP URLENCODE Generic 15 (attempted-admin) - detector_id: 70083 original_sid: 2019258
alert http any any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER Possible CVE-2014-6271 Attempt in HTTP URLENCODE Generic 15"; flow:established,to_server; pcre:"/[\?\=\x3a\s\x2f]/"; content:"%28%20%7b|20|"; nocase; fast_pattern; within:10; reference:url,blogs.akamai.com/2014/09/environment-bashing.html; classtype:attempted-admin; sid:1070083; rev:4; metadata:created_at 2014_09_25, updated_at 2014_09_25, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Possible CVE-2014-6271 Attempt in HTTP URLENCODE Generic 16 (attempted-admin) - detector_id: 70084 original_sid: 2019259
alert http any any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER Possible CVE-2014-6271 Attempt in HTTP URLENCODE Generic 16"; flow:established,to_server; pcre:"/[\?\=\x3a\s\x2f]/"; content:"%28%20%7b%20"; nocase; fast_pattern; within:12; reference:url,blogs.akamai.com/2014/09/environment-bashing.html; classtype:attempted-admin; sid:1070084; rev:4; metadata:created_at 2014_09_25, updated_at 2014_09_25, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Possible CVE-2014-6271 Attempt in HTTP URLENCODE Generic 17 (attempted-admin) - detector_id: 70085 original_sid: 2019260
alert http any any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER Possible CVE-2014-6271 Attempt in HTTP URLENCODE Generic 17"; flow:established,to_server; pcre:"/[\?\=\x3a\s\x2f]/"; content:"(%29|20|{|20|"; nocase; fast_pattern; within:7; reference:url,blogs.akamai.com/2014/09/environment-bashing.html; classtype:attempted-admin; sid:1070085; rev:4; metadata:created_at 2014_09_25, updated_at 2014_09_25, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Possible CVE-2014-6271 Attempt in HTTP URLENCODE Generic 18 (attempted-admin) - detector_id: 70086 original_sid: 2019261
alert http any any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER Possible CVE-2014-6271 Attempt in HTTP URLENCODE Generic 18"; flow:established,to_server; pcre:"/[\?\=\x3a\s\x2f]/"; content:"(%29|20|{%20"; nocase; fast_pattern; within:9; reference:url,blogs.akamai.com/2014/09/environment-bashing.html; classtype:attempted-admin; sid:1070086; rev:4; metadata:created_at 2014_09_25, updated_at 2014_09_25, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Possible CVE-2014-6271 Attempt in HTTP URLENCODE Generic 19 (attempted-admin) - detector_id: 70087 original_sid: 2019262
alert http any any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER Possible CVE-2014-6271 Attempt in HTTP URLENCODE Generic 19"; flow:established,to_server; pcre:"/[\?\=\x3a\s\x2f]/"; content:"(%29|20|%7b|20|"; nocase; fast_pattern; within:9; reference:url,blogs.akamai.com/2014/09/environment-bashing.html; classtype:attempted-admin; sid:1070087; rev:4; metadata:created_at 2014_09_25, updated_at 2014_09_25, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Possible CVE-2014-6271 Attempt in HTTP URLENCODE Generic 20 (attempted-admin) - detector_id: 70088 original_sid: 2019263
alert http any any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER Possible CVE-2014-6271 Attempt in HTTP URLENCODE Generic 20"; flow:established,to_server; pcre:"/[\?\=\x3a\s\x2f]/"; content:"(%29|20|%7b%20"; nocase; fast_pattern; within:11; reference:url,blogs.akamai.com/2014/09/environment-bashing.html; classtype:attempted-admin; sid:1070088; rev:3; metadata:created_at 2014_09_25, updated_at 2014_09_25, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Possible CVE-2014-6271 Attempt in HTTP URLENCODE Generic 21 (attempted-admin) - detector_id: 70089 original_sid: 2019264
alert http any any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER Possible CVE-2014-6271 Attempt in HTTP URLENCODE Generic 21"; flow:established,to_server; pcre:"/[\?\=\x3a\s\x2f]/"; content:"(%29%20{|20|"; nocase; fast_pattern; within:9; reference:url,blogs.akamai.com/2014/09/environment-bashing.html; classtype:attempted-admin; sid:1070089; rev:3; metadata:created_at 2014_09_25, updated_at 2014_09_25, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Possible CVE-2014-6271 Attempt in HTTP URLENCODE Generic 22 (attempted-admin) - detector_id: 70090 original_sid: 2019265
alert http any any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER Possible CVE-2014-6271 Attempt in HTTP URLENCODE Generic 22"; flow:established,to_server; pcre:"/[\?\=\x3a\s\x2f]/"; content:"(%29%20{%20"; nocase; fast_pattern; within:11; reference:url,blogs.akamai.com/2014/09/environment-bashing.html; classtype:attempted-admin; sid:1070090; rev:3; metadata:created_at 2014_09_25, updated_at 2014_09_25, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Possible CVE-2014-6271 Attempt in HTTP URLENCODE Generic 23 (attempted-admin) - detector_id: 70091 original_sid: 2019266
alert http any any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER Possible CVE-2014-6271 Attempt in HTTP URLENCODE Generic 23"; flow:established,to_server; pcre:"/[\?\=\x3a\s\x2f]/"; content:"(%29%20%7b|20|"; nocase; fast_pattern; within:11; reference:url,blogs.akamai.com/2014/09/environment-bashing.html; classtype:attempted-admin; sid:1070091; rev:3; metadata:created_at 2014_09_25, updated_at 2014_09_25, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Possible CVE-2014-6271 Attempt in HTTP URLENCODE Generic 24 (attempted-admin) - detector_id: 70092 original_sid: 2019267
alert http any any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER Possible CVE-2014-6271 Attempt in HTTP URLENCODE Generic 24"; flow:established,to_server; pcre:"/[\?\=\x3a\s\x2f]/"; content:"(%29%20%7b%20"; nocase; fast_pattern; within:13; reference:url,blogs.akamai.com/2014/09/environment-bashing.html; classtype:attempted-admin; sid:1070092; rev:3; metadata:created_at 2014_09_25, updated_at 2014_09_25, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Possible CVE-2014-6271 Attempt in HTTP URLENCODE Generic 25 (attempted-admin) - detector_id: 70093 original_sid: 2019268
alert http any any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER Possible CVE-2014-6271 Attempt in HTTP URLENCODE Generic 25"; flow:established,to_server; pcre:"/[\?\=\x3a\s\x2f]/"; content:"()|20|{%20"; nocase; fast_pattern; within:7; reference:url,blogs.akamai.com/2014/09/environment-bashing.html; classtype:attempted-admin; sid:1070093; rev:4; metadata:created_at 2014_09_25, updated_at 2014_09_25, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Possible CVE-2014-6271 Attempt in HTTP URLENCODE Generic 26 (attempted-admin) - detector_id: 70094 original_sid: 2019269
alert http any any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER Possible CVE-2014-6271 Attempt in HTTP URLENCODE Generic 26"; flow:established,to_server; pcre:"/[\?\=\x3a\s\x2f]/"; content:"()|20|%7b|20|"; nocase; fast_pattern; within:7; reference:url,blogs.akamai.com/2014/09/environment-bashing.html; classtype:attempted-admin; sid:1070094; rev:3; metadata:created_at 2014_09_25, updated_at 2014_09_25, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Possible CVE-2014-6271 Attempt in HTTP URLENCODE Generic 27 (attempted-admin) - detector_id: 70095 original_sid: 2019270
alert http any any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER Possible CVE-2014-6271 Attempt in HTTP URLENCODE Generic 27"; flow:established,to_server; pcre:"/[\?\=\x3a\s\x2f]/"; content:"()|20|%7b%20"; nocase; fast_pattern; within:9; reference:url,blogs.akamai.com/2014/09/environment-bashing.html; classtype:attempted-admin; sid:1070095; rev:3; metadata:created_at 2014_09_25, updated_at 2014_09_25, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Possible CVE-2014-6271 Attempt in HTTP URLENCODE Generic 28 (attempted-admin) - detector_id: 70096 original_sid: 2019271
alert http any any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER Possible CVE-2014-6271 Attempt in HTTP URLENCODE Generic 28"; flow:established,to_server; pcre:"/[\?\=\x3a\s\x2f]/"; content:"()%20{|20|"; nocase; fast_pattern; within:7; reference:url,blogs.akamai.com/2014/09/environment-bashing.html; classtype:attempted-admin; sid:1070096; rev:3; metadata:created_at 2014_09_25, updated_at 2014_09_25, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Possible CVE-2014-6271 Attempt in HTTP URLENCODE Generic 29 (attempted-admin) - detector_id: 70097 original_sid: 2019272
alert http any any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER Possible CVE-2014-6271 Attempt in HTTP URLENCODE Generic 29"; flow:established,to_server; pcre:"/[\?\=\x3a\s\x2f]/"; content:"()%20%7b|20|"; nocase; fast_pattern; within:9; reference:url,blogs.akamai.com/2014/09/environment-bashing.html; classtype:attempted-admin; sid:1070097; rev:4; metadata:created_at 2014_09_25, updated_at 2014_09_25, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Possible CVE-2014-6271 Attempt in HTTP URLENCODE Generic 30 (attempted-admin) - detector_id: 70098 original_sid: 2019273
alert http any any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER Possible CVE-2014-6271 Attempt in HTTP URLENCODE Generic 30"; flow:established,to_server; pcre:"/[\?\=\x3a\s\x2f]/"; content:"()%20%7b%20"; nocase; fast_pattern; within:11; reference:url,blogs.akamai.com/2014/09/environment-bashing.html; classtype:attempted-admin; sid:1070098; rev:3; metadata:created_at 2014_09_25, updated_at 2014_09_25, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Possible bash shell piped to dev tcp Inbound to WebServer (bad-unknown) - detector_id: 70099 original_sid: 2019285
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER Possible bash shell piped to dev tcp Inbound to WebServer"; flow:established,to_server; content:"/dev/tcp/"; fast_pattern:only; classtype:bad-unknown; sid:1070099; rev:3; metadata:created_at 2014_09_26, updated_at 2014_09_26, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER CVE-2014-6271 Attempt In HTTP Headers Line Continuation Evasion LF (attempted-admin) - detector_id: 70100 original_sid: 2019291
alert http any any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER CVE-2014-6271 Attempt In HTTP Headers Line Continuation Evasion LF"; flow:to_server,established; content:"|28 29 0a 20 7b|"; fast_pattern:only; reference:url,www.invisiblethreat.ca/2014/09/cve-2014-6271/; classtype:attempted-admin; sid:1070100; rev:2; metadata:created_at 2014_09_28, updated_at 2014_09_28, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER CVE-2014-6271 Attempt In HTTP Headers Line Continuation Evasion CRLF (attempted-admin) - detector_id: 70101 original_sid: 2019292
alert http any any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER CVE-2014-6271 Attempt In HTTP Headers Line Continuation Evasion CRLF"; flow:to_server,established; content:"|28 29 0d 0a 20 7b|"; fast_pattern:only; reference:url,www.invisiblethreat.ca/2014/09/cve-2014-6271/; classtype:attempted-admin; sid:1070101; rev:3; metadata:created_at 2014_09_28, updated_at 2014_09_28, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER CURL Command Specifying Output in HTTP Headers (attempted-admin) - detector_id: 70102 original_sid: 2019308
alert http any any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER CURL Command Specifying Output in HTTP Headers"; flow:established,to_server; content:"curl "; fast_pattern:only; http_header; pcre:"/(?!^User-Agent\x3a)\bcurl\s[^\r\n]*?-(?:[Oo]|-(?:remote-name|output))[^\r\n]+(?:\x3b|&&)/Hm"; reference:url,blogs.akamai.com/2014/09/environment-bashing.html; classtype:attempted-admin; sid:1070102; rev:2; metadata:created_at 2014_09_29, updated_at 2014_09_29, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER WGET Command Specifying Output in HTTP Headers (attempted-admin) - detector_id: 70103 original_sid: 2019309
alert http any any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER WGET Command Specifying Output in HTTP Headers"; flow:established,to_server; content:"wget "; fast_pattern:only; http_header; pcre:"/(?!^User-Agent\x3a)\bwget\s[^\r\n]+(?:\x3b|&&)/Hm"; reference:url,blogs.akamai.com/2014/09/environment-bashing.html; classtype:attempted-admin; sid:1070103; rev:2; metadata:created_at 2014_09_29, updated_at 2014_09_29, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER WGET Command Specifying Output in HTTP Headers (attempted-admin) - detector_id: 70104 original_sid: 2019310
alert http any any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER WGET Command Specifying Output in HTTP Headers"; flow:established,to_server; content:"lwp-download "; fast_pattern:only; http_header; pcre:"/(?!^User-Agent\x3a)\blwp-download\s[^\r\n]+(?:\x3b|&&)/Hm"; reference:url,blogs.akamai.com/2014/09/environment-bashing.html; classtype:attempted-admin; sid:1070104; rev:2; metadata:created_at 2014_09_29, updated_at 2014_09_29, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Possible bash shell piped to dev udp Inbound to WebServer (bad-unknown) - detector_id: 70105 original_sid: 2019314
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER Possible bash shell piped to dev udp Inbound to WebServer"; flow:established,to_server; content:"/dev/udp/"; fast_pattern:only; classtype:bad-unknown; sid:1070105; rev:3; metadata:created_at 2014_09_29, updated_at 2014_09_29, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER MongoDB Negated Parameter Server Side JavaScript Injection Attempt (web-application-attack) - detector_id: 70106 original_sid: 2019460
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER MongoDB Negated Parameter Server Side JavaScript Injection Attempt"; flow:established,to_server; content:"[$ne]"; http_uri; fast_pattern:only; reference:url,blog.imperva.com/2014/10/nosql-ssji-authentication-bypass.html; reference:url,docs.mongodb.org/manual/reference/operator/query/ne/; classtype:web-application-attack; sid:1070106; rev:2; metadata:created_at 2014_10_17, updated_at 2014_10_17, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Possible Cookie Based BackDoor Used in Drupal Attacks (attempted-user) - detector_id: 70108 original_sid: 2019627
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER Possible Cookie Based BackDoor Used in Drupal Attacks"; flow:established,to_server; content:"preg_replace"; http_cookie; nocase; metadata:former_category WEB_SERVER, flip_endpoints False, server_side True; reference:url,www.kahusecurity.com/posts/drupal_7_sql_injection_info.html; classtype:attempted-user; sid:1070108; rev:3; metadata:created_at 2014_11_03, updated_at 2014_11_03; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER PHP.//Input in HTTP POST (trojan-activity) - detector_id: 70111 original_sid: 2019804
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER PHP.//Input in HTTP POST"; flow:established,to_server; content:"POST"; http_method; content:"php|3a 2f 2f|input"; http_raw_uri; fast_pattern; content:"<?"; http_client_body; depth:2; reference:url,www.deependresearch.org/2014/07/another-linux-ddos-bot-via-cve-2012-1823.html; classtype:trojan-activity; sid:1070111; rev:3; metadata:created_at 2014_11_25, updated_at 2014_11_25, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Double Encoded Characters in URI (../) (misc-attack) - detector_id: 70112 original_sid: 2019880
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_SERVER Double Encoded Characters in URI (../)"; flow:to_server,established; content:"%252E%252E%252F"; nocase; http_raw_uri; classtype:misc-attack; sid:1070112; rev:4; metadata:created_at 2014_12_05, updated_at 2014_12_05, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Insomnia Shell HTTP Request (trojan-activity) - detector_id: 70113 original_sid: 2019899
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER Insomnia Shell HTTP Request"; flow:to_server,established; content:"POST"; http_method; content:".aspx"; http_uri; content:"txtRemoteHost="; http_client_body; fast_pattern; content:"txtRemotePort="; http_client_body; distance:0; content:"txtBindPort="; http_client_body; distance:0; content:"txtPipeName="; http_client_body; distance:0; reference:url,www.insomniasec.com/releases; classtype:trojan-activity; sid:1070113; rev:2; metadata:created_at 2014_12_09, updated_at 2014_12_09, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER MorXploit Shell Command (bad-unknown) - detector_id: 70115 original_sid: 2019951
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER MorXploit Shell Command"; flow:established,to_server; content:"?cmd=ZXhpdA=="; http_uri; fast_pattern; content:"User-Agent|3a 20|Mozilla 5"; http_header; reference:url,seclists.org/fulldisclosure/2014/Nov/78; classtype:bad-unknown; sid:1070115; rev:2; metadata:created_at 2014_12_16, updated_at 2014_12_16, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Generic PHP Remote File Include (attempted-user) - detector_id: 70116 original_sid: 2019957
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER Generic PHP Remote File Include"; flow:to_server,established; content:"POST"; http_method; content:"allow_url_include"; http_uri; content:"safe_mode"; http_uri; content:"php|3a 2f 2f|input"; http_raw_uri; content:"<?php"; fast_pattern:only; http_client_body; content:"chmod 777"; http_client_body; classtype:attempted-user; sid:1070116; rev:2; metadata:affected_product Any, attack_target Server, deployment Datacenter, tag Remote_File_Include, signature_severity Major, created_at 2014_12_17, updated_at 2016_07_01, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER PHP System Command in HTTP POST (web-application-attack) - detector_id: 70119 original_sid: 2020102
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER PHP System Command in HTTP POST"; flow:established,to_server; content:"POST"; http_method; content:"<?"; http_client_body; content:"system|28|"; http_client_body; distance:0; classtype:web-application-attack; sid:1070119; rev:4; metadata:created_at 2015_01_06, updated_at 2015_01_06, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Heimdallbot Attack Tool Inbound (web-application-attack) - detector_id: 70120 original_sid: 2020323
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER Heimdallbot Attack Tool Inbound"; flow:established,to_server; content:"Heimdallbot"; http_header; nocase; fast_pattern:only; pcre:"/^User-Agent\x3a[^\r\n]*?Heimdallbot/Hmi"; threshold: type limit, count 1, seconds 60, track by_src; classtype:web-application-attack; sid:1070120; rev:2; metadata:created_at 2015_01_28, updated_at 2015_01_28, flip_endpoints False, server_side True; target:dest_ip;)

# ET WEB_SERVER WPScan User Agent (web-application-attack) - detector_id: 70121 original_sid: 2020338
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_SERVER WPScan User Agent"; flow:established,to_server; content:"WPScan v"; depth:8; http_user_agent; threshold: type limit, count 1, seconds 60, track by_src; reference:url,github.com/wpscanteam/wpscan; classtype:web-application-attack; sid:1070121; rev:3; metadata:created_at 2015_01_30, updated_at 2015_01_30, flip_endpoints False, server_side True; target:dest_ip;)

# ET WEB_SERVER ATTACKER WebShell - Weevely - POSTed (trojan-activity) - detector_id: 70123 original_sid: 2020556
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER ATTACKER WebShell - Weevely - POSTed"; flow:established,to_server; content:"<?php|0A|$"; http_client_body; content:"="; distance:4; within:2; http_client_body; content:" str_replace("; distance:0; http_client_body; classtype:trojan-activity; sid:1070123; rev:2; metadata:created_at 2015_02_24, updated_at 2015_02_24, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER WebShell - ASPyder - File Create - POST Structure (trojan-activity) - detector_id: 70125 original_sid: 2020572
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER WebShell - ASPyder - File Create - POST Structure"; flow:established,to_server; content:"POST"; http_method; content:"Fname="; http_client_body; depth:6; content:"&cmd="; http_client_body; classtype:trojan-activity; sid:1070125; rev:3; metadata:created_at 2015_02_25, updated_at 2015_02_25, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Possible CVE-2015-1427 Elastic Search Sandbox Escape Remote Code Execution Attempt (attempted-admin) - detector_id: 70126 original_sid: 2020648
alert tcp $EXTERNAL_NET any -> $HOME_NET [9200,9292] (msg:"ET WEB_SERVER Possible CVE-2015-1427 Elastic Search Sandbox Escape Remote Code Execution Attempt"; flow:established,to_server; content:"POST /"; depth:6; content:"search"; distance:0; content:"script_fields"; distance:0; nocase; content:".class.forName"; nocase; distance:0; content:"java.lang.Runtime"; nocase; distance:0; reference:url,jordan-wright.github.io/blog/2015/03/08/elasticsearch-rce-vulnerability-cve-2015-1427; classtype:attempted-admin; sid:1070126; rev:2; metadata:created_at 2015_03_09, updated_at 2015_03_09, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Possible IIS Integer Overflow DoS (CVE-2015-1635) (web-application-attack) - detector_id: 70127 original_sid: 2020912
alert http any any -> $HTTP_SERVERS $HTTP_PORTS (msg:"ET WEB_SERVER Possible IIS Integer Overflow DoS (CVE-2015-1635)"; flow:established,to_server; content:"18446744073709551615"; http_header; fast_pattern:only; content:"Range|3a|"; nocase; http_header; pcre:"/^Range\x3a[^\r\n]*?18446744073709551615/Hmi"; reference:cve,2015-1635; classtype:web-application-attack; sid:1070127; rev:2; metadata:created_at 2015_04_15, updated_at 2015_04_15, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER ElasticSearch Directory Traversal Attempt (CVE-2015-3337) (web-application-attack) - detector_id: 70128 original_sid: 2021138
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_SERVER ElasticSearch Directory Traversal Attempt (CVE-2015-3337)"; flow:to_server,established; content:"/_plugin/"; http_raw_uri; fast_pattern; pcre:"/(?:%2(?:52e(?:%2(?:52e(?:%(?:(?:25)?2|c0%a)f|\/)|e(?:%(?:(?:25)?2|c0%a)f|\/))|\.(?:%(?:(?:25)?2|c0%a)f|\/))|e(?:%2(?:52e(?:%(?:(?:25)?2|c0%a)f|\/)|e(?:%(?:(?:25)?2|c0%a)f|\/))|\.(?:%(?:(?:25)?2|c0%a)f|\/)))|\.(?:%2(?:52e(?:%(?:(?:25)?2|c0%a)f|\/)|e(?:%(?:(?:25)?2|c0%a)f|\/))|\.(?:%(?:(?:25)?2|c0%a)f|\/)))/RIi"; reference:cve,2015-3337; classtype:web-application-attack; sid:1070128; rev:4; metadata:created_at 2015_05_22, updated_at 2015_05_22, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Possible CVE-2014-6271 Attempt (attempted-admin) - detector_id: 70129 original_sid: 2022028
alert tcp any any -> $HTTP_SERVERS $HTTP_PORTS (msg:"ET WEB_SERVER Possible CVE-2014-6271 Attempt"; flow:established,to_server; content:" HTTP/1."; pcre:"/^[^\r\n]*?HTTP\/1(?:(?!\r?\n\r?\n)[\x20-\x7e\s]){1,500}\n[\x20-\x7e]{1,100}\x3a[\x20-\x7e]{0,500}\x28\x29\x20\x7b/s"; content:"|28 29 20 7b|"; fast_pattern:only; reference:url,blogs.akamai.com/2014/09/environment-bashing.html; classtype:attempted-admin; sid:1070129; rev:1; metadata:created_at 2015_11_03, updated_at 2015_11_03, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER WeBaCoo Web Backdoor Detected (web-application-activity) - detector_id: 70131 original_sid: 2022295
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_SERVER WeBaCoo Web Backdoor Detected"; flow:to_server,established; content:"GET"; http_method; content:"cm="; http_cookie; content:"cn=M-cookie|3b|"; fast_pattern:only; content:"cp="; http_cookie; reference:url,panagioto.com/webacoo-backdoor-detection; classtype:web-application-activity; sid:1070131; rev:2; metadata:created_at 2015_12_21, updated_at 2015_12_21, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER WEBSHELL JSP/Backdoor Shell Access (successful-admin) - detector_id: 70132 original_sid: 2022348
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER WEBSHELL JSP/Backdoor Shell Access"; flow:established,to_server; content:".war?cmd="; http_uri; fast_pattern:only; content:"&winurl="; http_uri; content:"&linurl="; http_uri; pcre:"/\.war\?cmd=[a-zA-Z0-9+/=]+&winurl=[a-zA-Z0-9+/=]*&linurl=[a-zA-Z0-9+/=]*/U"; reference:url,blog.malwaremustdie.org/2016/01/mmd-0049-2016-case-of-java-trojan.html; classtype:successful-admin; sid:1070132; rev:3; metadata:created_at 2016_01_11, updated_at 2016_01_11, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER WEBSHELL Linux/Torte Uploaded (attempted-admin) - detector_id: 70133 original_sid: 2022359
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER WEBSHELL Linux/Torte Uploaded"; flow:established,to_server; content:"POST"; http_method; content:"JGVudiA9ICJYRFZTTl9TRVNTSU9OX0NPT0tJR"; http_client_body; fast_pattern:only; content:"eval(base64_decode($_REQUEST["; http_client_body; reference:url,blog.malwaremustdie.org/2016/01/mmd-0050-2016-incident-report-elf.html; classtype:attempted-admin; sid:1070133; rev:2; metadata:created_at 2016_01_13, updated_at 2016_01_13, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Possible Custom Content Type Manager WP Backdoor Access (trojan-activity) - detector_id: 70135 original_sid: 2022596
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER Possible Custom Content Type Manager WP Backdoor Access"; flow:established,to_server; content:"/plugins/custom-content-type-manager/auto-update.php"; http_uri; fast_pattern:32,20; nocase; reference:url,blog.sucuri.net/2016/03/when-wordpress-plugin-goes-bad.html; classtype:trojan-activity; sid:1070135; rev:3; metadata:created_at 2016_03_06, updated_at 2016_03_06, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER ImageMagick CVE-2016-3714 Inbound (mvg) (web-application-attack) - detector_id: 70136 original_sid: 2022789
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER ImageMagick CVE-2016-3714 Inbound (mvg)"; flow:established,to_server; content:"viewbox "; nocase; http_client_body; fast_pattern:only; pcre:"/https\x3a.+(?<!\x5c)(:[\x22\x27]|\\x2[27])\s*?[\x3b&\x7c><].*?(:[\x22\x27]|\\x2[27])/Psi"; classtype:web-application-attack; sid:1070136; rev:4; metadata:created_at 2016_05_04, updated_at 2016_05_06, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER ImageMagick CVE-2016-3714 Inbound (svg) (web-application-attack) - detector_id: 70137 original_sid: 2022790
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER ImageMagick CVE-2016-3714 Inbound (svg)"; flow:established,to_server; content:"<svg "; http_client_body; nocase; fast_pattern:only; content:"xlink"; http_client_body; nocase; pcre:"/xlink\s*?\x3a\s*?href\s*?=\s*?(:[\x22\x27]|\\x2[27])https.+?&quot\s*?\x3b(?:\x7c|&(?:[gl]t|amp)\s*?\x3b)/Psi"; classtype:web-application-attack; sid:1070137; rev:4; metadata:created_at 2016_05_04, updated_at 2016_05_06, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER ImageMagick CVE-2016-3718 SSRF Inbound (mvg + fill + url) (web-application-attack) - detector_id: 70138 original_sid: 2022791
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER ImageMagick CVE-2016-3718 SSRF Inbound (mvg + fill + url)"; flow:established,to_server; content:"viewbox "; nocase; http_client_body; fast_pattern:only; content:"fill"; http_client_body; content:"url("; http_client_body; distance:0; nocase; pcre:"/^\s*https?\x3a\/\//RPi"; classtype:web-application-attack; sid:1070138; rev:3; metadata:created_at 2016_05_04, updated_at 2016_05_06, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER ImageMagick CVE-2016-3715 File Deletion Inbound (ephermeral:+ mvg) (web-application-attack) - detector_id: 70139 original_sid: 2022792
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER ImageMagick CVE-2016-3715 File Deletion Inbound (ephermeral:+ mvg)"; flow:established,to_server; content:"viewbox "; nocase; http_client_body; fast_pattern:only; content:"ephemeral"; http_client_body; nocase; pcre:"/^\s*\x3a\s*[./]/RPi"; classtype:web-application-attack; sid:1070139; rev:3; metadata:created_at 2016_05_04, updated_at 2016_05_06, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER ImageMagick CVE-2016-3716 Move File Inbound (msl: + mvg) (web-application-attack) - detector_id: 70140 original_sid: 2022793
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER ImageMagick CVE-2016-3716 Move File Inbound (msl: + mvg)"; flow:established,to_server; content:"viewbox "; nocase; http_client_body; fast_pattern:only; content:"msl"; http_client_body; nocase; pcre:"/^\s*\x3a\s*[./]/RPi"; classtype:web-application-attack; sid:1070140; rev:3; metadata:created_at 2016_05_04, updated_at 2016_05_06, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER ImageMagick CVE-2016-3717 Local File Read Inbound (label: + mvg) (web-application-attack) - detector_id: 70141 original_sid: 2022794
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER ImageMagick CVE-2016-3717 Local File Read Inbound (label: + mvg)"; flow:established,to_server; content:"viewbox "; nocase; http_client_body; fast_pattern:only; content:"label"; http_client_body; nocase; pcre:"/^\s*\x3a\s*\x40/RPi"; classtype:web-application-attack; sid:1070141; rev:3; metadata:created_at 2016_05_04, updated_at 2016_05_06, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Possible SQLi Attempt in User Agent (Inbound) (trojan-activity) - detector_id: 70142 original_sid: 2022816
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER Possible SQLi Attempt in User Agent (Inbound)"; flow:established,to_server; content:"select"; nocase; distance:0; fast_pattern; http_user_agent; content:"from"; nocase; http_user_agent; within:20; reference:url,blog.cloudflare.com/the-sleepy-user-agent/; classtype:trojan-activity; sid:1070142; rev:3; metadata:created_at 2016_05_17, updated_at 2016_05_17, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Possible CVE-2016-5118 Exploit SVG attempt M1 (trojan-activity) - detector_id: 70143 original_sid: 2022846
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER Possible CVE-2016-5118 Exploit SVG attempt M1"; flow:established,to_server; content:"<svg"; nocase; http_client_body; content:"|78 6c 69 6e 6b 3a 68 72 65 66 3d 22 7c|"; http_client_body; reference:url,seclists.org/oss-sec/2016/q2/432; reference:cve,2016-5118; classtype:trojan-activity; sid:1070143; rev:2; metadata:created_at 2016_06_01, updated_at 2016_06_01, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Possible CVE-2016-5118 Exploit SVG attempt M2 (trojan-activity) - detector_id: 70144 original_sid: 2022847
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER Possible CVE-2016-5118 Exploit SVG attempt M2"; flow:established,to_server; content:"<svg"; nocase; http_client_body; content:"|78 6c 69 6e 6b 3a 68 72 65 66 3d 27 7c|"; http_client_body; nocase; reference:url,seclists.org/oss-sec/2016/q2/432; reference:cve,2016-5118; classtype:trojan-activity; sid:1070144; rev:2; metadata:created_at 2016_06_01, updated_at 2016_06_01, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Possible CVE-2016-5118 Exploit MVG attempt M1 (trojan-activity) - detector_id: 70145 original_sid: 2022848
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER Possible CVE-2016-5118 Exploit MVG attempt M1"; flow:established,to_server; content:"viewbox "; nocase; http_client_body; fast_pattern:only; content:"|20 27 7c|"; http_client_body; nocase; reference:url,seclists.org/oss-sec/2016/q2/432; reference:cve,2016-5118; classtype:trojan-activity; sid:1070145; rev:2; metadata:created_at 2016_06_01, updated_at 2016_06_01, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Possible CVE-2016-5118 Exploit MVG attempt M2 (trojan-activity) - detector_id: 70146 original_sid: 2022849
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER Possible CVE-2016-5118 Exploit MVG attempt M2"; flow:established,to_server; content:"viewbox "; nocase; http_client_body; fast_pattern:only; content:"|20 22 7c|"; http_client_body; nocase; reference:url,seclists.org/oss-sec/2016/q2/432; reference:cve,2016-5118; classtype:trojan-activity; sid:1070146; rev:2; metadata:created_at 2016_06_01, updated_at 2016_06_01, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Aribitrary File Upload Vulnerability in WP Mobile Detector (attempted-user) - detector_id: 70147 original_sid: 2022860
alert http $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS (msg:"ET WEB_SERVER Aribitrary File Upload Vulnerability in WP Mobile Detector"; flow:from_client,established; content:"/wp-content/plugins/wp-mobile-detector/"; http_uri; content:"resize.php?src=http"; http_uri; fast_pattern; reference:url,pluginvulnerabilities.com/2016/05/31/aribitrary-file-upload-vulnerability-in-wp-mobile-detector/; classtype:attempted-user; sid:1070147; rev:2; metadata:created_at 2016_06_03, updated_at 2016_06_03, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Apache Continuum Arbitrary Command Execution (attempted-user) - detector_id: 70148 original_sid: 2022912
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER Apache Continuum Arbitrary Command Execution"; flow:to_server,established; content:"POST"; http_method; content:"/saveInstallation.action"; http_uri; fast_pattern:only; content:"&installation.varValue="; http_client_body; content:"|25|60"; http_client_body; classtype:attempted-user; sid:1070148; rev:2; metadata:created_at 2016_06_22, updated_at 2016_06_22, flip_endpoints False, server_side True; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Microsoft IIS Remote Code Execution (CVE-2017-7269) (attempted-user) - detector_id: 70159 original_sid: 2024107
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER Microsoft IIS Remote Code Execution (CVE-2017-7269)"; flow:to_server,established; content:"If|3a 20 3c|"; http_header; pcre:"/^If\x3a\x20\x3c[^\r\n>]+?(?:[\x7f-\xff])/Hmi"; metadata:former_category WEB_SERVER, flip_endpoints False, server_side True; reference:url,github.com/edwardz246003/IIS_exploit/blob/master/exploit.py; classtype:attempted-user; sid:1070159; rev:2; metadata:affected_product Microsoft_IIS, attack_target Web_Server, deployment Datacenter, cve cve_2017_7269, signature_severity Major, created_at 2017_03_28, performance_impact Low, updated_at 2017_03_28; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Jorgee Scan (trojan-activity) - detector_id: 70160 original_sid: 2024265
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_SERVER Jorgee Scan"; flow:established,to_server; content:"HEAD"; http_method; content:"Mozilla/5.0 Jorgee"; depth:18; isdataat:!1,relative; http_user_agent; fast_pattern; threshold: type limit, track by_dst, count 3, seconds 60; metadata:former_category WEB_SERVER, flip_endpoints False, server_side True; reference:url,www.skepticism.us/2015/05/new-malware-user-agent-value-jorgee/; classtype:trojan-activity; sid:1070160; rev:4; metadata:created_at 2015_06_26, updated_at 2017_05_01; target:dest_ip;)

# ET WEB_SERVER OptionsBleed (CVE-2017-9798) (misc-activity) - detector_id: 70161 original_sid: 2024760
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"ET WEB_SERVER OptionsBleed (CVE-2017-9798)"; flow:from_server; content:"Allow|3a 20|"; http_header; pcre:"/^[^\n]+(?:[^ -~\x0d\x0a]|,\x20*,)/HR"; metadata:former_category WEB_SERVER, flip_endpoints True, server_side True; reference:cve,CVE-2017-9798; classtype:misc-activity; sid:1070161; rev:4; metadata:affected_product Apache_HTTP_server, attack_target Server, deployment Datacenter, signature_severity Minor, created_at 2017_09_19, performance_impact Significant, updated_at 2017_09_22; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET WEB_SERVER 401TRG Generic Webshell Request - POST with wget in body (web-application-attack) - detector_id: 70162 original_sid: 2024930
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER 401TRG Generic Webshell Request - POST with wget in body"; flow:established,to_server; content:"wget"; nocase; http_client_body; content:"http"; nocase; http_client_body; within:11; threshold: type limit, track by_src, seconds 3600, count 1; metadata:former_category WEB_SERVER, flip_endpoints False, server_side True; classtype:web-application-attack; sid:1070162; rev:1; metadata:affected_product Apache_HTTP_server, attack_target Server, deployment Datacenter, signature_severity Major, created_at 2017_10_26, malware_family webshell, performance_impact Moderate, updated_at 2017_10_26; target:dest_ip;)

# ET WEB_SERVER Weevely PHP backdoor detected (passthru() function used) M2 (web-application-activity) - detector_id: 70163 original_sid: 2025593
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER Weevely PHP backdoor detected (passthru() function used) M2"; flow:to_server,established; content:"BwYXNzdGhydSgn"; http_header; metadata:former_category WEB_SERVER, flip_endpoints False, server_side True; reference:url,bechtsoudis.com/security/put-weevely-on-the-your-nids-radar; classtype:web-application-activity; sid:1070163; rev:2; metadata:affected_product Web_Server_Applications, attack_target Web_Server, deployment Datacenter, signature_severity Major, created_at 2018_06_14, malware_family weevely, updated_at 2018_06_14; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER Weevely PHP backdoor detected (passthru() function used) M3 (web-application-activity) - detector_id: 70164 original_sid: 2025594
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER Weevely PHP backdoor detected (passthru() function used) M3"; flow:to_server,established; content:"AcGFzc3RocnUoJ"; http_header; metadata:former_category WEB_SERVER, flip_endpoints False, server_side True; reference:url,bechtsoudis.com/security/put-weevely-on-the-your-nids-radar; classtype:web-application-activity; sid:1070164; rev:2; metadata:affected_product Web_Server_Applications, attack_target Web_Server, deployment Datacenter, signature_severity Major, created_at 2018_06_14, malware_family weevely, updated_at 2018_06_14; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER JSP.SJavaWebManage WebShell Access (trojan-activity) - detector_id: 70165 original_sid: 2026336
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"ET WEB_SERVER JSP.SJavaWebManage WebShell Access"; flow:established,from_server; file_data; content:"|3c 25 40|page"; depth:7; content:"|22|os.name|22|"; distance:0; content:"|22|/bin/sh|22|"; distance:0; content:"getRuntime|28 29|.exec|28|"; fast_pattern; metadata:former_category WEB_SERVER, flip_endpoints True, server_side True; reference:md5,91eaca79943c972cb2ca7ee0e462922c; classtype:trojan-activity; sid:1070165; rev:3; metadata:affected_product Web_Server_Applications, attack_target Web_Server, deployment Datacenter, tag WebShell, signature_severity Major, created_at 2018_09_20, malware_family SJavaWebManage, performance_impact Low, updated_at 2018_09_25; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET WEB_SERVER JSP.SJavaWebManage WebShell Pass 20-09-2018 1 (trojan-activity) - detector_id: 70166 original_sid: 2026337
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"ET WEB_SERVER JSP.SJavaWebManage WebShell Pass 20-09-2018 1"; flow:established,from_server; file_data; content:"|3c 25 40|page"; depth:7; content:"String|20|PASS|20|=|20 22|09a0aa1091460d23e5a68550826b359b|22|"; distance:0; fast_pattern; metadata:former_category WEB_SERVER, flip_endpoints True, server_side True; reference:md5,91eaca79943c972cb2ca7ee0e462922c; classtype:trojan-activity; sid:1070166; rev:2; metadata:affected_product Web_Server_Applications, attack_target Web_Server, deployment Datacenter, tag WebShell, signature_severity Major, created_at 2018_09_20, malware_family SJavaWebManage, performance_impact Low, updated_at 2018_09_25; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET WEB_SERVER JSP.SJavaWebManage WebShell Pass 20-09-2018 2 (trojan-activity) - detector_id: 70167 original_sid: 2026338
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"ET WEB_SERVER JSP.SJavaWebManage WebShell Pass 20-09-2018 2"; flow:established,from_server; file_data; content:"|3c 25 40|page"; depth:7; content:"String|20|PASS|20|=|20 22|098f6bcd4621d373cade4e832627b4f6|22|"; distance:0; fast_pattern; metadata:former_category WEB_SERVER, flip_endpoints True, server_side True; reference:md5,91eaca79943c972cb2ca7ee0e462922c; classtype:trojan-activity; sid:1070167; rev:2; metadata:affected_product Web_Server_Applications, attack_target Web_Server, deployment Datacenter, tag WebShell, signature_severity Major, created_at 2018_09_20, malware_family SJavaWebManage, performance_impact Low, updated_at 2018_09_25; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET WEB_SERVER jQuery File Upload Attempt (web-application-attack) - detector_id: 70168 original_sid: 2026552
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER jQuery File Upload Attempt"; flow:established,to_server; content:"POST"; http_method; content:"/php/"; http_uri; content:"name=|22|files|22 3b|"; http_client_body; content:"<?php"; nocase; http_client_body; metadata:former_category WEB_SERVER, flip_endpoints False, server_side True; reference:url,github.com/lcashdol/Exploits/tree/master/CVE-2018-9206; reference:cve,2018-9206; classtype:web-application-attack; sid:1070168; rev:3; metadata:affected_product PHP, attack_target Server, deployment Datacenter, signature_severity Major, created_at 2018_10_25, updated_at 2018_10_25; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER HP Intelligent Management Java Deserialization RCE Attempt (web-application-attack) - detector_id: 70169 original_sid: 2026719
alert http $EXTERNAL_NET any -> $HTTP_SERVERS any (msg:"ET WEB_SERVER HP Intelligent Management Java Deserialization RCE Attempt"; flow:established,to_server; content:"POST"; http_method; content:"/login.jsf"; http_uri; content:"java.util.HashMap"; http_client_body; content:"javax.management.openmbean.TabularDataSupport"; http_client_body; metadata:former_category WEB_SERVER, flip_endpoints False, server_side True; reference:cve,2017-12557; reference:url,www.exploit-db.com/exploits/45952; classtype:web-application-attack; sid:1070169; rev:2; metadata:affected_product Web_Server_Applications, attack_target Web_Server, deployment Datacenter, signature_severity Major, created_at 2018_12_10, updated_at 2018_12_10; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER ThinkPHP RCE Exploitation Attempt (attempted-admin) - detector_id: 70170 original_sid: 2026731
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_SERVER ThinkPHP RCE Exploitation Attempt"; flow:established,to_server; content:"GET"; http_method; content:"/index"; http_uri; content:"/invokefunction&function=call_user_func_array"; http_uri; distance:0; fast_pattern; metadata:former_category WEB_SERVER, flip_endpoints False, server_side True; reference:url,www.exploit-db.com/exploits/45978; classtype:attempted-admin; sid:1070170; rev:2; metadata:affected_product PHP, attack_target Web_Server, deployment Perimeter, deployment Datacenter, tag ThinkPHP, signature_severity Major, created_at 2018_12_14, performance_impact Low, updated_at 2019_06_03; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

# ET WEB_SERVER China Chopper WebShell Observed Outbound (trojan-activity) - detector_id: 75932 original_sid: 2027341
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"ET WEB_SERVER China Chopper WebShell Observed Outbound"; flow:established,from_server; content:"200"; http_stat_code; file_data; content:"<%@|20|Page|20|Language=|22|Jscript|22|%><eval|28|Request.Item|5b|"; fast_pattern; content:"|22 29 3b|%>"; distance:0; within:50; metadata:former_category WEB_SERVER, flip_endpoints True, server_side True; classtype:trojan-activity; sid:1075932; rev:2; metadata:created_at 2019_05_09, performance_impact Low, updated_at 2019_05_09; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET WEB_SERVER China Chopper WebShell Observed Outbound (trojan-activity) - detector_id: 76071 original_sid: 2027393
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"ET WEB_SERVER China Chopper WebShell Observed Outbound"; flow:established,from_server; content:"200"; http_stat_code; file_data; content:"|3c 25 40 20|Page|20|Language=|22|Jscript|22 25 3e 3c 25|eval|28|"; fast_pattern; content:"FromBase64String"; distance:0; nocase; content:"|25 3e|"; distance:0; metadata:former_category WEB_SERVER, flip_endpoints True, server_side True; classtype:trojan-activity; sid:1076071; rev:1; metadata:affected_product Web_Server_Applications, attack_target Server, deployment Perimeter, signature_severity Major, created_at 2019_05_29, performance_impact Low, updated_at 2019_05_29; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET WEB_SERVER BlackSquid JSP Webshell Outbound (attempted-admin) - detector_id: 76128 original_sid: 2027433
alert http $HTTP_SERVERS any -> $EXTERNAL_NET any (msg:"ET WEB_SERVER BlackSquid JSP Webshell Outbound"; flow:established,from_server; content:"200"; http_stat_code; file_data; content:"<|25 25|java.io.InputStream|20|"; depth:25; content:"Runtime.getRunetime|28 29|.exec|28|request"; distance:0; within:50; content:".getInputStream|28 29 3b|int|20|"; distance:0; fast_pattern; metadata:former_category WEB_SERVER, flip_endpoints True, server_side True; reference:url,blog.trendmicro.com/trendlabs-security-intelligence/blacksquid-slithers-into-servers-and-drives-with-8-notorious-exploits-to-drop-xmrig-miner/; classtype:attempted-admin; sid:1076128; rev:1; metadata:attack_target Web_Server, deployment Perimeter, signature_severity Major, created_at 2019_06_04, performance_impact Low, updated_at 2019_06_04; threshold: type limit, track by_src, seconds 60, count 10; target:src_ip;)

# ET WEB_SERVER Observed FxCodeShell Web Shell Password (trojan-activity) - detector_id: 91491 original_sid: 2027514
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"ET WEB_SERVER Observed FxCodeShell Web Shell Password"; flow:established,to_server; content:"FxxkMyLie1836710Aa"; http_client_body; metadata:former_category WEB_SERVER, flip_endpoints False, server_side True; classtype:trojan-activity; sid:1091491; rev:2; metadata:affected_product Web_Server_Applications, attack_target Client_Endpoint, deployment Perimeter, signature_severity Major, created_at 2019_06_25, malware_family FxCodeShell, performance_impact Low, updated_at 2019_06_26; threshold: type limit, track by_src, seconds 60, count 10; target:dest_ip;)

